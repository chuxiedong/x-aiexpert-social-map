(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function K0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var uv={exports:{}},$d={},cv={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NM;function _I(){if(NM)return $t;NM=1;var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function p(U){return U===null||typeof U!="object"?null:(U=f&&U[f]||U["@@iterator"],typeof U=="function"?U:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function v(U,H,le){this.props=U,this.context=H,this.refs=b,this.updater=le||m}v.prototype.isReactComponent={},v.prototype.setState=function(U,H){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,H,"setState")},v.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function y(){}y.prototype=v.prototype;function S(U,H,le){this.props=U,this.context=H,this.refs=b,this.updater=le||m}var T=S.prototype=new y;T.constructor=S,_(T,v.prototype),T.isPureReactComponent=!0;var E=Array.isArray,N=Object.prototype.hasOwnProperty,M={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function D(U,H,le){var Te,Fe={},ie=null,q=null;if(H!=null)for(Te in H.ref!==void 0&&(q=H.ref),H.key!==void 0&&(ie=""+H.key),H)N.call(H,Te)&&!C.hasOwnProperty(Te)&&(Fe[Te]=H[Te]);var re=arguments.length-2;if(re===1)Fe.children=le;else if(1<re){for(var we=Array(re),He=0;He<re;He++)we[He]=arguments[He+2];Fe.children=we}if(U&&U.defaultProps)for(Te in re=U.defaultProps,re)Fe[Te]===void 0&&(Fe[Te]=re[Te]);return{$$typeof:i,type:U,key:ie,ref:q,props:Fe,_owner:M.current}}function R(U,H){return{$$typeof:i,type:U.type,key:H,ref:U.ref,props:U.props,_owner:U._owner}}function P(U){return typeof U=="object"&&U!==null&&U.$$typeof===i}function L(U){var H={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(le){return H[le]})}var z=/\/+/g;function B(U,H){return typeof U=="object"&&U!==null&&U.key!=null?L(""+U.key):H.toString(36)}function O(U,H,le,Te,Fe){var ie=typeof U;(ie==="undefined"||ie==="boolean")&&(U=null);var q=!1;if(U===null)q=!0;else switch(ie){case"string":case"number":q=!0;break;case"object":switch(U.$$typeof){case i:case e:q=!0}}if(q)return q=U,Fe=Fe(q),U=Te===""?"."+B(q,0):Te,E(Fe)?(le="",U!=null&&(le=U.replace(z,"$&/")+"/"),O(Fe,H,le,"",function(He){return He})):Fe!=null&&(P(Fe)&&(Fe=R(Fe,le+(!Fe.key||q&&q.key===Fe.key?"":(""+Fe.key).replace(z,"$&/")+"/")+U)),H.push(Fe)),1;if(q=0,Te=Te===""?".":Te+":",E(U))for(var re=0;re<U.length;re++){ie=U[re];var we=Te+B(ie,re);q+=O(ie,H,le,we,Fe)}else if(we=p(U),typeof we=="function")for(U=we.call(U),re=0;!(ie=U.next()).done;)ie=ie.value,we=Te+B(ie,re++),q+=O(ie,H,le,we,Fe);else if(ie==="object")throw H=String(U),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return q}function V(U,H,le){if(U==null)return U;var Te=[],Fe=0;return O(U,Te,"","",function(ie){return H.call(le,ie,Fe++)}),Te}function Y(U){if(U._status===-1){var H=U._result;H=H(),H.then(function(le){(U._status===0||U._status===-1)&&(U._status=1,U._result=le)},function(le){(U._status===0||U._status===-1)&&(U._status=2,U._result=le)}),U._status===-1&&(U._status=0,U._result=H)}if(U._status===1)return U._result.default;throw U._result}var G={current:null},W={transition:null},te={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:W,ReactCurrentOwner:M};return $t.Children={map:V,forEach:function(U,H,le){V(U,function(){H.apply(this,arguments)},le)},count:function(U){var H=0;return V(U,function(){H++}),H},toArray:function(U){return V(U,function(H){return H})||[]},only:function(U){if(!P(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},$t.Component=v,$t.Fragment=t,$t.Profiler=r,$t.PureComponent=S,$t.StrictMode=n,$t.Suspense=l,$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,$t.cloneElement=function(U,H,le){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var Te=_({},U.props),Fe=U.key,ie=U.ref,q=U._owner;if(H!=null){if(H.ref!==void 0&&(ie=H.ref,q=M.current),H.key!==void 0&&(Fe=""+H.key),U.type&&U.type.defaultProps)var re=U.type.defaultProps;for(we in H)N.call(H,we)&&!C.hasOwnProperty(we)&&(Te[we]=H[we]===void 0&&re!==void 0?re[we]:H[we])}var we=arguments.length-2;if(we===1)Te.children=le;else if(1<we){re=Array(we);for(var He=0;He<we;He++)re[He]=arguments[He+2];Te.children=re}return{$$typeof:i,type:U.type,key:Fe,ref:ie,props:Te,_owner:q}},$t.createContext=function(U){return U={$$typeof:a,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:s,_context:U},U.Consumer=U},$t.createElement=D,$t.createFactory=function(U){var H=D.bind(null,U);return H.type=U,H},$t.createRef=function(){return{current:null}},$t.forwardRef=function(U){return{$$typeof:o,render:U}},$t.isValidElement=P,$t.lazy=function(U){return{$$typeof:d,_payload:{_status:-1,_result:U},_init:Y}},$t.memo=function(U,H){return{$$typeof:c,type:U,compare:H===void 0?null:H}},$t.startTransition=function(U){var H=W.transition;W.transition={};try{U()}finally{W.transition=H}},$t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},$t.useCallback=function(U,H){return G.current.useCallback(U,H)},$t.useContext=function(U){return G.current.useContext(U)},$t.useDebugValue=function(){},$t.useDeferredValue=function(U){return G.current.useDeferredValue(U)},$t.useEffect=function(U,H){return G.current.useEffect(U,H)},$t.useId=function(){return G.current.useId()},$t.useImperativeHandle=function(U,H,le){return G.current.useImperativeHandle(U,H,le)},$t.useInsertionEffect=function(U,H){return G.current.useInsertionEffect(U,H)},$t.useLayoutEffect=function(U,H){return G.current.useLayoutEffect(U,H)},$t.useMemo=function(U,H){return G.current.useMemo(U,H)},$t.useReducer=function(U,H,le){return G.current.useReducer(U,H,le)},$t.useRef=function(U){return G.current.useRef(U)},$t.useState=function(U){return G.current.useState(U)},$t.useSyncExternalStore=function(U,H,le){return G.current.useSyncExternalStore(U,H,le)},$t.useTransition=function(){return G.current.useTransition()},$t.version="18.2.0",$t}var PM;function Ew(){return PM||(PM=1,cv.exports=_I()),cv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DM;function yI(){if(DM)return $d;DM=1;var i=Ew(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var d,f={},p=null,m=null;c!==void 0&&(p=""+c),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(m=l.ref);for(d in l)n.call(l,d)&&!s.hasOwnProperty(d)&&(f[d]=l[d]);if(o&&o.defaultProps)for(d in l=o.defaultProps,l)f[d]===void 0&&(f[d]=l[d]);return{$$typeof:e,type:o,key:p,ref:m,props:f,_owner:r.current}}return $d.Fragment=t,$d.jsx=a,$d.jsxs=a,$d}var kM;function vI(){return kM||(kM=1,uv.exports=yI()),uv.exports}var me=vI(),mt=Ew();const mR=K0(mt);var Hg={},hv={exports:{}},Sr={},dv={exports:{}},fv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IM;function xI(){return IM||(IM=1,(function(i){function e(W,te){var U=W.length;W.push(te);e:for(;0<U;){var H=U-1>>>1,le=W[H];if(0<r(le,te))W[H]=te,W[U]=le,U=H;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var te=W[0],U=W.pop();if(U!==te){W[0]=U;e:for(var H=0,le=W.length,Te=le>>>1;H<Te;){var Fe=2*(H+1)-1,ie=W[Fe],q=Fe+1,re=W[q];if(0>r(ie,U))q<le&&0>r(re,ie)?(W[H]=re,W[q]=U,H=q):(W[H]=ie,W[Fe]=U,H=Fe);else if(q<le&&0>r(re,U))W[H]=re,W[q]=U,H=q;else break e}}return te}function r(W,te){var U=W.sortIndex-te.sortIndex;return U!==0?U:W.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,f=null,p=3,m=!1,_=!1,b=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(W){for(var te=t(c);te!==null;){if(te.callback===null)n(c);else if(te.startTime<=W)n(c),te.sortIndex=te.expirationTime,e(l,te);else break;te=t(c)}}function E(W){if(b=!1,T(W),!_)if(t(l)!==null)_=!0,Y(N);else{var te=t(c);te!==null&&G(E,te.startTime-W)}}function N(W,te){_=!1,b&&(b=!1,y(D),D=-1),m=!0;var U=p;try{for(T(te),f=t(l);f!==null&&(!(f.expirationTime>te)||W&&!L());){var H=f.callback;if(typeof H=="function"){f.callback=null,p=f.priorityLevel;var le=H(f.expirationTime<=te);te=i.unstable_now(),typeof le=="function"?f.callback=le:f===t(l)&&n(l),T(te)}else n(l);f=t(l)}if(f!==null)var Te=!0;else{var Fe=t(c);Fe!==null&&G(E,Fe.startTime-te),Te=!1}return Te}finally{f=null,p=U,m=!1}}var M=!1,C=null,D=-1,R=5,P=-1;function L(){return!(i.unstable_now()-P<R)}function z(){if(C!==null){var W=i.unstable_now();P=W;var te=!0;try{te=C(!0,W)}finally{te?B():(M=!1,C=null)}}else M=!1}var B;if(typeof S=="function")B=function(){S(z)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,V=O.port2;O.port1.onmessage=z,B=function(){V.postMessage(null)}}else B=function(){v(z,0)};function Y(W){C=W,M||(M=!0,B())}function G(W,te){D=v(function(){W(i.unstable_now())},te)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_continueExecution=function(){_||m||(_=!0,Y(N))},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(W){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var U=p;p=te;try{return W()}finally{p=U}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(W,te){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var U=p;p=W;try{return te()}finally{p=U}},i.unstable_scheduleCallback=function(W,te,U){var H=i.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?H+U:H):U=H,W){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=U+le,W={id:d++,callback:te,priorityLevel:W,startTime:U,expirationTime:le,sortIndex:-1},U>H?(W.sortIndex=U,e(c,W),t(l)===null&&W===t(c)&&(b?(y(D),D=-1):b=!0,G(E,U-H))):(W.sortIndex=le,e(l,W),_||m||(_=!0,Y(N))),W},i.unstable_shouldYield=L,i.unstable_wrapCallback=function(W){var te=p;return function(){var U=p;p=te;try{return W.apply(this,arguments)}finally{p=U}}}})(fv)),fv}var LM;function bI(){return LM||(LM=1,dv.exports=xI()),dv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FM;function wI(){if(FM)return Sr;FM=1;var i=Ew(),e=bI();function t(u){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+u,g=1;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function s(u,h){a(u,h),a(u+"Capture",h)}function a(u,h){for(r[u]=h,u=0;u<h.length;u++)n.add(h[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function p(u){return l.call(f,u)?!0:l.call(d,u)?!1:c.test(u)?f[u]=!0:(d[u]=!0,!1)}function m(u,h,g,x){if(g!==null&&g.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return x?!1:g!==null?!g.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function _(u,h,g,x){if(h===null||typeof h>"u"||m(u,h,g,x))return!0;if(x)return!1;if(g!==null)switch(g.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function b(u,h,g,x,w,A,I){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=x,this.attributeNamespace=w,this.mustUseProperty=g,this.propertyName=u,this.type=h,this.sanitizeURL=A,this.removeEmptyString=I}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){v[u]=new b(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var h=u[0];v[h]=new b(h,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){v[u]=new b(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){v[u]=new b(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){v[u]=new b(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){v[u]=new b(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){v[u]=new b(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){v[u]=new b(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){v[u]=new b(u,5,!1,u.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function S(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var h=u.replace(y,S);v[h]=new b(h,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var h=u.replace(y,S);v[h]=new b(h,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var h=u.replace(y,S);v[h]=new b(h,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){v[u]=new b(u,1,!1,u.toLowerCase(),null,!1,!1)}),v.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){v[u]=new b(u,1,!1,u.toLowerCase(),null,!0,!0)});function T(u,h,g,x){var w=v.hasOwnProperty(h)?v[h]:null;(w!==null?w.type!==0:x||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(_(h,g,w,x)&&(g=null),x||w===null?p(h)&&(g===null?u.removeAttribute(h):u.setAttribute(h,""+g)):w.mustUseProperty?u[w.propertyName]=g===null?w.type===3?!1:"":g:(h=w.attributeName,x=w.attributeNamespace,g===null?u.removeAttribute(h):(w=w.type,g=w===3||w===4&&g===!0?"":""+g,x?u.setAttributeNS(x,h,g):u.setAttribute(h,g))))}var E=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),M=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),L=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),W=Symbol.iterator;function te(u){return u===null||typeof u!="object"?null:(u=W&&u[W]||u["@@iterator"],typeof u=="function"?u:null)}var U=Object.assign,H;function le(u){if(H===void 0)try{throw Error()}catch(g){var h=g.stack.trim().match(/\n( *(at )?)/);H=h&&h[1]||""}return`
`+H+u}var Te=!1;function Fe(u,h){if(!u||Te)return"";Te=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(pe){var x=pe}Reflect.construct(u,[],h)}else{try{h.call()}catch(pe){x=pe}u.call(h.prototype)}else{try{throw Error()}catch(pe){x=pe}u()}}catch(pe){if(pe&&x&&typeof pe.stack=="string"){for(var w=pe.stack.split(`
`),A=x.stack.split(`
`),I=w.length-1,$=A.length-1;1<=I&&0<=$&&w[I]!==A[$];)$--;for(;1<=I&&0<=$;I--,$--)if(w[I]!==A[$]){if(I!==1||$!==1)do if(I--,$--,0>$||w[I]!==A[$]){var Q=`
`+w[I].replace(" at new "," at ");return u.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",u.displayName)),Q}while(1<=I&&0<=$);break}}}finally{Te=!1,Error.prepareStackTrace=g}return(u=u?u.displayName||u.name:"")?le(u):""}function ie(u){switch(u.tag){case 5:return le(u.type);case 16:return le("Lazy");case 13:return le("Suspense");case 19:return le("SuspenseList");case 0:case 2:case 15:return u=Fe(u.type,!1),u;case 11:return u=Fe(u.type.render,!1),u;case 1:return u=Fe(u.type,!0),u;default:return""}}function q(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case C:return"Fragment";case M:return"Portal";case R:return"Profiler";case D:return"StrictMode";case B:return"Suspense";case O:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case L:return(u.displayName||"Context")+".Consumer";case P:return(u._context.displayName||"Context")+".Provider";case z:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case V:return h=u.displayName||null,h!==null?h:q(u.type)||"Memo";case Y:h=u._payload,u=u._init;try{return q(u(h))}catch{}}return null}function re(u){var h=u.type;switch(u.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=h.render,u=u.displayName||u.name||"",h.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(h);case 8:return h===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function we(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function He(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Be(u){var h=He(u)?"checked":"value",g=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),x=""+u[h];if(!u.hasOwnProperty(h)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,A=g.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return w.call(this)},set:function(I){x=""+I,A.call(this,I)}}),Object.defineProperty(u,h,{enumerable:g.enumerable}),{getValue:function(){return x},setValue:function(I){x=""+I},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function pt(u){u._valueTracker||(u._valueTracker=Be(u))}function ln(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var g=h.getValue(),x="";return u&&(x=He(u)?u.checked?"true":"false":u.value),u=x,u!==g?(h.setValue(u),!0):!1}function Dt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function zt(u,h){var g=h.checked;return U({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??u._wrapperState.initialChecked})}function Yt(u,h){var g=h.defaultValue==null?"":h.defaultValue,x=h.checked!=null?h.checked:h.defaultChecked;g=we(h.value!=null?h.value:g),u._wrapperState={initialChecked:x,initialValue:g,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Ct(u,h){h=h.checked,h!=null&&T(u,"checked",h,!1)}function tn(u,h){Ct(u,h);var g=we(h.value),x=h.type;if(g!=null)x==="number"?(g===0&&u.value===""||u.value!=g)&&(u.value=""+g):u.value!==""+g&&(u.value=""+g);else if(x==="submit"||x==="reset"){u.removeAttribute("value");return}h.hasOwnProperty("value")?Gn(u,h.type,g):h.hasOwnProperty("defaultValue")&&Gn(u,h.type,we(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(u.defaultChecked=!!h.defaultChecked)}function Z(u,h,g){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var x=h.type;if(!(x!=="submit"&&x!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+u._wrapperState.initialValue,g||h===u.value||(u.value=h),u.defaultValue=h}g=u.name,g!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,g!==""&&(u.name=g)}function Gn(u,h,g){(h!=="number"||Dt(u.ownerDocument)!==u)&&(g==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+g&&(u.defaultValue=""+g))}var Kt=Array.isArray;function nn(u,h,g,x){if(u=u.options,h){h={};for(var w=0;w<g.length;w++)h["$"+g[w]]=!0;for(g=0;g<u.length;g++)w=h.hasOwnProperty("$"+u[g].value),u[g].selected!==w&&(u[g].selected=w),w&&x&&(u[g].defaultSelected=!0)}else{for(g=""+we(g),h=null,w=0;w<u.length;w++){if(u[w].value===g){u[w].selected=!0,x&&(u[w].defaultSelected=!0);return}h!==null||u[w].disabled||(h=u[w])}h!==null&&(h.selected=!0)}}function ut(u,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return U({},h,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function j(u,h){var g=h.value;if(g==null){if(g=h.children,h=h.defaultValue,g!=null){if(h!=null)throw Error(t(92));if(Kt(g)){if(1<g.length)throw Error(t(93));g=g[0]}h=g}h==null&&(h=""),g=h}u._wrapperState={initialValue:we(g)}}function k(u,h){var g=we(h.value),x=we(h.defaultValue);g!=null&&(g=""+g,g!==u.value&&(u.value=g),h.defaultValue==null&&u.defaultValue!==g&&(u.defaultValue=g)),x!=null&&(u.defaultValue=""+x)}function se(u){var h=u.textContent;h===u._wrapperState.initialValue&&h!==""&&h!==null&&(u.value=h)}function Me(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Re(u,h){return u==null||u==="http://www.w3.org/1999/xhtml"?Me(h):u==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var be,dt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,g,x,w){MSApp.execUnsafeLocalFunction(function(){return u(h,g,x,w)})}:u})(function(u,h){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=h;else{for(be=be||document.createElement("div"),be.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=be.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;h.firstChild;)u.appendChild(h.firstChild)}});function ze(u,h){if(h){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=h;return}}u.textContent=h}var it={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rt=["Webkit","ms","Moz","O"];Object.keys(it).forEach(function(u){Rt.forEach(function(h){h=h+u.charAt(0).toUpperCase()+u.substring(1),it[h]=it[u]})});function Ie(u,h,g){return h==null||typeof h=="boolean"||h===""?"":g||typeof h!="number"||h===0||it.hasOwnProperty(u)&&it[u]?(""+h).trim():h+"px"}function We(u,h){u=u.style;for(var g in h)if(h.hasOwnProperty(g)){var x=g.indexOf("--")===0,w=Ie(g,h[g],x);g==="float"&&(g="cssFloat"),x?u.setProperty(g,w):u[g]=w}}var ot=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ct(u,h){if(h){if(ot[u]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function Ve(u,h){if(u.indexOf("-")===-1)return typeof h.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=null;function J(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var qe=null,Le=null,Ye=null;function De(u){if(u=Pd(u)){if(typeof qe!="function")throw Error(t(280));var h=u.stateNode;h&&(h=sg(h),qe(u.stateNode,u.type,h))}}function Ce(u){Le?Ye?Ye.push(u):Ye=[u]:Le=u}function je(){if(Le){var u=Le,h=Ye;if(Ye=Le=null,De(u),h)for(u=0;u<h.length;u++)De(h[u])}}function Nt(u,h){return u(h)}function xn(){}var rn=!1;function Ur(u,h,g){if(rn)return u(h,g);rn=!0;try{return Nt(u,h,g)}finally{rn=!1,(Le!==null||Ye!==null)&&(xn(),je())}}function tr(u,h){var g=u.stateNode;if(g===null)return null;var x=sg(g);if(x===null)return null;g=x[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(u=u.type,x=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!x;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(t(231,h,typeof g));return g}var cd=!1;if(o)try{var bo={};Object.defineProperty(bo,"passive",{get:function(){cd=!0}}),window.addEventListener("test",bo,bo),window.removeEventListener("test",bo,bo)}catch{cd=!1}function hd(u,h,g,x,w,A,I,$,Q){var pe=Array.prototype.slice.call(arguments,3);try{h.apply(g,pe)}catch(Pe){this.onError(Pe)}}var Ml=!1,Al=null,El=!1,ws=null,dd={onError:function(u){Ml=!0,Al=u}};function Op(u,h,g,x,w,A,I,$,Q){Ml=!1,Al=null,hd.apply(dd,arguments)}function Bp(u,h,g,x,w,A,I,$,Q){if(Op.apply(this,arguments),Ml){if(Ml){var pe=Al;Ml=!1,Al=null}else throw Error(t(198));El||(El=!0,ws=pe)}}function ns(u){var h=u,g=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(g=h.return),u=h.return;while(u)}return h.tag===3?g:null}function fd(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function Cl(u){if(ns(u)!==u)throw Error(t(188))}function zp(u){var h=u.alternate;if(!h){if(h=ns(u),h===null)throw Error(t(188));return h!==u?null:u}for(var g=u,x=h;;){var w=g.return;if(w===null)break;var A=w.alternate;if(A===null){if(x=w.return,x!==null){g=x;continue}break}if(w.child===A.child){for(A=w.child;A;){if(A===g)return Cl(w),u;if(A===x)return Cl(w),h;A=A.sibling}throw Error(t(188))}if(g.return!==x.return)g=w,x=A;else{for(var I=!1,$=w.child;$;){if($===g){I=!0,g=w,x=A;break}if($===x){I=!0,x=w,g=A;break}$=$.sibling}if(!I){for($=A.child;$;){if($===g){I=!0,g=A,x=w;break}if($===x){I=!0,x=A,g=w;break}$=$.sibling}if(!I)throw Error(t(189))}}if(g.alternate!==x)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?u:h}function pd(u){return u=zp(u),u!==null?Gp(u):null}function Gp(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var h=Gp(u);if(h!==null)return h;u=u.sibling}return null}var Vp=e.unstable_scheduleCallback,jp=e.unstable_cancelCallback,D_=e.unstable_shouldYield,k_=e.unstable_requestPaint,Xn=e.unstable_now,F=e.unstable_getCurrentPriorityLevel,ae=e.unstable_ImmediatePriority,ge=e.unstable_UserBlockingPriority,de=e.unstable_NormalPriority,ce=e.unstable_LowPriority,$e=e.unstable_IdlePriority,Je=null,Ge=null;function at(u){if(Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(Je,u,void 0,(u.current.flags&128)===128)}catch{}}var nt=Math.clz32?Math.clz32:Vt,At=Math.log,vt=Math.LN2;function Vt(u){return u>>>=0,u===0?32:31-(At(u)/vt|0)|0}var sn=64,Cn=4194304;function Tn(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function un(u,h){var g=u.pendingLanes;if(g===0)return 0;var x=0,w=u.suspendedLanes,A=u.pingedLanes,I=g&268435455;if(I!==0){var $=I&~w;$!==0?x=Tn($):(A&=I,A!==0&&(x=Tn(A)))}else I=g&~w,I!==0?x=Tn(I):A!==0&&(x=Tn(A));if(x===0)return 0;if(h!==0&&h!==x&&(h&w)===0&&(w=x&-x,A=h&-h,w>=A||w===16&&(A&4194240)!==0))return h;if((x&4)!==0&&(x|=g&16),h=u.entangledLanes,h!==0)for(u=u.entanglements,h&=x;0<h;)g=31-nt(h),w=1<<g,x|=u[g],h&=~w;return x}function xt(u,h){switch(u){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fn(u,h){for(var g=u.suspendedLanes,x=u.pingedLanes,w=u.expirationTimes,A=u.pendingLanes;0<A;){var I=31-nt(A),$=1<<I,Q=w[I];Q===-1?(($&g)===0||($&x)!==0)&&(w[I]=xt($,h)):Q<=h&&(u.expiredLanes|=$),A&=~$}}function Zt(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function Fi(){var u=sn;return sn<<=1,(sn&4194240)===0&&(sn=64),u}function Qs(u){for(var h=[],g=0;31>g;g++)h.push(u);return h}function ui(u,h,g){u.pendingLanes|=h,h!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,h=31-nt(h),u[h]=g}function Rl(u,h){var g=u.pendingLanes&~h;u.pendingLanes=h,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=h,u.mutableReadLanes&=h,u.entangledLanes&=h,h=u.entanglements;var x=u.eventTimes;for(u=u.expirationTimes;0<g;){var w=31-nt(g),A=1<<w;h[w]=0,x[w]=-1,u[w]=-1,g&=~A}}function mn(u,h){var g=u.entangledLanes|=h;for(u=u.entanglements;g;){var x=31-nt(g),w=1<<x;w&h|u[x]&h&&(u[x]|=h),g&=~w}}var Lt=0;function nr(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var _i,yi,Bu,Js,h1,I_=!1,Hp=[],wo=null,So=null,To=null,gd=new Map,md=new Map,Mo=[],BD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d1(u,h){switch(u){case"focusin":case"focusout":wo=null;break;case"dragenter":case"dragleave":So=null;break;case"mouseover":case"mouseout":To=null;break;case"pointerover":case"pointerout":gd.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":md.delete(h.pointerId)}}function _d(u,h,g,x,w,A){return u===null||u.nativeEvent!==A?(u={blockedOn:h,domEventName:g,eventSystemFlags:x,nativeEvent:A,targetContainers:[w]},h!==null&&(h=Pd(h),h!==null&&yi(h)),u):(u.eventSystemFlags|=x,h=u.targetContainers,w!==null&&h.indexOf(w)===-1&&h.push(w),u)}function zD(u,h,g,x,w){switch(h){case"focusin":return wo=_d(wo,u,h,g,x,w),!0;case"dragenter":return So=_d(So,u,h,g,x,w),!0;case"mouseover":return To=_d(To,u,h,g,x,w),!0;case"pointerover":var A=w.pointerId;return gd.set(A,_d(gd.get(A)||null,u,h,g,x,w)),!0;case"gotpointercapture":return A=w.pointerId,md.set(A,_d(md.get(A)||null,u,h,g,x,w)),!0}return!1}function f1(u){var h=Nl(u.target);if(h!==null){var g=ns(h);if(g!==null){if(h=g.tag,h===13){if(h=fd(g),h!==null){u.blockedOn=h,h1(u.priority,function(){Bu(g)});return}}else if(h===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Wp(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var g=F_(u.domEventName,u.eventSystemFlags,h[0],u.nativeEvent);if(g===null){g=u.nativeEvent;var x=new g.constructor(g.type,g);Ot=x,g.target.dispatchEvent(x),Ot=null}else return h=Pd(g),h!==null&&yi(h),u.blockedOn=g,!1;h.shift()}return!0}function p1(u,h,g){Wp(u)&&g.delete(h)}function GD(){I_=!1,wo!==null&&Wp(wo)&&(wo=null),So!==null&&Wp(So)&&(So=null),To!==null&&Wp(To)&&(To=null),gd.forEach(p1),md.forEach(p1)}function yd(u,h){u.blockedOn===h&&(u.blockedOn=null,I_||(I_=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,GD)))}function vd(u){function h(w){return yd(w,u)}if(0<Hp.length){yd(Hp[0],u);for(var g=1;g<Hp.length;g++){var x=Hp[g];x.blockedOn===u&&(x.blockedOn=null)}}for(wo!==null&&yd(wo,u),So!==null&&yd(So,u),To!==null&&yd(To,u),gd.forEach(h),md.forEach(h),g=0;g<Mo.length;g++)x=Mo[g],x.blockedOn===u&&(x.blockedOn=null);for(;0<Mo.length&&(g=Mo[0],g.blockedOn===null);)f1(g),g.blockedOn===null&&Mo.shift()}var zu=E.ReactCurrentBatchConfig,$p=!0;function VD(u,h,g,x){var w=Lt,A=zu.transition;zu.transition=null;try{Lt=1,L_(u,h,g,x)}finally{Lt=w,zu.transition=A}}function jD(u,h,g,x){var w=Lt,A=zu.transition;zu.transition=null;try{Lt=4,L_(u,h,g,x)}finally{Lt=w,zu.transition=A}}function L_(u,h,g,x){if($p){var w=F_(u,h,g,x);if(w===null)J_(u,h,x,qp,g),d1(u,x);else if(zD(w,u,h,g,x))x.stopPropagation();else if(d1(u,x),h&4&&-1<BD.indexOf(u)){for(;w!==null;){var A=Pd(w);if(A!==null&&_i(A),A=F_(u,h,g,x),A===null&&J_(u,h,x,qp,g),A===w)break;w=A}w!==null&&x.stopPropagation()}else J_(u,h,x,null,g)}}var qp=null;function F_(u,h,g,x){if(qp=null,u=J(x),u=Nl(u),u!==null)if(h=ns(u),h===null)u=null;else if(g=h.tag,g===13){if(u=fd(h),u!==null)return u;u=null}else if(g===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null);return qp=u,null}function g1(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F()){case ae:return 1;case ge:return 4;case de:case ce:return 16;case $e:return 536870912;default:return 16}default:return 16}}var Ao=null,U_=null,Xp=null;function m1(){if(Xp)return Xp;var u,h=U_,g=h.length,x,w="value"in Ao?Ao.value:Ao.textContent,A=w.length;for(u=0;u<g&&h[u]===w[u];u++);var I=g-u;for(x=1;x<=I&&h[g-x]===w[A-x];x++);return Xp=w.slice(u,1<x?1-x:void 0)}function Yp(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function Kp(){return!0}function _1(){return!1}function Or(u){function h(g,x,w,A,I){this._reactName=g,this._targetInst=w,this.type=x,this.nativeEvent=A,this.target=I,this.currentTarget=null;for(var $ in u)u.hasOwnProperty($)&&(g=u[$],this[$]=g?g(A):A[$]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Kp:_1,this.isPropagationStopped=_1,this}return U(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Kp)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Kp)},persist:function(){},isPersistent:Kp}),h}var Gu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O_=Or(Gu),xd=U({},Gu,{view:0,detail:0}),HD=Or(xd),B_,z_,bd,Zp=U({},xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:V_,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==bd&&(bd&&u.type==="mousemove"?(B_=u.screenX-bd.screenX,z_=u.screenY-bd.screenY):z_=B_=0,bd=u),B_)},movementY:function(u){return"movementY"in u?u.movementY:z_}}),y1=Or(Zp),WD=U({},Zp,{dataTransfer:0}),$D=Or(WD),qD=U({},xd,{relatedTarget:0}),G_=Or(qD),XD=U({},Gu,{animationName:0,elapsedTime:0,pseudoElement:0}),YD=Or(XD),KD=U({},Gu,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),ZD=Or(KD),QD=U({},Gu,{data:0}),v1=Or(QD),JD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ek={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nk(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=tk[u])?!!h[u]:!1}function V_(){return nk}var ik=U({},xd,{key:function(u){if(u.key){var h=JD[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Yp(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?ek[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:V_,charCode:function(u){return u.type==="keypress"?Yp(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Yp(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),rk=Or(ik),sk=U({},Zp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x1=Or(sk),ak=U({},xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:V_}),ok=Or(ak),lk=U({},Gu,{propertyName:0,elapsedTime:0,pseudoElement:0}),uk=Or(lk),ck=U({},Zp,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),hk=Or(ck),dk=[9,13,27,32],j_=o&&"CompositionEvent"in window,wd=null;o&&"documentMode"in document&&(wd=document.documentMode);var fk=o&&"TextEvent"in window&&!wd,b1=o&&(!j_||wd&&8<wd&&11>=wd),w1=" ",S1=!1;function T1(u,h){switch(u){case"keyup":return dk.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function M1(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Vu=!1;function pk(u,h){switch(u){case"compositionend":return M1(h);case"keypress":return h.which!==32?null:(S1=!0,w1);case"textInput":return u=h.data,u===w1&&S1?null:u;default:return null}}function gk(u,h){if(Vu)return u==="compositionend"||!j_&&T1(u,h)?(u=m1(),Xp=U_=Ao=null,Vu=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return b1&&h.locale!=="ko"?null:h.data;default:return null}}var mk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A1(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!mk[u.type]:h==="textarea"}function E1(u,h,g,x){Ce(x),h=ng(h,"onChange"),0<h.length&&(g=new O_("onChange","change",null,g,x),u.push({event:g,listeners:h}))}var Sd=null,Td=null;function _k(u){W1(u,0)}function Qp(u){var h=qu(u);if(ln(h))return u}function yk(u,h){if(u==="change")return h}var C1=!1;if(o){var H_;if(o){var W_="oninput"in document;if(!W_){var R1=document.createElement("div");R1.setAttribute("oninput","return;"),W_=typeof R1.oninput=="function"}H_=W_}else H_=!1;C1=H_&&(!document.documentMode||9<document.documentMode)}function N1(){Sd&&(Sd.detachEvent("onpropertychange",P1),Td=Sd=null)}function P1(u){if(u.propertyName==="value"&&Qp(Td)){var h=[];E1(h,Td,u,J(u)),Ur(_k,h)}}function vk(u,h,g){u==="focusin"?(N1(),Sd=h,Td=g,Sd.attachEvent("onpropertychange",P1)):u==="focusout"&&N1()}function xk(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Qp(Td)}function bk(u,h){if(u==="click")return Qp(h)}function wk(u,h){if(u==="input"||u==="change")return Qp(h)}function Sk(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var Ss=typeof Object.is=="function"?Object.is:Sk;function Md(u,h){if(Ss(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var g=Object.keys(u),x=Object.keys(h);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var w=g[x];if(!l.call(h,w)||!Ss(u[w],h[w]))return!1}return!0}function D1(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function k1(u,h){var g=D1(u);u=0;for(var x;g;){if(g.nodeType===3){if(x=u+g.textContent.length,u<=h&&x>=h)return{node:g,offset:h-u};u=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=D1(g)}}function I1(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?I1(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function L1(){for(var u=window,h=Dt();h instanceof u.HTMLIFrameElement;){try{var g=typeof h.contentWindow.location.href=="string"}catch{g=!1}if(g)u=h.contentWindow;else break;h=Dt(u.document)}return h}function $_(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function Tk(u){var h=L1(),g=u.focusedElem,x=u.selectionRange;if(h!==g&&g&&g.ownerDocument&&I1(g.ownerDocument.documentElement,g)){if(x!==null&&$_(g)){if(h=x.start,u=x.end,u===void 0&&(u=h),"selectionStart"in g)g.selectionStart=h,g.selectionEnd=Math.min(u,g.value.length);else if(u=(h=g.ownerDocument||document)&&h.defaultView||window,u.getSelection){u=u.getSelection();var w=g.textContent.length,A=Math.min(x.start,w);x=x.end===void 0?A:Math.min(x.end,w),!u.extend&&A>x&&(w=x,x=A,A=w),w=k1(g,A);var I=k1(g,x);w&&I&&(u.rangeCount!==1||u.anchorNode!==w.node||u.anchorOffset!==w.offset||u.focusNode!==I.node||u.focusOffset!==I.offset)&&(h=h.createRange(),h.setStart(w.node,w.offset),u.removeAllRanges(),A>x?(u.addRange(h),u.extend(I.node,I.offset)):(h.setEnd(I.node,I.offset),u.addRange(h)))}}for(h=[],u=g;u=u.parentNode;)u.nodeType===1&&h.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<h.length;g++)u=h[g],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Mk=o&&"documentMode"in document&&11>=document.documentMode,ju=null,q_=null,Ad=null,X_=!1;function F1(u,h,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;X_||ju==null||ju!==Dt(x)||(x=ju,"selectionStart"in x&&$_(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ad&&Md(Ad,x)||(Ad=x,x=ng(q_,"onSelect"),0<x.length&&(h=new O_("onSelect","select",null,h,g),u.push({event:h,listeners:x}),h.target=ju)))}function Jp(u,h){var g={};return g[u.toLowerCase()]=h.toLowerCase(),g["Webkit"+u]="webkit"+h,g["Moz"+u]="moz"+h,g}var Hu={animationend:Jp("Animation","AnimationEnd"),animationiteration:Jp("Animation","AnimationIteration"),animationstart:Jp("Animation","AnimationStart"),transitionend:Jp("Transition","TransitionEnd")},Y_={},U1={};o&&(U1=document.createElement("div").style,"AnimationEvent"in window||(delete Hu.animationend.animation,delete Hu.animationiteration.animation,delete Hu.animationstart.animation),"TransitionEvent"in window||delete Hu.transitionend.transition);function eg(u){if(Y_[u])return Y_[u];if(!Hu[u])return u;var h=Hu[u],g;for(g in h)if(h.hasOwnProperty(g)&&g in U1)return Y_[u]=h[g];return u}var O1=eg("animationend"),B1=eg("animationiteration"),z1=eg("animationstart"),G1=eg("transitionend"),V1=new Map,j1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Eo(u,h){V1.set(u,h),s(h,[u])}for(var K_=0;K_<j1.length;K_++){var Z_=j1[K_],Ak=Z_.toLowerCase(),Ek=Z_[0].toUpperCase()+Z_.slice(1);Eo(Ak,"on"+Ek)}Eo(O1,"onAnimationEnd"),Eo(B1,"onAnimationIteration"),Eo(z1,"onAnimationStart"),Eo("dblclick","onDoubleClick"),Eo("focusin","onFocus"),Eo("focusout","onBlur"),Eo(G1,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ed="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ck=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ed));function H1(u,h,g){var x=u.type||"unknown-event";u.currentTarget=g,Bp(x,h,void 0,u),u.currentTarget=null}function W1(u,h){h=(h&4)!==0;for(var g=0;g<u.length;g++){var x=u[g],w=x.event;x=x.listeners;e:{var A=void 0;if(h)for(var I=x.length-1;0<=I;I--){var $=x[I],Q=$.instance,pe=$.currentTarget;if($=$.listener,Q!==A&&w.isPropagationStopped())break e;H1(w,$,pe),A=Q}else for(I=0;I<x.length;I++){if($=x[I],Q=$.instance,pe=$.currentTarget,$=$.listener,Q!==A&&w.isPropagationStopped())break e;H1(w,$,pe),A=Q}}}if(El)throw u=ws,El=!1,ws=null,u}function On(u,h){var g=h[sy];g===void 0&&(g=h[sy]=new Set);var x=u+"__bubble";g.has(x)||($1(h,u,2,!1),g.add(x))}function Q_(u,h,g){var x=0;h&&(x|=4),$1(g,u,x,h)}var tg="_reactListening"+Math.random().toString(36).slice(2);function Cd(u){if(!u[tg]){u[tg]=!0,n.forEach(function(g){g!=="selectionchange"&&(Ck.has(g)||Q_(g,!1,u),Q_(g,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[tg]||(h[tg]=!0,Q_("selectionchange",!1,h))}}function $1(u,h,g,x){switch(g1(h)){case 1:var w=VD;break;case 4:w=jD;break;default:w=L_}g=w.bind(null,h,g,u),w=void 0,!cd||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(w=!0),x?w!==void 0?u.addEventListener(h,g,{capture:!0,passive:w}):u.addEventListener(h,g,!0):w!==void 0?u.addEventListener(h,g,{passive:w}):u.addEventListener(h,g,!1)}function J_(u,h,g,x,w){var A=x;if((h&1)===0&&(h&2)===0&&x!==null)e:for(;;){if(x===null)return;var I=x.tag;if(I===3||I===4){var $=x.stateNode.containerInfo;if($===w||$.nodeType===8&&$.parentNode===w)break;if(I===4)for(I=x.return;I!==null;){var Q=I.tag;if((Q===3||Q===4)&&(Q=I.stateNode.containerInfo,Q===w||Q.nodeType===8&&Q.parentNode===w))return;I=I.return}for(;$!==null;){if(I=Nl($),I===null)return;if(Q=I.tag,Q===5||Q===6){x=A=I;continue e}$=$.parentNode}}x=x.return}Ur(function(){var pe=A,Pe=J(g),ke=[];e:{var Ne=V1.get(u);if(Ne!==void 0){var et=O_,lt=u;switch(u){case"keypress":if(Yp(g)===0)break e;case"keydown":case"keyup":et=rk;break;case"focusin":lt="focus",et=G_;break;case"focusout":lt="blur",et=G_;break;case"beforeblur":case"afterblur":et=G_;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=y1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=$D;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=ok;break;case O1:case B1:case z1:et=YD;break;case G1:et=uk;break;case"scroll":et=HD;break;case"wheel":et=hk;break;case"copy":case"cut":case"paste":et=ZD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=x1}var ht=(h&4)!==0,ei=!ht&&u==="scroll",ue=ht?Ne!==null?Ne+"Capture":null:Ne;ht=[];for(var ne=pe,he;ne!==null;){he=ne;var Ue=he.stateNode;if(he.tag===5&&Ue!==null&&(he=Ue,ue!==null&&(Ue=tr(ne,ue),Ue!=null&&ht.push(Rd(ne,Ue,he)))),ei)break;ne=ne.return}0<ht.length&&(Ne=new et(Ne,lt,null,g,Pe),ke.push({event:Ne,listeners:ht}))}}if((h&7)===0){e:{if(Ne=u==="mouseover"||u==="pointerover",et=u==="mouseout"||u==="pointerout",Ne&&g!==Ot&&(lt=g.relatedTarget||g.fromElement)&&(Nl(lt)||lt[Pa]))break e;if((et||Ne)&&(Ne=Pe.window===Pe?Pe:(Ne=Pe.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,et?(lt=g.relatedTarget||g.toElement,et=pe,lt=lt?Nl(lt):null,lt!==null&&(ei=ns(lt),lt!==ei||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(et=null,lt=pe),et!==lt)){if(ht=y1,Ue="onMouseLeave",ue="onMouseEnter",ne="mouse",(u==="pointerout"||u==="pointerover")&&(ht=x1,Ue="onPointerLeave",ue="onPointerEnter",ne="pointer"),ei=et==null?Ne:qu(et),he=lt==null?Ne:qu(lt),Ne=new ht(Ue,ne+"leave",et,g,Pe),Ne.target=ei,Ne.relatedTarget=he,Ue=null,Nl(Pe)===pe&&(ht=new ht(ue,ne+"enter",lt,g,Pe),ht.target=he,ht.relatedTarget=ei,Ue=ht),ei=Ue,et&&lt)t:{for(ht=et,ue=lt,ne=0,he=ht;he;he=Wu(he))ne++;for(he=0,Ue=ue;Ue;Ue=Wu(Ue))he++;for(;0<ne-he;)ht=Wu(ht),ne--;for(;0<he-ne;)ue=Wu(ue),he--;for(;ne--;){if(ht===ue||ue!==null&&ht===ue.alternate)break t;ht=Wu(ht),ue=Wu(ue)}ht=null}else ht=null;et!==null&&q1(ke,Ne,et,ht,!1),lt!==null&&ei!==null&&q1(ke,ei,lt,ht,!0)}}e:{if(Ne=pe?qu(pe):window,et=Ne.nodeName&&Ne.nodeName.toLowerCase(),et==="select"||et==="input"&&Ne.type==="file")var gt=yk;else if(A1(Ne))if(C1)gt=wk;else{gt=xk;var St=vk}else(et=Ne.nodeName)&&et.toLowerCase()==="input"&&(Ne.type==="checkbox"||Ne.type==="radio")&&(gt=bk);if(gt&&(gt=gt(u,pe))){E1(ke,gt,g,Pe);break e}St&&St(u,Ne,pe),u==="focusout"&&(St=Ne._wrapperState)&&St.controlled&&Ne.type==="number"&&Gn(Ne,"number",Ne.value)}switch(St=pe?qu(pe):window,u){case"focusin":(A1(St)||St.contentEditable==="true")&&(ju=St,q_=pe,Ad=null);break;case"focusout":Ad=q_=ju=null;break;case"mousedown":X_=!0;break;case"contextmenu":case"mouseup":case"dragend":X_=!1,F1(ke,g,Pe);break;case"selectionchange":if(Mk)break;case"keydown":case"keyup":F1(ke,g,Pe)}var Tt;if(j_)e:{switch(u){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else Vu?T1(u,g)&&(Pt="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(Pt="onCompositionStart");Pt&&(b1&&g.locale!=="ko"&&(Vu||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&Vu&&(Tt=m1()):(Ao=Pe,U_="value"in Ao?Ao.value:Ao.textContent,Vu=!0)),St=ng(pe,Pt),0<St.length&&(Pt=new v1(Pt,u,null,g,Pe),ke.push({event:Pt,listeners:St}),Tt?Pt.data=Tt:(Tt=M1(g),Tt!==null&&(Pt.data=Tt)))),(Tt=fk?pk(u,g):gk(u,g))&&(pe=ng(pe,"onBeforeInput"),0<pe.length&&(Pe=new v1("onBeforeInput","beforeinput",null,g,Pe),ke.push({event:Pe,listeners:pe}),Pe.data=Tt))}W1(ke,h)})}function Rd(u,h,g){return{instance:u,listener:h,currentTarget:g}}function ng(u,h){for(var g=h+"Capture",x=[];u!==null;){var w=u,A=w.stateNode;w.tag===5&&A!==null&&(w=A,A=tr(u,g),A!=null&&x.unshift(Rd(u,A,w)),A=tr(u,h),A!=null&&x.push(Rd(u,A,w))),u=u.return}return x}function Wu(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function q1(u,h,g,x,w){for(var A=h._reactName,I=[];g!==null&&g!==x;){var $=g,Q=$.alternate,pe=$.stateNode;if(Q!==null&&Q===x)break;$.tag===5&&pe!==null&&($=pe,w?(Q=tr(g,A),Q!=null&&I.unshift(Rd(g,Q,$))):w||(Q=tr(g,A),Q!=null&&I.push(Rd(g,Q,$)))),g=g.return}I.length!==0&&u.push({event:h,listeners:I})}var Rk=/\r\n?/g,Nk=/\u0000|\uFFFD/g;function X1(u){return(typeof u=="string"?u:""+u).replace(Rk,`
`).replace(Nk,"")}function ig(u,h,g){if(h=X1(h),X1(u)!==h&&g)throw Error(t(425))}function rg(){}var ey=null,ty=null;function ny(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var iy=typeof setTimeout=="function"?setTimeout:void 0,Pk=typeof clearTimeout=="function"?clearTimeout:void 0,Y1=typeof Promise=="function"?Promise:void 0,Dk=typeof queueMicrotask=="function"?queueMicrotask:typeof Y1<"u"?function(u){return Y1.resolve(null).then(u).catch(kk)}:iy;function kk(u){setTimeout(function(){throw u})}function ry(u,h){var g=h,x=0;do{var w=g.nextSibling;if(u.removeChild(g),w&&w.nodeType===8)if(g=w.data,g==="/$"){if(x===0){u.removeChild(w),vd(h);return}x--}else g!=="$"&&g!=="$?"&&g!=="$!"||x++;g=w}while(g);vd(h)}function Co(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return u}function K1(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"){if(h===0)return u;h--}else g==="/$"&&h++}u=u.previousSibling}return null}var $u=Math.random().toString(36).slice(2),ea="__reactFiber$"+$u,Nd="__reactProps$"+$u,Pa="__reactContainer$"+$u,sy="__reactEvents$"+$u,Ik="__reactListeners$"+$u,Lk="__reactHandles$"+$u;function Nl(u){var h=u[ea];if(h)return h;for(var g=u.parentNode;g;){if(h=g[Pa]||g[ea]){if(g=h.alternate,h.child!==null||g!==null&&g.child!==null)for(u=K1(u);u!==null;){if(g=u[ea])return g;u=K1(u)}return h}u=g,g=u.parentNode}return null}function Pd(u){return u=u[ea]||u[Pa],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function qu(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function sg(u){return u[Nd]||null}var ay=[],Xu=-1;function Ro(u){return{current:u}}function Bn(u){0>Xu||(u.current=ay[Xu],ay[Xu]=null,Xu--)}function Ln(u,h){Xu++,ay[Xu]=u.current,u.current=h}var No={},Ui=Ro(No),yr=Ro(!1),Pl=No;function Yu(u,h){var g=u.type.contextTypes;if(!g)return No;var x=u.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===h)return x.__reactInternalMemoizedMaskedChildContext;var w={},A;for(A in g)w[A]=h[A];return x&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=h,u.__reactInternalMemoizedMaskedChildContext=w),w}function vr(u){return u=u.childContextTypes,u!=null}function ag(){Bn(yr),Bn(Ui)}function Z1(u,h,g){if(Ui.current!==No)throw Error(t(168));Ln(Ui,h),Ln(yr,g)}function Q1(u,h,g){var x=u.stateNode;if(h=h.childContextTypes,typeof x.getChildContext!="function")return g;x=x.getChildContext();for(var w in x)if(!(w in h))throw Error(t(108,re(u)||"Unknown",w));return U({},g,x)}function og(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||No,Pl=Ui.current,Ln(Ui,u),Ln(yr,yr.current),!0}function J1(u,h,g){var x=u.stateNode;if(!x)throw Error(t(169));g?(u=Q1(u,h,Pl),x.__reactInternalMemoizedMergedChildContext=u,Bn(yr),Bn(Ui),Ln(Ui,u)):Bn(yr),Ln(yr,g)}var Da=null,lg=!1,oy=!1;function eT(u){Da===null?Da=[u]:Da.push(u)}function Fk(u){lg=!0,eT(u)}function Po(){if(!oy&&Da!==null){oy=!0;var u=0,h=Lt;try{var g=Da;for(Lt=1;u<g.length;u++){var x=g[u];do x=x(!0);while(x!==null)}Da=null,lg=!1}catch(w){throw Da!==null&&(Da=Da.slice(u+1)),Vp(ae,Po),w}finally{Lt=h,oy=!1}}return null}var Ku=[],Zu=0,ug=null,cg=0,is=[],rs=0,Dl=null,ka=1,Ia="";function kl(u,h){Ku[Zu++]=cg,Ku[Zu++]=ug,ug=u,cg=h}function tT(u,h,g){is[rs++]=ka,is[rs++]=Ia,is[rs++]=Dl,Dl=u;var x=ka;u=Ia;var w=32-nt(x)-1;x&=~(1<<w),g+=1;var A=32-nt(h)+w;if(30<A){var I=w-w%5;A=(x&(1<<I)-1).toString(32),x>>=I,w-=I,ka=1<<32-nt(h)+w|g<<w|x,Ia=A+u}else ka=1<<A|g<<w|x,Ia=u}function ly(u){u.return!==null&&(kl(u,1),tT(u,1,0))}function uy(u){for(;u===ug;)ug=Ku[--Zu],Ku[Zu]=null,cg=Ku[--Zu],Ku[Zu]=null;for(;u===Dl;)Dl=is[--rs],is[rs]=null,Ia=is[--rs],is[rs]=null,ka=is[--rs],is[rs]=null}var Br=null,zr=null,Vn=!1,Ts=null;function nT(u,h){var g=ls(5,null,null,0);g.elementType="DELETED",g.stateNode=h,g.return=u,h=u.deletions,h===null?(u.deletions=[g],u.flags|=16):h.push(g)}function iT(u,h){switch(u.tag){case 5:var g=u.type;return h=h.nodeType!==1||g.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(u.stateNode=h,Br=u,zr=Co(h.firstChild),!0):!1;case 6:return h=u.pendingProps===""||h.nodeType!==3?null:h,h!==null?(u.stateNode=h,Br=u,zr=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(g=Dl!==null?{id:ka,overflow:Ia}:null,u.memoizedState={dehydrated:h,treeContext:g,retryLane:1073741824},g=ls(18,null,null,0),g.stateNode=h,g.return=u,u.child=g,Br=u,zr=null,!0):!1;default:return!1}}function cy(u){return(u.mode&1)!==0&&(u.flags&128)===0}function hy(u){if(Vn){var h=zr;if(h){var g=h;if(!iT(u,h)){if(cy(u))throw Error(t(418));h=Co(g.nextSibling);var x=Br;h&&iT(u,h)?nT(x,g):(u.flags=u.flags&-4097|2,Vn=!1,Br=u)}}else{if(cy(u))throw Error(t(418));u.flags=u.flags&-4097|2,Vn=!1,Br=u}}}function rT(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Br=u}function hg(u){if(u!==Br)return!1;if(!Vn)return rT(u),Vn=!0,!1;var h;if((h=u.tag!==3)&&!(h=u.tag!==5)&&(h=u.type,h=h!=="head"&&h!=="body"&&!ny(u.type,u.memoizedProps)),h&&(h=zr)){if(cy(u))throw sT(),Error(t(418));for(;h;)nT(u,h),h=Co(h.nextSibling)}if(rT(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8){var g=u.data;if(g==="/$"){if(h===0){zr=Co(u.nextSibling);break e}h--}else g!=="$"&&g!=="$!"&&g!=="$?"||h++}u=u.nextSibling}zr=null}}else zr=Br?Co(u.stateNode.nextSibling):null;return!0}function sT(){for(var u=zr;u;)u=Co(u.nextSibling)}function Qu(){zr=Br=null,Vn=!1}function dy(u){Ts===null?Ts=[u]:Ts.push(u)}var Uk=E.ReactCurrentBatchConfig;function Ms(u,h){if(u&&u.defaultProps){h=U({},h),u=u.defaultProps;for(var g in u)h[g]===void 0&&(h[g]=u[g]);return h}return h}var dg=Ro(null),fg=null,Ju=null,fy=null;function py(){fy=Ju=fg=null}function gy(u){var h=dg.current;Bn(dg),u._currentValue=h}function my(u,h,g){for(;u!==null;){var x=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,x!==null&&(x.childLanes|=h)):x!==null&&(x.childLanes&h)!==h&&(x.childLanes|=h),u===g)break;u=u.return}}function ec(u,h){fg=u,fy=Ju=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&h)!==0&&(xr=!0),u.firstContext=null)}function ss(u){var h=u._currentValue;if(fy!==u)if(u={context:u,memoizedValue:h,next:null},Ju===null){if(fg===null)throw Error(t(308));Ju=u,fg.dependencies={lanes:0,firstContext:u}}else Ju=Ju.next=u;return h}var Il=null;function _y(u){Il===null?Il=[u]:Il.push(u)}function aT(u,h,g,x){var w=h.interleaved;return w===null?(g.next=g,_y(h)):(g.next=w.next,w.next=g),h.interleaved=g,La(u,x)}function La(u,h){u.lanes|=h;var g=u.alternate;for(g!==null&&(g.lanes|=h),g=u,u=u.return;u!==null;)u.childLanes|=h,g=u.alternate,g!==null&&(g.childLanes|=h),g=u,u=u.return;return g.tag===3?g.stateNode:null}var Do=!1;function yy(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oT(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Fa(u,h){return{eventTime:u,lane:h,tag:0,payload:null,callback:null,next:null}}function ko(u,h,g){var x=u.updateQueue;if(x===null)return null;if(x=x.shared,(an&2)!==0){var w=x.pending;return w===null?h.next=h:(h.next=w.next,w.next=h),x.pending=h,La(u,g)}return w=x.interleaved,w===null?(h.next=h,_y(x)):(h.next=w.next,w.next=h),x.interleaved=h,La(u,g)}function pg(u,h,g){if(h=h.updateQueue,h!==null&&(h=h.shared,(g&4194240)!==0)){var x=h.lanes;x&=u.pendingLanes,g|=x,h.lanes=g,mn(u,g)}}function lT(u,h){var g=u.updateQueue,x=u.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var w=null,A=null;if(g=g.firstBaseUpdate,g!==null){do{var I={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};A===null?w=A=I:A=A.next=I,g=g.next}while(g!==null);A===null?w=A=h:A=A.next=h}else w=A=h;g={baseState:x.baseState,firstBaseUpdate:w,lastBaseUpdate:A,shared:x.shared,effects:x.effects},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=h:u.next=h,g.lastBaseUpdate=h}function gg(u,h,g,x){var w=u.updateQueue;Do=!1;var A=w.firstBaseUpdate,I=w.lastBaseUpdate,$=w.shared.pending;if($!==null){w.shared.pending=null;var Q=$,pe=Q.next;Q.next=null,I===null?A=pe:I.next=pe,I=Q;var Pe=u.alternate;Pe!==null&&(Pe=Pe.updateQueue,$=Pe.lastBaseUpdate,$!==I&&($===null?Pe.firstBaseUpdate=pe:$.next=pe,Pe.lastBaseUpdate=Q))}if(A!==null){var ke=w.baseState;I=0,Pe=pe=Q=null,$=A;do{var Ne=$.lane,et=$.eventTime;if((x&Ne)===Ne){Pe!==null&&(Pe=Pe.next={eventTime:et,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var lt=u,ht=$;switch(Ne=h,et=g,ht.tag){case 1:if(lt=ht.payload,typeof lt=="function"){ke=lt.call(et,ke,Ne);break e}ke=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ht.payload,Ne=typeof lt=="function"?lt.call(et,ke,Ne):lt,Ne==null)break e;ke=U({},ke,Ne);break e;case 2:Do=!0}}$.callback!==null&&$.lane!==0&&(u.flags|=64,Ne=w.effects,Ne===null?w.effects=[$]:Ne.push($))}else et={eventTime:et,lane:Ne,tag:$.tag,payload:$.payload,callback:$.callback,next:null},Pe===null?(pe=Pe=et,Q=ke):Pe=Pe.next=et,I|=Ne;if($=$.next,$===null){if($=w.shared.pending,$===null)break;Ne=$,$=Ne.next,Ne.next=null,w.lastBaseUpdate=Ne,w.shared.pending=null}}while(!0);if(Pe===null&&(Q=ke),w.baseState=Q,w.firstBaseUpdate=pe,w.lastBaseUpdate=Pe,h=w.shared.interleaved,h!==null){w=h;do I|=w.lane,w=w.next;while(w!==h)}else A===null&&(w.shared.lanes=0);Ul|=I,u.lanes=I,u.memoizedState=ke}}function uT(u,h,g){if(u=h.effects,h.effects=null,u!==null)for(h=0;h<u.length;h++){var x=u[h],w=x.callback;if(w!==null){if(x.callback=null,x=g,typeof w!="function")throw Error(t(191,w));w.call(x)}}}var cT=new i.Component().refs;function vy(u,h,g,x){h=u.memoizedState,g=g(x,h),g=g==null?h:U({},h,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var mg={isMounted:function(u){return(u=u._reactInternals)?ns(u)===u:!1},enqueueSetState:function(u,h,g){u=u._reactInternals;var x=rr(),w=Uo(u),A=Fa(x,w);A.payload=h,g!=null&&(A.callback=g),h=ko(u,A,w),h!==null&&(Cs(h,u,w,x),pg(h,u,w))},enqueueReplaceState:function(u,h,g){u=u._reactInternals;var x=rr(),w=Uo(u),A=Fa(x,w);A.tag=1,A.payload=h,g!=null&&(A.callback=g),h=ko(u,A,w),h!==null&&(Cs(h,u,w,x),pg(h,u,w))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var g=rr(),x=Uo(u),w=Fa(g,x);w.tag=2,h!=null&&(w.callback=h),h=ko(u,w,x),h!==null&&(Cs(h,u,x,g),pg(h,u,x))}};function hT(u,h,g,x,w,A,I){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(x,A,I):h.prototype&&h.prototype.isPureReactComponent?!Md(g,x)||!Md(w,A):!0}function dT(u,h,g){var x=!1,w=No,A=h.contextType;return typeof A=="object"&&A!==null?A=ss(A):(w=vr(h)?Pl:Ui.current,x=h.contextTypes,A=(x=x!=null)?Yu(u,w):No),h=new h(g,A),u.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=mg,u.stateNode=h,h._reactInternals=u,x&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=w,u.__reactInternalMemoizedMaskedChildContext=A),h}function fT(u,h,g,x){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(g,x),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(g,x),h.state!==u&&mg.enqueueReplaceState(h,h.state,null)}function xy(u,h,g,x){var w=u.stateNode;w.props=g,w.state=u.memoizedState,w.refs=cT,yy(u);var A=h.contextType;typeof A=="object"&&A!==null?w.context=ss(A):(A=vr(h)?Pl:Ui.current,w.context=Yu(u,A)),w.state=u.memoizedState,A=h.getDerivedStateFromProps,typeof A=="function"&&(vy(u,h,A,g),w.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(h=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),h!==w.state&&mg.enqueueReplaceState(w,w.state,null),gg(u,g,w,x),w.state=u.memoizedState),typeof w.componentDidMount=="function"&&(u.flags|=4194308)}function Dd(u,h,g){if(u=g.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var x=g.stateNode}if(!x)throw Error(t(147,u));var w=x,A=""+u;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===A?h.ref:(h=function(I){var $=w.refs;$===cT&&($=w.refs={}),I===null?delete $[A]:$[A]=I},h._stringRef=A,h)}if(typeof u!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,u))}return u}function _g(u,h){throw u=Object.prototype.toString.call(h),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u))}function pT(u){var h=u._init;return h(u._payload)}function gT(u){function h(ue,ne){if(u){var he=ue.deletions;he===null?(ue.deletions=[ne],ue.flags|=16):he.push(ne)}}function g(ue,ne){if(!u)return null;for(;ne!==null;)h(ue,ne),ne=ne.sibling;return null}function x(ue,ne){for(ue=new Map;ne!==null;)ne.key!==null?ue.set(ne.key,ne):ue.set(ne.index,ne),ne=ne.sibling;return ue}function w(ue,ne){return ue=Bo(ue,ne),ue.index=0,ue.sibling=null,ue}function A(ue,ne,he){return ue.index=he,u?(he=ue.alternate,he!==null?(he=he.index,he<ne?(ue.flags|=2,ne):he):(ue.flags|=2,ne)):(ue.flags|=1048576,ne)}function I(ue){return u&&ue.alternate===null&&(ue.flags|=2),ue}function $(ue,ne,he,Ue){return ne===null||ne.tag!==6?(ne=iv(he,ue.mode,Ue),ne.return=ue,ne):(ne=w(ne,he),ne.return=ue,ne)}function Q(ue,ne,he,Ue){var gt=he.type;return gt===C?Pe(ue,ne,he.props.children,Ue,he.key):ne!==null&&(ne.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===Y&&pT(gt)===ne.type)?(Ue=w(ne,he.props),Ue.ref=Dd(ue,ne,he),Ue.return=ue,Ue):(Ue=Fg(he.type,he.key,he.props,null,ue.mode,Ue),Ue.ref=Dd(ue,ne,he),Ue.return=ue,Ue)}function pe(ue,ne,he,Ue){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==he.containerInfo||ne.stateNode.implementation!==he.implementation?(ne=rv(he,ue.mode,Ue),ne.return=ue,ne):(ne=w(ne,he.children||[]),ne.return=ue,ne)}function Pe(ue,ne,he,Ue,gt){return ne===null||ne.tag!==7?(ne=Gl(he,ue.mode,Ue,gt),ne.return=ue,ne):(ne=w(ne,he),ne.return=ue,ne)}function ke(ue,ne,he){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=iv(""+ne,ue.mode,he),ne.return=ue,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case N:return he=Fg(ne.type,ne.key,ne.props,null,ue.mode,he),he.ref=Dd(ue,null,ne),he.return=ue,he;case M:return ne=rv(ne,ue.mode,he),ne.return=ue,ne;case Y:var Ue=ne._init;return ke(ue,Ue(ne._payload),he)}if(Kt(ne)||te(ne))return ne=Gl(ne,ue.mode,he,null),ne.return=ue,ne;_g(ue,ne)}return null}function Ne(ue,ne,he,Ue){var gt=ne!==null?ne.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return gt!==null?null:$(ue,ne,""+he,Ue);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case N:return he.key===gt?Q(ue,ne,he,Ue):null;case M:return he.key===gt?pe(ue,ne,he,Ue):null;case Y:return gt=he._init,Ne(ue,ne,gt(he._payload),Ue)}if(Kt(he)||te(he))return gt!==null?null:Pe(ue,ne,he,Ue,null);_g(ue,he)}return null}function et(ue,ne,he,Ue,gt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return ue=ue.get(he)||null,$(ne,ue,""+Ue,gt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case N:return ue=ue.get(Ue.key===null?he:Ue.key)||null,Q(ne,ue,Ue,gt);case M:return ue=ue.get(Ue.key===null?he:Ue.key)||null,pe(ne,ue,Ue,gt);case Y:var St=Ue._init;return et(ue,ne,he,St(Ue._payload),gt)}if(Kt(Ue)||te(Ue))return ue=ue.get(he)||null,Pe(ne,ue,Ue,gt,null);_g(ne,Ue)}return null}function lt(ue,ne,he,Ue){for(var gt=null,St=null,Tt=ne,Pt=ne=0,bi=null;Tt!==null&&Pt<he.length;Pt++){Tt.index>Pt?(bi=Tt,Tt=null):bi=Tt.sibling;var cn=Ne(ue,Tt,he[Pt],Ue);if(cn===null){Tt===null&&(Tt=bi);break}u&&Tt&&cn.alternate===null&&h(ue,Tt),ne=A(cn,ne,Pt),St===null?gt=cn:St.sibling=cn,St=cn,Tt=bi}if(Pt===he.length)return g(ue,Tt),Vn&&kl(ue,Pt),gt;if(Tt===null){for(;Pt<he.length;Pt++)Tt=ke(ue,he[Pt],Ue),Tt!==null&&(ne=A(Tt,ne,Pt),St===null?gt=Tt:St.sibling=Tt,St=Tt);return Vn&&kl(ue,Pt),gt}for(Tt=x(ue,Tt);Pt<he.length;Pt++)bi=et(Tt,ue,Pt,he[Pt],Ue),bi!==null&&(u&&bi.alternate!==null&&Tt.delete(bi.key===null?Pt:bi.key),ne=A(bi,ne,Pt),St===null?gt=bi:St.sibling=bi,St=bi);return u&&Tt.forEach(function(zo){return h(ue,zo)}),Vn&&kl(ue,Pt),gt}function ht(ue,ne,he,Ue){var gt=te(he);if(typeof gt!="function")throw Error(t(150));if(he=gt.call(he),he==null)throw Error(t(151));for(var St=gt=null,Tt=ne,Pt=ne=0,bi=null,cn=he.next();Tt!==null&&!cn.done;Pt++,cn=he.next()){Tt.index>Pt?(bi=Tt,Tt=null):bi=Tt.sibling;var zo=Ne(ue,Tt,cn.value,Ue);if(zo===null){Tt===null&&(Tt=bi);break}u&&Tt&&zo.alternate===null&&h(ue,Tt),ne=A(zo,ne,Pt),St===null?gt=zo:St.sibling=zo,St=zo,Tt=bi}if(cn.done)return g(ue,Tt),Vn&&kl(ue,Pt),gt;if(Tt===null){for(;!cn.done;Pt++,cn=he.next())cn=ke(ue,cn.value,Ue),cn!==null&&(ne=A(cn,ne,Pt),St===null?gt=cn:St.sibling=cn,St=cn);return Vn&&kl(ue,Pt),gt}for(Tt=x(ue,Tt);!cn.done;Pt++,cn=he.next())cn=et(Tt,ue,Pt,cn.value,Ue),cn!==null&&(u&&cn.alternate!==null&&Tt.delete(cn.key===null?Pt:cn.key),ne=A(cn,ne,Pt),St===null?gt=cn:St.sibling=cn,St=cn);return u&&Tt.forEach(function(mI){return h(ue,mI)}),Vn&&kl(ue,Pt),gt}function ei(ue,ne,he,Ue){if(typeof he=="object"&&he!==null&&he.type===C&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case N:e:{for(var gt=he.key,St=ne;St!==null;){if(St.key===gt){if(gt=he.type,gt===C){if(St.tag===7){g(ue,St.sibling),ne=w(St,he.props.children),ne.return=ue,ue=ne;break e}}else if(St.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===Y&&pT(gt)===St.type){g(ue,St.sibling),ne=w(St,he.props),ne.ref=Dd(ue,St,he),ne.return=ue,ue=ne;break e}g(ue,St);break}else h(ue,St);St=St.sibling}he.type===C?(ne=Gl(he.props.children,ue.mode,Ue,he.key),ne.return=ue,ue=ne):(Ue=Fg(he.type,he.key,he.props,null,ue.mode,Ue),Ue.ref=Dd(ue,ne,he),Ue.return=ue,ue=Ue)}return I(ue);case M:e:{for(St=he.key;ne!==null;){if(ne.key===St)if(ne.tag===4&&ne.stateNode.containerInfo===he.containerInfo&&ne.stateNode.implementation===he.implementation){g(ue,ne.sibling),ne=w(ne,he.children||[]),ne.return=ue,ue=ne;break e}else{g(ue,ne);break}else h(ue,ne);ne=ne.sibling}ne=rv(he,ue.mode,Ue),ne.return=ue,ue=ne}return I(ue);case Y:return St=he._init,ei(ue,ne,St(he._payload),Ue)}if(Kt(he))return lt(ue,ne,he,Ue);if(te(he))return ht(ue,ne,he,Ue);_g(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ne!==null&&ne.tag===6?(g(ue,ne.sibling),ne=w(ne,he),ne.return=ue,ue=ne):(g(ue,ne),ne=iv(he,ue.mode,Ue),ne.return=ue,ue=ne),I(ue)):g(ue,ne)}return ei}var tc=gT(!0),mT=gT(!1),kd={},ta=Ro(kd),Id=Ro(kd),Ld=Ro(kd);function Ll(u){if(u===kd)throw Error(t(174));return u}function by(u,h){switch(Ln(Ld,h),Ln(Id,u),Ln(ta,kd),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Re(null,"");break;default:u=u===8?h.parentNode:h,h=u.namespaceURI||null,u=u.tagName,h=Re(h,u)}Bn(ta),Ln(ta,h)}function nc(){Bn(ta),Bn(Id),Bn(Ld)}function _T(u){Ll(Ld.current);var h=Ll(ta.current),g=Re(h,u.type);h!==g&&(Ln(Id,u),Ln(ta,g))}function wy(u){Id.current===u&&(Bn(ta),Bn(Id))}var Yn=Ro(0);function yg(u){for(var h=u;h!==null;){if(h.tag===13){var g=h.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Sy=[];function Ty(){for(var u=0;u<Sy.length;u++)Sy[u]._workInProgressVersionPrimary=null;Sy.length=0}var vg=E.ReactCurrentDispatcher,My=E.ReactCurrentBatchConfig,Fl=0,Kn=null,ci=null,vi=null,xg=!1,Fd=!1,Ud=0,Ok=0;function Oi(){throw Error(t(321))}function Ay(u,h){if(h===null)return!1;for(var g=0;g<h.length&&g<u.length;g++)if(!Ss(u[g],h[g]))return!1;return!0}function Ey(u,h,g,x,w,A){if(Fl=A,Kn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,vg.current=u===null||u.memoizedState===null?Vk:jk,u=g(x,w),Fd){A=0;do{if(Fd=!1,Ud=0,25<=A)throw Error(t(301));A+=1,vi=ci=null,h.updateQueue=null,vg.current=Hk,u=g(x,w)}while(Fd)}if(vg.current=Sg,h=ci!==null&&ci.next!==null,Fl=0,vi=ci=Kn=null,xg=!1,h)throw Error(t(300));return u}function Cy(){var u=Ud!==0;return Ud=0,u}function na(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vi===null?Kn.memoizedState=vi=u:vi=vi.next=u,vi}function as(){if(ci===null){var u=Kn.alternate;u=u!==null?u.memoizedState:null}else u=ci.next;var h=vi===null?Kn.memoizedState:vi.next;if(h!==null)vi=h,ci=u;else{if(u===null)throw Error(t(310));ci=u,u={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},vi===null?Kn.memoizedState=vi=u:vi=vi.next=u}return vi}function Od(u,h){return typeof h=="function"?h(u):h}function Ry(u){var h=as(),g=h.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=u;var x=ci,w=x.baseQueue,A=g.pending;if(A!==null){if(w!==null){var I=w.next;w.next=A.next,A.next=I}x.baseQueue=w=A,g.pending=null}if(w!==null){A=w.next,x=x.baseState;var $=I=null,Q=null,pe=A;do{var Pe=pe.lane;if((Fl&Pe)===Pe)Q!==null&&(Q=Q.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),x=pe.hasEagerState?pe.eagerState:u(x,pe.action);else{var ke={lane:Pe,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};Q===null?($=Q=ke,I=x):Q=Q.next=ke,Kn.lanes|=Pe,Ul|=Pe}pe=pe.next}while(pe!==null&&pe!==A);Q===null?I=x:Q.next=$,Ss(x,h.memoizedState)||(xr=!0),h.memoizedState=x,h.baseState=I,h.baseQueue=Q,g.lastRenderedState=x}if(u=g.interleaved,u!==null){w=u;do A=w.lane,Kn.lanes|=A,Ul|=A,w=w.next;while(w!==u)}else w===null&&(g.lanes=0);return[h.memoizedState,g.dispatch]}function Ny(u){var h=as(),g=h.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=u;var x=g.dispatch,w=g.pending,A=h.memoizedState;if(w!==null){g.pending=null;var I=w=w.next;do A=u(A,I.action),I=I.next;while(I!==w);Ss(A,h.memoizedState)||(xr=!0),h.memoizedState=A,h.baseQueue===null&&(h.baseState=A),g.lastRenderedState=A}return[A,x]}function yT(){}function vT(u,h){var g=Kn,x=as(),w=h(),A=!Ss(x.memoizedState,w);if(A&&(x.memoizedState=w,xr=!0),x=x.queue,Py(wT.bind(null,g,x,u),[u]),x.getSnapshot!==h||A||vi!==null&&vi.memoizedState.tag&1){if(g.flags|=2048,Bd(9,bT.bind(null,g,x,w,h),void 0,null),xi===null)throw Error(t(349));(Fl&30)!==0||xT(g,h,w)}return w}function xT(u,h,g){u.flags|=16384,u={getSnapshot:h,value:g},h=Kn.updateQueue,h===null?(h={lastEffect:null,stores:null},Kn.updateQueue=h,h.stores=[u]):(g=h.stores,g===null?h.stores=[u]:g.push(u))}function bT(u,h,g,x){h.value=g,h.getSnapshot=x,ST(h)&&TT(u)}function wT(u,h,g){return g(function(){ST(h)&&TT(u)})}function ST(u){var h=u.getSnapshot;u=u.value;try{var g=h();return!Ss(u,g)}catch{return!0}}function TT(u){var h=La(u,1);h!==null&&Cs(h,u,1,-1)}function MT(u){var h=na();return typeof u=="function"&&(u=u()),h.memoizedState=h.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Od,lastRenderedState:u},h.queue=u,u=u.dispatch=Gk.bind(null,Kn,u),[h.memoizedState,u]}function Bd(u,h,g,x){return u={tag:u,create:h,destroy:g,deps:x,next:null},h=Kn.updateQueue,h===null?(h={lastEffect:null,stores:null},Kn.updateQueue=h,h.lastEffect=u.next=u):(g=h.lastEffect,g===null?h.lastEffect=u.next=u:(x=g.next,g.next=u,u.next=x,h.lastEffect=u)),u}function AT(){return as().memoizedState}function bg(u,h,g,x){var w=na();Kn.flags|=u,w.memoizedState=Bd(1|h,g,void 0,x===void 0?null:x)}function wg(u,h,g,x){var w=as();x=x===void 0?null:x;var A=void 0;if(ci!==null){var I=ci.memoizedState;if(A=I.destroy,x!==null&&Ay(x,I.deps)){w.memoizedState=Bd(h,g,A,x);return}}Kn.flags|=u,w.memoizedState=Bd(1|h,g,A,x)}function ET(u,h){return bg(8390656,8,u,h)}function Py(u,h){return wg(2048,8,u,h)}function CT(u,h){return wg(4,2,u,h)}function RT(u,h){return wg(4,4,u,h)}function NT(u,h){if(typeof h=="function")return u=u(),h(u),function(){h(null)};if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function PT(u,h,g){return g=g!=null?g.concat([u]):null,wg(4,4,NT.bind(null,h,u),g)}function Dy(){}function DT(u,h){var g=as();h=h===void 0?null:h;var x=g.memoizedState;return x!==null&&h!==null&&Ay(h,x[1])?x[0]:(g.memoizedState=[u,h],u)}function kT(u,h){var g=as();h=h===void 0?null:h;var x=g.memoizedState;return x!==null&&h!==null&&Ay(h,x[1])?x[0]:(u=u(),g.memoizedState=[u,h],u)}function IT(u,h,g){return(Fl&21)===0?(u.baseState&&(u.baseState=!1,xr=!0),u.memoizedState=g):(Ss(g,h)||(g=Fi(),Kn.lanes|=g,Ul|=g,u.baseState=!0),h)}function Bk(u,h){var g=Lt;Lt=g!==0&&4>g?g:4,u(!0);var x=My.transition;My.transition={};try{u(!1),h()}finally{Lt=g,My.transition=x}}function LT(){return as().memoizedState}function zk(u,h,g){var x=Uo(u);if(g={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null},FT(u))UT(h,g);else if(g=aT(u,h,g,x),g!==null){var w=rr();Cs(g,u,x,w),OT(g,h,x)}}function Gk(u,h,g){var x=Uo(u),w={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null};if(FT(u))UT(h,w);else{var A=u.alternate;if(u.lanes===0&&(A===null||A.lanes===0)&&(A=h.lastRenderedReducer,A!==null))try{var I=h.lastRenderedState,$=A(I,g);if(w.hasEagerState=!0,w.eagerState=$,Ss($,I)){var Q=h.interleaved;Q===null?(w.next=w,_y(h)):(w.next=Q.next,Q.next=w),h.interleaved=w;return}}catch{}finally{}g=aT(u,h,w,x),g!==null&&(w=rr(),Cs(g,u,x,w),OT(g,h,x))}}function FT(u){var h=u.alternate;return u===Kn||h!==null&&h===Kn}function UT(u,h){Fd=xg=!0;var g=u.pending;g===null?h.next=h:(h.next=g.next,g.next=h),u.pending=h}function OT(u,h,g){if((g&4194240)!==0){var x=h.lanes;x&=u.pendingLanes,g|=x,h.lanes=g,mn(u,g)}}var Sg={readContext:ss,useCallback:Oi,useContext:Oi,useEffect:Oi,useImperativeHandle:Oi,useInsertionEffect:Oi,useLayoutEffect:Oi,useMemo:Oi,useReducer:Oi,useRef:Oi,useState:Oi,useDebugValue:Oi,useDeferredValue:Oi,useTransition:Oi,useMutableSource:Oi,useSyncExternalStore:Oi,useId:Oi,unstable_isNewReconciler:!1},Vk={readContext:ss,useCallback:function(u,h){return na().memoizedState=[u,h===void 0?null:h],u},useContext:ss,useEffect:ET,useImperativeHandle:function(u,h,g){return g=g!=null?g.concat([u]):null,bg(4194308,4,NT.bind(null,h,u),g)},useLayoutEffect:function(u,h){return bg(4194308,4,u,h)},useInsertionEffect:function(u,h){return bg(4,2,u,h)},useMemo:function(u,h){var g=na();return h=h===void 0?null:h,u=u(),g.memoizedState=[u,h],u},useReducer:function(u,h,g){var x=na();return h=g!==void 0?g(h):h,x.memoizedState=x.baseState=h,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:h},x.queue=u,u=u.dispatch=zk.bind(null,Kn,u),[x.memoizedState,u]},useRef:function(u){var h=na();return u={current:u},h.memoizedState=u},useState:MT,useDebugValue:Dy,useDeferredValue:function(u){return na().memoizedState=u},useTransition:function(){var u=MT(!1),h=u[0];return u=Bk.bind(null,u[1]),na().memoizedState=u,[h,u]},useMutableSource:function(){},useSyncExternalStore:function(u,h,g){var x=Kn,w=na();if(Vn){if(g===void 0)throw Error(t(407));g=g()}else{if(g=h(),xi===null)throw Error(t(349));(Fl&30)!==0||xT(x,h,g)}w.memoizedState=g;var A={value:g,getSnapshot:h};return w.queue=A,ET(wT.bind(null,x,A,u),[u]),x.flags|=2048,Bd(9,bT.bind(null,x,A,g,h),void 0,null),g},useId:function(){var u=na(),h=xi.identifierPrefix;if(Vn){var g=Ia,x=ka;g=(x&~(1<<32-nt(x)-1)).toString(32)+g,h=":"+h+"R"+g,g=Ud++,0<g&&(h+="H"+g.toString(32)),h+=":"}else g=Ok++,h=":"+h+"r"+g.toString(32)+":";return u.memoizedState=h},unstable_isNewReconciler:!1},jk={readContext:ss,useCallback:DT,useContext:ss,useEffect:Py,useImperativeHandle:PT,useInsertionEffect:CT,useLayoutEffect:RT,useMemo:kT,useReducer:Ry,useRef:AT,useState:function(){return Ry(Od)},useDebugValue:Dy,useDeferredValue:function(u){var h=as();return IT(h,ci.memoizedState,u)},useTransition:function(){var u=Ry(Od)[0],h=as().memoizedState;return[u,h]},useMutableSource:yT,useSyncExternalStore:vT,useId:LT,unstable_isNewReconciler:!1},Hk={readContext:ss,useCallback:DT,useContext:ss,useEffect:Py,useImperativeHandle:PT,useInsertionEffect:CT,useLayoutEffect:RT,useMemo:kT,useReducer:Ny,useRef:AT,useState:function(){return Ny(Od)},useDebugValue:Dy,useDeferredValue:function(u){var h=as();return ci===null?h.memoizedState=u:IT(h,ci.memoizedState,u)},useTransition:function(){var u=Ny(Od)[0],h=as().memoizedState;return[u,h]},useMutableSource:yT,useSyncExternalStore:vT,useId:LT,unstable_isNewReconciler:!1};function ic(u,h){try{var g="",x=h;do g+=ie(x),x=x.return;while(x);var w=g}catch(A){w=`
Error generating stack: `+A.message+`
`+A.stack}return{value:u,source:h,stack:w,digest:null}}function ky(u,h,g){return{value:u,source:null,stack:g??null,digest:h??null}}function Iy(u,h){try{console.error(h.value)}catch(g){setTimeout(function(){throw g})}}var Wk=typeof WeakMap=="function"?WeakMap:Map;function BT(u,h,g){g=Fa(-1,g),g.tag=3,g.payload={element:null};var x=h.value;return g.callback=function(){Ng||(Ng=!0,Yy=x),Iy(u,h)},g}function zT(u,h,g){g=Fa(-1,g),g.tag=3;var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var w=h.value;g.payload=function(){return x(w)},g.callback=function(){Iy(u,h)}}var A=u.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(g.callback=function(){Iy(u,h),typeof x!="function"&&(Lo===null?Lo=new Set([this]):Lo.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})}),g}function GT(u,h,g){var x=u.pingCache;if(x===null){x=u.pingCache=new Wk;var w=new Set;x.set(h,w)}else w=x.get(h),w===void 0&&(w=new Set,x.set(h,w));w.has(g)||(w.add(g),u=sI.bind(null,u,h,g),h.then(u,u))}function VT(u){do{var h;if((h=u.tag===13)&&(h=u.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return u;u=u.return}while(u!==null);return null}function jT(u,h,g,x,w){return(u.mode&1)===0?(u===h?u.flags|=65536:(u.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(h=Fa(-1,1),h.tag=2,ko(g,h,1))),g.lanes|=1),u):(u.flags|=65536,u.lanes=w,u)}var $k=E.ReactCurrentOwner,xr=!1;function ir(u,h,g,x){h.child=u===null?mT(h,null,g,x):tc(h,u.child,g,x)}function HT(u,h,g,x,w){g=g.render;var A=h.ref;return ec(h,w),x=Ey(u,h,g,x,A,w),g=Cy(),u!==null&&!xr?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~w,Ua(u,h,w)):(Vn&&g&&ly(h),h.flags|=1,ir(u,h,x,w),h.child)}function WT(u,h,g,x,w){if(u===null){var A=g.type;return typeof A=="function"&&!nv(A)&&A.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(h.tag=15,h.type=A,$T(u,h,A,x,w)):(u=Fg(g.type,null,x,h,h.mode,w),u.ref=h.ref,u.return=h,h.child=u)}if(A=u.child,(u.lanes&w)===0){var I=A.memoizedProps;if(g=g.compare,g=g!==null?g:Md,g(I,x)&&u.ref===h.ref)return Ua(u,h,w)}return h.flags|=1,u=Bo(A,x),u.ref=h.ref,u.return=h,h.child=u}function $T(u,h,g,x,w){if(u!==null){var A=u.memoizedProps;if(Md(A,x)&&u.ref===h.ref)if(xr=!1,h.pendingProps=x=A,(u.lanes&w)!==0)(u.flags&131072)!==0&&(xr=!0);else return h.lanes=u.lanes,Ua(u,h,w)}return Ly(u,h,g,x,w)}function qT(u,h,g){var x=h.pendingProps,w=x.children,A=u!==null?u.memoizedState:null;if(x.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ln(sc,Gr),Gr|=g;else{if((g&1073741824)===0)return u=A!==null?A.baseLanes|g:g,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:u,cachePool:null,transitions:null},h.updateQueue=null,Ln(sc,Gr),Gr|=u,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=A!==null?A.baseLanes:g,Ln(sc,Gr),Gr|=x}else A!==null?(x=A.baseLanes|g,h.memoizedState=null):x=g,Ln(sc,Gr),Gr|=x;return ir(u,h,w,g),h.child}function XT(u,h){var g=h.ref;(u===null&&g!==null||u!==null&&u.ref!==g)&&(h.flags|=512,h.flags|=2097152)}function Ly(u,h,g,x,w){var A=vr(g)?Pl:Ui.current;return A=Yu(h,A),ec(h,w),g=Ey(u,h,g,x,A,w),x=Cy(),u!==null&&!xr?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~w,Ua(u,h,w)):(Vn&&x&&ly(h),h.flags|=1,ir(u,h,g,w),h.child)}function YT(u,h,g,x,w){if(vr(g)){var A=!0;og(h)}else A=!1;if(ec(h,w),h.stateNode===null)Mg(u,h),dT(h,g,x),xy(h,g,x,w),x=!0;else if(u===null){var I=h.stateNode,$=h.memoizedProps;I.props=$;var Q=I.context,pe=g.contextType;typeof pe=="object"&&pe!==null?pe=ss(pe):(pe=vr(g)?Pl:Ui.current,pe=Yu(h,pe));var Pe=g.getDerivedStateFromProps,ke=typeof Pe=="function"||typeof I.getSnapshotBeforeUpdate=="function";ke||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||($!==x||Q!==pe)&&fT(h,I,x,pe),Do=!1;var Ne=h.memoizedState;I.state=Ne,gg(h,x,I,w),Q=h.memoizedState,$!==x||Ne!==Q||yr.current||Do?(typeof Pe=="function"&&(vy(h,g,Pe,x),Q=h.memoizedState),($=Do||hT(h,g,$,x,Ne,Q,pe))?(ke||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(h.flags|=4194308)):(typeof I.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=x,h.memoizedState=Q),I.props=x,I.state=Q,I.context=pe,x=$):(typeof I.componentDidMount=="function"&&(h.flags|=4194308),x=!1)}else{I=h.stateNode,oT(u,h),$=h.memoizedProps,pe=h.type===h.elementType?$:Ms(h.type,$),I.props=pe,ke=h.pendingProps,Ne=I.context,Q=g.contextType,typeof Q=="object"&&Q!==null?Q=ss(Q):(Q=vr(g)?Pl:Ui.current,Q=Yu(h,Q));var et=g.getDerivedStateFromProps;(Pe=typeof et=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||($!==ke||Ne!==Q)&&fT(h,I,x,Q),Do=!1,Ne=h.memoizedState,I.state=Ne,gg(h,x,I,w);var lt=h.memoizedState;$!==ke||Ne!==lt||yr.current||Do?(typeof et=="function"&&(vy(h,g,et,x),lt=h.memoizedState),(pe=Do||hT(h,g,pe,x,Ne,lt,Q)||!1)?(Pe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(x,lt,Q),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(x,lt,Q)),typeof I.componentDidUpdate=="function"&&(h.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof I.componentDidUpdate!="function"||$===u.memoizedProps&&Ne===u.memoizedState||(h.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||$===u.memoizedProps&&Ne===u.memoizedState||(h.flags|=1024),h.memoizedProps=x,h.memoizedState=lt),I.props=x,I.state=lt,I.context=Q,x=pe):(typeof I.componentDidUpdate!="function"||$===u.memoizedProps&&Ne===u.memoizedState||(h.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||$===u.memoizedProps&&Ne===u.memoizedState||(h.flags|=1024),x=!1)}return Fy(u,h,g,x,A,w)}function Fy(u,h,g,x,w,A){XT(u,h);var I=(h.flags&128)!==0;if(!x&&!I)return w&&J1(h,g,!1),Ua(u,h,A);x=h.stateNode,$k.current=h;var $=I&&typeof g.getDerivedStateFromError!="function"?null:x.render();return h.flags|=1,u!==null&&I?(h.child=tc(h,u.child,null,A),h.child=tc(h,null,$,A)):ir(u,h,$,A),h.memoizedState=x.state,w&&J1(h,g,!0),h.child}function KT(u){var h=u.stateNode;h.pendingContext?Z1(u,h.pendingContext,h.pendingContext!==h.context):h.context&&Z1(u,h.context,!1),by(u,h.containerInfo)}function ZT(u,h,g,x,w){return Qu(),dy(w),h.flags|=256,ir(u,h,g,x),h.child}var Uy={dehydrated:null,treeContext:null,retryLane:0};function Oy(u){return{baseLanes:u,cachePool:null,transitions:null}}function QT(u,h,g){var x=h.pendingProps,w=Yn.current,A=!1,I=(h.flags&128)!==0,$;if(($=I)||($=u!==null&&u.memoizedState===null?!1:(w&2)!==0),$?(A=!0,h.flags&=-129):(u===null||u.memoizedState!==null)&&(w|=1),Ln(Yn,w&1),u===null)return hy(h),u=h.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((h.mode&1)===0?h.lanes=1:u.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(I=x.children,u=x.fallback,A?(x=h.mode,A=h.child,I={mode:"hidden",children:I},(x&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=I):A=Ug(I,x,0,null),u=Gl(u,x,g,null),A.return=h,u.return=h,A.sibling=u,h.child=A,h.child.memoizedState=Oy(g),h.memoizedState=Uy,u):By(h,I));if(w=u.memoizedState,w!==null&&($=w.dehydrated,$!==null))return qk(u,h,I,x,$,w,g);if(A){A=x.fallback,I=h.mode,w=u.child,$=w.sibling;var Q={mode:"hidden",children:x.children};return(I&1)===0&&h.child!==w?(x=h.child,x.childLanes=0,x.pendingProps=Q,h.deletions=null):(x=Bo(w,Q),x.subtreeFlags=w.subtreeFlags&14680064),$!==null?A=Bo($,A):(A=Gl(A,I,g,null),A.flags|=2),A.return=h,x.return=h,x.sibling=A,h.child=x,x=A,A=h.child,I=u.child.memoizedState,I=I===null?Oy(g):{baseLanes:I.baseLanes|g,cachePool:null,transitions:I.transitions},A.memoizedState=I,A.childLanes=u.childLanes&~g,h.memoizedState=Uy,x}return A=u.child,u=A.sibling,x=Bo(A,{mode:"visible",children:x.children}),(h.mode&1)===0&&(x.lanes=g),x.return=h,x.sibling=null,u!==null&&(g=h.deletions,g===null?(h.deletions=[u],h.flags|=16):g.push(u)),h.child=x,h.memoizedState=null,x}function By(u,h){return h=Ug({mode:"visible",children:h},u.mode,0,null),h.return=u,u.child=h}function Tg(u,h,g,x){return x!==null&&dy(x),tc(h,u.child,null,g),u=By(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function qk(u,h,g,x,w,A,I){if(g)return h.flags&256?(h.flags&=-257,x=ky(Error(t(422))),Tg(u,h,I,x)):h.memoizedState!==null?(h.child=u.child,h.flags|=128,null):(A=x.fallback,w=h.mode,x=Ug({mode:"visible",children:x.children},w,0,null),A=Gl(A,w,I,null),A.flags|=2,x.return=h,A.return=h,x.sibling=A,h.child=x,(h.mode&1)!==0&&tc(h,u.child,null,I),h.child.memoizedState=Oy(I),h.memoizedState=Uy,A);if((h.mode&1)===0)return Tg(u,h,I,null);if(w.data==="$!"){if(x=w.nextSibling&&w.nextSibling.dataset,x)var $=x.dgst;return x=$,A=Error(t(419)),x=ky(A,x,void 0),Tg(u,h,I,x)}if($=(I&u.childLanes)!==0,xr||$){if(x=xi,x!==null){switch(I&-I){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(x.suspendedLanes|I))!==0?0:w,w!==0&&w!==A.retryLane&&(A.retryLane=w,La(u,w),Cs(x,u,w,-1))}return tv(),x=ky(Error(t(421))),Tg(u,h,I,x)}return w.data==="$?"?(h.flags|=128,h.child=u.child,h=aI.bind(null,u),w._reactRetry=h,null):(u=A.treeContext,zr=Co(w.nextSibling),Br=h,Vn=!0,Ts=null,u!==null&&(is[rs++]=ka,is[rs++]=Ia,is[rs++]=Dl,ka=u.id,Ia=u.overflow,Dl=h),h=By(h,x.children),h.flags|=4096,h)}function JT(u,h,g){u.lanes|=h;var x=u.alternate;x!==null&&(x.lanes|=h),my(u.return,h,g)}function zy(u,h,g,x,w){var A=u.memoizedState;A===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:w}:(A.isBackwards=h,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=g,A.tailMode=w)}function eM(u,h,g){var x=h.pendingProps,w=x.revealOrder,A=x.tail;if(ir(u,h,x.children,g),x=Yn.current,(x&2)!==0)x=x&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&JT(u,g,h);else if(u.tag===19)JT(u,g,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}x&=1}if(Ln(Yn,x),(h.mode&1)===0)h.memoizedState=null;else switch(w){case"forwards":for(g=h.child,w=null;g!==null;)u=g.alternate,u!==null&&yg(u)===null&&(w=g),g=g.sibling;g=w,g===null?(w=h.child,h.child=null):(w=g.sibling,g.sibling=null),zy(h,!1,w,g,A);break;case"backwards":for(g=null,w=h.child,h.child=null;w!==null;){if(u=w.alternate,u!==null&&yg(u)===null){h.child=w;break}u=w.sibling,w.sibling=g,g=w,w=u}zy(h,!0,g,null,A);break;case"together":zy(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Mg(u,h){(h.mode&1)===0&&u!==null&&(u.alternate=null,h.alternate=null,h.flags|=2)}function Ua(u,h,g){if(u!==null&&(h.dependencies=u.dependencies),Ul|=h.lanes,(g&h.childLanes)===0)return null;if(u!==null&&h.child!==u.child)throw Error(t(153));if(h.child!==null){for(u=h.child,g=Bo(u,u.pendingProps),h.child=g,g.return=h;u.sibling!==null;)u=u.sibling,g=g.sibling=Bo(u,u.pendingProps),g.return=h;g.sibling=null}return h.child}function Xk(u,h,g){switch(h.tag){case 3:KT(h),Qu();break;case 5:_T(h);break;case 1:vr(h.type)&&og(h);break;case 4:by(h,h.stateNode.containerInfo);break;case 10:var x=h.type._context,w=h.memoizedProps.value;Ln(dg,x._currentValue),x._currentValue=w;break;case 13:if(x=h.memoizedState,x!==null)return x.dehydrated!==null?(Ln(Yn,Yn.current&1),h.flags|=128,null):(g&h.child.childLanes)!==0?QT(u,h,g):(Ln(Yn,Yn.current&1),u=Ua(u,h,g),u!==null?u.sibling:null);Ln(Yn,Yn.current&1);break;case 19:if(x=(g&h.childLanes)!==0,(u.flags&128)!==0){if(x)return eM(u,h,g);h.flags|=128}if(w=h.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ln(Yn,Yn.current),x)break;return null;case 22:case 23:return h.lanes=0,qT(u,h,g)}return Ua(u,h,g)}var tM,Gy,nM,iM;tM=function(u,h){for(var g=h.child;g!==null;){if(g.tag===5||g.tag===6)u.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},Gy=function(){},nM=function(u,h,g,x){var w=u.memoizedProps;if(w!==x){u=h.stateNode,Ll(ta.current);var A=null;switch(g){case"input":w=zt(u,w),x=zt(u,x),A=[];break;case"select":w=U({},w,{value:void 0}),x=U({},x,{value:void 0}),A=[];break;case"textarea":w=ut(u,w),x=ut(u,x),A=[];break;default:typeof w.onClick!="function"&&typeof x.onClick=="function"&&(u.onclick=rg)}ct(g,x);var I;g=null;for(pe in w)if(!x.hasOwnProperty(pe)&&w.hasOwnProperty(pe)&&w[pe]!=null)if(pe==="style"){var $=w[pe];for(I in $)$.hasOwnProperty(I)&&(g||(g={}),g[I]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(r.hasOwnProperty(pe)?A||(A=[]):(A=A||[]).push(pe,null));for(pe in x){var Q=x[pe];if($=w!=null?w[pe]:void 0,x.hasOwnProperty(pe)&&Q!==$&&(Q!=null||$!=null))if(pe==="style")if($){for(I in $)!$.hasOwnProperty(I)||Q&&Q.hasOwnProperty(I)||(g||(g={}),g[I]="");for(I in Q)Q.hasOwnProperty(I)&&$[I]!==Q[I]&&(g||(g={}),g[I]=Q[I])}else g||(A||(A=[]),A.push(pe,g)),g=Q;else pe==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,$=$?$.__html:void 0,Q!=null&&$!==Q&&(A=A||[]).push(pe,Q)):pe==="children"?typeof Q!="string"&&typeof Q!="number"||(A=A||[]).push(pe,""+Q):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(r.hasOwnProperty(pe)?(Q!=null&&pe==="onScroll"&&On("scroll",u),A||$===Q||(A=[])):(A=A||[]).push(pe,Q))}g&&(A=A||[]).push("style",g);var pe=A;(h.updateQueue=pe)&&(h.flags|=4)}},iM=function(u,h,g,x){g!==x&&(h.flags|=4)};function zd(u,h){if(!Vn)switch(u.tailMode){case"hidden":h=u.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:x.sibling=null}}function Bi(u){var h=u.alternate!==null&&u.alternate.child===u.child,g=0,x=0;if(h)for(var w=u.child;w!==null;)g|=w.lanes|w.childLanes,x|=w.subtreeFlags&14680064,x|=w.flags&14680064,w.return=u,w=w.sibling;else for(w=u.child;w!==null;)g|=w.lanes|w.childLanes,x|=w.subtreeFlags,x|=w.flags,w.return=u,w=w.sibling;return u.subtreeFlags|=x,u.childLanes=g,h}function Yk(u,h,g){var x=h.pendingProps;switch(uy(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bi(h),null;case 1:return vr(h.type)&&ag(),Bi(h),null;case 3:return x=h.stateNode,nc(),Bn(yr),Bn(Ui),Ty(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(u===null||u.child===null)&&(hg(h)?h.flags|=4:u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ts!==null&&(Qy(Ts),Ts=null))),Gy(u,h),Bi(h),null;case 5:wy(h);var w=Ll(Ld.current);if(g=h.type,u!==null&&h.stateNode!=null)nM(u,h,g,x,w),u.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!x){if(h.stateNode===null)throw Error(t(166));return Bi(h),null}if(u=Ll(ta.current),hg(h)){x=h.stateNode,g=h.type;var A=h.memoizedProps;switch(x[ea]=h,x[Nd]=A,u=(h.mode&1)!==0,g){case"dialog":On("cancel",x),On("close",x);break;case"iframe":case"object":case"embed":On("load",x);break;case"video":case"audio":for(w=0;w<Ed.length;w++)On(Ed[w],x);break;case"source":On("error",x);break;case"img":case"image":case"link":On("error",x),On("load",x);break;case"details":On("toggle",x);break;case"input":Yt(x,A),On("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!A.multiple},On("invalid",x);break;case"textarea":j(x,A),On("invalid",x)}ct(g,A),w=null;for(var I in A)if(A.hasOwnProperty(I)){var $=A[I];I==="children"?typeof $=="string"?x.textContent!==$&&(A.suppressHydrationWarning!==!0&&ig(x.textContent,$,u),w=["children",$]):typeof $=="number"&&x.textContent!==""+$&&(A.suppressHydrationWarning!==!0&&ig(x.textContent,$,u),w=["children",""+$]):r.hasOwnProperty(I)&&$!=null&&I==="onScroll"&&On("scroll",x)}switch(g){case"input":pt(x),Z(x,A,!0);break;case"textarea":pt(x),se(x);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(x.onclick=rg)}x=w,h.updateQueue=x,x!==null&&(h.flags|=4)}else{I=w.nodeType===9?w:w.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Me(g)),u==="http://www.w3.org/1999/xhtml"?g==="script"?(u=I.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof x.is=="string"?u=I.createElement(g,{is:x.is}):(u=I.createElement(g),g==="select"&&(I=u,x.multiple?I.multiple=!0:x.size&&(I.size=x.size))):u=I.createElementNS(u,g),u[ea]=h,u[Nd]=x,tM(u,h,!1,!1),h.stateNode=u;e:{switch(I=Ve(g,x),g){case"dialog":On("cancel",u),On("close",u),w=x;break;case"iframe":case"object":case"embed":On("load",u),w=x;break;case"video":case"audio":for(w=0;w<Ed.length;w++)On(Ed[w],u);w=x;break;case"source":On("error",u),w=x;break;case"img":case"image":case"link":On("error",u),On("load",u),w=x;break;case"details":On("toggle",u),w=x;break;case"input":Yt(u,x),w=zt(u,x),On("invalid",u);break;case"option":w=x;break;case"select":u._wrapperState={wasMultiple:!!x.multiple},w=U({},x,{value:void 0}),On("invalid",u);break;case"textarea":j(u,x),w=ut(u,x),On("invalid",u);break;default:w=x}ct(g,w),$=w;for(A in $)if($.hasOwnProperty(A)){var Q=$[A];A==="style"?We(u,Q):A==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&dt(u,Q)):A==="children"?typeof Q=="string"?(g!=="textarea"||Q!=="")&&ze(u,Q):typeof Q=="number"&&ze(u,""+Q):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(r.hasOwnProperty(A)?Q!=null&&A==="onScroll"&&On("scroll",u):Q!=null&&T(u,A,Q,I))}switch(g){case"input":pt(u),Z(u,x,!1);break;case"textarea":pt(u),se(u);break;case"option":x.value!=null&&u.setAttribute("value",""+we(x.value));break;case"select":u.multiple=!!x.multiple,A=x.value,A!=null?nn(u,!!x.multiple,A,!1):x.defaultValue!=null&&nn(u,!!x.multiple,x.defaultValue,!0);break;default:typeof w.onClick=="function"&&(u.onclick=rg)}switch(g){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Bi(h),null;case 6:if(u&&h.stateNode!=null)iM(u,h,u.memoizedProps,x);else{if(typeof x!="string"&&h.stateNode===null)throw Error(t(166));if(g=Ll(Ld.current),Ll(ta.current),hg(h)){if(x=h.stateNode,g=h.memoizedProps,x[ea]=h,(A=x.nodeValue!==g)&&(u=Br,u!==null))switch(u.tag){case 3:ig(x.nodeValue,g,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&ig(x.nodeValue,g,(u.mode&1)!==0)}A&&(h.flags|=4)}else x=(g.nodeType===9?g:g.ownerDocument).createTextNode(x),x[ea]=h,h.stateNode=x}return Bi(h),null;case 13:if(Bn(Yn),x=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(Vn&&zr!==null&&(h.mode&1)!==0&&(h.flags&128)===0)sT(),Qu(),h.flags|=98560,A=!1;else if(A=hg(h),x!==null&&x.dehydrated!==null){if(u===null){if(!A)throw Error(t(318));if(A=h.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[ea]=h}else Qu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Bi(h),A=!1}else Ts!==null&&(Qy(Ts),Ts=null),A=!0;if(!A)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=g,h):(x=x!==null,x!==(u!==null&&u.memoizedState!==null)&&x&&(h.child.flags|=8192,(h.mode&1)!==0&&(u===null||(Yn.current&1)!==0?hi===0&&(hi=3):tv())),h.updateQueue!==null&&(h.flags|=4),Bi(h),null);case 4:return nc(),Gy(u,h),u===null&&Cd(h.stateNode.containerInfo),Bi(h),null;case 10:return gy(h.type._context),Bi(h),null;case 17:return vr(h.type)&&ag(),Bi(h),null;case 19:if(Bn(Yn),A=h.memoizedState,A===null)return Bi(h),null;if(x=(h.flags&128)!==0,I=A.rendering,I===null)if(x)zd(A,!1);else{if(hi!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(I=yg(u),I!==null){for(h.flags|=128,zd(A,!1),x=I.updateQueue,x!==null&&(h.updateQueue=x,h.flags|=4),h.subtreeFlags=0,x=g,g=h.child;g!==null;)A=g,u=x,A.flags&=14680066,I=A.alternate,I===null?(A.childLanes=0,A.lanes=u,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=I.childLanes,A.lanes=I.lanes,A.child=I.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=I.memoizedProps,A.memoizedState=I.memoizedState,A.updateQueue=I.updateQueue,A.type=I.type,u=I.dependencies,A.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),g=g.sibling;return Ln(Yn,Yn.current&1|2),h.child}u=u.sibling}A.tail!==null&&Xn()>ac&&(h.flags|=128,x=!0,zd(A,!1),h.lanes=4194304)}else{if(!x)if(u=yg(I),u!==null){if(h.flags|=128,x=!0,g=u.updateQueue,g!==null&&(h.updateQueue=g,h.flags|=4),zd(A,!0),A.tail===null&&A.tailMode==="hidden"&&!I.alternate&&!Vn)return Bi(h),null}else 2*Xn()-A.renderingStartTime>ac&&g!==1073741824&&(h.flags|=128,x=!0,zd(A,!1),h.lanes=4194304);A.isBackwards?(I.sibling=h.child,h.child=I):(g=A.last,g!==null?g.sibling=I:h.child=I,A.last=I)}return A.tail!==null?(h=A.tail,A.rendering=h,A.tail=h.sibling,A.renderingStartTime=Xn(),h.sibling=null,g=Yn.current,Ln(Yn,x?g&1|2:g&1),h):(Bi(h),null);case 22:case 23:return ev(),x=h.memoizedState!==null,u!==null&&u.memoizedState!==null!==x&&(h.flags|=8192),x&&(h.mode&1)!==0?(Gr&1073741824)!==0&&(Bi(h),h.subtreeFlags&6&&(h.flags|=8192)):Bi(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function Kk(u,h){switch(uy(h),h.tag){case 1:return vr(h.type)&&ag(),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return nc(),Bn(yr),Bn(Ui),Ty(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 5:return wy(h),null;case 13:if(Bn(Yn),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Qu()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return Bn(Yn),null;case 4:return nc(),null;case 10:return gy(h.type._context),null;case 22:case 23:return ev(),null;case 24:return null;default:return null}}var Ag=!1,zi=!1,Zk=typeof WeakSet=="function"?WeakSet:Set,rt=null;function rc(u,h){var g=u.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(x){Zn(u,h,x)}else g.current=null}function Vy(u,h,g){try{g()}catch(x){Zn(u,h,x)}}var rM=!1;function Qk(u,h){if(ey=$p,u=L1(),$_(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var w=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{g.nodeType,A.nodeType}catch{g=null;break e}var I=0,$=-1,Q=-1,pe=0,Pe=0,ke=u,Ne=null;t:for(;;){for(var et;ke!==g||w!==0&&ke.nodeType!==3||($=I+w),ke!==A||x!==0&&ke.nodeType!==3||(Q=I+x),ke.nodeType===3&&(I+=ke.nodeValue.length),(et=ke.firstChild)!==null;)Ne=ke,ke=et;for(;;){if(ke===u)break t;if(Ne===g&&++pe===w&&($=I),Ne===A&&++Pe===x&&(Q=I),(et=ke.nextSibling)!==null)break;ke=Ne,Ne=ke.parentNode}ke=et}g=$===-1||Q===-1?null:{start:$,end:Q}}else g=null}g=g||{start:0,end:0}}else g=null;for(ty={focusedElem:u,selectionRange:g},$p=!1,rt=h;rt!==null;)if(h=rt,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,rt=u;else for(;rt!==null;){h=rt;try{var lt=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ht=lt.memoizedProps,ei=lt.memoizedState,ue=h.stateNode,ne=ue.getSnapshotBeforeUpdate(h.elementType===h.type?ht:Ms(h.type,ht),ei);ue.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var he=h.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){Zn(h,h.return,Ue)}if(u=h.sibling,u!==null){u.return=h.return,rt=u;break}rt=h.return}return lt=rM,rM=!1,lt}function Gd(u,h,g){var x=h.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var w=x=x.next;do{if((w.tag&u)===u){var A=w.destroy;w.destroy=void 0,A!==void 0&&Vy(h,g,A)}w=w.next}while(w!==x)}}function Eg(u,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&u)===u){var x=g.create;g.destroy=x()}g=g.next}while(g!==h)}}function jy(u){var h=u.ref;if(h!==null){var g=u.stateNode;switch(u.tag){case 5:u=g;break;default:u=g}typeof h=="function"?h(u):h.current=u}}function sM(u){var h=u.alternate;h!==null&&(u.alternate=null,sM(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&(delete h[ea],delete h[Nd],delete h[sy],delete h[Ik],delete h[Lk])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function aM(u){return u.tag===5||u.tag===3||u.tag===4}function oM(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||aM(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Hy(u,h,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,h?g.nodeType===8?g.parentNode.insertBefore(u,h):g.insertBefore(u,h):(g.nodeType===8?(h=g.parentNode,h.insertBefore(u,g)):(h=g,h.appendChild(u)),g=g._reactRootContainer,g!=null||h.onclick!==null||(h.onclick=rg));else if(x!==4&&(u=u.child,u!==null))for(Hy(u,h,g),u=u.sibling;u!==null;)Hy(u,h,g),u=u.sibling}function Wy(u,h,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,h?g.insertBefore(u,h):g.appendChild(u);else if(x!==4&&(u=u.child,u!==null))for(Wy(u,h,g),u=u.sibling;u!==null;)Wy(u,h,g),u=u.sibling}var Ei=null,As=!1;function Io(u,h,g){for(g=g.child;g!==null;)lM(u,h,g),g=g.sibling}function lM(u,h,g){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(Je,g)}catch{}switch(g.tag){case 5:zi||rc(g,h);case 6:var x=Ei,w=As;Ei=null,Io(u,h,g),Ei=x,As=w,Ei!==null&&(As?(u=Ei,g=g.stateNode,u.nodeType===8?u.parentNode.removeChild(g):u.removeChild(g)):Ei.removeChild(g.stateNode));break;case 18:Ei!==null&&(As?(u=Ei,g=g.stateNode,u.nodeType===8?ry(u.parentNode,g):u.nodeType===1&&ry(u,g),vd(u)):ry(Ei,g.stateNode));break;case 4:x=Ei,w=As,Ei=g.stateNode.containerInfo,As=!0,Io(u,h,g),Ei=x,As=w;break;case 0:case 11:case 14:case 15:if(!zi&&(x=g.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){w=x=x.next;do{var A=w,I=A.destroy;A=A.tag,I!==void 0&&((A&2)!==0||(A&4)!==0)&&Vy(g,h,I),w=w.next}while(w!==x)}Io(u,h,g);break;case 1:if(!zi&&(rc(g,h),x=g.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=g.memoizedProps,x.state=g.memoizedState,x.componentWillUnmount()}catch($){Zn(g,h,$)}Io(u,h,g);break;case 21:Io(u,h,g);break;case 22:g.mode&1?(zi=(x=zi)||g.memoizedState!==null,Io(u,h,g),zi=x):Io(u,h,g);break;default:Io(u,h,g)}}function uM(u){var h=u.updateQueue;if(h!==null){u.updateQueue=null;var g=u.stateNode;g===null&&(g=u.stateNode=new Zk),h.forEach(function(x){var w=oI.bind(null,u,x);g.has(x)||(g.add(x),x.then(w,w))})}}function Es(u,h){var g=h.deletions;if(g!==null)for(var x=0;x<g.length;x++){var w=g[x];try{var A=u,I=h,$=I;e:for(;$!==null;){switch($.tag){case 5:Ei=$.stateNode,As=!1;break e;case 3:Ei=$.stateNode.containerInfo,As=!0;break e;case 4:Ei=$.stateNode.containerInfo,As=!0;break e}$=$.return}if(Ei===null)throw Error(t(160));lM(A,I,w),Ei=null,As=!1;var Q=w.alternate;Q!==null&&(Q.return=null),w.return=null}catch(pe){Zn(w,h,pe)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)cM(h,u),h=h.sibling}function cM(u,h){var g=u.alternate,x=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Es(h,u),ia(u),x&4){try{Gd(3,u,u.return),Eg(3,u)}catch(ht){Zn(u,u.return,ht)}try{Gd(5,u,u.return)}catch(ht){Zn(u,u.return,ht)}}break;case 1:Es(h,u),ia(u),x&512&&g!==null&&rc(g,g.return);break;case 5:if(Es(h,u),ia(u),x&512&&g!==null&&rc(g,g.return),u.flags&32){var w=u.stateNode;try{ze(w,"")}catch(ht){Zn(u,u.return,ht)}}if(x&4&&(w=u.stateNode,w!=null)){var A=u.memoizedProps,I=g!==null?g.memoizedProps:A,$=u.type,Q=u.updateQueue;if(u.updateQueue=null,Q!==null)try{$==="input"&&A.type==="radio"&&A.name!=null&&Ct(w,A),Ve($,I);var pe=Ve($,A);for(I=0;I<Q.length;I+=2){var Pe=Q[I],ke=Q[I+1];Pe==="style"?We(w,ke):Pe==="dangerouslySetInnerHTML"?dt(w,ke):Pe==="children"?ze(w,ke):T(w,Pe,ke,pe)}switch($){case"input":tn(w,A);break;case"textarea":k(w,A);break;case"select":var Ne=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!A.multiple;var et=A.value;et!=null?nn(w,!!A.multiple,et,!1):Ne!==!!A.multiple&&(A.defaultValue!=null?nn(w,!!A.multiple,A.defaultValue,!0):nn(w,!!A.multiple,A.multiple?[]:"",!1))}w[Nd]=A}catch(ht){Zn(u,u.return,ht)}}break;case 6:if(Es(h,u),ia(u),x&4){if(u.stateNode===null)throw Error(t(162));w=u.stateNode,A=u.memoizedProps;try{w.nodeValue=A}catch(ht){Zn(u,u.return,ht)}}break;case 3:if(Es(h,u),ia(u),x&4&&g!==null&&g.memoizedState.isDehydrated)try{vd(h.containerInfo)}catch(ht){Zn(u,u.return,ht)}break;case 4:Es(h,u),ia(u);break;case 13:Es(h,u),ia(u),w=u.child,w.flags&8192&&(A=w.memoizedState!==null,w.stateNode.isHidden=A,!A||w.alternate!==null&&w.alternate.memoizedState!==null||(Xy=Xn())),x&4&&uM(u);break;case 22:if(Pe=g!==null&&g.memoizedState!==null,u.mode&1?(zi=(pe=zi)||Pe,Es(h,u),zi=pe):Es(h,u),ia(u),x&8192){if(pe=u.memoizedState!==null,(u.stateNode.isHidden=pe)&&!Pe&&(u.mode&1)!==0)for(rt=u,Pe=u.child;Pe!==null;){for(ke=rt=Pe;rt!==null;){switch(Ne=rt,et=Ne.child,Ne.tag){case 0:case 11:case 14:case 15:Gd(4,Ne,Ne.return);break;case 1:rc(Ne,Ne.return);var lt=Ne.stateNode;if(typeof lt.componentWillUnmount=="function"){x=Ne,g=Ne.return;try{h=x,lt.props=h.memoizedProps,lt.state=h.memoizedState,lt.componentWillUnmount()}catch(ht){Zn(x,g,ht)}}break;case 5:rc(Ne,Ne.return);break;case 22:if(Ne.memoizedState!==null){fM(ke);continue}}et!==null?(et.return=Ne,rt=et):fM(ke)}Pe=Pe.sibling}e:for(Pe=null,ke=u;;){if(ke.tag===5){if(Pe===null){Pe=ke;try{w=ke.stateNode,pe?(A=w.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):($=ke.stateNode,Q=ke.memoizedProps.style,I=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,$.style.display=Ie("display",I))}catch(ht){Zn(u,u.return,ht)}}}else if(ke.tag===6){if(Pe===null)try{ke.stateNode.nodeValue=pe?"":ke.memoizedProps}catch(ht){Zn(u,u.return,ht)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===u)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===u)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===u)break e;Pe===ke&&(Pe=null),ke=ke.return}Pe===ke&&(Pe=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:Es(h,u),ia(u),x&4&&uM(u);break;case 21:break;default:Es(h,u),ia(u)}}function ia(u){var h=u.flags;if(h&2){try{e:{for(var g=u.return;g!==null;){if(aM(g)){var x=g;break e}g=g.return}throw Error(t(160))}switch(x.tag){case 5:var w=x.stateNode;x.flags&32&&(ze(w,""),x.flags&=-33);var A=oM(u);Wy(u,A,w);break;case 3:case 4:var I=x.stateNode.containerInfo,$=oM(u);Hy(u,$,I);break;default:throw Error(t(161))}}catch(Q){Zn(u,u.return,Q)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function Jk(u,h,g){rt=u,hM(u)}function hM(u,h,g){for(var x=(u.mode&1)!==0;rt!==null;){var w=rt,A=w.child;if(w.tag===22&&x){var I=w.memoizedState!==null||Ag;if(!I){var $=w.alternate,Q=$!==null&&$.memoizedState!==null||zi;$=Ag;var pe=zi;if(Ag=I,(zi=Q)&&!pe)for(rt=w;rt!==null;)I=rt,Q=I.child,I.tag===22&&I.memoizedState!==null?pM(w):Q!==null?(Q.return=I,rt=Q):pM(w);for(;A!==null;)rt=A,hM(A),A=A.sibling;rt=w,Ag=$,zi=pe}dM(u)}else(w.subtreeFlags&8772)!==0&&A!==null?(A.return=w,rt=A):dM(u)}}function dM(u){for(;rt!==null;){var h=rt;if((h.flags&8772)!==0){var g=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:zi||Eg(5,h);break;case 1:var x=h.stateNode;if(h.flags&4&&!zi)if(g===null)x.componentDidMount();else{var w=h.elementType===h.type?g.memoizedProps:Ms(h.type,g.memoizedProps);x.componentDidUpdate(w,g.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var A=h.updateQueue;A!==null&&uT(h,A,x);break;case 3:var I=h.updateQueue;if(I!==null){if(g=null,h.child!==null)switch(h.child.tag){case 5:g=h.child.stateNode;break;case 1:g=h.child.stateNode}uT(h,I,g)}break;case 5:var $=h.stateNode;if(g===null&&h.flags&4){g=$;var Q=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&g.focus();break;case"img":Q.src&&(g.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var pe=h.alternate;if(pe!==null){var Pe=pe.memoizedState;if(Pe!==null){var ke=Pe.dehydrated;ke!==null&&vd(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}zi||h.flags&512&&jy(h)}catch(Ne){Zn(h,h.return,Ne)}}if(h===u){rt=null;break}if(g=h.sibling,g!==null){g.return=h.return,rt=g;break}rt=h.return}}function fM(u){for(;rt!==null;){var h=rt;if(h===u){rt=null;break}var g=h.sibling;if(g!==null){g.return=h.return,rt=g;break}rt=h.return}}function pM(u){for(;rt!==null;){var h=rt;try{switch(h.tag){case 0:case 11:case 15:var g=h.return;try{Eg(4,h)}catch(Q){Zn(h,g,Q)}break;case 1:var x=h.stateNode;if(typeof x.componentDidMount=="function"){var w=h.return;try{x.componentDidMount()}catch(Q){Zn(h,w,Q)}}var A=h.return;try{jy(h)}catch(Q){Zn(h,A,Q)}break;case 5:var I=h.return;try{jy(h)}catch(Q){Zn(h,I,Q)}}}catch(Q){Zn(h,h.return,Q)}if(h===u){rt=null;break}var $=h.sibling;if($!==null){$.return=h.return,rt=$;break}rt=h.return}}var eI=Math.ceil,Cg=E.ReactCurrentDispatcher,$y=E.ReactCurrentOwner,os=E.ReactCurrentBatchConfig,an=0,xi=null,ii=null,Ci=0,Gr=0,sc=Ro(0),hi=0,Vd=null,Ul=0,Rg=0,qy=0,jd=null,br=null,Xy=0,ac=1/0,Oa=null,Ng=!1,Yy=null,Lo=null,Pg=!1,Fo=null,Dg=0,Hd=0,Ky=null,kg=-1,Ig=0;function rr(){return(an&6)!==0?Xn():kg!==-1?kg:kg=Xn()}function Uo(u){return(u.mode&1)===0?1:(an&2)!==0&&Ci!==0?Ci&-Ci:Uk.transition!==null?(Ig===0&&(Ig=Fi()),Ig):(u=Lt,u!==0||(u=window.event,u=u===void 0?16:g1(u.type)),u)}function Cs(u,h,g,x){if(50<Hd)throw Hd=0,Ky=null,Error(t(185));ui(u,g,x),((an&2)===0||u!==xi)&&(u===xi&&((an&2)===0&&(Rg|=g),hi===4&&Oo(u,Ci)),wr(u,x),g===1&&an===0&&(h.mode&1)===0&&(ac=Xn()+500,lg&&Po()))}function wr(u,h){var g=u.callbackNode;fn(u,h);var x=un(u,u===xi?Ci:0);if(x===0)g!==null&&jp(g),u.callbackNode=null,u.callbackPriority=0;else if(h=x&-x,u.callbackPriority!==h){if(g!=null&&jp(g),h===1)u.tag===0?Fk(mM.bind(null,u)):eT(mM.bind(null,u)),Dk(function(){(an&6)===0&&Po()}),g=null;else{switch(nr(x)){case 1:g=ae;break;case 4:g=ge;break;case 16:g=de;break;case 536870912:g=$e;break;default:g=de}g=TM(g,gM.bind(null,u))}u.callbackPriority=h,u.callbackNode=g}}function gM(u,h){if(kg=-1,Ig=0,(an&6)!==0)throw Error(t(327));var g=u.callbackNode;if(oc()&&u.callbackNode!==g)return null;var x=un(u,u===xi?Ci:0);if(x===0)return null;if((x&30)!==0||(x&u.expiredLanes)!==0||h)h=Lg(u,x);else{h=x;var w=an;an|=2;var A=yM();(xi!==u||Ci!==h)&&(Oa=null,ac=Xn()+500,Bl(u,h));do try{iI();break}catch($){_M(u,$)}while(!0);py(),Cg.current=A,an=w,ii!==null?h=0:(xi=null,Ci=0,h=hi)}if(h!==0){if(h===2&&(w=Zt(u),w!==0&&(x=w,h=Zy(u,w))),h===1)throw g=Vd,Bl(u,0),Oo(u,x),wr(u,Xn()),g;if(h===6)Oo(u,x);else{if(w=u.current.alternate,(x&30)===0&&!tI(w)&&(h=Lg(u,x),h===2&&(A=Zt(u),A!==0&&(x=A,h=Zy(u,A))),h===1))throw g=Vd,Bl(u,0),Oo(u,x),wr(u,Xn()),g;switch(u.finishedWork=w,u.finishedLanes=x,h){case 0:case 1:throw Error(t(345));case 2:zl(u,br,Oa);break;case 3:if(Oo(u,x),(x&130023424)===x&&(h=Xy+500-Xn(),10<h)){if(un(u,0)!==0)break;if(w=u.suspendedLanes,(w&x)!==x){rr(),u.pingedLanes|=u.suspendedLanes&w;break}u.timeoutHandle=iy(zl.bind(null,u,br,Oa),h);break}zl(u,br,Oa);break;case 4:if(Oo(u,x),(x&4194240)===x)break;for(h=u.eventTimes,w=-1;0<x;){var I=31-nt(x);A=1<<I,I=h[I],I>w&&(w=I),x&=~A}if(x=w,x=Xn()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*eI(x/1960))-x,10<x){u.timeoutHandle=iy(zl.bind(null,u,br,Oa),x);break}zl(u,br,Oa);break;case 5:zl(u,br,Oa);break;default:throw Error(t(329))}}}return wr(u,Xn()),u.callbackNode===g?gM.bind(null,u):null}function Zy(u,h){var g=jd;return u.current.memoizedState.isDehydrated&&(Bl(u,h).flags|=256),u=Lg(u,h),u!==2&&(h=br,br=g,h!==null&&Qy(h)),u}function Qy(u){br===null?br=u:br.push.apply(br,u)}function tI(u){for(var h=u;;){if(h.flags&16384){var g=h.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var x=0;x<g.length;x++){var w=g[x],A=w.getSnapshot;w=w.value;try{if(!Ss(A(),w))return!1}catch{return!1}}}if(g=h.child,h.subtreeFlags&16384&&g!==null)g.return=h,h=g;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Oo(u,h){for(h&=~qy,h&=~Rg,u.suspendedLanes|=h,u.pingedLanes&=~h,u=u.expirationTimes;0<h;){var g=31-nt(h),x=1<<g;u[g]=-1,h&=~x}}function mM(u){if((an&6)!==0)throw Error(t(327));oc();var h=un(u,0);if((h&1)===0)return wr(u,Xn()),null;var g=Lg(u,h);if(u.tag!==0&&g===2){var x=Zt(u);x!==0&&(h=x,g=Zy(u,x))}if(g===1)throw g=Vd,Bl(u,0),Oo(u,h),wr(u,Xn()),g;if(g===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=h,zl(u,br,Oa),wr(u,Xn()),null}function Jy(u,h){var g=an;an|=1;try{return u(h)}finally{an=g,an===0&&(ac=Xn()+500,lg&&Po())}}function Ol(u){Fo!==null&&Fo.tag===0&&(an&6)===0&&oc();var h=an;an|=1;var g=os.transition,x=Lt;try{if(os.transition=null,Lt=1,u)return u()}finally{Lt=x,os.transition=g,an=h,(an&6)===0&&Po()}}function ev(){Gr=sc.current,Bn(sc)}function Bl(u,h){u.finishedWork=null,u.finishedLanes=0;var g=u.timeoutHandle;if(g!==-1&&(u.timeoutHandle=-1,Pk(g)),ii!==null)for(g=ii.return;g!==null;){var x=g;switch(uy(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&ag();break;case 3:nc(),Bn(yr),Bn(Ui),Ty();break;case 5:wy(x);break;case 4:nc();break;case 13:Bn(Yn);break;case 19:Bn(Yn);break;case 10:gy(x.type._context);break;case 22:case 23:ev()}g=g.return}if(xi=u,ii=u=Bo(u.current,null),Ci=Gr=h,hi=0,Vd=null,qy=Rg=Ul=0,br=jd=null,Il!==null){for(h=0;h<Il.length;h++)if(g=Il[h],x=g.interleaved,x!==null){g.interleaved=null;var w=x.next,A=g.pending;if(A!==null){var I=A.next;A.next=w,x.next=I}g.pending=x}Il=null}return u}function _M(u,h){do{var g=ii;try{if(py(),vg.current=Sg,xg){for(var x=Kn.memoizedState;x!==null;){var w=x.queue;w!==null&&(w.pending=null),x=x.next}xg=!1}if(Fl=0,vi=ci=Kn=null,Fd=!1,Ud=0,$y.current=null,g===null||g.return===null){hi=1,Vd=h,ii=null;break}e:{var A=u,I=g.return,$=g,Q=h;if(h=Ci,$.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var pe=Q,Pe=$,ke=Pe.tag;if((Pe.mode&1)===0&&(ke===0||ke===11||ke===15)){var Ne=Pe.alternate;Ne?(Pe.updateQueue=Ne.updateQueue,Pe.memoizedState=Ne.memoizedState,Pe.lanes=Ne.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var et=VT(I);if(et!==null){et.flags&=-257,jT(et,I,$,A,h),et.mode&1&&GT(A,pe,h),h=et,Q=pe;var lt=h.updateQueue;if(lt===null){var ht=new Set;ht.add(Q),h.updateQueue=ht}else lt.add(Q);break e}else{if((h&1)===0){GT(A,pe,h),tv();break e}Q=Error(t(426))}}else if(Vn&&$.mode&1){var ei=VT(I);if(ei!==null){(ei.flags&65536)===0&&(ei.flags|=256),jT(ei,I,$,A,h),dy(ic(Q,$));break e}}A=Q=ic(Q,$),hi!==4&&(hi=2),jd===null?jd=[A]:jd.push(A),A=I;do{switch(A.tag){case 3:A.flags|=65536,h&=-h,A.lanes|=h;var ue=BT(A,Q,h);lT(A,ue);break e;case 1:$=Q;var ne=A.type,he=A.stateNode;if((A.flags&128)===0&&(typeof ne.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(Lo===null||!Lo.has(he)))){A.flags|=65536,h&=-h,A.lanes|=h;var Ue=zT(A,$,h);lT(A,Ue);break e}}A=A.return}while(A!==null)}xM(g)}catch(gt){h=gt,ii===g&&g!==null&&(ii=g=g.return);continue}break}while(!0)}function yM(){var u=Cg.current;return Cg.current=Sg,u===null?Sg:u}function tv(){(hi===0||hi===3||hi===2)&&(hi=4),xi===null||(Ul&268435455)===0&&(Rg&268435455)===0||Oo(xi,Ci)}function Lg(u,h){var g=an;an|=2;var x=yM();(xi!==u||Ci!==h)&&(Oa=null,Bl(u,h));do try{nI();break}catch(w){_M(u,w)}while(!0);if(py(),an=g,Cg.current=x,ii!==null)throw Error(t(261));return xi=null,Ci=0,hi}function nI(){for(;ii!==null;)vM(ii)}function iI(){for(;ii!==null&&!D_();)vM(ii)}function vM(u){var h=SM(u.alternate,u,Gr);u.memoizedProps=u.pendingProps,h===null?xM(u):ii=h,$y.current=null}function xM(u){var h=u;do{var g=h.alternate;if(u=h.return,(h.flags&32768)===0){if(g=Yk(g,h,Gr),g!==null){ii=g;return}}else{if(g=Kk(g,h),g!==null){g.flags&=32767,ii=g;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{hi=6,ii=null;return}}if(h=h.sibling,h!==null){ii=h;return}ii=h=u}while(h!==null);hi===0&&(hi=5)}function zl(u,h,g){var x=Lt,w=os.transition;try{os.transition=null,Lt=1,rI(u,h,g,x)}finally{os.transition=w,Lt=x}return null}function rI(u,h,g,x){do oc();while(Fo!==null);if((an&6)!==0)throw Error(t(327));g=u.finishedWork;var w=u.finishedLanes;if(g===null)return null;if(u.finishedWork=null,u.finishedLanes=0,g===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var A=g.lanes|g.childLanes;if(Rl(u,A),u===xi&&(ii=xi=null,Ci=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||Pg||(Pg=!0,TM(de,function(){return oc(),null})),A=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||A){A=os.transition,os.transition=null;var I=Lt;Lt=1;var $=an;an|=4,$y.current=null,Qk(u,g),cM(g,u),Tk(ty),$p=!!ey,ty=ey=null,u.current=g,Jk(g),k_(),an=$,Lt=I,os.transition=A}else u.current=g;if(Pg&&(Pg=!1,Fo=u,Dg=w),A=u.pendingLanes,A===0&&(Lo=null),at(g.stateNode),wr(u,Xn()),h!==null)for(x=u.onRecoverableError,g=0;g<h.length;g++)w=h[g],x(w.value,{componentStack:w.stack,digest:w.digest});if(Ng)throw Ng=!1,u=Yy,Yy=null,u;return(Dg&1)!==0&&u.tag!==0&&oc(),A=u.pendingLanes,(A&1)!==0?u===Ky?Hd++:(Hd=0,Ky=u):Hd=0,Po(),null}function oc(){if(Fo!==null){var u=nr(Dg),h=os.transition,g=Lt;try{if(os.transition=null,Lt=16>u?16:u,Fo===null)var x=!1;else{if(u=Fo,Fo=null,Dg=0,(an&6)!==0)throw Error(t(331));var w=an;for(an|=4,rt=u.current;rt!==null;){var A=rt,I=A.child;if((rt.flags&16)!==0){var $=A.deletions;if($!==null){for(var Q=0;Q<$.length;Q++){var pe=$[Q];for(rt=pe;rt!==null;){var Pe=rt;switch(Pe.tag){case 0:case 11:case 15:Gd(8,Pe,A)}var ke=Pe.child;if(ke!==null)ke.return=Pe,rt=ke;else for(;rt!==null;){Pe=rt;var Ne=Pe.sibling,et=Pe.return;if(sM(Pe),Pe===pe){rt=null;break}if(Ne!==null){Ne.return=et,rt=Ne;break}rt=et}}}var lt=A.alternate;if(lt!==null){var ht=lt.child;if(ht!==null){lt.child=null;do{var ei=ht.sibling;ht.sibling=null,ht=ei}while(ht!==null)}}rt=A}}if((A.subtreeFlags&2064)!==0&&I!==null)I.return=A,rt=I;else e:for(;rt!==null;){if(A=rt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Gd(9,A,A.return)}var ue=A.sibling;if(ue!==null){ue.return=A.return,rt=ue;break e}rt=A.return}}var ne=u.current;for(rt=ne;rt!==null;){I=rt;var he=I.child;if((I.subtreeFlags&2064)!==0&&he!==null)he.return=I,rt=he;else e:for(I=ne;rt!==null;){if($=rt,($.flags&2048)!==0)try{switch($.tag){case 0:case 11:case 15:Eg(9,$)}}catch(gt){Zn($,$.return,gt)}if($===I){rt=null;break e}var Ue=$.sibling;if(Ue!==null){Ue.return=$.return,rt=Ue;break e}rt=$.return}}if(an=w,Po(),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(Je,u)}catch{}x=!0}return x}finally{Lt=g,os.transition=h}}return!1}function bM(u,h,g){h=ic(g,h),h=BT(u,h,1),u=ko(u,h,1),h=rr(),u!==null&&(ui(u,1,h),wr(u,h))}function Zn(u,h,g){if(u.tag===3)bM(u,u,g);else for(;h!==null;){if(h.tag===3){bM(h,u,g);break}else if(h.tag===1){var x=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Lo===null||!Lo.has(x))){u=ic(g,u),u=zT(h,u,1),h=ko(h,u,1),u=rr(),h!==null&&(ui(h,1,u),wr(h,u));break}}h=h.return}}function sI(u,h,g){var x=u.pingCache;x!==null&&x.delete(h),h=rr(),u.pingedLanes|=u.suspendedLanes&g,xi===u&&(Ci&g)===g&&(hi===4||hi===3&&(Ci&130023424)===Ci&&500>Xn()-Xy?Bl(u,0):qy|=g),wr(u,h)}function wM(u,h){h===0&&((u.mode&1)===0?h=1:(h=Cn,Cn<<=1,(Cn&130023424)===0&&(Cn=4194304)));var g=rr();u=La(u,h),u!==null&&(ui(u,h,g),wr(u,g))}function aI(u){var h=u.memoizedState,g=0;h!==null&&(g=h.retryLane),wM(u,g)}function oI(u,h){var g=0;switch(u.tag){case 13:var x=u.stateNode,w=u.memoizedState;w!==null&&(g=w.retryLane);break;case 19:x=u.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(h),wM(u,g)}var SM;SM=function(u,h,g){if(u!==null)if(u.memoizedProps!==h.pendingProps||yr.current)xr=!0;else{if((u.lanes&g)===0&&(h.flags&128)===0)return xr=!1,Xk(u,h,g);xr=(u.flags&131072)!==0}else xr=!1,Vn&&(h.flags&1048576)!==0&&tT(h,cg,h.index);switch(h.lanes=0,h.tag){case 2:var x=h.type;Mg(u,h),u=h.pendingProps;var w=Yu(h,Ui.current);ec(h,g),w=Ey(null,h,x,u,w,g);var A=Cy();return h.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,vr(x)?(A=!0,og(h)):A=!1,h.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,yy(h),w.updater=mg,h.stateNode=w,w._reactInternals=h,xy(h,x,u,g),h=Fy(null,h,x,!0,A,g)):(h.tag=0,Vn&&A&&ly(h),ir(null,h,w,g),h=h.child),h;case 16:x=h.elementType;e:{switch(Mg(u,h),u=h.pendingProps,w=x._init,x=w(x._payload),h.type=x,w=h.tag=uI(x),u=Ms(x,u),w){case 0:h=Ly(null,h,x,u,g);break e;case 1:h=YT(null,h,x,u,g);break e;case 11:h=HT(null,h,x,u,g);break e;case 14:h=WT(null,h,x,Ms(x.type,u),g);break e}throw Error(t(306,x,""))}return h;case 0:return x=h.type,w=h.pendingProps,w=h.elementType===x?w:Ms(x,w),Ly(u,h,x,w,g);case 1:return x=h.type,w=h.pendingProps,w=h.elementType===x?w:Ms(x,w),YT(u,h,x,w,g);case 3:e:{if(KT(h),u===null)throw Error(t(387));x=h.pendingProps,A=h.memoizedState,w=A.element,oT(u,h),gg(h,x,null,g);var I=h.memoizedState;if(x=I.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},h.updateQueue.baseState=A,h.memoizedState=A,h.flags&256){w=ic(Error(t(423)),h),h=ZT(u,h,x,g,w);break e}else if(x!==w){w=ic(Error(t(424)),h),h=ZT(u,h,x,g,w);break e}else for(zr=Co(h.stateNode.containerInfo.firstChild),Br=h,Vn=!0,Ts=null,g=mT(h,null,x,g),h.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Qu(),x===w){h=Ua(u,h,g);break e}ir(u,h,x,g)}h=h.child}return h;case 5:return _T(h),u===null&&hy(h),x=h.type,w=h.pendingProps,A=u!==null?u.memoizedProps:null,I=w.children,ny(x,w)?I=null:A!==null&&ny(x,A)&&(h.flags|=32),XT(u,h),ir(u,h,I,g),h.child;case 6:return u===null&&hy(h),null;case 13:return QT(u,h,g);case 4:return by(h,h.stateNode.containerInfo),x=h.pendingProps,u===null?h.child=tc(h,null,x,g):ir(u,h,x,g),h.child;case 11:return x=h.type,w=h.pendingProps,w=h.elementType===x?w:Ms(x,w),HT(u,h,x,w,g);case 7:return ir(u,h,h.pendingProps,g),h.child;case 8:return ir(u,h,h.pendingProps.children,g),h.child;case 12:return ir(u,h,h.pendingProps.children,g),h.child;case 10:e:{if(x=h.type._context,w=h.pendingProps,A=h.memoizedProps,I=w.value,Ln(dg,x._currentValue),x._currentValue=I,A!==null)if(Ss(A.value,I)){if(A.children===w.children&&!yr.current){h=Ua(u,h,g);break e}}else for(A=h.child,A!==null&&(A.return=h);A!==null;){var $=A.dependencies;if($!==null){I=A.child;for(var Q=$.firstContext;Q!==null;){if(Q.context===x){if(A.tag===1){Q=Fa(-1,g&-g),Q.tag=2;var pe=A.updateQueue;if(pe!==null){pe=pe.shared;var Pe=pe.pending;Pe===null?Q.next=Q:(Q.next=Pe.next,Pe.next=Q),pe.pending=Q}}A.lanes|=g,Q=A.alternate,Q!==null&&(Q.lanes|=g),my(A.return,g,h),$.lanes|=g;break}Q=Q.next}}else if(A.tag===10)I=A.type===h.type?null:A.child;else if(A.tag===18){if(I=A.return,I===null)throw Error(t(341));I.lanes|=g,$=I.alternate,$!==null&&($.lanes|=g),my(I,g,h),I=A.sibling}else I=A.child;if(I!==null)I.return=A;else for(I=A;I!==null;){if(I===h){I=null;break}if(A=I.sibling,A!==null){A.return=I.return,I=A;break}I=I.return}A=I}ir(u,h,w.children,g),h=h.child}return h;case 9:return w=h.type,x=h.pendingProps.children,ec(h,g),w=ss(w),x=x(w),h.flags|=1,ir(u,h,x,g),h.child;case 14:return x=h.type,w=Ms(x,h.pendingProps),w=Ms(x.type,w),WT(u,h,x,w,g);case 15:return $T(u,h,h.type,h.pendingProps,g);case 17:return x=h.type,w=h.pendingProps,w=h.elementType===x?w:Ms(x,w),Mg(u,h),h.tag=1,vr(x)?(u=!0,og(h)):u=!1,ec(h,g),dT(h,x,w),xy(h,x,w,g),Fy(null,h,x,!0,u,g);case 19:return eM(u,h,g);case 22:return qT(u,h,g)}throw Error(t(156,h.tag))};function TM(u,h){return Vp(u,h)}function lI(u,h,g,x){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(u,h,g,x){return new lI(u,h,g,x)}function nv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function uI(u){if(typeof u=="function")return nv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===z)return 11;if(u===V)return 14}return 2}function Bo(u,h){var g=u.alternate;return g===null?(g=ls(u.tag,h,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=h,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&14680064,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,h=u.dependencies,g.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g}function Fg(u,h,g,x,w,A){var I=2;if(x=u,typeof u=="function")nv(u)&&(I=1);else if(typeof u=="string")I=5;else e:switch(u){case C:return Gl(g.children,w,A,h);case D:I=8,w|=8;break;case R:return u=ls(12,g,h,w|2),u.elementType=R,u.lanes=A,u;case B:return u=ls(13,g,h,w),u.elementType=B,u.lanes=A,u;case O:return u=ls(19,g,h,w),u.elementType=O,u.lanes=A,u;case G:return Ug(g,w,A,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case P:I=10;break e;case L:I=9;break e;case z:I=11;break e;case V:I=14;break e;case Y:I=16,x=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return h=ls(I,g,h,w),h.elementType=u,h.type=x,h.lanes=A,h}function Gl(u,h,g,x){return u=ls(7,u,x,h),u.lanes=g,u}function Ug(u,h,g,x){return u=ls(22,u,x,h),u.elementType=G,u.lanes=g,u.stateNode={isHidden:!1},u}function iv(u,h,g){return u=ls(6,u,null,h),u.lanes=g,u}function rv(u,h,g){return h=ls(4,u.children!==null?u.children:[],u.key,h),h.lanes=g,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function cI(u,h,g,x,w){this.tag=h,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qs(0),this.expirationTimes=Qs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qs(0),this.identifierPrefix=x,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function sv(u,h,g,x,w,A,I,$,Q){return u=new cI(u,h,g,$,Q),h===1?(h=1,A===!0&&(h|=8)):h=0,A=ls(3,null,null,h),u.current=A,A.stateNode=u,A.memoizedState={element:x,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},yy(A),u}function hI(u,h,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:x==null?null:""+x,children:u,containerInfo:h,implementation:g}}function MM(u){if(!u)return No;u=u._reactInternals;e:{if(ns(u)!==u||u.tag!==1)throw Error(t(170));var h=u;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(vr(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(u.tag===1){var g=u.type;if(vr(g))return Q1(u,g,h)}return h}function AM(u,h,g,x,w,A,I,$,Q){return u=sv(g,x,!0,u,w,A,I,$,Q),u.context=MM(null),g=u.current,x=rr(),w=Uo(g),A=Fa(x,w),A.callback=h??null,ko(g,A,w),u.current.lanes=w,ui(u,w,x),wr(u,x),u}function Og(u,h,g,x){var w=h.current,A=rr(),I=Uo(w);return g=MM(g),h.context===null?h.context=g:h.pendingContext=g,h=Fa(A,I),h.payload={element:u},x=x===void 0?null:x,x!==null&&(h.callback=x),u=ko(w,h,I),u!==null&&(Cs(u,w,I,A),pg(u,w,I)),I}function Bg(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function EM(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<h?g:h}}function av(u,h){EM(u,h),(u=u.alternate)&&EM(u,h)}function dI(){return null}var CM=typeof reportError=="function"?reportError:function(u){console.error(u)};function ov(u){this._internalRoot=u}zg.prototype.render=ov.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(t(409));Og(u,h,null,null)},zg.prototype.unmount=ov.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;Ol(function(){Og(null,u,null,null)}),h[Pa]=null}};function zg(u){this._internalRoot=u}zg.prototype.unstable_scheduleHydration=function(u){if(u){var h=Js();u={blockedOn:null,target:u,priority:h};for(var g=0;g<Mo.length&&h!==0&&h<Mo[g].priority;g++);Mo.splice(g,0,u),g===0&&f1(u)}};function lv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Gg(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function RM(){}function fI(u,h,g,x,w){if(w){if(typeof x=="function"){var A=x;x=function(){var pe=Bg(I);A.call(pe)}}var I=AM(h,x,u,0,null,!1,!1,"",RM);return u._reactRootContainer=I,u[Pa]=I.current,Cd(u.nodeType===8?u.parentNode:u),Ol(),I}for(;w=u.lastChild;)u.removeChild(w);if(typeof x=="function"){var $=x;x=function(){var pe=Bg(Q);$.call(pe)}}var Q=sv(u,0,!1,null,null,!1,!1,"",RM);return u._reactRootContainer=Q,u[Pa]=Q.current,Cd(u.nodeType===8?u.parentNode:u),Ol(function(){Og(h,Q,g,x)}),Q}function Vg(u,h,g,x,w){var A=g._reactRootContainer;if(A){var I=A;if(typeof w=="function"){var $=w;w=function(){var Q=Bg(I);$.call(Q)}}Og(h,I,u,w)}else I=fI(g,h,u,w,x);return Bg(I)}_i=function(u){switch(u.tag){case 3:var h=u.stateNode;if(h.current.memoizedState.isDehydrated){var g=Tn(h.pendingLanes);g!==0&&(mn(h,g|1),wr(h,Xn()),(an&6)===0&&(ac=Xn()+500,Po()))}break;case 13:Ol(function(){var x=La(u,1);if(x!==null){var w=rr();Cs(x,u,1,w)}}),av(u,1)}},yi=function(u){if(u.tag===13){var h=La(u,134217728);if(h!==null){var g=rr();Cs(h,u,134217728,g)}av(u,134217728)}},Bu=function(u){if(u.tag===13){var h=Uo(u),g=La(u,h);if(g!==null){var x=rr();Cs(g,u,h,x)}av(u,h)}},Js=function(){return Lt},h1=function(u,h){var g=Lt;try{return Lt=u,h()}finally{Lt=g}},qe=function(u,h,g){switch(h){case"input":if(tn(u,g),h=g.name,g.type==="radio"&&h!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<g.length;h++){var x=g[h];if(x!==u&&x.form===u.form){var w=sg(x);if(!w)throw Error(t(90));ln(x),tn(x,w)}}}break;case"textarea":k(u,g);break;case"select":h=g.value,h!=null&&nn(u,!!g.multiple,h,!1)}},Nt=Jy,xn=Ol;var pI={usingClientEntryPoint:!1,Events:[Pd,qu,sg,Ce,je,Jy]},Wd={findFiberByHostInstance:Nl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},gI={bundleType:Wd.bundleType,version:Wd.version,rendererPackageName:Wd.rendererPackageName,rendererConfig:Wd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=pd(u),u===null?null:u.stateNode},findFiberByHostInstance:Wd.findFiberByHostInstance||dI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jg.isDisabled&&jg.supportsFiber)try{Je=jg.inject(gI),Ge=jg}catch{}}return Sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pI,Sr.createPortal=function(u,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lv(h))throw Error(t(200));return hI(u,h,null,g)},Sr.createRoot=function(u,h){if(!lv(u))throw Error(t(299));var g=!1,x="",w=CM;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onRecoverableError!==void 0&&(w=h.onRecoverableError)),h=sv(u,1,!1,null,null,g,!1,x,w),u[Pa]=h.current,Cd(u.nodeType===8?u.parentNode:u),new ov(h)},Sr.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=pd(h),u=u===null?null:u.stateNode,u},Sr.flushSync=function(u){return Ol(u)},Sr.hydrate=function(u,h,g){if(!Gg(h))throw Error(t(200));return Vg(null,u,h,!0,g)},Sr.hydrateRoot=function(u,h,g){if(!lv(u))throw Error(t(405));var x=g!=null&&g.hydratedSources||null,w=!1,A="",I=CM;if(g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onRecoverableError!==void 0&&(I=g.onRecoverableError)),h=AM(h,null,u,1,g??null,w,!1,A,I),u[Pa]=h.current,Cd(u),x)for(u=0;u<x.length;u++)g=x[u],w=g._getVersion,w=w(g._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[g,w]:h.mutableSourceEagerHydrationData.push(g,w);return new zg(h)},Sr.render=function(u,h,g){if(!Gg(h))throw Error(t(200));return Vg(null,u,h,!1,g)},Sr.unmountComponentAtNode=function(u){if(!Gg(u))throw Error(t(40));return u._reactRootContainer?(Ol(function(){Vg(null,null,u,!1,function(){u._reactRootContainer=null,u[Pa]=null})}),!0):!1},Sr.unstable_batchedUpdates=Jy,Sr.unstable_renderSubtreeIntoContainer=function(u,h,g,x){if(!Gg(g))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return Vg(u,h,g,!1,x)},Sr.version="18.2.0-next-9e3b772b8-20220608",Sr}var UM;function SI(){if(UM)return hv.exports;UM=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),hv.exports=wI(),hv.exports}var OM;function TI(){if(OM)return Hg;OM=1;var i=SI();return Hg.createRoot=i.createRoot,Hg.hydrateRoot=i.hydrateRoot,Hg}var MI=TI();const AI=K0(MI);var BM={},EI="@vercel/analytics",CI="1.6.1",RI=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function _R(){return typeof window<"u"}function yR(){try{const i="production"}catch{}return"production"}function NI(i="auto"){if(i==="auto"){window.vam=yR();return}window.vam=i}function PI(){return(_R()?window.vam:yR())||"production"}function Tb(){return PI()==="development"}function DI(i){return i.scriptSrc?i.scriptSrc:Tb()?"https://va.vercel-scripts.com/v1/script.debug.js":i.basePath?`${i.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function kI(i={debug:!0}){var e;if(!_R())return;NI(i.mode),RI(),i.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",i.beforeSend));const t=DI(i);if(document.head.querySelector(`script[src*="${t}"]`))return;const n=document.createElement("script");n.src=t,n.defer=!0,n.dataset.sdkn=EI+(i.framework?`/${i.framework}`:""),n.dataset.sdkv=CI,i.disableAutoTrack&&(n.dataset.disableAutoTrack="1"),i.endpoint?n.dataset.endpoint=i.endpoint:i.basePath&&(n.dataset.endpoint=`${i.basePath}/insights`),i.dsn&&(n.dataset.dsn=i.dsn),n.onerror=()=>{const r=Tb()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${t}. ${r}`)},Tb()&&i.debug===!1&&(n.dataset.debug="false"),document.head.appendChild(n)}function II({route:i,path:e}){var t;(t=window.va)==null||t.call(window,"pageview",{route:i,path:e})}function LI(){if(!(typeof process>"u"||typeof BM>"u"))return BM.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function FI(i){return mt.useEffect(()=>{var e;i.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",i.beforeSend))},[i.beforeSend]),mt.useEffect(()=>{kI({framework:i.framework||"react",basePath:i.basePath??LI(),...i.route!==void 0&&{disableAutoTrack:!0},...i})},[]),mt.useEffect(()=>{i.route&&i.path&&II({route:i.route,path:i.path})},[i.route,i.path]),null}function UI(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function OI(i,e,t){return e=$I(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function zM(i,e){return GI(i)||UI(i,e)||vR(i,e)||HI()}function BI(i){return zI(i)||VI(i)||vR(i)||jI()}function zI(i){if(Array.isArray(i))return Mb(i)}function GI(i){if(Array.isArray(i))return i}function VI(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function vR(i,e){if(i){if(typeof i=="string")return Mb(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Mb(i,e)}}function Mb(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function jI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HI(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WI(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function $I(i){var e=WI(i,"string");return typeof e=="symbol"?e:String(e)}var qI=function(e,t){var n=new Set(t);return Object.assign.apply(Object,[{}].concat(BI(Object.entries(e).filter(function(r){var s=zM(r,1),a=s[0];return!n.has(a)}).map(function(r){var s=zM(r,2),a=s[0],o=s[1];return OI({},a,o)}))))};function Ab(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function XI(i){if(Array.isArray(i))return i}function YI(i){if(Array.isArray(i))return Ab(i)}function KI(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function ZI(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function QI(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eL(i,e){return XI(i)||ZI(i,e)||xR(i,e)||QI()}function GM(i){return YI(i)||KI(i)||xR(i)||JI()}function xR(i,e){if(i){if(typeof i=="string")return Ab(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ab(i,e):void 0}}function tL(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.wrapperElementType,n=t===void 0?"div":t,r=e.nodeMapper,s=r===void 0?function(d){return d}:r,a=e.methodNames,o=a===void 0?[]:a,l=e.initPropNames,c=l===void 0?[]:l;return mt.forwardRef(function(d,f){var p=mt.useRef(),m=mt.useMemo(function(){var v=Object.fromEntries(c.filter(function(y){return d.hasOwnProperty(y)}).map(function(y){return[y,d[y]]}));return i(v)},[]);VM(function(){m(s(p.current))},mt.useLayoutEffect),VM(function(){return m._destructor instanceof Function?m._destructor:void 0});var _=mt.useCallback(function(v){for(var y=arguments.length,S=new Array(y>1?y-1:0),T=1;T<y;T++)S[T-1]=arguments[T];return m[v]instanceof Function?m[v].apply(m,S):void 0},[m]),b=mt.useRef({});return Object.keys(qI(d,[].concat(GM(o),GM(c)))).filter(function(v){return b.current[v]!==d[v]}).forEach(function(v){return _(v,d[v])}),b.current=d,mt.useImperativeHandle(f,function(){return Object.fromEntries(o.map(function(v){return[v,function(){for(var y=arguments.length,S=new Array(y),T=0;T<y;T++)S[T]=arguments[T];return _.apply(void 0,[v].concat(S))}]}))},[_]),mR.createElement(n,{ref:p})})}function VM(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mt.useEffect,t=mt.useRef(),n=mt.useRef(!1),r=mt.useRef(!1),s=mt.useState(0),a=eL(s,2);a[0];var o=a[1];n.current&&(r.current=!0),e(function(){return n.current||(t.current=i(),n.current=!0),o(function(l){return l+1}),function(){r.current&&t.current&&t.current()}},[])}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ku="182",Pi={ROTATE:0,DOLLY:1,PAN:2},so={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},bR=0,Eb=1,wR=2,nL=0,If=1,iL=2,ao=3,Zr=0,En=1,Xi=2,pr=0,Qr=1,oh=2,lh=3,uh=4,Jc=5,Yi=100,Cw=101,Rw=102,SR=103,TR=104,Ja=200,Nw=201,Pw=202,Dw=203,Zf=204,Qf=205,kw=206,Iw=207,Lw=208,Fw=209,Uw=210,rL=211,sL=212,aL=213,oL=214,Jf=0,ep=1,tp=2,gl=3,np=4,ip=5,rp=6,sp=7,xp=0,MR=1,AR=2,Di=0,Ow=1,Bw=2,zw=3,Gw=4,ER=5,Vw=6,jw=7,Hw=300,Xs=301,wa=302,ch=303,hh=304,xu=306,bu=1e3,Rr=1001,wu=1002,vn=1003,Ww=1004,oo=1005,In=1006,eh=1007,Nr=1008,Un=1009,du=1010,fu=1011,js=1012,Ti=1013,yn=1014,Qn=1015,Wn=1016,Z0=1017,Q0=1018,Jr=1020,J0=35902,e_=35899,$w=1021,bp=1022,Jn=1023,ki=1026,hr=1027,wp=1028,Xh=1029,dr=1030,Yh=1031,lL=1032,Kh=1033,ll=33776,ul=33777,cl=33778,hl=33779,ap=35840,op=35841,lp=35842,up=35843,dh=36196,fh=37492,ph=37496,gh=37488,mh=37489,Su=37490,_h=37491,yh=37808,vh=37809,xh=37810,bh=37811,wh=37812,Sh=37813,Th=37814,Mh=37815,Ah=37816,Eh=37817,Ch=37818,Rh=37819,Nh=37820,Ph=37821,Dh=36492,Cb=36494,Rb=36495,kh=36283,Ih=36284,Tu=36285,Lh=36286,uL=3200,ba=0,CR=1,Er="",lr="srgb",Mu="srgb-linear",Fh="linear",Ze="srgb",pv="",RR="rg",cL="ga",hL=0,tu=7680,dL=7681,fL=7682,pL=7683,gL=34055,mL=34056,_L=5386,yL=512,vL=513,xL=514,bL=515,wL=516,SL=517,TL=518,Nb=519,qw=512,Sp=513,Xw=514,Tp=515,Yw=516,Kw=517,Mp=518,Zw=519,Uh=35044,Yc=35048,jM="300 es",fr=2e3,Sa=2001,ya={COMPUTE:"compute",RENDER:"render"};function Qw(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function P0(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function cp(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function NR(){const i=cp("canvas");return i.style.display="block",i}const HM={};function hp(...i){const e="THREE."+i.shift();console.log(e,...i)}function Ae(...i){const e="THREE."+i.shift();console.warn(e,...i)}function Ee(...i){const e="THREE."+i.shift();console.error(e,...i)}function Fn(...i){const e=i.join(" ");e in HM||(HM[e]=!0,Ae(...i))}function ML(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let Ca=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}};const Gi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let WM=1234567;const Lf=Math.PI/180,Au=180/Math.PI;function ho(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Gi[i&255]+Gi[i>>8&255]+Gi[i>>16&255]+Gi[i>>24&255]+"-"+Gi[e&255]+Gi[e>>8&255]+"-"+Gi[e>>16&15|64]+Gi[e>>24&255]+"-"+Gi[t&63|128]+Gi[t>>8&255]+"-"+Gi[t>>16&255]+Gi[t>>24&255]+Gi[n&255]+Gi[n>>8&255]+Gi[n>>16&255]+Gi[n>>24&255]).toLowerCase()}function Ht(i,e,t){return Math.max(e,Math.min(t,i))}function Jw(i,e){return(i%e+e)%e}function AL(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function EL(i,e,t){return i!==e?(t-i)/(e-i):0}function Ff(i,e,t){return(1-t)*i+t*e}function CL(i,e,t,n){return Ff(i,e,1-Math.exp(-t*n))}function RL(i,e=1){return e-Math.abs(Jw(i,e*2)-e)}function NL(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function PL(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function DL(i,e){return i+Math.floor(Math.random()*(e-i+1))}function kL(i,e){return i+Math.random()*(e-i)}function IL(i){return i*(.5-Math.random())}function LL(i){i!==void 0&&(WM=i);let e=WM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function FL(i){return i*Lf}function UL(i){return i*Au}function OL(i){return(i&i-1)===0&&i!==0}function BL(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function zL(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function GL(i,e,t,n,r){const s=Math.cos,a=Math.sin,o=s(t/2),l=a(t/2),c=s((e+n)/2),d=a((e+n)/2),f=s((e-n)/2),p=a((e-n)/2),m=s((n-e)/2),_=a((n-e)/2);switch(r){case"XYX":i.set(o*d,l*f,l*p,o*c);break;case"YZY":i.set(l*p,o*d,l*f,o*c);break;case"ZXZ":i.set(l*f,l*p,o*d,o*c);break;case"XZX":i.set(o*d,l*_,l*m,o*c);break;case"YXY":i.set(l*m,o*d,l*_,o*c);break;case"ZYZ":i.set(l*_,l*m,o*d,o*c);break;default:Ae("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ur(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Gt(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const D0={DEG2RAD:Lf,RAD2DEG:Au,generateUUID:ho,clamp:Ht,euclideanModulo:Jw,mapLinear:AL,inverseLerp:EL,lerp:Ff,damp:CL,pingpong:RL,smoothstep:NL,smootherstep:PL,randInt:DL,randFloat:kL,randFloatSpread:IL,seededRandom:LL,degToRad:FL,radToDeg:UL,isPowerOfTwo:OL,ceilPowerOfTwo:BL,floorPowerOfTwo:zL,setQuaternionFromProperEuler:GL,normalize:Gt,denormalize:ur};let Xe=class PR{constructor(e=0,t=0){PR.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ht(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ht(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ys=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,o){let l=n[r+0],c=n[r+1],d=n[r+2],f=n[r+3],p=s[a+0],m=s[a+1],_=s[a+2],b=s[a+3];if(o<=0){e[t+0]=l,e[t+1]=c,e[t+2]=d,e[t+3]=f;return}if(o>=1){e[t+0]=p,e[t+1]=m,e[t+2]=_,e[t+3]=b;return}if(f!==b||l!==p||c!==m||d!==_){let v=l*p+c*m+d*_+f*b;v<0&&(p=-p,m=-m,_=-_,b=-b,v=-v);let y=1-o;if(v<.9995){const S=Math.acos(v),T=Math.sin(S);y=Math.sin(y*S)/T,o=Math.sin(o*S)/T,l=l*y+p*o,c=c*y+m*o,d=d*y+_*o,f=f*y+b*o}else{l=l*y+p*o,c=c*y+m*o,d=d*y+_*o,f=f*y+b*o;const S=1/Math.sqrt(l*l+c*c+d*d+f*f);l*=S,c*=S,d*=S,f*=S}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,s,a){const o=n[r],l=n[r+1],c=n[r+2],d=n[r+3],f=s[a],p=s[a+1],m=s[a+2],_=s[a+3];return e[t]=o*_+d*f+l*m-c*p,e[t+1]=l*_+d*p+c*f-o*m,e[t+2]=c*_+d*m+o*p-l*f,e[t+3]=d*_-o*f-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(n/2),d=o(r/2),f=o(s/2),p=l(n/2),m=l(r/2),_=l(s/2);switch(a){case"XYZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"YXZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"ZXY":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"ZYX":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"YZX":this._x=p*d*f+c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f-p*m*_;break;case"XZY":this._x=p*d*f-c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f+p*m*_;break;default:Ae("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],d=t[6],f=t[10],p=n+o+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-c)*m,this._z=(a-r)*m}else if(n>o&&n>f){const m=2*Math.sqrt(1+n-o-f);this._w=(d-l)/m,this._x=.25*m,this._y=(r+a)/m,this._z=(s+c)/m}else if(o>f){const m=2*Math.sqrt(1+o-n-f);this._w=(s-c)/m,this._x=(r+a)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+f-n-o);this._w=(a-r)/m,this._x=(s+c)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ht(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+a*o+r*c-s*l,this._y=r*d+a*l+s*o-n*c,this._z=s*d+a*c+n*l-r*o,this._w=a*d-n*o-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(n=-n,r=-r,s=-s,a=-a,o=-o);let l=1-t;if(o<.9995){const c=Math.acos(o),d=Math.sin(c);l=Math.sin(l*c)/d,t=Math.sin(t*c)/d,this._x=this._x*l+n*t,this._y=this._y*l+r*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this._onChangeCallback()}else this._x=this._x*l+n*t,this._y=this._y*l+r*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},X=class DR{constructor(e=0,t=0,n=0){DR.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion($M.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion($M.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*r-o*n),d=2*(o*t-s*r),f=2*(s*n-a*t);return this.x=t+l*c+a*f-o*d,this.y=n+l*d+o*c-s*f,this.z=r+l*f+s*d-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this.z=Ht(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this.z=Ht(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ht(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=r*l-s*o,this.y=s*a-n*l,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return gv.copy(this).projectOnVector(e),this.sub(gv)}reflect(e){return this.sub(gv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ht(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const gv=new X,$M=new Ys;let Ft=class kR{constructor(e,t,n,r,s,a,o,l,c){kR.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c)}set(e,t,n,r,s,a,o,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=o,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=a,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],d=n[4],f=n[7],p=n[2],m=n[5],_=n[8],b=r[0],v=r[3],y=r[6],S=r[1],T=r[4],E=r[7],N=r[2],M=r[5],C=r[8];return s[0]=a*b+o*S+l*N,s[3]=a*v+o*T+l*M,s[6]=a*y+o*E+l*C,s[1]=c*b+d*S+f*N,s[4]=c*v+d*T+f*M,s[7]=c*y+d*E+f*C,s[2]=p*b+m*S+_*N,s[5]=p*v+m*T+_*M,s[8]=p*y+m*E+_*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8];return t*a*d-t*o*c-n*s*d+n*o*l+r*s*c-r*a*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],f=d*a-o*c,p=o*l-d*s,m=c*s-a*l,_=t*f+n*p+r*m;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/_;return e[0]=f*b,e[1]=(r*c-d*n)*b,e[2]=(o*n-r*a)*b,e[3]=p*b,e[4]=(d*t-r*l)*b,e[5]=(r*s-o*t)*b,e[6]=m*b,e[7]=(n*l-c*t)*b,e[8]=(a*t-n*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-r*c,r*l,-r*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(mv.makeScale(e,t)),this}rotate(e){return this.premultiply(mv.makeRotation(-e)),this}translate(e,t){return this.premultiply(mv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const mv=new Ft,qM=new Ft().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),XM=new Ft().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function VL(){const i={enabled:!0,workingColorSpace:Mu,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Ze&&(r.r=fo(r.r),r.g=fo(r.g),r.b=fo(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Ze&&(r.r=th(r.r),r.g=th(r.g),r.b=th(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Er?Fh:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return Fn("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return Fn("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Mu]:{primaries:e,whitePoint:n,transfer:Fh,toXYZ:qM,fromXYZ:XM,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:lr},outputColorSpaceConfig:{drawingBufferColorSpace:lr}},[lr]:{primaries:e,whitePoint:n,transfer:Ze,toXYZ:qM,fromXYZ:XM,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:lr}}}),i}const bt=VL();function fo(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function th(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let lc,jL=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{lc===void 0&&(lc=cp("canvas")),lc.width=e.width,lc.height=e.height;const r=lc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=lc}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=cp("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=fo(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(fo(t[n]/255)*255):t[n]=fo(t[n]);return{data:t,width:e.width,height:e.height}}else return Ae("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},HL=0,eS=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:HL++}),this.uuid=ho(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(_v(r[a].image)):s.push(_v(r[a]))}else s=_v(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function _v(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?jL.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Ae("Texture: Unable to serialize Texture."),{})}let WL=0;const yv=new X;let er=class _0 extends Ca{constructor(e=_0.DEFAULT_IMAGE,t=_0.DEFAULT_MAPPING,n=Rr,r=Rr,s=In,a=Nr,o=Jn,l=Un,c=_0.DEFAULT_ANISOTROPY,d=Er){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:WL++}),this.uuid=ho(),this.name="",this.source=new eS(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ft,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(yv).x}get height(){return this.source.getSize(yv).y}get depth(){return this.source.getSize(yv).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Ae(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ae(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Hw)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case bu:e.x=e.x-Math.floor(e.x);break;case Rr:e.x=e.x<0?0:1;break;case wu:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case bu:e.y=e.y-Math.floor(e.y);break;case Rr:e.y=e.y<0?0:1;break;case wu:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};er.DEFAULT_IMAGE=null;er.DEFAULT_MAPPING=Hw;er.DEFAULT_ANISOTROPY=1;class It{constructor(e=0,t=0,n=0,r=1){It.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],d=l[4],f=l[8],p=l[1],m=l[5],_=l[9],b=l[2],v=l[6],y=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-b)<.01&&Math.abs(_-v)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+b)<.1&&Math.abs(_+v)<.1&&Math.abs(c+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(c+1)/2,E=(m+1)/2,N=(y+1)/2,M=(d+p)/4,C=(f+b)/4,D=(_+v)/4;return T>E&&T>N?T<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(T),r=M/n,s=C/n):E>N?E<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(E),n=M/r,s=D/r):N<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(N),n=C/s,r=D/s),this.set(n,r,s,t),this}let S=Math.sqrt((v-_)*(v-_)+(f-b)*(f-b)+(p-d)*(p-d));return Math.abs(S)<.001&&(S=1),this.x=(v-_)/S,this.y=(f-b)/S,this.z=(p-d)/S,this.w=Math.acos((c+m+y-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this.z=Ht(this.z,e.z,t.z),this.w=Ht(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this.z=Ht(this.z,e,t),this.w=Ht(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ht(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Iu extends Ca{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:In,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new It(0,0,e,t),this.scissorTest=!1,this.viewport=new It(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new er(r);this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:In,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new eS(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ws extends Iu{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class tS extends er{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=vn,this.minFilter=vn,this.wrapR=Rr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class $L extends er{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=vn,this.minFilter=vn,this.wrapR=Rr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let Zh=class{constructor(e=new X(1/0,1/0,1/0),t=new X(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Rs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Rs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Rs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Rs):Rs.fromBufferAttribute(s,a),Rs.applyMatrix4(e.matrixWorld),this.expandByPoint(Rs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Wg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Wg.copy(n.boundingBox)),Wg.applyMatrix4(e.matrixWorld),this.union(Wg)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Rs),Rs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qd),$g.subVectors(this.max,qd),uc.subVectors(e.a,qd),cc.subVectors(e.b,qd),hc.subVectors(e.c,qd),Go.subVectors(cc,uc),Vo.subVectors(hc,cc),Vl.subVectors(uc,hc);let t=[0,-Go.z,Go.y,0,-Vo.z,Vo.y,0,-Vl.z,Vl.y,Go.z,0,-Go.x,Vo.z,0,-Vo.x,Vl.z,0,-Vl.x,-Go.y,Go.x,0,-Vo.y,Vo.x,0,-Vl.y,Vl.x,0];return!vv(t,uc,cc,hc,$g)||(t=[1,0,0,0,1,0,0,0,1],!vv(t,uc,cc,hc,$g))?!1:(qg.crossVectors(Go,Vo),t=[qg.x,qg.y,qg.z],vv(t,uc,cc,hc,$g))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Rs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Rs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ba[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ba[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ba[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ba[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ba[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ba[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ba[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ba[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ba),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}};const Ba=[new X,new X,new X,new X,new X,new X,new X,new X],Rs=new X,Wg=new Zh,uc=new X,cc=new X,hc=new X,Go=new X,Vo=new X,Vl=new X,qd=new X,$g=new X,qg=new X,jl=new X;function vv(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){jl.fromArray(i,s);const o=r.x*Math.abs(jl.x)+r.y*Math.abs(jl.y)+r.z*Math.abs(jl.z),l=e.dot(jl),c=t.dot(jl),d=n.dot(jl);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>o)return!1}return!0}const qL=new Zh,Xd=new X,xv=new X;let t_=class{constructor(e=new X,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):qL.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Xd.subVectors(e,this.center);const t=Xd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Xd,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(xv.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Xd.copy(e.center).add(xv)),this.expandByPoint(Xd.copy(e.center).sub(xv))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}};const za=new X,bv=new X,Xg=new X,jo=new X,wv=new X,Yg=new X,Sv=new X;let nS=class{constructor(e=new X,t=new X(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,za)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=za.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(za.copy(this.origin).addScaledVector(this.direction,t),za.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){bv.copy(e).add(t).multiplyScalar(.5),Xg.copy(t).sub(e).normalize(),jo.copy(this.origin).sub(bv);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Xg),o=jo.dot(this.direction),l=-jo.dot(Xg),c=jo.lengthSq(),d=Math.abs(1-a*a);let f,p,m,_;if(d>0)if(f=a*l-o,p=a*o-l,_=s*d,f>=0)if(p>=-_)if(p<=_){const b=1/d;f*=b,p*=b,m=f*(f+a*p+2*o)+p*(a*f+p+2*l)+c}else p=s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;else p=-s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;else p<=-_?(f=Math.max(0,-(-a*s+o)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c):p<=_?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(f=Math.max(0,-(a*s+o)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c);else p=a>0?-s:s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(bv).addScaledVector(Xg,p),m}intersectSphere(e,t){za.subVectors(e.center,this.origin);const n=za.dot(this.direction),r=za.dot(za)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,o,l;const c=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return c>=0?(n=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(n=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),d>=0?(s=(e.min.y-p.y)*d,a=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,a=(e.min.y-p.y)*d),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),f>=0?(o=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(o=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),n>l||o>r)||((o>n||n!==n)&&(n=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,za)!==null}intersectTriangle(e,t,n,r,s){wv.subVectors(t,e),Yg.subVectors(n,e),Sv.crossVectors(wv,Yg);let a=this.direction.dot(Sv),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;jo.subVectors(this.origin,e);const l=o*this.direction.dot(Yg.crossVectors(jo,Yg));if(l<0)return null;const c=o*this.direction.dot(wv.cross(jo));if(c<0||l+c>a)return null;const d=-o*jo.dot(Sv);return d<0?null:this.at(d/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},hn=class Pb{constructor(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v){Pb.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v)}set(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=a,y[9]=o,y[13]=l,y[2]=c,y[6]=d,y[10]=f,y[14]=p,y[3]=m,y[7]=_,y[11]=b,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Pb().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/dc.setFromMatrixColumn(e,0).length(),s=1/dc.setFromMatrixColumn(e,1).length(),a=1/dc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=a*d,m=a*f,_=o*d,b=o*f;t[0]=l*d,t[4]=-l*f,t[8]=c,t[1]=m+_*c,t[5]=p-b*c,t[9]=-o*l,t[2]=b-p*c,t[6]=_+m*c,t[10]=a*l}else if(e.order==="YXZ"){const p=l*d,m=l*f,_=c*d,b=c*f;t[0]=p+b*o,t[4]=_*o-m,t[8]=a*c,t[1]=a*f,t[5]=a*d,t[9]=-o,t[2]=m*o-_,t[6]=b+p*o,t[10]=a*l}else if(e.order==="ZXY"){const p=l*d,m=l*f,_=c*d,b=c*f;t[0]=p-b*o,t[4]=-a*f,t[8]=_+m*o,t[1]=m+_*o,t[5]=a*d,t[9]=b-p*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const p=a*d,m=a*f,_=o*d,b=o*f;t[0]=l*d,t[4]=_*c-m,t[8]=p*c+b,t[1]=l*f,t[5]=b*c+p,t[9]=m*c-_,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const p=a*l,m=a*c,_=o*l,b=o*c;t[0]=l*d,t[4]=b-p*f,t[8]=_*f+m,t[1]=f,t[5]=a*d,t[9]=-o*d,t[2]=-c*d,t[6]=m*f+_,t[10]=p-b*f}else if(e.order==="XZY"){const p=a*l,m=a*c,_=o*l,b=o*c;t[0]=l*d,t[4]=-f,t[8]=c*d,t[1]=p*f+b,t[5]=a*d,t[9]=m*f-_,t[2]=_*f-m,t[6]=o*d,t[10]=b*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(XL,e,YL)}lookAt(e,t,n){const r=this.elements;return Vr.subVectors(e,t),Vr.lengthSq()===0&&(Vr.z=1),Vr.normalize(),Ho.crossVectors(n,Vr),Ho.lengthSq()===0&&(Math.abs(n.z)===1?Vr.x+=1e-4:Vr.z+=1e-4,Vr.normalize(),Ho.crossVectors(n,Vr)),Ho.normalize(),Kg.crossVectors(Vr,Ho),r[0]=Ho.x,r[4]=Kg.x,r[8]=Vr.x,r[1]=Ho.y,r[5]=Kg.y,r[9]=Vr.y,r[2]=Ho.z,r[6]=Kg.z,r[10]=Vr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],d=n[1],f=n[5],p=n[9],m=n[13],_=n[2],b=n[6],v=n[10],y=n[14],S=n[3],T=n[7],E=n[11],N=n[15],M=r[0],C=r[4],D=r[8],R=r[12],P=r[1],L=r[5],z=r[9],B=r[13],O=r[2],V=r[6],Y=r[10],G=r[14],W=r[3],te=r[7],U=r[11],H=r[15];return s[0]=a*M+o*P+l*O+c*W,s[4]=a*C+o*L+l*V+c*te,s[8]=a*D+o*z+l*Y+c*U,s[12]=a*R+o*B+l*G+c*H,s[1]=d*M+f*P+p*O+m*W,s[5]=d*C+f*L+p*V+m*te,s[9]=d*D+f*z+p*Y+m*U,s[13]=d*R+f*B+p*G+m*H,s[2]=_*M+b*P+v*O+y*W,s[6]=_*C+b*L+v*V+y*te,s[10]=_*D+b*z+v*Y+y*U,s[14]=_*R+b*B+v*G+y*H,s[3]=S*M+T*P+E*O+N*W,s[7]=S*C+T*L+E*V+N*te,s[11]=S*D+T*z+E*Y+N*U,s[15]=S*R+T*B+E*G+N*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],d=e[2],f=e[6],p=e[10],m=e[14],_=e[3],b=e[7],v=e[11],y=e[15],S=l*m-c*p,T=o*m-c*f,E=o*p-l*f,N=a*m-c*d,M=a*p-l*d,C=a*f-o*d;return t*(b*S-v*T+y*E)-n*(_*S-v*N+y*M)+r*(_*T-b*N+y*C)-s*(_*E-b*M+v*C)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],m=e[11],_=e[12],b=e[13],v=e[14],y=e[15],S=f*v*c-b*p*c+b*l*m-o*v*m-f*l*y+o*p*y,T=_*p*c-d*v*c-_*l*m+a*v*m+d*l*y-a*p*y,E=d*b*c-_*f*c+_*o*m-a*b*m-d*o*y+a*f*y,N=_*f*l-d*b*l-_*o*p+a*b*p+d*o*v-a*f*v,M=t*S+n*T+r*E+s*N;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/M;return e[0]=S*C,e[1]=(b*p*s-f*v*s-b*r*m+n*v*m+f*r*y-n*p*y)*C,e[2]=(o*v*s-b*l*s+b*r*c-n*v*c-o*r*y+n*l*y)*C,e[3]=(f*l*s-o*p*s-f*r*c+n*p*c+o*r*m-n*l*m)*C,e[4]=T*C,e[5]=(d*v*s-_*p*s+_*r*m-t*v*m-d*r*y+t*p*y)*C,e[6]=(_*l*s-a*v*s-_*r*c+t*v*c+a*r*y-t*l*y)*C,e[7]=(a*p*s-d*l*s+d*r*c-t*p*c-a*r*m+t*l*m)*C,e[8]=E*C,e[9]=(_*f*s-d*b*s-_*n*m+t*b*m+d*n*y-t*f*y)*C,e[10]=(a*b*s-_*o*s+_*n*c-t*b*c-a*n*y+t*o*y)*C,e[11]=(d*o*s-a*f*s-d*n*c+t*f*c+a*n*m-t*o*m)*C,e[12]=N*C,e[13]=(d*b*r-_*f*r+_*n*p-t*b*p-d*n*v+t*f*v)*C,e[14]=(_*o*r-a*b*r-_*n*l+t*b*l+a*n*v-t*o*v)*C,e[15]=(a*f*r-d*o*r+d*n*l-t*f*l-a*n*p+t*o*p)*C,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,o=e.y,l=e.z,c=s*a,d=s*o;return this.set(c*a+n,c*o-r*l,c*l+r*o,0,c*o+r*l,d*o+n,d*l-r*a,0,c*l-r*o,d*l+r*a,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,d=a+a,f=o+o,p=s*c,m=s*d,_=s*f,b=a*d,v=a*f,y=o*f,S=l*c,T=l*d,E=l*f,N=n.x,M=n.y,C=n.z;return r[0]=(1-(b+y))*N,r[1]=(m+E)*N,r[2]=(_-T)*N,r[3]=0,r[4]=(m-E)*M,r[5]=(1-(p+y))*M,r[6]=(v+S)*M,r[7]=0,r[8]=(_+T)*C,r[9]=(v-S)*C,r[10]=(1-(p+b))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=dc.set(r[0],r[1],r[2]).length();const a=dc.set(r[4],r[5],r[6]).length(),o=dc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Ns.copy(this);const c=1/s,d=1/a,f=1/o;return Ns.elements[0]*=c,Ns.elements[1]*=c,Ns.elements[2]*=c,Ns.elements[4]*=d,Ns.elements[5]*=d,Ns.elements[6]*=d,Ns.elements[8]*=f,Ns.elements[9]*=f,Ns.elements[10]*=f,t.setFromRotationMatrix(Ns),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,r,s,a,o=fr,l=!1){const c=this.elements,d=2*s/(t-e),f=2*s/(n-r),p=(t+e)/(t-e),m=(n+r)/(n-r);let _,b;if(l)_=s/(a-s),b=a*s/(a-s);else if(o===fr)_=-(a+s)/(a-s),b=-2*a*s/(a-s);else if(o===Sa)_=-a/(a-s),b=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=d,c[4]=0,c[8]=p,c[12]=0,c[1]=0,c[5]=f,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=_,c[14]=b,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,s,a,o=fr,l=!1){const c=this.elements,d=2/(t-e),f=2/(n-r),p=-(t+e)/(t-e),m=-(n+r)/(n-r);let _,b;if(l)_=1/(a-s),b=a/(a-s);else if(o===fr)_=-2/(a-s),b=-(a+s)/(a-s);else if(o===Sa)_=-1/(a-s),b=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=d,c[4]=0,c[8]=0,c[12]=p,c[1]=0,c[5]=f,c[9]=0,c[13]=m,c[2]=0,c[6]=0,c[10]=_,c[14]=b,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};const dc=new X,Ns=new hn,XL=new X(0,0,0),YL=new X(1,1,1),Ho=new X,Kg=new X,Vr=new X,YM=new hn,KM=new Ys;let ys=class IR{constructor(e=0,t=0,n=0,r=IR.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],l=r[1],c=r[5],d=r[9],f=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(Ht(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ht(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ht(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Ht(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Ht(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-Ht(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:Ae("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return YM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(YM,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return KM.setFromEuler(this),this.setFromQuaternion(KM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ys.DEFAULT_ORDER="XYZ";let iS=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},KL=0;const ZM=new X,fc=new Ys,Ga=new hn,Zg=new X,Yd=new X,ZL=new X,QL=new Ys,QM=new X(1,0,0),JM=new X(0,1,0),eA=new X(0,0,1),tA={type:"added"},JL={type:"removed"},pc={type:"childadded",child:null},Tv={type:"childremoved",child:null};let mr=class y0 extends Ca{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:KL++}),this.uuid=ho(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=y0.DEFAULT_UP.clone();const e=new X,t=new ys,n=new Ys,r=new X(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new hn},normalMatrix:{value:new Ft}}),this.matrix=new hn,this.matrixWorld=new hn,this.matrixAutoUpdate=y0.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=y0.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new iS,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return fc.setFromAxisAngle(e,t),this.quaternion.multiply(fc),this}rotateOnWorldAxis(e,t){return fc.setFromAxisAngle(e,t),this.quaternion.premultiply(fc),this}rotateX(e){return this.rotateOnAxis(QM,e)}rotateY(e){return this.rotateOnAxis(JM,e)}rotateZ(e){return this.rotateOnAxis(eA,e)}translateOnAxis(e,t){return ZM.copy(e).applyQuaternion(this.quaternion),this.position.add(ZM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(QM,e)}translateY(e){return this.translateOnAxis(JM,e)}translateZ(e){return this.translateOnAxis(eA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ga.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Zg.copy(e):Zg.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Yd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ga.lookAt(Yd,Zg,this.up):Ga.lookAt(Zg,Yd,this.up),this.quaternion.setFromRotationMatrix(Ga),r&&(Ga.extractRotation(r.matrixWorld),fc.setFromRotationMatrix(Ga),this.quaternion.premultiply(fc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Ee("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(tA),pc.child=e,this.dispatchEvent(pc),pc.child=null):Ee("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(JL),Tv.child=e,this.dispatchEvent(Tv),Tv.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ga.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ga.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ga),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(tA),pc.child=e,this.dispatchEvent(pc),pc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yd,e,ZL),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yd,QL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,d=l.length;c<d;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),d=a(e.images),f=a(e.shapes),p=a(e.skeletons),m=a(e.animations),_=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),d.length>0&&(n.images=d),f.length>0&&(n.shapes=f),p.length>0&&(n.skeletons=p),m.length>0&&(n.animations=m),_.length>0&&(n.nodes=_)}return n.object=r,n;function a(o){const l=[];for(const c in o){const d=o[c];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}};mr.DEFAULT_UP=new X(0,1,0);mr.DEFAULT_MATRIX_AUTO_UPDATE=!0;mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ps=new X,Va=new X,Mv=new X,ja=new X,gc=new X,mc=new X,nA=new X,Av=new X,Ev=new X,Cv=new X,Rv=new It,Nv=new It,Pv=new It;let Kd=class qc{constructor(e=new X,t=new X,n=new X){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ps.subVectors(e,t),r.cross(Ps);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Ps.subVectors(r,t),Va.subVectors(n,t),Mv.subVectors(e,t);const a=Ps.dot(Ps),o=Ps.dot(Va),l=Ps.dot(Mv),c=Va.dot(Va),d=Va.dot(Mv),f=a*c-o*o;if(f===0)return s.set(0,0,0),null;const p=1/f,m=(c*l-o*d)*p,_=(a*d-o*l)*p;return s.set(1-m-_,_,m)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,ja)===null?!1:ja.x>=0&&ja.y>=0&&ja.x+ja.y<=1}static getInterpolation(e,t,n,r,s,a,o,l){return this.getBarycoord(e,t,n,r,ja)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,ja.x),l.addScaledVector(a,ja.y),l.addScaledVector(o,ja.z),l)}static getInterpolatedAttribute(e,t,n,r,s,a){return Rv.setScalar(0),Nv.setScalar(0),Pv.setScalar(0),Rv.fromBufferAttribute(e,t),Nv.fromBufferAttribute(e,n),Pv.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Rv,s.x),a.addScaledVector(Nv,s.y),a.addScaledVector(Pv,s.z),a}static isFrontFacing(e,t,n,r){return Ps.subVectors(n,t),Va.subVectors(e,t),Ps.cross(Va).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ps.subVectors(this.c,this.b),Va.subVectors(this.a,this.b),Ps.cross(Va).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return qc.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return qc.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return qc.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return qc.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return qc.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,o;gc.subVectors(r,n),mc.subVectors(s,n),Av.subVectors(e,n);const l=gc.dot(Av),c=mc.dot(Av);if(l<=0&&c<=0)return t.copy(n);Ev.subVectors(e,r);const d=gc.dot(Ev),f=mc.dot(Ev);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*c;if(p<=0&&l>=0&&d<=0)return a=l/(l-d),t.copy(n).addScaledVector(gc,a);Cv.subVectors(e,s);const m=gc.dot(Cv),_=mc.dot(Cv);if(_>=0&&m<=_)return t.copy(s);const b=m*c-l*_;if(b<=0&&c>=0&&_<=0)return o=c/(c-_),t.copy(n).addScaledVector(mc,o);const v=d*_-m*f;if(v<=0&&f-d>=0&&m-_>=0)return nA.subVectors(s,r),o=(f-d)/(f-d+(m-_)),t.copy(r).addScaledVector(nA,o);const y=1/(v+b+p);return a=b*y,o=p*y,t.copy(n).addScaledVector(gc,a).addScaledVector(mc,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const LR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wo={h:0,s:0,l:0},Qg={h:0,s:0,l:0};function Dv(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}let _t=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=lr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,bt.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=bt.workingColorSpace){return this.r=e,this.g=t,this.b=n,bt.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=bt.workingColorSpace){if(e=Jw(e,1),t=Ht(t,0,1),n=Ht(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=Dv(a,s,e+1/3),this.g=Dv(a,s,e),this.b=Dv(a,s,e-1/3)}return bt.colorSpaceToWorking(this,r),this}setStyle(e,t=lr){function n(s){s!==void 0&&parseFloat(s)<1&&Ae("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Ae("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);Ae("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=lr){const n=LR[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Ae("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=fo(e.r),this.g=fo(e.g),this.b=fo(e.b),this}copyLinearToSRGB(e){return this.r=th(e.r),this.g=th(e.g),this.b=th(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=lr){return bt.workingToColorSpace(Vi.copy(this),e),Math.round(Ht(Vi.r*255,0,255))*65536+Math.round(Ht(Vi.g*255,0,255))*256+Math.round(Ht(Vi.b*255,0,255))}getHexString(e=lr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=bt.workingColorSpace){bt.workingToColorSpace(Vi.copy(this),t);const n=Vi.r,r=Vi.g,s=Vi.b,a=Math.max(n,r,s),o=Math.min(n,r,s);let l,c;const d=(o+a)/2;if(o===a)l=0,c=0;else{const f=a-o;switch(c=d<=.5?f/(a+o):f/(2-a-o),a){case n:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-n)/f+2;break;case s:l=(n-r)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=bt.workingColorSpace){return bt.workingToColorSpace(Vi.copy(this),t),e.r=Vi.r,e.g=Vi.g,e.b=Vi.b,e}getStyle(e=lr){bt.workingToColorSpace(Vi.copy(this),e);const t=Vi.r,n=Vi.g,r=Vi.b;return e!==lr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Wo),this.setHSL(Wo.h+e,Wo.s+t,Wo.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Wo),e.getHSL(Qg);const n=Ff(Wo.h,Qg.h,t),r=Ff(Wo.s,Qg.s,t),s=Ff(Wo.l,Qg.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Vi=new _t;_t.NAMES=LR;let eF=0,Qi=class extends Ca{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:eF++}),this.uuid=ho(),this.name="",this.type="Material",this.blending=Qr,this.side=Zr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Zf,this.blendDst=Qf,this.blendEquation=Yi,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new _t(0,0,0),this.blendAlpha=0,this.depthFunc=gl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Nb,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tu,this.stencilZFail=tu,this.stencilZPass=tu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Ae(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ae(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qr&&(n.blending=this.blending),this.side!==Zr&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Zf&&(n.blendSrc=this.blendSrc),this.blendDst!==Qf&&(n.blendDst=this.blendDst),this.blendEquation!==Yi&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==gl&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Nb&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==tu&&(n.stencilFail=this.stencilFail),this.stencilZFail!==tu&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==tu&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},ma=class extends Qi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _t(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const to=tF();function tF(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;(c&8388608)===0;)c<<=1,d-=8388608;c&=-8388609,d+=947912704,s[l]=c|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function jr(i){Math.abs(i)>65504&&Ae("DataUtils.toHalfFloat(): Value out of range."),i=Ht(i,-65504,65504),to.floatView[0]=i;const e=to.uint32View[0],t=e>>23&511;return to.baseTable[t]+((e&8388607)>>to.shiftTable[t])}function Jg(i){const e=i>>10;return to.uint32View[0]=to.mantissaTable[to.offsetTable[e]+(i&1023)]+to.exponentTable[e],to.floatView[0]}const ri=new X,em=new Xe;let nF=0,Ki=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:nF++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Uh,this.updateRanges=[],this.gpuType=Qn,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)em.fromBufferAttribute(this,t),em.applyMatrix3(e),this.setXY(t,em.x,em.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)ri.fromBufferAttribute(this,t),ri.applyMatrix3(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ri.fromBufferAttribute(this,t),ri.applyMatrix4(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ri.fromBufferAttribute(this,t),ri.applyNormalMatrix(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ri.fromBufferAttribute(this,t),ri.transformDirection(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ur(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Gt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ur(t,this.array)),t}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ur(t,this.array)),t}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ur(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ur(t,this.array)),t}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Uh&&(e.usage=this.usage),e}},rS=class extends Ki{constructor(e,t,n){super(new Uint16Array(e),t,n)}},sS=class extends Ki{constructor(e,t,n){super(new Uint32Array(e),t,n)}};class FR extends Ki{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Jg(this.array[e*this.itemSize]);return this.normalized&&(t=ur(t,this.array)),t}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize]=jr(t),this}getY(e){let t=Jg(this.array[e*this.itemSize+1]);return this.normalized&&(t=ur(t,this.array)),t}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+1]=jr(t),this}getZ(e){let t=Jg(this.array[e*this.itemSize+2]);return this.normalized&&(t=ur(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+2]=jr(t),this}getW(e){let t=Jg(this.array[e*this.itemSize+3]);return this.normalized&&(t=ur(t,this.array)),t}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+3]=jr(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array)),this.array[e+0]=jr(t),this.array[e+1]=jr(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array)),this.array[e+0]=jr(t),this.array[e+1]=jr(n),this.array[e+2]=jr(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.array[e+0]=jr(t),this.array[e+1]=jr(n),this.array[e+2]=jr(r),this.array[e+3]=jr(s),this}}let fi=class extends Ki{constructor(e,t,n){super(new Float32Array(e),t,n)}},iF=0;const us=new hn,kv=new mr,_c=new X,Hr=new Zh,Zd=new Zh,wi=new X;let es=class UR extends Ca{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:iF++}),this.uuid=ho(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Qw(e)?sS:rS)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Ft().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return us.makeRotationFromQuaternion(e),this.applyMatrix4(us),this}rotateX(e){return us.makeRotationX(e),this.applyMatrix4(us),this}rotateY(e){return us.makeRotationY(e),this.applyMatrix4(us),this}rotateZ(e){return us.makeRotationZ(e),this.applyMatrix4(us),this}translate(e,t,n){return us.makeTranslation(e,t,n),this.applyMatrix4(us),this}scale(e,t,n){return us.makeScale(e,t,n),this.applyMatrix4(us),this}lookAt(e){return kv.lookAt(e),kv.updateMatrix(),this.applyMatrix4(kv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_c).negate(),this.translate(_c.x,_c.y,_c.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new fi(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Ae("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Ee("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new X(-1/0,-1/0,-1/0),new X(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];Hr.setFromBufferAttribute(s),this.morphTargetsRelative?(wi.addVectors(this.boundingBox.min,Hr.min),this.boundingBox.expandByPoint(wi),wi.addVectors(this.boundingBox.max,Hr.max),this.boundingBox.expandByPoint(wi)):(this.boundingBox.expandByPoint(Hr.min),this.boundingBox.expandByPoint(Hr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Ee('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new t_);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Ee("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new X,1/0);return}if(e){const n=this.boundingSphere.center;if(Hr.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];Zd.setFromBufferAttribute(o),this.morphTargetsRelative?(wi.addVectors(Hr.min,Zd.min),Hr.expandByPoint(wi),wi.addVectors(Hr.max,Zd.max),Hr.expandByPoint(wi)):(Hr.expandByPoint(Zd.min),Hr.expandByPoint(Zd.max))}Hr.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)wi.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(wi));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,d=o.count;c<d;c++)wi.fromBufferAttribute(o,c),l&&(_c.fromBufferAttribute(e,c),wi.add(_c)),r=Math.max(r,n.distanceToSquared(wi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Ee('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Ee("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ki(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let D=0;D<n.count;D++)o[D]=new X,l[D]=new X;const c=new X,d=new X,f=new X,p=new Xe,m=new Xe,_=new Xe,b=new X,v=new X;function y(D,R,P){c.fromBufferAttribute(n,D),d.fromBufferAttribute(n,R),f.fromBufferAttribute(n,P),p.fromBufferAttribute(s,D),m.fromBufferAttribute(s,R),_.fromBufferAttribute(s,P),d.sub(c),f.sub(c),m.sub(p),_.sub(p);const L=1/(m.x*_.y-_.x*m.y);isFinite(L)&&(b.copy(d).multiplyScalar(_.y).addScaledVector(f,-m.y).multiplyScalar(L),v.copy(f).multiplyScalar(m.x).addScaledVector(d,-_.x).multiplyScalar(L),o[D].add(b),o[R].add(b),o[P].add(b),l[D].add(v),l[R].add(v),l[P].add(v))}let S=this.groups;S.length===0&&(S=[{start:0,count:e.count}]);for(let D=0,R=S.length;D<R;++D){const P=S[D],L=P.start,z=P.count;for(let B=L,O=L+z;B<O;B+=3)y(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const T=new X,E=new X,N=new X,M=new X;function C(D){N.fromBufferAttribute(r,D),M.copy(N);const R=o[D];T.copy(R),T.sub(N.multiplyScalar(N.dot(R))).normalize(),E.crossVectors(M,R);const L=E.dot(l[D])<0?-1:1;a.setXYZW(D,T.x,T.y,T.z,L)}for(let D=0,R=S.length;D<R;++D){const P=S[D],L=P.start,z=P.count;for(let B=L,O=L+z;B<O;B+=3)C(e.getX(B+0)),C(e.getX(B+1)),C(e.getX(B+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ki(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let p=0,m=n.count;p<m;p++)n.setXYZ(p,0,0,0);const r=new X,s=new X,a=new X,o=new X,l=new X,c=new X,d=new X,f=new X;if(e)for(let p=0,m=e.count;p<m;p+=3){const _=e.getX(p+0),b=e.getX(p+1),v=e.getX(p+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,b),a.fromBufferAttribute(t,v),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),o.fromBufferAttribute(n,_),l.fromBufferAttribute(n,b),c.fromBufferAttribute(n,v),o.add(d),l.add(d),c.add(d),n.setXYZ(_,o.x,o.y,o.z),n.setXYZ(b,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),a.fromBufferAttribute(t,p+2),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),n.setXYZ(p+0,d.x,d.y,d.z),n.setXYZ(p+1,d.x,d.y,d.z),n.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)wi.fromBufferAttribute(e,t),wi.normalize(),e.setXYZ(t,wi.x,wi.y,wi.z)}toNonIndexed(){function e(o,l){const c=o.array,d=o.itemSize,f=o.normalized,p=new c.constructor(l.length*d);let m=0,_=0;for(let b=0,v=l.length;b<v;b++){o.isInterleavedBufferAttribute?m=l[b]*o.data.stride+o.offset:m=l[b]*d;for(let y=0;y<d;y++)p[_++]=c[m++]}return new Ki(p,d,f)}if(this.index===null)return Ae("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new UR,n=this.index.array,r=this.attributes;for(const o in r){const l=r[o],c=e(l,n);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let d=0,f=c.length;d<f;d++){const p=c[d],m=e(p,n);l.push(m)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let f=0,p=c.length;f<p;f++){const m=c[f];d.push(m.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const c in r){const d=r[c];this.setAttribute(c,d.clone(t))}const s=e.morphAttributes;for(const c in s){const d=[],f=s[c];for(let p=0,m=f.length;p<m;p++)d.push(f[p].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,d=a.length;c<d;c++){const f=a[c];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const iA=new hn,Hl=new nS,tm=new t_,rA=new X,nm=new X,im=new X,rm=new X,Iv=new X,sm=new X,sA=new X,am=new X;let pi=class extends mr{constructor(e=new es,t=new ma){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){sm.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=o[l],f=s[l];d!==0&&(Iv.fromBufferAttribute(f,e),a?sm.addScaledVector(Iv,d):sm.addScaledVector(Iv.sub(t),d))}t.add(sm)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),tm.copy(n.boundingSphere),tm.applyMatrix4(s),Hl.copy(e.ray).recast(e.near),!(tm.containsPoint(Hl.origin)===!1&&(Hl.intersectSphere(tm,rA)===null||Hl.origin.distanceToSquared(rA)>(e.far-e.near)**2))&&(iA.copy(s).invert(),Hl.copy(e.ray).applyMatrix4(iA),!(n.boundingBox!==null&&Hl.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Hl)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(o!==null)if(Array.isArray(a))for(let _=0,b=p.length;_<b;_++){const v=p[_],y=a[v.materialIndex],S=Math.max(v.start,m.start),T=Math.min(o.count,Math.min(v.start+v.count,m.start+m.count));for(let E=S,N=T;E<N;E+=3){const M=o.getX(E),C=o.getX(E+1),D=o.getX(E+2);r=om(this,y,e,n,c,d,f,M,C,D),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const _=Math.max(0,m.start),b=Math.min(o.count,m.start+m.count);for(let v=_,y=b;v<y;v+=3){const S=o.getX(v),T=o.getX(v+1),E=o.getX(v+2);r=om(this,a,e,n,c,d,f,S,T,E),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let _=0,b=p.length;_<b;_++){const v=p[_],y=a[v.materialIndex],S=Math.max(v.start,m.start),T=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));for(let E=S,N=T;E<N;E+=3){const M=E,C=E+1,D=E+2;r=om(this,y,e,n,c,d,f,M,C,D),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const _=Math.max(0,m.start),b=Math.min(l.count,m.start+m.count);for(let v=_,y=b;v<y;v+=3){const S=v,T=v+1,E=v+2;r=om(this,a,e,n,c,d,f,S,T,E),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}}};function rF(i,e,t,n,r,s,a,o){let l;if(e.side===En?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,e.side===Zr,o),l===null)return null;am.copy(o),am.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(am);return c<t.near||c>t.far?null:{distance:c,point:am.clone(),object:i}}function om(i,e,t,n,r,s,a,o,l,c){i.getVertexPosition(o,nm),i.getVertexPosition(l,im),i.getVertexPosition(c,rm);const d=rF(i,e,t,n,nm,im,rm,sA);if(d){const f=new X;Kd.getBarycoord(sA,nm,im,rm,f),r&&(d.uv=Kd.getInterpolatedAttribute(r,o,l,c,f,new Xe)),s&&(d.uv1=Kd.getInterpolatedAttribute(s,o,l,c,f,new Xe)),a&&(d.normal=Kd.getInterpolatedAttribute(a,o,l,c,f,new X),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const p={a:o,b:l,c,normal:new X,materialIndex:0};Kd.getNormal(nm,im,rm,p.normal),d.face=p,d.barycoord=f}return d}class Lu extends es{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],d=[],f=[];let p=0,m=0;_("z","y","x",-1,-1,n,t,e,a,s,0),_("z","y","x",1,-1,n,t,-e,a,s,1),_("x","z","y",1,1,e,n,t,r,a,2),_("x","z","y",1,-1,e,n,-t,r,a,3),_("x","y","z",1,-1,e,t,n,r,s,4),_("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new fi(c,3)),this.setAttribute("normal",new fi(d,3)),this.setAttribute("uv",new fi(f,2));function _(b,v,y,S,T,E,N,M,C,D,R){const P=E/C,L=N/D,z=E/2,B=N/2,O=M/2,V=C+1,Y=D+1;let G=0,W=0;const te=new X;for(let U=0;U<Y;U++){const H=U*L-B;for(let le=0;le<V;le++){const Te=le*P-z;te[b]=Te*S,te[v]=H*T,te[y]=O,c.push(te.x,te.y,te.z),te[b]=0,te[v]=0,te[y]=M>0?1:-1,d.push(te.x,te.y,te.z),f.push(le/C),f.push(1-U/D),G+=1}}for(let U=0;U<D;U++)for(let H=0;H<C;H++){const le=p+H+V*U,Te=p+H+V*(U+1),Fe=p+(H+1)+V*(U+1),ie=p+(H+1)+V*U;l.push(le,Te,ie),l.push(Te,Fe,ie),W+=6}o.addGroup(m,W,R),m+=W,p+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Oh(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Ae("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function ar(i){const e={};for(let t=0;t<i.length;t++){const n=Oh(i[t]);for(const r in n)e[r]=n[r]}return e}function sF(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function OR(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:bt.workingColorSpace}const BR={clone:Oh,merge:ar};var aF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class vs extends Qi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aF,this.fragmentShader=oF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Oh(e.uniforms),this.uniformsGroups=sF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class aS extends mr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new hn,this.projectionMatrix=new hn,this.projectionMatrixInverse=new hn,this.coordinateSystem=fr,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const $o=new X,aA=new Xe,oA=new Xe;class Mi extends aS{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Au*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Lf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Au*2*Math.atan(Math.tan(Lf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){$o.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set($o.x,$o.y).multiplyScalar(-e/$o.z),$o.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set($o.x,$o.y).multiplyScalar(-e/$o.z)}getViewSize(e,t){return this.getViewBounds(e,aA,oA),t.subVectors(oA,aA)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Lf*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*r/l,t-=a.offsetY*n/c,r*=a.width/l,n*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const yc=-90,vc=1;class zR extends mr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Mi(yc,vc,e,t);r.layers=this.layers,this.add(r);const s=new Mi(yc,vc,e,t);s.layers=this.layers,this.add(s);const a=new Mi(yc,vc,e,t);a.layers=this.layers,this.add(a);const o=new Mi(yc,vc,e,t);o.layers=this.layers,this.add(o);const l=new Mi(yc,vc,e,t);l.layers=this.layers,this.add(l);const c=new Mi(yc,vc,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===fr)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Sa)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const b=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,o),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,c),n.texture.generateMipmaps=b,e.setRenderTarget(n,5,r),e.render(t,d),e.setRenderTarget(f,p,m),e.xr.enabled=_,n.texture.needsPMREMUpdate=!0}}class Ap extends er{constructor(e=[],t=Xs,n,r,s,a,o,l,c,d){super(e,t,n,r,s,a,o,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class oS extends Ws{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Ap(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Lu(5,5,5),s=new vs({name:"CubemapFromEquirect",uniforms:Oh(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:En,blending:pr});s.uniforms.tEquirect.value=t;const a=new pi(r,s),o=t.minFilter;return t.minFilter===Nr&&(t.minFilter=In),new zR(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}let lm=class extends mr{constructor(){super(),this.isGroup=!0,this.type="Group"}};const lF={type:"move"};class v0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new lm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new lm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new X,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new X),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new lm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new X,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new X),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const b of e.hand.values()){const v=t.getJointPose(b,n),y=this._getHandJoint(c,b);v!==null&&(y.matrix.fromArray(v.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=v.radius),y.visible=v!==null}const d=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],p=d.position.distanceTo(f.position),m=.02,_=.005;c.inputState.pinching&&p>m+_?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-_&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(lF)))}return o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new lm;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class n_ extends mr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ys,this.environmentIntensity=1,this.environmentRotation=new ys,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class GR{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Uh,this.updateRanges=[],this.version=0,this.uuid=ho()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ho()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ho()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const sr=new X;class lS{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)sr.fromBufferAttribute(this,t),sr.applyMatrix4(e),this.setXYZ(t,sr.x,sr.y,sr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)sr.fromBufferAttribute(this,t),sr.applyNormalMatrix(e),this.setXYZ(t,sr.x,sr.y,sr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)sr.fromBufferAttribute(this,t),sr.transformDirection(e),this.setXYZ(t,sr.x,sr.y,sr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ur(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Gt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ur(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ur(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ur(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ur(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),n=Gt(n,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){hp("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ki(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new lS(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){hp("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class uF extends Qi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new _t(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class uS extends er{constructor(e=null,t=1,n=1,r,s,a,o,l,c=vn,d=vn,f,p){super(null,a,o,l,c,d,r,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class cF extends Ki{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Lv=new X,hF=new X,dF=new Ft;class zs{constructor(e=new X(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Lv.subVectors(n,t).cross(hF.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Lv),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||dF.getNormalMatrix(e),r=this.coplanarPoint(Lv).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Wl=new t_,fF=new Xe(.5,.5),um=new X;class Ep{constructor(e=new zs,t=new zs,n=new zs,r=new zs,s=new zs,a=new zs){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=fr,n=!1){const r=this.planes,s=e.elements,a=s[0],o=s[1],l=s[2],c=s[3],d=s[4],f=s[5],p=s[6],m=s[7],_=s[8],b=s[9],v=s[10],y=s[11],S=s[12],T=s[13],E=s[14],N=s[15];if(r[0].setComponents(c-a,m-d,y-_,N-S).normalize(),r[1].setComponents(c+a,m+d,y+_,N+S).normalize(),r[2].setComponents(c+o,m+f,y+b,N+T).normalize(),r[3].setComponents(c-o,m-f,y-b,N-T).normalize(),n)r[4].setComponents(l,p,v,E).normalize(),r[5].setComponents(c-l,m-p,y-v,N-E).normalize();else if(r[4].setComponents(c-l,m-p,y-v,N-E).normalize(),t===fr)r[5].setComponents(c+l,m+p,y+v,N+E).normalize();else if(t===Sa)r[5].setComponents(l,p,v,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Wl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Wl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Wl)}intersectsSprite(e){Wl.center.set(0,0,0);const t=fF.distanceTo(e.center);return Wl.radius=.7071067811865476+t,Wl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wl)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(um.x=r.normal.x>0?e.max.x:e.min.x,um.y=r.normal.y>0?e.max.y:e.min.y,um.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(um)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const ra=new hn,sa=new Ep;class cS{constructor(){this.coordinateSystem=fr}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ra.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),sa.setFromProjectionMatrix(ra,r.coordinateSystem,r.reversedDepth),sa.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ra.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),sa.setFromProjectionMatrix(ra,r.coordinateSystem,r.reversedDepth),sa.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ra.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),sa.setFromProjectionMatrix(ra,r.coordinateSystem,r.reversedDepth),sa.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ra.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),sa.setFromProjectionMatrix(ra,r.coordinateSystem,r.reversedDepth),sa.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ra.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),sa.setFromProjectionMatrix(ra,r.coordinateSystem,r.reversedDepth),sa.containsPoint(e))return!0}return!1}clone(){return new cS}}let VR=class extends Qi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _t(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};class pF extends Qi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new _t(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class jR extends er{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=vn,this.minFilter=vn,this.generateMipmaps=!1,this.needsUpdate=!0}}let gr=class extends er{constructor(e,t,n=yn,r,s,a,o=vn,l=vn,c,d=ki,f=1){if(d!==ki&&d!==hr)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const p={width:e,height:t,depth:f};super(p,r,s,a,o,l,d,n,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new eS(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};class HR extends gr{constructor(e,t=yn,n=Xs,r,s,a=vn,o=vn,l,c=ki){const d={width:e,height:e,depth:1},f=[d,d,d,d,d,d];super(e,e,t,n,r,s,a,o,l,c),this.image=f,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class WR extends er{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}let gF=class $R extends es{constructor(e=1,t=1,n=1,r=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],f=[],p=[],m=[];let _=0;const b=[],v=n/2;let y=0;S(),a===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(d),this.setAttribute("position",new fi(f,3)),this.setAttribute("normal",new fi(p,3)),this.setAttribute("uv",new fi(m,2));function S(){const E=new X,N=new X;let M=0;const C=(t-e)/n;for(let D=0;D<=s;D++){const R=[],P=D/s,L=P*(t-e)+e;for(let z=0;z<=r;z++){const B=z/r,O=B*l+o,V=Math.sin(O),Y=Math.cos(O);N.x=L*V,N.y=-P*n+v,N.z=L*Y,f.push(N.x,N.y,N.z),E.set(V,C,Y).normalize(),p.push(E.x,E.y,E.z),m.push(B,1-P),R.push(_++)}b.push(R)}for(let D=0;D<r;D++)for(let R=0;R<s;R++){const P=b[R][D],L=b[R+1][D],z=b[R+1][D+1],B=b[R][D+1];(e>0||R!==0)&&(d.push(P,L,B),M+=3),(t>0||R!==s-1)&&(d.push(L,z,B),M+=3)}c.addGroup(y,M,0),y+=M}function T(E){const N=_,M=new Xe,C=new X;let D=0;const R=E===!0?e:t,P=E===!0?1:-1;for(let z=1;z<=r;z++)f.push(0,v*P,0),p.push(0,P,0),m.push(.5,.5),_++;const L=_;for(let z=0;z<=r;z++){const O=z/r*l+o,V=Math.cos(O),Y=Math.sin(O);C.x=R*Y,C.y=v*P,C.z=R*V,f.push(C.x,C.y,C.z),p.push(0,P,0),M.x=V*.5+.5,M.y=Y*.5*P+.5,m.push(M.x,M.y),_++}for(let z=0;z<r;z++){const B=N+z,O=L+z;E===!0?d.push(O,O+1,B):d.push(O+1,O,B),D+=3}c.addGroup(y,D,E===!0?1:2),y+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $R(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};class Cp extends es{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,o=Math.floor(n),l=Math.floor(r),c=o+1,d=l+1,f=e/o,p=t/l,m=[],_=[],b=[],v=[];for(let y=0;y<d;y++){const S=y*p-a;for(let T=0;T<c;T++){const E=T*f-s;_.push(E,-S,0),b.push(0,0,1),v.push(T/o),v.push(1-y/l)}}for(let y=0;y<l;y++)for(let S=0;S<o;S++){const T=S+c*y,E=S+c*(y+1),N=S+1+c*(y+1),M=S+1+c*y;m.push(T,E,M),m.push(E,N,M)}this.setIndex(m),this.setAttribute("position",new fi(_,3)),this.setAttribute("normal",new fi(b,3)),this.setAttribute("uv",new fi(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cp(e.width,e.height,e.widthSegments,e.heightSegments)}}let qR=class XR extends es{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const d=[],f=new X,p=new X,m=[],_=[],b=[],v=[];for(let y=0;y<=n;y++){const S=[],T=y/n;let E=0;y===0&&a===0?E=.5/t:y===n&&l===Math.PI&&(E=-.5/t);for(let N=0;N<=t;N++){const M=N/t;f.x=-e*Math.cos(r+M*s)*Math.sin(a+T*o),f.y=e*Math.cos(a+T*o),f.z=e*Math.sin(r+M*s)*Math.sin(a+T*o),_.push(f.x,f.y,f.z),p.copy(f).normalize(),b.push(p.x,p.y,p.z),v.push(M+E,1-T),S.push(c++)}d.push(S)}for(let y=0;y<n;y++)for(let S=0;S<t;S++){const T=d[y][S+1],E=d[y][S],N=d[y+1][S],M=d[y+1][S+1];(y!==0||a>0)&&m.push(T,E,M),(y!==n-1||l<Math.PI)&&m.push(E,N,M)}this.setIndex(m),this.setAttribute("position",new fi(_,3)),this.setAttribute("normal",new fi(b,3)),this.setAttribute("uv",new fi(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new XR(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class mF extends Qi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new _t(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _F extends vs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class YR extends Qi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new _t(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yF extends YR{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ht(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new _t(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new _t(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new _t(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class vF extends Qi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new _t(16777215),this.specular=new _t(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xF extends Qi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new _t(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class bF extends Qi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}let wF=class extends Qi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new _t(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ys,this.combine=xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};class SF extends Qi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=uL,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class TF extends Qi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class MF extends Qi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new _t(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ba,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class AF extends VR{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const Fv={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class EF{constructor(e,t,n){const r=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(d){o++,s===!1&&r.onStart!==void 0&&r.onStart(d,a,o),s=!0},this.itemEnd=function(d){a++,r.onProgress!==void 0&&r.onProgress(d,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,f){return c.push(d,f),this},this.removeHandler=function(d){const f=c.indexOf(d);return f!==-1&&c.splice(f,2),this},this.getHandler=function(d){for(let f=0,p=c.length;f<p;f+=2){const m=c[f],_=c[f+1];if(m.global&&(m.lastIndex=0),m.test(d))return _}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const CF=new EF;class hS{constructor(e){this.manager=e!==void 0?e:CF,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}hS.DEFAULT_MATERIAL_NAME="__DEFAULT";const xc=new WeakMap;class RF extends hS{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Fv.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let f=xc.get(a);f===void 0&&(f=[],xc.set(a,f)),f.push({onLoad:t,onError:r})}return a}const o=cp("img");function l(){d(),t&&t(this);const f=xc.get(this)||[];for(let p=0;p<f.length;p++){const m=f[p];m.onLoad&&m.onLoad(this)}xc.delete(this),s.manager.itemEnd(e)}function c(f){d(),r&&r(f),Fv.remove(`image:${e}`);const p=xc.get(this)||[];for(let m=0;m<p.length;m++){const _=p[m];_.onError&&_.onError(f)}xc.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),Fv.add(`image:${e}`,o),s.manager.itemStart(e),o.src=e,o}}class NF extends hS{constructor(e){super(e)}load(e,t,n,r){const s=new er,a=new RF(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Fu extends mr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new _t(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class PF extends Fu{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new _t(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const Uv=new hn,lA=new X,uA=new X;class dS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.mapType=Un,this.map=null,this.mapPass=null,this.matrix=new hn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ep,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new It(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;lA.setFromMatrixPosition(e.matrixWorld),t.position.copy(lA),uA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(uA),t.updateMatrixWorld(),Uv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Uv,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Uv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class DF extends dS{constructor(){super(new Mi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Au*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class fS extends Fu{constructor(e,t,n=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.target=new mr,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new DF}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class kF extends dS{constructor(){super(new Mi(90,1,.5,500)),this.isPointLightShadow=!0}}class IF extends Fu{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new kF}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Qh extends aS{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,o=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=d*this.view.offsetY,l=o-d*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class LF extends dS{constructor(){super(new Qh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class KR extends Fu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mr.DEFAULT_UP),this.updateMatrix(),this.target=new mr,this.shadow=new LF}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class ZR extends Fu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class FF extends Fu{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class UF{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new X)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class OF extends Fu{constructor(e=new UF,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class QR extends Mi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class JR{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}class BF extends GR{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const cA=new hn;class eN{constructor(e,t,n=0,r=1/0){this.ray=new nS(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new iS,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Ee("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return cA.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cA),this}intersectObject(e,t=!0,n=[]){return Db(e,this,n,t),n.sort(hA),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)Db(e[r],this,n,t);return n.sort(hA),n}}function hA(i,e){return i.distance-e.distance}function Db(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let a=0,o=s.length;a<o;a++)Db(s[a],e,t,!0)}}class dA{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ht(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ht(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class i_{constructor(e,t,n,r){i_.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}class r_ extends Ca{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Ae("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function kb(i,e,t,n){const r=zF(n);switch(t){case $w:return i*e;case wp:return i*e/r.components*r.byteLength;case Xh:return i*e/r.components*r.byteLength;case dr:return i*e*2/r.components*r.byteLength;case Yh:return i*e*2/r.components*r.byteLength;case bp:return i*e*3/r.components*r.byteLength;case Jn:return i*e*4/r.components*r.byteLength;case Kh:return i*e*4/r.components*r.byteLength;case ll:case ul:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case cl:case hl:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case op:case up:return Math.max(i,16)*Math.max(e,8)/4;case ap:case lp:return Math.max(i,8)*Math.max(e,8)/2;case dh:case fh:case gh:case mh:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case ph:case Su:case _h:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case yh:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case vh:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case xh:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case bh:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case wh:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Sh:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Th:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Mh:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case Ah:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Eh:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Ch:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Rh:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Nh:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Ph:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Dh:case Cb:case Rb:return Math.ceil(i/4)*Math.ceil(e/4)*16;case kh:case Ih:return Math.ceil(i/4)*Math.ceil(e/4)*8;case Tu:case Lh:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function zF(i){switch(i){case Un:case du:return{byteLength:1,components:1};case js:case fu:case Wn:return{byteLength:2,components:1};case Z0:case Q0:return{byteLength:2,components:4};case yn:case Ti:case Qn:return{byteLength:4,components:1};case J0:case e_:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ku}}));typeof window<"u"&&(window.__THREE__?Ae("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ku);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function tN(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function GF(i){const e=new WeakMap;function t(o,l){const c=o.array,d=o.usage,f=c.byteLength,p=i.createBuffer();i.bindBuffer(l,p),i.bufferData(l,c,d),o.onUploadCallback();let m;if(c instanceof Float32Array)m=i.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)m=i.HALF_FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?m=i.HALF_FLOAT:m=i.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=i.SHORT;else if(c instanceof Uint32Array)m=i.UNSIGNED_INT;else if(c instanceof Int32Array)m=i.INT;else if(c instanceof Int8Array)m=i.BYTE;else if(c instanceof Uint8Array)m=i.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:p,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:f}}function n(o,l,c){const d=l.array,f=l.updateRanges;if(i.bindBuffer(c,o),f.length===0)i.bufferSubData(c,0,d);else{f.sort((m,_)=>m.start-_.start);let p=0;for(let m=1;m<f.length;m++){const _=f[p],b=f[m];b.start<=_.start+_.count+1?_.count=Math.max(_.count,b.start+b.count-_.start):(++p,f[p]=b)}f.length=p+1;for(let m=0,_=f.length;m<_;m++){const b=f[m];i.bufferSubData(c,b.start*d.BYTES_PER_ELEMENT,d,b.start,b.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(i.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const d=e.get(o);(!d||d.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,o,l),c.version=o.version}}return{get:r,remove:s,update:a}}var VF=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,jF=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,HF=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,WF=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$F=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,qF=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,XF=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,YF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,KF=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,ZF=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,QF=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,JF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,eU=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,tU=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,nU=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,iU=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,rU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,sU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,aU=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,oU=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,lU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,uU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,cU=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,hU=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,dU=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,fU=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,pU=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,gU=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,mU=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,_U=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,yU="gl_FragColor = linearToOutputTexel( gl_FragColor );",vU=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,xU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,bU=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,wU=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,SU=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,TU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,MU=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,AU=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,EU=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,CU=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,RU=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,NU=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,PU=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,DU=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,kU=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,IU=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,LU=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,FU=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,UU=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,OU=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,BU=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,zU=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,GU=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,VU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,jU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,HU=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,WU=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,$U=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,qU=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,XU=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,YU=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,KU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ZU=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,QU=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,JU=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,eO=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,tO=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,nO=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,iO=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,rO=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,sO=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,aO=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,oO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,lO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,uO=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,cO=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,hO=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,dO=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,fO=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,pO=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,gO=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,mO=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,_O=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,yO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,vO=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,xO=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,bO=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,wO=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,SO=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,TO=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,MO=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,AO=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,EO=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,CO=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,RO=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,NO=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,PO=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,DO=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,kO=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,IO=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,LO=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,FO=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,UO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,OO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,zO=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const GO=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,VO=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,HO=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,WO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,$O=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qO=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,XO=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,YO=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,KO=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,ZO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,QO=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,JO=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,eB=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,tB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,nB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iB=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rB=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,aB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,lB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,uB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,dB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fB=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,mB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,_B=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,jt={alphahash_fragment:VF,alphahash_pars_fragment:jF,alphamap_fragment:HF,alphamap_pars_fragment:WF,alphatest_fragment:$F,alphatest_pars_fragment:qF,aomap_fragment:XF,aomap_pars_fragment:YF,batching_pars_vertex:KF,batching_vertex:ZF,begin_vertex:QF,beginnormal_vertex:JF,bsdfs:eU,iridescence_fragment:tU,bumpmap_pars_fragment:nU,clipping_planes_fragment:iU,clipping_planes_pars_fragment:rU,clipping_planes_pars_vertex:sU,clipping_planes_vertex:aU,color_fragment:oU,color_pars_fragment:lU,color_pars_vertex:uU,color_vertex:cU,common:hU,cube_uv_reflection_fragment:dU,defaultnormal_vertex:fU,displacementmap_pars_vertex:pU,displacementmap_vertex:gU,emissivemap_fragment:mU,emissivemap_pars_fragment:_U,colorspace_fragment:yU,colorspace_pars_fragment:vU,envmap_fragment:xU,envmap_common_pars_fragment:bU,envmap_pars_fragment:wU,envmap_pars_vertex:SU,envmap_physical_pars_fragment:IU,envmap_vertex:TU,fog_vertex:MU,fog_pars_vertex:AU,fog_fragment:EU,fog_pars_fragment:CU,gradientmap_pars_fragment:RU,lightmap_pars_fragment:NU,lights_lambert_fragment:PU,lights_lambert_pars_fragment:DU,lights_pars_begin:kU,lights_toon_fragment:LU,lights_toon_pars_fragment:FU,lights_phong_fragment:UU,lights_phong_pars_fragment:OU,lights_physical_fragment:BU,lights_physical_pars_fragment:zU,lights_fragment_begin:GU,lights_fragment_maps:VU,lights_fragment_end:jU,logdepthbuf_fragment:HU,logdepthbuf_pars_fragment:WU,logdepthbuf_pars_vertex:$U,logdepthbuf_vertex:qU,map_fragment:XU,map_pars_fragment:YU,map_particle_fragment:KU,map_particle_pars_fragment:ZU,metalnessmap_fragment:QU,metalnessmap_pars_fragment:JU,morphinstance_vertex:eO,morphcolor_vertex:tO,morphnormal_vertex:nO,morphtarget_pars_vertex:iO,morphtarget_vertex:rO,normal_fragment_begin:sO,normal_fragment_maps:aO,normal_pars_fragment:oO,normal_pars_vertex:lO,normal_vertex:uO,normalmap_pars_fragment:cO,clearcoat_normal_fragment_begin:hO,clearcoat_normal_fragment_maps:dO,clearcoat_pars_fragment:fO,iridescence_pars_fragment:pO,opaque_fragment:gO,packing:mO,premultiplied_alpha_fragment:_O,project_vertex:yO,dithering_fragment:vO,dithering_pars_fragment:xO,roughnessmap_fragment:bO,roughnessmap_pars_fragment:wO,shadowmap_pars_fragment:SO,shadowmap_pars_vertex:TO,shadowmap_vertex:MO,shadowmask_pars_fragment:AO,skinbase_vertex:EO,skinning_pars_vertex:CO,skinning_vertex:RO,skinnormal_vertex:NO,specularmap_fragment:PO,specularmap_pars_fragment:DO,tonemapping_fragment:kO,tonemapping_pars_fragment:IO,transmission_fragment:LO,transmission_pars_fragment:FO,uv_pars_fragment:UO,uv_pars_vertex:OO,uv_vertex:BO,worldpos_vertex:zO,background_vert:GO,background_frag:VO,backgroundCube_vert:jO,backgroundCube_frag:HO,cube_vert:WO,cube_frag:$O,depth_vert:qO,depth_frag:XO,distance_vert:YO,distance_frag:KO,equirect_vert:ZO,equirect_frag:QO,linedashed_vert:JO,linedashed_frag:eB,meshbasic_vert:tB,meshbasic_frag:nB,meshlambert_vert:iB,meshlambert_frag:rB,meshmatcap_vert:sB,meshmatcap_frag:aB,meshnormal_vert:oB,meshnormal_frag:lB,meshphong_vert:uB,meshphong_frag:cB,meshphysical_vert:hB,meshphysical_frag:dB,meshtoon_vert:fB,meshtoon_frag:pB,points_vert:gB,points_frag:mB,shadow_vert:_B,shadow_frag:yB,sprite_vert:vB,sprite_frag:xB},Ke={common:{diffuse:{value:new _t(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ft},alphaMap:{value:null},alphaMapTransform:{value:new Ft},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ft}},envmap:{envMap:{value:null},envMapRotation:{value:new Ft},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ft}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ft}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ft},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ft},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ft},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ft}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ft}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ft}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _t(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _t(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ft},alphaTest:{value:0},uvTransform:{value:new Ft}},sprite:{diffuse:{value:new _t(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ft},alphaMap:{value:null},alphaMapTransform:{value:new Ft},alphaTest:{value:0}}},fa={basic:{uniforms:ar([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.fog]),vertexShader:jt.meshbasic_vert,fragmentShader:jt.meshbasic_frag},lambert:{uniforms:ar([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,Ke.lights,{emissive:{value:new _t(0)}}]),vertexShader:jt.meshlambert_vert,fragmentShader:jt.meshlambert_frag},phong:{uniforms:ar([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,Ke.lights,{emissive:{value:new _t(0)},specular:{value:new _t(1118481)},shininess:{value:30}}]),vertexShader:jt.meshphong_vert,fragmentShader:jt.meshphong_frag},standard:{uniforms:ar([Ke.common,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.roughnessmap,Ke.metalnessmap,Ke.fog,Ke.lights,{emissive:{value:new _t(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag},toon:{uniforms:ar([Ke.common,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.gradientmap,Ke.fog,Ke.lights,{emissive:{value:new _t(0)}}]),vertexShader:jt.meshtoon_vert,fragmentShader:jt.meshtoon_frag},matcap:{uniforms:ar([Ke.common,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,{matcap:{value:null}}]),vertexShader:jt.meshmatcap_vert,fragmentShader:jt.meshmatcap_frag},points:{uniforms:ar([Ke.points,Ke.fog]),vertexShader:jt.points_vert,fragmentShader:jt.points_frag},dashed:{uniforms:ar([Ke.common,Ke.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jt.linedashed_vert,fragmentShader:jt.linedashed_frag},depth:{uniforms:ar([Ke.common,Ke.displacementmap]),vertexShader:jt.depth_vert,fragmentShader:jt.depth_frag},normal:{uniforms:ar([Ke.common,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,{opacity:{value:1}}]),vertexShader:jt.meshnormal_vert,fragmentShader:jt.meshnormal_frag},sprite:{uniforms:ar([Ke.sprite,Ke.fog]),vertexShader:jt.sprite_vert,fragmentShader:jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Ft},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:jt.background_vert,fragmentShader:jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ft}},vertexShader:jt.backgroundCube_vert,fragmentShader:jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:jt.cube_vert,fragmentShader:jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jt.equirect_vert,fragmentShader:jt.equirect_frag},distance:{uniforms:ar([Ke.common,Ke.displacementmap,{referencePosition:{value:new X},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:jt.distance_vert,fragmentShader:jt.distance_frag},shadow:{uniforms:ar([Ke.lights,Ke.fog,{color:{value:new _t(0)},opacity:{value:1}}]),vertexShader:jt.shadow_vert,fragmentShader:jt.shadow_frag}};fa.physical={uniforms:ar([fa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ft},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ft},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ft},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ft},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ft},sheen:{value:0},sheenColor:{value:new _t(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ft},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ft},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ft},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ft},attenuationDistance:{value:0},attenuationColor:{value:new _t(0)},specularColor:{value:new _t(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ft},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ft},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ft}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag};const cm={r:0,b:0,g:0},$l=new ys,bB=new hn;function wB(i,e,t,n,r,s,a){const o=new _t(0);let l=s===!0?0:1,c,d,f=null,p=0,m=null;function _(T){let E=T.isScene===!0?T.background:null;return E&&E.isTexture&&(E=(T.backgroundBlurriness>0?t:e).get(E)),E}function b(T){let E=!1;const N=_(T);N===null?y(o,l):N&&N.isColor&&(y(N,1),E=!0);const M=i.xr.getEnvironmentBlendMode();M==="additive"?n.buffers.color.setClear(0,0,0,1,a):M==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(i.autoClear||E)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function v(T,E){const N=_(E);N&&(N.isCubeTexture||N.mapping===xu)?(d===void 0&&(d=new pi(new Lu(1,1,1),new vs({name:"BackgroundCubeMaterial",uniforms:Oh(fa.backgroundCube.uniforms),vertexShader:fa.backgroundCube.vertexShader,fragmentShader:fa.backgroundCube.fragmentShader,side:En,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(M,C,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),$l.copy(E.backgroundRotation),$l.x*=-1,$l.y*=-1,$l.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&($l.y*=-1,$l.z*=-1),d.material.uniforms.envMap.value=N,d.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=E.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(bB.makeRotationFromEuler($l)),d.material.toneMapped=bt.getTransfer(N.colorSpace)!==Ze,(f!==N||p!==N.version||m!==i.toneMapping)&&(d.material.needsUpdate=!0,f=N,p=N.version,m=i.toneMapping),d.layers.enableAll(),T.unshift(d,d.geometry,d.material,0,0,null)):N&&N.isTexture&&(c===void 0&&(c=new pi(new Cp(2,2),new vs({name:"BackgroundMaterial",uniforms:Oh(fa.background.uniforms),vertexShader:fa.background.vertexShader,fragmentShader:fa.background.fragmentShader,side:Zr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=N,c.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,c.material.toneMapped=bt.getTransfer(N.colorSpace)!==Ze,N.matrixAutoUpdate===!0&&N.updateMatrix(),c.material.uniforms.uvTransform.value.copy(N.matrix),(f!==N||p!==N.version||m!==i.toneMapping)&&(c.material.needsUpdate=!0,f=N,p=N.version,m=i.toneMapping),c.layers.enableAll(),T.unshift(c,c.geometry,c.material,0,0,null))}function y(T,E){T.getRGB(cm,OR(i)),n.buffers.color.setClear(cm.r,cm.g,cm.b,E,a)}function S(){d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(T,E=1){o.set(T),l=E,y(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(T){l=T,y(o,l)},render:b,addToRenderList:v,dispose:S}}function SB(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=p(null);let s=r,a=!1;function o(P,L,z,B,O){let V=!1;const Y=f(B,z,L);s!==Y&&(s=Y,c(s.object)),V=m(P,B,z,O),V&&_(P,B,z,O),O!==null&&e.update(O,i.ELEMENT_ARRAY_BUFFER),(V||a)&&(a=!1,E(P,L,z,B),O!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(O).buffer))}function l(){return i.createVertexArray()}function c(P){return i.bindVertexArray(P)}function d(P){return i.deleteVertexArray(P)}function f(P,L,z){const B=z.wireframe===!0;let O=n[P.id];O===void 0&&(O={},n[P.id]=O);let V=O[L.id];V===void 0&&(V={},O[L.id]=V);let Y=V[B];return Y===void 0&&(Y=p(l()),V[B]=Y),Y}function p(P){const L=[],z=[],B=[];for(let O=0;O<t;O++)L[O]=0,z[O]=0,B[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:L,enabledAttributes:z,attributeDivisors:B,object:P,attributes:{},index:null}}function m(P,L,z,B){const O=s.attributes,V=L.attributes;let Y=0;const G=z.getAttributes();for(const W in G)if(G[W].location>=0){const U=O[W];let H=V[W];if(H===void 0&&(W==="instanceMatrix"&&P.instanceMatrix&&(H=P.instanceMatrix),W==="instanceColor"&&P.instanceColor&&(H=P.instanceColor)),U===void 0||U.attribute!==H||H&&U.data!==H.data)return!0;Y++}return s.attributesNum!==Y||s.index!==B}function _(P,L,z,B){const O={},V=L.attributes;let Y=0;const G=z.getAttributes();for(const W in G)if(G[W].location>=0){let U=V[W];U===void 0&&(W==="instanceMatrix"&&P.instanceMatrix&&(U=P.instanceMatrix),W==="instanceColor"&&P.instanceColor&&(U=P.instanceColor));const H={};H.attribute=U,U&&U.data&&(H.data=U.data),O[W]=H,Y++}s.attributes=O,s.attributesNum=Y,s.index=B}function b(){const P=s.newAttributes;for(let L=0,z=P.length;L<z;L++)P[L]=0}function v(P){y(P,0)}function y(P,L){const z=s.newAttributes,B=s.enabledAttributes,O=s.attributeDivisors;z[P]=1,B[P]===0&&(i.enableVertexAttribArray(P),B[P]=1),O[P]!==L&&(i.vertexAttribDivisor(P,L),O[P]=L)}function S(){const P=s.newAttributes,L=s.enabledAttributes;for(let z=0,B=L.length;z<B;z++)L[z]!==P[z]&&(i.disableVertexAttribArray(z),L[z]=0)}function T(P,L,z,B,O,V,Y){Y===!0?i.vertexAttribIPointer(P,L,z,O,V):i.vertexAttribPointer(P,L,z,B,O,V)}function E(P,L,z,B){b();const O=B.attributes,V=z.getAttributes(),Y=L.defaultAttributeValues;for(const G in V){const W=V[G];if(W.location>=0){let te=O[G];if(te===void 0&&(G==="instanceMatrix"&&P.instanceMatrix&&(te=P.instanceMatrix),G==="instanceColor"&&P.instanceColor&&(te=P.instanceColor)),te!==void 0){const U=te.normalized,H=te.itemSize,le=e.get(te);if(le===void 0)continue;const Te=le.buffer,Fe=le.type,ie=le.bytesPerElement,q=Fe===i.INT||Fe===i.UNSIGNED_INT||te.gpuType===Ti;if(te.isInterleavedBufferAttribute){const re=te.data,we=re.stride,He=te.offset;if(re.isInstancedInterleavedBuffer){for(let Be=0;Be<W.locationSize;Be++)y(W.location+Be,re.meshPerAttribute);P.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=re.meshPerAttribute*re.count)}else for(let Be=0;Be<W.locationSize;Be++)v(W.location+Be);i.bindBuffer(i.ARRAY_BUFFER,Te);for(let Be=0;Be<W.locationSize;Be++)T(W.location+Be,H/W.locationSize,Fe,U,we*ie,(He+H/W.locationSize*Be)*ie,q)}else{if(te.isInstancedBufferAttribute){for(let re=0;re<W.locationSize;re++)y(W.location+re,te.meshPerAttribute);P.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let re=0;re<W.locationSize;re++)v(W.location+re);i.bindBuffer(i.ARRAY_BUFFER,Te);for(let re=0;re<W.locationSize;re++)T(W.location+re,H/W.locationSize,Fe,U,H*ie,H/W.locationSize*re*ie,q)}}else if(Y!==void 0){const U=Y[G];if(U!==void 0)switch(U.length){case 2:i.vertexAttrib2fv(W.location,U);break;case 3:i.vertexAttrib3fv(W.location,U);break;case 4:i.vertexAttrib4fv(W.location,U);break;default:i.vertexAttrib1fv(W.location,U)}}}}S()}function N(){D();for(const P in n){const L=n[P];for(const z in L){const B=L[z];for(const O in B)d(B[O].object),delete B[O];delete L[z]}delete n[P]}}function M(P){if(n[P.id]===void 0)return;const L=n[P.id];for(const z in L){const B=L[z];for(const O in B)d(B[O].object),delete B[O];delete L[z]}delete n[P.id]}function C(P){for(const L in n){const z=n[L];if(z[P.id]===void 0)continue;const B=z[P.id];for(const O in B)d(B[O].object),delete B[O];delete z[P.id]}}function D(){R(),a=!0,s!==r&&(s=r,c(s.object))}function R(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:D,resetDefaultState:R,dispose:N,releaseStatesOfGeometry:M,releaseStatesOfProgram:C,initAttributes:b,enableAttribute:v,disableUnusedAttributes:S}}function TB(i,e,t){let n;function r(c){n=c}function s(c,d){i.drawArrays(n,c,d),t.update(d,n,1)}function a(c,d,f){f!==0&&(i.drawArraysInstanced(n,c,d,f),t.update(d,n,f))}function o(c,d,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,d,0,f);let m=0;for(let _=0;_<f;_++)m+=d[_];t.update(m,n,1)}function l(c,d,f,p){if(f===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let _=0;_<c.length;_++)a(c[_],d[_],p[_]);else{m.multiDrawArraysInstancedWEBGL(n,c,0,d,0,p,0,f);let _=0;for(let b=0;b<f;b++)_+=d[b]*p[b];t.update(_,n,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function MB(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(C){return!(C!==Jn&&n.convert(C)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(C){const D=C===Wn&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(C!==Un&&n.convert(C)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&C!==Qn&&!D)}function l(C){if(C==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const d=l(c);d!==c&&(Ae("WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);const f=t.logarithmicDepthBuffer===!0,p=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),m=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),_=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=i.getParameter(i.MAX_TEXTURE_SIZE),v=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),y=i.getParameter(i.MAX_VERTEX_ATTRIBS),S=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),T=i.getParameter(i.MAX_VARYING_VECTORS),E=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),N=i.getParameter(i.MAX_SAMPLES),M=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:f,reversedDepthBuffer:p,maxTextures:m,maxVertexTextures:_,maxTextureSize:b,maxCubemapSize:v,maxAttributes:y,maxVertexUniforms:S,maxVaryings:T,maxFragmentUniforms:E,maxSamples:N,samples:M}}function AB(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new zs,o=new Ft,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const m=f.length!==0||p||n!==0||r;return r=p,n=f.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,m){const _=f.clippingPlanes,b=f.clipIntersection,v=f.clipShadows,y=i.get(f);if(!r||_===null||_.length===0||s&&!v)s?d(null):c();else{const S=s?0:n,T=S*4;let E=y.clippingState||null;l.value=E,E=d(_,p,T,m);for(let N=0;N!==T;++N)E[N]=t[N];y.clippingState=E,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=S}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(f,p,m,_){const b=f!==null?f.length:0;let v=null;if(b!==0){if(v=l.value,_!==!0||v===null){const y=m+b*4,S=p.matrixWorldInverse;o.getNormalMatrix(S),(v===null||v.length<y)&&(v=new Float32Array(y));for(let T=0,E=m;T!==b;++T,E+=4)a.copy(f[T]).applyMatrix4(S,o),a.normal.toArray(v,E),v[E+3]=a.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,v}}function EB(i){let e=new WeakMap;function t(a,o){return o===ch?a.mapping=Xs:o===hh&&(a.mapping=wa),a}function n(a){if(a&&a.isTexture){const o=a.mapping;if(o===ch||o===hh)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new oS(l.height);return c.fromEquirectangularTexture(i,a),e.set(a,c),a.addEventListener("dispose",r),t(c.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const sl=4,fA=[.125,.215,.35,.446,.526,.582],ru=20,CB=256,Qd=new Qh,pA=new _t;let Ov=null,Bv=0,zv=0,Gv=!1;const RB=new X;let gA=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:o=RB}=s;Ov=this._renderer.getRenderTarget(),Bv=this._renderer.getActiveCubeFace(),zv=this._renderer.getActiveMipmapLevel(),Gv=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,r,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=yA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_A(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Ov,Bv,zv),this._renderer.xr.enabled=Gv,e.scissorTest=!1,bc(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Xs||e.mapping===wa?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ov=this._renderer.getRenderTarget(),Bv=this._renderer.getActiveCubeFace(),zv=this._renderer.getActiveMipmapLevel(),Gv=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:In,minFilter:In,generateMipmaps:!1,type:Wn,format:Jn,colorSpace:Mu,depthBuffer:!1},r=mA(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=mA(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=NB(s)),this._blurMaterial=DB(s,e,t),this._ggxMaterial=PB(s,e,t)}return r}_compileMaterial(e){const t=new pi(new es,e);this._renderer.compile(t,Qd)}_sceneToCubeUV(e,t,n,r,s){const l=new Mi(90,1,t,n),c=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,m=f.toneMapping;f.getClearColor(pA),f.toneMapping=Di,f.autoClear=!1,f.state.buffers.depth.getReversed()&&(f.setRenderTarget(r),f.clearDepth(),f.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new pi(new Lu,new ma({name:"PMREM.Background",side:En,depthWrite:!1,depthTest:!1})));const b=this._backgroundBox,v=b.material;let y=!1;const S=e.background;S?S.isColor&&(v.color.copy(S),e.background=null,y=!0):(v.color.copy(pA),y=!0);for(let T=0;T<6;T++){const E=T%3;E===0?(l.up.set(0,c[T],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+d[T],s.y,s.z)):E===1?(l.up.set(0,0,c[T]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+d[T],s.z)):(l.up.set(0,c[T],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+d[T]));const N=this._cubeSize;bc(r,E*N,T>2?N:0,N,N),f.setRenderTarget(r),y&&f.render(b,l),f.render(e,l)}f.toneMapping=m,f.autoClear=p,e.background=S}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Xs||e.mapping===wa;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=yA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_A());const s=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;bc(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,Qd)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const l=a.uniforms,c=n/(this._lodMeshes.length-1),d=t/(this._lodMeshes.length-1),f=Math.sqrt(c*c-d*d),p=0+c*1.25,m=f*p,{_lodMax:_}=this,b=this._sizeLods[n],v=3*b*(n>_-sl?n-_+sl:0),y=4*(this._cubeSize-b);l.envMap.value=e.texture,l.roughness.value=m,l.mipInt.value=_-t,bc(s,v,y,3*b,2*b),r.setRenderTarget(s),r.render(o,Qd),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=_-n,bc(e,v,y,3*b,2*b),r.setRenderTarget(e),r.render(o,Qd)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Ee("blur direction must be either latitudinal or longitudinal!");const d=3,f=this._lodMeshes[r];f.material=c;const p=c.uniforms,m=this._sizeLods[n]-1,_=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*ru-1),b=s/_,v=isFinite(s)?1+Math.floor(d*b):ru;v>ru&&Ae(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${ru}`);const y=[];let S=0;for(let C=0;C<ru;++C){const D=C/b,R=Math.exp(-D*D/2);y.push(R),C===0?S+=R:C<v&&(S+=2*R)}for(let C=0;C<y.length;C++)y[C]=y[C]/S;p.envMap.value=e.texture,p.samples.value=v,p.weights.value=y,p.latitudinal.value=a==="latitudinal",o&&(p.poleAxis.value=o);const{_lodMax:T}=this;p.dTheta.value=_,p.mipInt.value=T-n;const E=this._sizeLods[r],N=3*E*(r>T-sl?r-T+sl:0),M=4*(this._cubeSize-E);bc(t,N,M,3*E,2*E),l.setRenderTarget(t),l.render(f,Qd)}};function NB(i){const e=[],t=[],n=[];let r=i;const s=i-sl+1+fA.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);e.push(o);let l=1/o;a>i-sl?l=fA[a-i+sl-1]:a===0&&(l=0),t.push(l);const c=1/(o-2),d=-c,f=1+c,p=[d,d,f,d,f,f,d,d,f,f,d,f],m=6,_=6,b=3,v=2,y=1,S=new Float32Array(b*_*m),T=new Float32Array(v*_*m),E=new Float32Array(y*_*m);for(let M=0;M<m;M++){const C=M%3*2/3-1,D=M>2?0:-1,R=[C,D,0,C+2/3,D,0,C+2/3,D+1,0,C,D,0,C+2/3,D+1,0,C,D+1,0];S.set(R,b*_*M),T.set(p,v*_*M);const P=[M,M,M,M,M,M];E.set(P,y*_*M)}const N=new es;N.setAttribute("position",new Ki(S,b)),N.setAttribute("uv",new Ki(T,v)),N.setAttribute("faceIndex",new Ki(E,y)),n.push(new pi(N,null)),r>sl&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function mA(i,e,t){const n=new Ws(i,e,t);return n.texture.mapping=xu,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function bc(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function PB(i,e,t){return new vs({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:CB,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:s_(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:pr,depthTest:!1,depthWrite:!1})}function DB(i,e,t){const n=new Float32Array(ru),r=new X(0,1,0);return new vs({name:"SphericalGaussianBlur",defines:{n:ru,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:s_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:pr,depthTest:!1,depthWrite:!1})}function _A(){return new vs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:s_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:pr,depthTest:!1,depthWrite:!1})}function yA(){return new vs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:s_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:pr,depthTest:!1,depthWrite:!1})}function s_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function kB(i){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture){const l=o.mapping,c=l===ch||l===hh,d=l===Xs||l===wa;if(c||d){let f=e.get(o);const p=f!==void 0?f.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==p)return t===null&&(t=new gA(i)),f=c?t.fromEquirectangular(o,f):t.fromCubemap(o,f),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),f.texture;if(f!==void 0)return f.texture;{const m=o.image;return c&&m&&m.height>0||d&&m&&r(m)?(t===null&&(t=new gA(i)),f=c?t.fromEquirectangular(o):t.fromCubemap(o),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),o.addEventListener("dispose",s),f.texture):null}}}return o}function r(o){let l=0;const c=6;for(let d=0;d<c;d++)o[d]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function IB(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&Fn("WebGLRenderer: "+n+" extension not supported."),r}}}function LB(i,e,t,n){const r={},s=new WeakMap;function a(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const _ in p.attributes)e.remove(p.attributes[_]);p.removeEventListener("dispose",a),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function o(f,p){return r[p.id]===!0||(p.addEventListener("dispose",a),r[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const m in p)e.update(p[m],i.ARRAY_BUFFER)}function c(f){const p=[],m=f.index,_=f.attributes.position;let b=0;if(m!==null){const S=m.array;b=m.version;for(let T=0,E=S.length;T<E;T+=3){const N=S[T+0],M=S[T+1],C=S[T+2];p.push(N,M,M,C,C,N)}}else if(_!==void 0){const S=_.array;b=_.version;for(let T=0,E=S.length/3-1;T<E;T+=3){const N=T+0,M=T+1,C=T+2;p.push(N,M,M,C,C,N)}}else return;const v=new(Qw(p)?sS:rS)(p,1);v.version=b;const y=s.get(f);y&&e.remove(y),s.set(f,v)}function d(f){const p=s.get(f);if(p){const m=f.index;m!==null&&p.version<m.version&&c(f)}else c(f);return s.get(f)}return{get:o,update:l,getWireframeAttribute:d}}function FB(i,e,t){let n;function r(p){n=p}let s,a;function o(p){s=p.type,a=p.bytesPerElement}function l(p,m){i.drawElements(n,m,s,p*a),t.update(m,n,1)}function c(p,m,_){_!==0&&(i.drawElementsInstanced(n,m,s,p*a,_),t.update(m,n,_))}function d(p,m,_){if(_===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,m,0,s,p,0,_);let v=0;for(let y=0;y<_;y++)v+=m[y];t.update(v,n,1)}function f(p,m,_,b){if(_===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<p.length;y++)c(p[y]/a,m[y],b[y]);else{v.multiDrawElementsInstancedWEBGL(n,m,0,s,p,0,b,0,_);let y=0;for(let S=0;S<_;S++)y+=m[S]*b[S];t.update(y,n,1)}}this.setMode=r,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=d,this.renderMultiDrawInstances=f}function UB(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=o*(s/3);break;case i.LINES:t.lines+=o*(s/2);break;case i.LINE_STRIP:t.lines+=o*(s-1);break;case i.LINE_LOOP:t.lines+=o*s;break;case i.POINTS:t.points+=o*s;break;default:Ee("WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function OB(i,e,t){const n=new WeakMap,r=new It;function s(a,o,l){const c=a.morphTargetInfluences,d=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,f=d!==void 0?d.length:0;let p=n.get(o);if(p===void 0||p.count!==f){let P=function(){D.dispose(),n.delete(o),o.removeEventListener("dispose",P)};var m=P;p!==void 0&&p.texture.dispose();const _=o.morphAttributes.position!==void 0,b=o.morphAttributes.normal!==void 0,v=o.morphAttributes.color!==void 0,y=o.morphAttributes.position||[],S=o.morphAttributes.normal||[],T=o.morphAttributes.color||[];let E=0;_===!0&&(E=1),b===!0&&(E=2),v===!0&&(E=3);let N=o.attributes.position.count*E,M=1;N>e.maxTextureSize&&(M=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const C=new Float32Array(N*M*4*f),D=new tS(C,N,M,f);D.type=Qn,D.needsUpdate=!0;const R=E*4;for(let L=0;L<f;L++){const z=y[L],B=S[L],O=T[L],V=N*M*4*L;for(let Y=0;Y<z.count;Y++){const G=Y*R;_===!0&&(r.fromBufferAttribute(z,Y),C[V+G+0]=r.x,C[V+G+1]=r.y,C[V+G+2]=r.z,C[V+G+3]=0),b===!0&&(r.fromBufferAttribute(B,Y),C[V+G+4]=r.x,C[V+G+5]=r.y,C[V+G+6]=r.z,C[V+G+7]=0),v===!0&&(r.fromBufferAttribute(O,Y),C[V+G+8]=r.x,C[V+G+9]=r.y,C[V+G+10]=r.z,C[V+G+11]=O.itemSize===4?r.w:1)}}p={count:f,texture:D,size:new Xe(N,M)},n.set(o,p),o.addEventListener("dispose",P)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",a.morphTexture,t);else{let _=0;for(let v=0;v<c.length;v++)_+=c[v];const b=o.morphTargetsRelative?1:1-_;l.getUniforms().setValue(i,"morphTargetBaseInfluence",b),l.getUniforms().setValue(i,"morphTargetInfluences",c)}l.getUniforms().setValue(i,"morphTargetsTexture",p.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",p.size)}return{update:s}}function BB(i,e,t,n){let r=new WeakMap;function s(l){const c=n.render.frame,d=l.geometry,f=e.get(l,d);if(r.get(f)!==c&&(e.update(f),r.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.get(l)!==c&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return f}function a(){r=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}const zB={[Ow]:"LINEAR_TONE_MAPPING",[Bw]:"REINHARD_TONE_MAPPING",[zw]:"CINEON_TONE_MAPPING",[Gw]:"ACES_FILMIC_TONE_MAPPING",[Vw]:"AGX_TONE_MAPPING",[jw]:"NEUTRAL_TONE_MAPPING",[ER]:"CUSTOM_TONE_MAPPING"};function GB(i,e,t,n,r){const s=new Ws(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),a=new Ws(e,t,{type:Wn,depthBuffer:!1,stencilBuffer:!1}),o=new es;o.setAttribute("position",new fi([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new fi([0,2,0,0,2,0],2));const l=new _F({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),c=new pi(o,l),d=new Qh(-1,1,1,-1,0,1);let f=null,p=null,m=!1,_,b=null,v=[],y=!1;this.setSize=function(S,T){s.setSize(S,T),a.setSize(S,T);for(let E=0;E<v.length;E++){const N=v[E];N.setSize&&N.setSize(S,T)}},this.setEffects=function(S){v=S,y=v.length>0&&v[0].isRenderPass===!0;const T=s.width,E=s.height;for(let N=0;N<v.length;N++){const M=v[N];M.setSize&&M.setSize(T,E)}},this.begin=function(S,T){if(m||S.toneMapping===Di&&v.length===0)return!1;if(b=T,T!==null){const E=T.width,N=T.height;(s.width!==E||s.height!==N)&&this.setSize(E,N)}return y===!1&&S.setRenderTarget(s),_=S.toneMapping,S.toneMapping=Di,!0},this.hasRenderPass=function(){return y},this.end=function(S,T){S.toneMapping=_,m=!0;let E=s,N=a;for(let M=0;M<v.length;M++){const C=v[M];if(C.enabled!==!1&&(C.render(S,N,E,T),C.needsSwap!==!1)){const D=E;E=N,N=D}}if(f!==S.outputColorSpace||p!==S.toneMapping){f=S.outputColorSpace,p=S.toneMapping,l.defines={},bt.getTransfer(f)===Ze&&(l.defines.SRGB_TRANSFER="");const M=zB[p];M&&(l.defines[M]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=E.texture,S.setRenderTarget(b),S.render(c,d),b=null,m=!1},this.isCompositing=function(){return m},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),l.dispose()}}const nN=new er,Ib=new gr(1,1),iN=new tS,rN=new $L,sN=new Ap,vA=[],xA=[],bA=new Float32Array(16),wA=new Float32Array(9),SA=new Float32Array(4);function Jh(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=vA[r];if(s===void 0&&(s=new Float32Array(r),vA[r]=s),e!==0){n.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,i[a].toArray(s,o)}return s}function gi(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function mi(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function a_(i,e){let t=xA[e];t===void 0&&(t=new Int32Array(e),xA[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function VB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function jB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;i.uniform2fv(this.addr,e),mi(t,e)}}function HB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(gi(t,e))return;i.uniform3fv(this.addr,e),mi(t,e)}}function WB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;i.uniform4fv(this.addr,e),mi(t,e)}}function $B(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(gi(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),mi(t,e)}else{if(gi(t,n))return;SA.set(n),i.uniformMatrix2fv(this.addr,!1,SA),mi(t,n)}}function qB(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(gi(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),mi(t,e)}else{if(gi(t,n))return;wA.set(n),i.uniformMatrix3fv(this.addr,!1,wA),mi(t,n)}}function XB(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(gi(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),mi(t,e)}else{if(gi(t,n))return;bA.set(n),i.uniformMatrix4fv(this.addr,!1,bA),mi(t,n)}}function YB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function KB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;i.uniform2iv(this.addr,e),mi(t,e)}}function ZB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(gi(t,e))return;i.uniform3iv(this.addr,e),mi(t,e)}}function QB(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;i.uniform4iv(this.addr,e),mi(t,e)}}function JB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function e4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;i.uniform2uiv(this.addr,e),mi(t,e)}}function t4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(gi(t,e))return;i.uniform3uiv(this.addr,e),mi(t,e)}}function n4(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;i.uniform4uiv(this.addr,e),mi(t,e)}}function i4(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(Ib.compareFunction=t.isReversedDepthBuffer()?Mp:Tp,s=Ib):s=nN,t.setTexture2D(e||s,r)}function r4(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||rN,r)}function s4(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||sN,r)}function a4(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||iN,r)}function o4(i){switch(i){case 5126:return VB;case 35664:return jB;case 35665:return HB;case 35666:return WB;case 35674:return $B;case 35675:return qB;case 35676:return XB;case 5124:case 35670:return YB;case 35667:case 35671:return KB;case 35668:case 35672:return ZB;case 35669:case 35673:return QB;case 5125:return JB;case 36294:return e4;case 36295:return t4;case 36296:return n4;case 35678:case 36198:case 36298:case 36306:case 35682:return i4;case 35679:case 36299:case 36307:return r4;case 35680:case 36300:case 36308:case 36293:return s4;case 36289:case 36303:case 36311:case 36292:return a4}}function l4(i,e){i.uniform1fv(this.addr,e)}function u4(i,e){const t=Jh(e,this.size,2);i.uniform2fv(this.addr,t)}function c4(i,e){const t=Jh(e,this.size,3);i.uniform3fv(this.addr,t)}function h4(i,e){const t=Jh(e,this.size,4);i.uniform4fv(this.addr,t)}function d4(i,e){const t=Jh(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function f4(i,e){const t=Jh(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function p4(i,e){const t=Jh(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function g4(i,e){i.uniform1iv(this.addr,e)}function m4(i,e){i.uniform2iv(this.addr,e)}function _4(i,e){i.uniform3iv(this.addr,e)}function y4(i,e){i.uniform4iv(this.addr,e)}function v4(i,e){i.uniform1uiv(this.addr,e)}function x4(i,e){i.uniform2uiv(this.addr,e)}function b4(i,e){i.uniform3uiv(this.addr,e)}function w4(i,e){i.uniform4uiv(this.addr,e)}function S4(i,e,t){const n=this.cache,r=e.length,s=a_(t,r);gi(n,s)||(i.uniform1iv(this.addr,s),mi(n,s));let a;this.type===i.SAMPLER_2D_SHADOW?a=Ib:a=nN;for(let o=0;o!==r;++o)t.setTexture2D(e[o]||a,s[o])}function T4(i,e,t){const n=this.cache,r=e.length,s=a_(t,r);gi(n,s)||(i.uniform1iv(this.addr,s),mi(n,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||rN,s[a])}function M4(i,e,t){const n=this.cache,r=e.length,s=a_(t,r);gi(n,s)||(i.uniform1iv(this.addr,s),mi(n,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||sN,s[a])}function A4(i,e,t){const n=this.cache,r=e.length,s=a_(t,r);gi(n,s)||(i.uniform1iv(this.addr,s),mi(n,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||iN,s[a])}function E4(i){switch(i){case 5126:return l4;case 35664:return u4;case 35665:return c4;case 35666:return h4;case 35674:return d4;case 35675:return f4;case 35676:return p4;case 5124:case 35670:return g4;case 35667:case 35671:return m4;case 35668:case 35672:return _4;case 35669:case 35673:return y4;case 5125:return v4;case 36294:return x4;case 36295:return b4;case 36296:return w4;case 35678:case 36198:case 36298:case 36306:case 35682:return S4;case 35679:case 36299:case 36307:return T4;case 35680:case 36300:case 36308:case 36293:return M4;case 36289:case 36303:case 36311:case 36292:return A4}}class C4{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=o4(t.type)}}class R4{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=E4(t.type)}}class N4{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,t[o.id],n)}}}const Vv=/(\w+)(\])?(\[|\.)?/g;function TA(i,e){i.seq.push(e),i.map[e.id]=e}function P4(i,e,t){const n=i.name,r=n.length;for(Vv.lastIndex=0;;){const s=Vv.exec(n),a=Vv.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===r){TA(t,c===void 0?new C4(o,i,e):new R4(o,i,e));break}else{let f=t.map[o];f===void 0&&(f=new N4(o),TA(t,f)),t=f}}}class x0{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const o=e.getActiveUniform(t,a),l=e.getUniformLocation(t,o.name);P4(o,l,this)}const r=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(a):s.push(a);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=n[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function MA(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const D4=37297;let k4=0;function I4(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const o=a+1;n.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return n.join(`
`)}const AA=new Ft;function L4(i){bt._getMatrix(AA,bt.workingColorSpace,i);const e=`mat3( ${AA.elements.map(t=>t.toFixed(4))} )`;switch(bt.getTransfer(i)){case Fh:return[e,"LinearTransferOETF"];case Ze:return[e,"sRGBTransferOETF"];default:return Ae("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function EA(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+I4(i.getShaderSource(e),o)}else return s}function F4(i,e){const t=L4(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const U4={[Ow]:"Linear",[Bw]:"Reinhard",[zw]:"Cineon",[Gw]:"ACESFilmic",[Vw]:"AgX",[jw]:"Neutral",[ER]:"Custom"};function O4(i,e){const t=U4[e];return t===void 0?(Ae("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const hm=new X;function B4(){bt.getLuminanceCoefficients(hm);const i=hm.x.toFixed(4),e=hm.y.toFixed(4),t=hm.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function z4(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Af).join(`
`)}function G4(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function V4(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let o=1;s.type===i.FLOAT_MAT2&&(o=2),s.type===i.FLOAT_MAT3&&(o=3),s.type===i.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:o}}return t}function Af(i){return i!==""}function CA(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function RA(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const j4=/^[ \t]*#include +<([\w\d./]+)>/gm;function Lb(i){return i.replace(j4,W4)}const H4=new Map;function W4(i,e){let t=jt[e];if(t===void 0){const n=H4.get(e);if(n!==void 0)t=jt[n],Ae('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Lb(t)}const $4=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function NA(i){return i.replace($4,q4)}function q4(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function PA(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const X4={[If]:"SHADOWMAP_TYPE_PCF",[ao]:"SHADOWMAP_TYPE_VSM"};function Y4(i){return X4[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const K4={[Xs]:"ENVMAP_TYPE_CUBE",[wa]:"ENVMAP_TYPE_CUBE",[xu]:"ENVMAP_TYPE_CUBE_UV"};function Z4(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":K4[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const Q4={[wa]:"ENVMAP_MODE_REFRACTION"};function J4(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":Q4[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const ez={[xp]:"ENVMAP_BLENDING_MULTIPLY",[MR]:"ENVMAP_BLENDING_MIX",[AR]:"ENVMAP_BLENDING_ADD"};function tz(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":ez[i.combine]||"ENVMAP_BLENDING_NONE"}function nz(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function iz(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=Y4(t),c=Z4(t),d=J4(t),f=tz(t),p=nz(t),m=z4(t),_=G4(s),b=r.createProgram();let v,y,S=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Af).join(`
`),v.length>0&&(v+=`
`),y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Af).join(`
`),y.length>0&&(y+=`
`)):(v=[PA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Af).join(`
`),y=[PA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Di?"#define TONE_MAPPING":"",t.toneMapping!==Di?jt.tonemapping_pars_fragment:"",t.toneMapping!==Di?O4("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",jt.colorspace_pars_fragment,F4("linearToOutputTexel",t.outputColorSpace),B4(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Af).join(`
`)),a=Lb(a),a=CA(a,t),a=RA(a,t),o=Lb(o),o=CA(o,t),o=RA(o,t),a=NA(a),o=NA(o),t.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,v=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,y=["#define varying in",t.glslVersion===jM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===jM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const T=S+v+a,E=S+y+o,N=MA(r,r.VERTEX_SHADER,T),M=MA(r,r.FRAGMENT_SHADER,E);r.attachShader(b,N),r.attachShader(b,M),t.index0AttributeName!==void 0?r.bindAttribLocation(b,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(b,0,"position"),r.linkProgram(b);function C(L){if(i.debug.checkShaderErrors){const z=r.getProgramInfoLog(b)||"",B=r.getShaderInfoLog(N)||"",O=r.getShaderInfoLog(M)||"",V=z.trim(),Y=B.trim(),G=O.trim();let W=!0,te=!0;if(r.getProgramParameter(b,r.LINK_STATUS)===!1)if(W=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,b,N,M);else{const U=EA(r,N,"vertex"),H=EA(r,M,"fragment");Ee("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(b,r.VALIDATE_STATUS)+`

Material Name: `+L.name+`
Material Type: `+L.type+`

Program Info Log: `+V+`
`+U+`
`+H)}else V!==""?Ae("WebGLProgram: Program Info Log:",V):(Y===""||G==="")&&(te=!1);te&&(L.diagnostics={runnable:W,programLog:V,vertexShader:{log:Y,prefix:v},fragmentShader:{log:G,prefix:y}})}r.deleteShader(N),r.deleteShader(M),D=new x0(r,b),R=V4(r,b)}let D;this.getUniforms=function(){return D===void 0&&C(this),D};let R;this.getAttributes=function(){return R===void 0&&C(this),R};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=r.getProgramParameter(b,D4)),P},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=k4++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=N,this.fragmentShader=M,this}let rz=0;class sz{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new az(e),t.set(e,n)),n}}class az{constructor(e){this.id=rz++,this.code=e,this.usedTimes=0}}function oz(i,e,t,n,r,s,a){const o=new iS,l=new sz,c=new Set,d=[],f=new Map,p=r.logarithmicDepthBuffer;let m=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(R){return c.add(R),R===0?"uv":`uv${R}`}function v(R,P,L,z,B){const O=z.fog,V=B.geometry,Y=R.isMeshStandardMaterial?z.environment:null,G=(R.isMeshStandardMaterial?t:e).get(R.envMap||Y),W=G&&G.mapping===xu?G.image.height:null,te=_[R.type];R.precision!==null&&(m=r.getMaxPrecision(R.precision),m!==R.precision&&Ae("WebGLProgram.getParameters:",R.precision,"not supported, using",m,"instead."));const U=V.morphAttributes.position||V.morphAttributes.normal||V.morphAttributes.color,H=U!==void 0?U.length:0;let le=0;V.morphAttributes.position!==void 0&&(le=1),V.morphAttributes.normal!==void 0&&(le=2),V.morphAttributes.color!==void 0&&(le=3);let Te,Fe,ie,q;if(te){const rn=fa[te];Te=rn.vertexShader,Fe=rn.fragmentShader}else Te=R.vertexShader,Fe=R.fragmentShader,l.update(R),ie=l.getVertexShaderID(R),q=l.getFragmentShaderID(R);const re=i.getRenderTarget(),we=i.state.buffers.depth.getReversed(),He=B.isInstancedMesh===!0,Be=B.isBatchedMesh===!0,pt=!!R.map,ln=!!R.matcap,Dt=!!G,zt=!!R.aoMap,Yt=!!R.lightMap,Ct=!!R.bumpMap,tn=!!R.normalMap,Z=!!R.displacementMap,Gn=!!R.emissiveMap,Kt=!!R.metalnessMap,nn=!!R.roughnessMap,ut=R.anisotropy>0,j=R.clearcoat>0,k=R.dispersion>0,se=R.iridescence>0,Me=R.sheen>0,Re=R.transmission>0,be=ut&&!!R.anisotropyMap,dt=j&&!!R.clearcoatMap,ze=j&&!!R.clearcoatNormalMap,it=j&&!!R.clearcoatRoughnessMap,Rt=se&&!!R.iridescenceMap,Ie=se&&!!R.iridescenceThicknessMap,We=Me&&!!R.sheenColorMap,ot=Me&&!!R.sheenRoughnessMap,ct=!!R.specularMap,Ve=!!R.specularColorMap,Ot=!!R.specularIntensityMap,J=Re&&!!R.transmissionMap,qe=Re&&!!R.thicknessMap,Le=!!R.gradientMap,Ye=!!R.alphaMap,De=R.alphaTest>0,Ce=!!R.alphaHash,je=!!R.extensions;let Nt=Di;R.toneMapped&&(re===null||re.isXRRenderTarget===!0)&&(Nt=i.toneMapping);const xn={shaderID:te,shaderType:R.type,shaderName:R.name,vertexShader:Te,fragmentShader:Fe,defines:R.defines,customVertexShaderID:ie,customFragmentShaderID:q,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:m,batching:Be,batchingColor:Be&&B._colorsTexture!==null,instancing:He,instancingColor:He&&B.instanceColor!==null,instancingMorph:He&&B.morphTexture!==null,outputColorSpace:re===null?i.outputColorSpace:re.isXRRenderTarget===!0?re.texture.colorSpace:Mu,alphaToCoverage:!!R.alphaToCoverage,map:pt,matcap:ln,envMap:Dt,envMapMode:Dt&&G.mapping,envMapCubeUVHeight:W,aoMap:zt,lightMap:Yt,bumpMap:Ct,normalMap:tn,displacementMap:Z,emissiveMap:Gn,normalMapObjectSpace:tn&&R.normalMapType===CR,normalMapTangentSpace:tn&&R.normalMapType===ba,metalnessMap:Kt,roughnessMap:nn,anisotropy:ut,anisotropyMap:be,clearcoat:j,clearcoatMap:dt,clearcoatNormalMap:ze,clearcoatRoughnessMap:it,dispersion:k,iridescence:se,iridescenceMap:Rt,iridescenceThicknessMap:Ie,sheen:Me,sheenColorMap:We,sheenRoughnessMap:ot,specularMap:ct,specularColorMap:Ve,specularIntensityMap:Ot,transmission:Re,transmissionMap:J,thicknessMap:qe,gradientMap:Le,opaque:R.transparent===!1&&R.blending===Qr&&R.alphaToCoverage===!1,alphaMap:Ye,alphaTest:De,alphaHash:Ce,combine:R.combine,mapUv:pt&&b(R.map.channel),aoMapUv:zt&&b(R.aoMap.channel),lightMapUv:Yt&&b(R.lightMap.channel),bumpMapUv:Ct&&b(R.bumpMap.channel),normalMapUv:tn&&b(R.normalMap.channel),displacementMapUv:Z&&b(R.displacementMap.channel),emissiveMapUv:Gn&&b(R.emissiveMap.channel),metalnessMapUv:Kt&&b(R.metalnessMap.channel),roughnessMapUv:nn&&b(R.roughnessMap.channel),anisotropyMapUv:be&&b(R.anisotropyMap.channel),clearcoatMapUv:dt&&b(R.clearcoatMap.channel),clearcoatNormalMapUv:ze&&b(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:it&&b(R.clearcoatRoughnessMap.channel),iridescenceMapUv:Rt&&b(R.iridescenceMap.channel),iridescenceThicknessMapUv:Ie&&b(R.iridescenceThicknessMap.channel),sheenColorMapUv:We&&b(R.sheenColorMap.channel),sheenRoughnessMapUv:ot&&b(R.sheenRoughnessMap.channel),specularMapUv:ct&&b(R.specularMap.channel),specularColorMapUv:Ve&&b(R.specularColorMap.channel),specularIntensityMapUv:Ot&&b(R.specularIntensityMap.channel),transmissionMapUv:J&&b(R.transmissionMap.channel),thicknessMapUv:qe&&b(R.thicknessMap.channel),alphaMapUv:Ye&&b(R.alphaMap.channel),vertexTangents:!!V.attributes.tangent&&(tn||ut),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!V.attributes.color&&V.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!V.attributes.uv&&(pt||Ye),fog:!!O,useFog:R.fog===!0,fogExp2:!!O&&O.isFogExp2,flatShading:R.flatShading===!0&&R.wireframe===!1,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:p,reversedDepthBuffer:we,skinning:B.isSkinnedMesh===!0,morphTargets:V.morphAttributes.position!==void 0,morphNormals:V.morphAttributes.normal!==void 0,morphColors:V.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:le,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:R.dithering,shadowMapEnabled:i.shadowMap.enabled&&L.length>0,shadowMapType:i.shadowMap.type,toneMapping:Nt,decodeVideoTexture:pt&&R.map.isVideoTexture===!0&&bt.getTransfer(R.map.colorSpace)===Ze,decodeVideoTextureEmissive:Gn&&R.emissiveMap.isVideoTexture===!0&&bt.getTransfer(R.emissiveMap.colorSpace)===Ze,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===Xi,flipSided:R.side===En,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:je&&R.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(je&&R.extensions.multiDraw===!0||Be)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return xn.vertexUv1s=c.has(1),xn.vertexUv2s=c.has(2),xn.vertexUv3s=c.has(3),c.clear(),xn}function y(R){const P=[];if(R.shaderID?P.push(R.shaderID):(P.push(R.customVertexShaderID),P.push(R.customFragmentShaderID)),R.defines!==void 0)for(const L in R.defines)P.push(L),P.push(R.defines[L]);return R.isRawShaderMaterial===!1&&(S(P,R),T(P,R),P.push(i.outputColorSpace)),P.push(R.customProgramCacheKey),P.join()}function S(R,P){R.push(P.precision),R.push(P.outputColorSpace),R.push(P.envMapMode),R.push(P.envMapCubeUVHeight),R.push(P.mapUv),R.push(P.alphaMapUv),R.push(P.lightMapUv),R.push(P.aoMapUv),R.push(P.bumpMapUv),R.push(P.normalMapUv),R.push(P.displacementMapUv),R.push(P.emissiveMapUv),R.push(P.metalnessMapUv),R.push(P.roughnessMapUv),R.push(P.anisotropyMapUv),R.push(P.clearcoatMapUv),R.push(P.clearcoatNormalMapUv),R.push(P.clearcoatRoughnessMapUv),R.push(P.iridescenceMapUv),R.push(P.iridescenceThicknessMapUv),R.push(P.sheenColorMapUv),R.push(P.sheenRoughnessMapUv),R.push(P.specularMapUv),R.push(P.specularColorMapUv),R.push(P.specularIntensityMapUv),R.push(P.transmissionMapUv),R.push(P.thicknessMapUv),R.push(P.combine),R.push(P.fogExp2),R.push(P.sizeAttenuation),R.push(P.morphTargetsCount),R.push(P.morphAttributeCount),R.push(P.numDirLights),R.push(P.numPointLights),R.push(P.numSpotLights),R.push(P.numSpotLightMaps),R.push(P.numHemiLights),R.push(P.numRectAreaLights),R.push(P.numDirLightShadows),R.push(P.numPointLightShadows),R.push(P.numSpotLightShadows),R.push(P.numSpotLightShadowsWithMaps),R.push(P.numLightProbes),R.push(P.shadowMapType),R.push(P.toneMapping),R.push(P.numClippingPlanes),R.push(P.numClipIntersection),R.push(P.depthPacking)}function T(R,P){o.disableAll(),P.instancing&&o.enable(0),P.instancingColor&&o.enable(1),P.instancingMorph&&o.enable(2),P.matcap&&o.enable(3),P.envMap&&o.enable(4),P.normalMapObjectSpace&&o.enable(5),P.normalMapTangentSpace&&o.enable(6),P.clearcoat&&o.enable(7),P.iridescence&&o.enable(8),P.alphaTest&&o.enable(9),P.vertexColors&&o.enable(10),P.vertexAlphas&&o.enable(11),P.vertexUv1s&&o.enable(12),P.vertexUv2s&&o.enable(13),P.vertexUv3s&&o.enable(14),P.vertexTangents&&o.enable(15),P.anisotropy&&o.enable(16),P.alphaHash&&o.enable(17),P.batching&&o.enable(18),P.dispersion&&o.enable(19),P.batchingColor&&o.enable(20),P.gradientMap&&o.enable(21),R.push(o.mask),o.disableAll(),P.fog&&o.enable(0),P.useFog&&o.enable(1),P.flatShading&&o.enable(2),P.logarithmicDepthBuffer&&o.enable(3),P.reversedDepthBuffer&&o.enable(4),P.skinning&&o.enable(5),P.morphTargets&&o.enable(6),P.morphNormals&&o.enable(7),P.morphColors&&o.enable(8),P.premultipliedAlpha&&o.enable(9),P.shadowMapEnabled&&o.enable(10),P.doubleSided&&o.enable(11),P.flipSided&&o.enable(12),P.useDepthPacking&&o.enable(13),P.dithering&&o.enable(14),P.transmission&&o.enable(15),P.sheen&&o.enable(16),P.opaque&&o.enable(17),P.pointsUvs&&o.enable(18),P.decodeVideoTexture&&o.enable(19),P.decodeVideoTextureEmissive&&o.enable(20),P.alphaToCoverage&&o.enable(21),R.push(o.mask)}function E(R){const P=_[R.type];let L;if(P){const z=fa[P];L=BR.clone(z.uniforms)}else L=R.uniforms;return L}function N(R,P){let L=f.get(P);return L!==void 0?++L.usedTimes:(L=new iz(i,P,R,s),d.push(L),f.set(P,L)),L}function M(R){if(--R.usedTimes===0){const P=d.indexOf(R);d[P]=d[d.length-1],d.pop(),f.delete(R.cacheKey),R.destroy()}}function C(R){l.remove(R)}function D(){l.dispose()}return{getParameters:v,getProgramCacheKey:y,getUniforms:E,acquireProgram:N,releaseProgram:M,releaseShaderCache:C,programs:d,dispose:D}}function lz(){let i=new WeakMap;function e(a){return i.has(a)}function t(a){let o=i.get(a);return o===void 0&&(o={},i.set(a,o)),o}function n(a){i.delete(a)}function r(a,o,l){i.get(a)[o]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function uz(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function DA(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function kA(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function a(f,p,m,_,b,v){let y=i[e];return y===void 0?(y={id:f.id,object:f,geometry:p,material:m,groupOrder:_,renderOrder:f.renderOrder,z:b,group:v},i[e]=y):(y.id=f.id,y.object=f,y.geometry=p,y.material=m,y.groupOrder=_,y.renderOrder=f.renderOrder,y.z=b,y.group=v),e++,y}function o(f,p,m,_,b,v){const y=a(f,p,m,_,b,v);m.transmission>0?n.push(y):m.transparent===!0?r.push(y):t.push(y)}function l(f,p,m,_,b,v){const y=a(f,p,m,_,b,v);m.transmission>0?n.unshift(y):m.transparent===!0?r.unshift(y):t.unshift(y)}function c(f,p){t.length>1&&t.sort(f||uz),n.length>1&&n.sort(p||DA),r.length>1&&r.sort(p||DA)}function d(){for(let f=e,p=i.length;f<p;f++){const m=i[f];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:o,unshift:l,finish:d,sort:c}}function cz(){let i=new WeakMap;function e(n,r){const s=i.get(n);let a;return s===void 0?(a=new kA,i.set(n,[a])):r>=s.length?(a=new kA,s.push(a)):a=s[r],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function hz(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new X,color:new _t};break;case"SpotLight":t={position:new X,direction:new X,color:new _t,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new X,color:new _t,distance:0,decay:0};break;case"HemisphereLight":t={direction:new X,skyColor:new _t,groundColor:new _t};break;case"RectAreaLight":t={color:new _t,position:new X,halfWidth:new X,halfHeight:new X};break}return i[e.id]=t,t}}}function dz(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let fz=0;function pz(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function gz(i){const e=new hz,t=dz(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new X);const r=new X,s=new hn,a=new hn;function o(c){let d=0,f=0,p=0;for(let R=0;R<9;R++)n.probe[R].set(0,0,0);let m=0,_=0,b=0,v=0,y=0,S=0,T=0,E=0,N=0,M=0,C=0;c.sort(pz);for(let R=0,P=c.length;R<P;R++){const L=c[R],z=L.color,B=L.intensity,O=L.distance;let V=null;if(L.shadow&&L.shadow.map&&(L.shadow.map.texture.format===dr?V=L.shadow.map.texture:V=L.shadow.map.depthTexture||L.shadow.map.texture),L.isAmbientLight)d+=z.r*B,f+=z.g*B,p+=z.b*B;else if(L.isLightProbe){for(let Y=0;Y<9;Y++)n.probe[Y].addScaledVector(L.sh.coefficients[Y],B);C++}else if(L.isDirectionalLight){const Y=e.get(L);if(Y.color.copy(L.color).multiplyScalar(L.intensity),L.castShadow){const G=L.shadow,W=t.get(L);W.shadowIntensity=G.intensity,W.shadowBias=G.bias,W.shadowNormalBias=G.normalBias,W.shadowRadius=G.radius,W.shadowMapSize=G.mapSize,n.directionalShadow[m]=W,n.directionalShadowMap[m]=V,n.directionalShadowMatrix[m]=L.shadow.matrix,S++}n.directional[m]=Y,m++}else if(L.isSpotLight){const Y=e.get(L);Y.position.setFromMatrixPosition(L.matrixWorld),Y.color.copy(z).multiplyScalar(B),Y.distance=O,Y.coneCos=Math.cos(L.angle),Y.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),Y.decay=L.decay,n.spot[b]=Y;const G=L.shadow;if(L.map&&(n.spotLightMap[N]=L.map,N++,G.updateMatrices(L),L.castShadow&&M++),n.spotLightMatrix[b]=G.matrix,L.castShadow){const W=t.get(L);W.shadowIntensity=G.intensity,W.shadowBias=G.bias,W.shadowNormalBias=G.normalBias,W.shadowRadius=G.radius,W.shadowMapSize=G.mapSize,n.spotShadow[b]=W,n.spotShadowMap[b]=V,E++}b++}else if(L.isRectAreaLight){const Y=e.get(L);Y.color.copy(z).multiplyScalar(B),Y.halfWidth.set(L.width*.5,0,0),Y.halfHeight.set(0,L.height*.5,0),n.rectArea[v]=Y,v++}else if(L.isPointLight){const Y=e.get(L);if(Y.color.copy(L.color).multiplyScalar(L.intensity),Y.distance=L.distance,Y.decay=L.decay,L.castShadow){const G=L.shadow,W=t.get(L);W.shadowIntensity=G.intensity,W.shadowBias=G.bias,W.shadowNormalBias=G.normalBias,W.shadowRadius=G.radius,W.shadowMapSize=G.mapSize,W.shadowCameraNear=G.camera.near,W.shadowCameraFar=G.camera.far,n.pointShadow[_]=W,n.pointShadowMap[_]=V,n.pointShadowMatrix[_]=L.shadow.matrix,T++}n.point[_]=Y,_++}else if(L.isHemisphereLight){const Y=e.get(L);Y.skyColor.copy(L.color).multiplyScalar(B),Y.groundColor.copy(L.groundColor).multiplyScalar(B),n.hemi[y]=Y,y++}}v>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ke.LTC_FLOAT_1,n.rectAreaLTC2=Ke.LTC_FLOAT_2):(n.rectAreaLTC1=Ke.LTC_HALF_1,n.rectAreaLTC2=Ke.LTC_HALF_2)),n.ambient[0]=d,n.ambient[1]=f,n.ambient[2]=p;const D=n.hash;(D.directionalLength!==m||D.pointLength!==_||D.spotLength!==b||D.rectAreaLength!==v||D.hemiLength!==y||D.numDirectionalShadows!==S||D.numPointShadows!==T||D.numSpotShadows!==E||D.numSpotMaps!==N||D.numLightProbes!==C)&&(n.directional.length=m,n.spot.length=b,n.rectArea.length=v,n.point.length=_,n.hemi.length=y,n.directionalShadow.length=S,n.directionalShadowMap.length=S,n.pointShadow.length=T,n.pointShadowMap.length=T,n.spotShadow.length=E,n.spotShadowMap.length=E,n.directionalShadowMatrix.length=S,n.pointShadowMatrix.length=T,n.spotLightMatrix.length=E+N-M,n.spotLightMap.length=N,n.numSpotLightShadowsWithMaps=M,n.numLightProbes=C,D.directionalLength=m,D.pointLength=_,D.spotLength=b,D.rectAreaLength=v,D.hemiLength=y,D.numDirectionalShadows=S,D.numPointShadows=T,D.numSpotShadows=E,D.numSpotMaps=N,D.numLightProbes=C,n.version=fz++)}function l(c,d){let f=0,p=0,m=0,_=0,b=0;const v=d.matrixWorldInverse;for(let y=0,S=c.length;y<S;y++){const T=c[y];if(T.isDirectionalLight){const E=n.directional[f];E.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),f++}else if(T.isSpotLight){const E=n.spot[m];E.position.setFromMatrixPosition(T.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),m++}else if(T.isRectAreaLight){const E=n.rectArea[_];E.position.setFromMatrixPosition(T.matrixWorld),E.position.applyMatrix4(v),a.identity(),s.copy(T.matrixWorld),s.premultiply(v),a.extractRotation(s),E.halfWidth.set(T.width*.5,0,0),E.halfHeight.set(0,T.height*.5,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),_++}else if(T.isPointLight){const E=n.point[p];E.position.setFromMatrixPosition(T.matrixWorld),E.position.applyMatrix4(v),p++}else if(T.isHemisphereLight){const E=n.hemi[b];E.direction.setFromMatrixPosition(T.matrixWorld),E.direction.transformDirection(v),b++}}}return{setup:o,setupView:l,state:n}}function IA(i){const e=new gz(i),t=[],n=[];function r(d){c.camera=d,t.length=0,n.length=0}function s(d){t.push(d)}function a(d){n.push(d)}function o(){e.setup(t)}function l(d){e.setupView(t,d)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function mz(i){let e=new WeakMap;function t(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new IA(i),e.set(r,[o])):s>=a.length?(o=new IA(i),a.push(o)):o=a[s],o}function n(){e=new WeakMap}return{get:t,dispose:n}}const _z=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,yz=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,vz=[new X(1,0,0),new X(-1,0,0),new X(0,1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1)],xz=[new X(0,-1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1),new X(0,-1,0),new X(0,-1,0)],LA=new hn,Jd=new X,jv=new X;function bz(i,e,t){let n=new Ep;const r=new Xe,s=new Xe,a=new It,o=new SF,l=new TF,c={},d=t.maxTextureSize,f={[Zr]:En,[En]:Zr,[Xi]:Xi},p=new vs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:_z,fragmentShader:yz}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const _=new es;_.setAttribute("position",new Ki(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new pi(_,p),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=If;let y=this.type;this.render=function(M,C,D){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||M.length===0)return;M.type===iL&&(Ae("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),M.type=If);const R=i.getRenderTarget(),P=i.getActiveCubeFace(),L=i.getActiveMipmapLevel(),z=i.state;z.setBlending(pr),z.buffers.depth.getReversed()===!0?z.buffers.color.setClear(0,0,0,0):z.buffers.color.setClear(1,1,1,1),z.buffers.depth.setTest(!0),z.setScissorTest(!1);const B=y!==this.type;B&&C.traverse(function(O){O.material&&(Array.isArray(O.material)?O.material.forEach(V=>V.needsUpdate=!0):O.material.needsUpdate=!0)});for(let O=0,V=M.length;O<V;O++){const Y=M[O],G=Y.shadow;if(G===void 0){Ae("WebGLShadowMap:",Y,"has no shadow.");continue}if(G.autoUpdate===!1&&G.needsUpdate===!1)continue;r.copy(G.mapSize);const W=G.getFrameExtents();if(r.multiply(W),s.copy(G.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/W.x),r.x=s.x*W.x,G.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/W.y),r.y=s.y*W.y,G.mapSize.y=s.y)),G.map===null||B===!0){if(G.map!==null&&(G.map.depthTexture!==null&&(G.map.depthTexture.dispose(),G.map.depthTexture=null),G.map.dispose()),this.type===ao){if(Y.isPointLight){Ae("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}G.map=new Ws(r.x,r.y,{format:dr,type:Wn,minFilter:In,magFilter:In,generateMipmaps:!1}),G.map.texture.name=Y.name+".shadowMap",G.map.depthTexture=new gr(r.x,r.y,Qn),G.map.depthTexture.name=Y.name+".shadowMapDepth",G.map.depthTexture.format=ki,G.map.depthTexture.compareFunction=null,G.map.depthTexture.minFilter=vn,G.map.depthTexture.magFilter=vn}else{Y.isPointLight?(G.map=new oS(r.x),G.map.depthTexture=new HR(r.x,yn)):(G.map=new Ws(r.x,r.y),G.map.depthTexture=new gr(r.x,r.y,yn)),G.map.depthTexture.name=Y.name+".shadowMap",G.map.depthTexture.format=ki;const U=i.state.buffers.depth.getReversed();this.type===If?(G.map.depthTexture.compareFunction=U?Mp:Tp,G.map.depthTexture.minFilter=In,G.map.depthTexture.magFilter=In):(G.map.depthTexture.compareFunction=null,G.map.depthTexture.minFilter=vn,G.map.depthTexture.magFilter=vn)}G.camera.updateProjectionMatrix()}const te=G.map.isWebGLCubeRenderTarget?6:1;for(let U=0;U<te;U++){if(G.map.isWebGLCubeRenderTarget)i.setRenderTarget(G.map,U),i.clear();else{U===0&&(i.setRenderTarget(G.map),i.clear());const H=G.getViewport(U);a.set(s.x*H.x,s.y*H.y,s.x*H.z,s.y*H.w),z.viewport(a)}if(Y.isPointLight){const H=G.camera,le=G.matrix,Te=Y.distance||H.far;Te!==H.far&&(H.far=Te,H.updateProjectionMatrix()),Jd.setFromMatrixPosition(Y.matrixWorld),H.position.copy(Jd),jv.copy(H.position),jv.add(vz[U]),H.up.copy(xz[U]),H.lookAt(jv),H.updateMatrixWorld(),le.makeTranslation(-Jd.x,-Jd.y,-Jd.z),LA.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse),G._frustum.setFromProjectionMatrix(LA,H.coordinateSystem,H.reversedDepth)}else G.updateMatrices(Y);n=G.getFrustum(),E(C,D,G.camera,Y,this.type)}G.isPointLightShadow!==!0&&this.type===ao&&S(G,D),G.needsUpdate=!1}y=this.type,v.needsUpdate=!1,i.setRenderTarget(R,P,L)};function S(M,C){const D=e.update(b);p.defines.VSM_SAMPLES!==M.blurSamples&&(p.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Ws(r.x,r.y,{format:dr,type:Wn})),p.uniforms.shadow_pass.value=M.map.depthTexture,p.uniforms.resolution.value=M.mapSize,p.uniforms.radius.value=M.radius,i.setRenderTarget(M.mapPass),i.clear(),i.renderBufferDirect(C,null,D,p,b,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,i.setRenderTarget(M.map),i.clear(),i.renderBufferDirect(C,null,D,m,b,null)}function T(M,C,D,R){let P=null;const L=D.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(L!==void 0)P=L;else if(P=D.isPointLight===!0?l:o,i.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0||C.alphaToCoverage===!0){const z=P.uuid,B=C.uuid;let O=c[z];O===void 0&&(O={},c[z]=O);let V=O[B];V===void 0&&(V=P.clone(),O[B]=V,C.addEventListener("dispose",N)),P=V}if(P.visible=C.visible,P.wireframe=C.wireframe,R===ao?P.side=C.shadowSide!==null?C.shadowSide:C.side:P.side=C.shadowSide!==null?C.shadowSide:f[C.side],P.alphaMap=C.alphaMap,P.alphaTest=C.alphaToCoverage===!0?.5:C.alphaTest,P.map=C.map,P.clipShadows=C.clipShadows,P.clippingPlanes=C.clippingPlanes,P.clipIntersection=C.clipIntersection,P.displacementMap=C.displacementMap,P.displacementScale=C.displacementScale,P.displacementBias=C.displacementBias,P.wireframeLinewidth=C.wireframeLinewidth,P.linewidth=C.linewidth,D.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const z=i.properties.get(P);z.light=D}return P}function E(M,C,D,R,P){if(M.visible===!1)return;if(M.layers.test(C.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&P===ao)&&(!M.frustumCulled||n.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,M.matrixWorld);const B=e.update(M),O=M.material;if(Array.isArray(O)){const V=B.groups;for(let Y=0,G=V.length;Y<G;Y++){const W=V[Y],te=O[W.materialIndex];if(te&&te.visible){const U=T(M,te,R,P);M.onBeforeShadow(i,M,C,D,B,U,W),i.renderBufferDirect(D,null,B,U,M,W),M.onAfterShadow(i,M,C,D,B,U,W)}}}else if(O.visible){const V=T(M,O,R,P);M.onBeforeShadow(i,M,C,D,B,V,null),i.renderBufferDirect(D,null,B,V,M,null),M.onAfterShadow(i,M,C,D,B,V,null)}}const z=M.children;for(let B=0,O=z.length;B<O;B++)E(z[B],C,D,R,P)}function N(M){M.target.removeEventListener("dispose",N);for(const D in c){const R=c[D],P=M.target.uuid;P in R&&(R[P].dispose(),delete R[P])}}}const wz={[Jf]:ep,[tp]:rp,[np]:sp,[gl]:ip,[ep]:Jf,[rp]:tp,[sp]:np,[ip]:gl};function Sz(i,e){function t(){let J=!1;const qe=new It;let Le=null;const Ye=new It(0,0,0,0);return{setMask:function(De){Le!==De&&!J&&(i.colorMask(De,De,De,De),Le=De)},setLocked:function(De){J=De},setClear:function(De,Ce,je,Nt,xn){xn===!0&&(De*=Nt,Ce*=Nt,je*=Nt),qe.set(De,Ce,je,Nt),Ye.equals(qe)===!1&&(i.clearColor(De,Ce,je,Nt),Ye.copy(qe))},reset:function(){J=!1,Le=null,Ye.set(-1,0,0,0)}}}function n(){let J=!1,qe=!1,Le=null,Ye=null,De=null;return{setReversed:function(Ce){if(qe!==Ce){const je=e.get("EXT_clip_control");Ce?je.clipControlEXT(je.LOWER_LEFT_EXT,je.ZERO_TO_ONE_EXT):je.clipControlEXT(je.LOWER_LEFT_EXT,je.NEGATIVE_ONE_TO_ONE_EXT),qe=Ce;const Nt=De;De=null,this.setClear(Nt)}},getReversed:function(){return qe},setTest:function(Ce){Ce?re(i.DEPTH_TEST):we(i.DEPTH_TEST)},setMask:function(Ce){Le!==Ce&&!J&&(i.depthMask(Ce),Le=Ce)},setFunc:function(Ce){if(qe&&(Ce=wz[Ce]),Ye!==Ce){switch(Ce){case Jf:i.depthFunc(i.NEVER);break;case ep:i.depthFunc(i.ALWAYS);break;case tp:i.depthFunc(i.LESS);break;case gl:i.depthFunc(i.LEQUAL);break;case np:i.depthFunc(i.EQUAL);break;case ip:i.depthFunc(i.GEQUAL);break;case rp:i.depthFunc(i.GREATER);break;case sp:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Ye=Ce}},setLocked:function(Ce){J=Ce},setClear:function(Ce){De!==Ce&&(qe&&(Ce=1-Ce),i.clearDepth(Ce),De=Ce)},reset:function(){J=!1,Le=null,Ye=null,De=null,qe=!1}}}function r(){let J=!1,qe=null,Le=null,Ye=null,De=null,Ce=null,je=null,Nt=null,xn=null;return{setTest:function(rn){J||(rn?re(i.STENCIL_TEST):we(i.STENCIL_TEST))},setMask:function(rn){qe!==rn&&!J&&(i.stencilMask(rn),qe=rn)},setFunc:function(rn,Ur,tr){(Le!==rn||Ye!==Ur||De!==tr)&&(i.stencilFunc(rn,Ur,tr),Le=rn,Ye=Ur,De=tr)},setOp:function(rn,Ur,tr){(Ce!==rn||je!==Ur||Nt!==tr)&&(i.stencilOp(rn,Ur,tr),Ce=rn,je=Ur,Nt=tr)},setLocked:function(rn){J=rn},setClear:function(rn){xn!==rn&&(i.clearStencil(rn),xn=rn)},reset:function(){J=!1,qe=null,Le=null,Ye=null,De=null,Ce=null,je=null,Nt=null,xn=null}}}const s=new t,a=new n,o=new r,l=new WeakMap,c=new WeakMap;let d={},f={},p=new WeakMap,m=[],_=null,b=!1,v=null,y=null,S=null,T=null,E=null,N=null,M=null,C=new _t(0,0,0),D=0,R=!1,P=null,L=null,z=null,B=null,O=null;const V=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Y=!1,G=0;const W=i.getParameter(i.VERSION);W.indexOf("WebGL")!==-1?(G=parseFloat(/^WebGL (\d)/.exec(W)[1]),Y=G>=1):W.indexOf("OpenGL ES")!==-1&&(G=parseFloat(/^OpenGL ES (\d)/.exec(W)[1]),Y=G>=2);let te=null,U={};const H=i.getParameter(i.SCISSOR_BOX),le=i.getParameter(i.VIEWPORT),Te=new It().fromArray(H),Fe=new It().fromArray(le);function ie(J,qe,Le,Ye){const De=new Uint8Array(4),Ce=i.createTexture();i.bindTexture(J,Ce),i.texParameteri(J,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(J,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let je=0;je<Le;je++)J===i.TEXTURE_3D||J===i.TEXTURE_2D_ARRAY?i.texImage3D(qe,0,i.RGBA,1,1,Ye,0,i.RGBA,i.UNSIGNED_BYTE,De):i.texImage2D(qe+je,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,De);return Ce}const q={};q[i.TEXTURE_2D]=ie(i.TEXTURE_2D,i.TEXTURE_2D,1),q[i.TEXTURE_CUBE_MAP]=ie(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),q[i.TEXTURE_2D_ARRAY]=ie(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),q[i.TEXTURE_3D]=ie(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),re(i.DEPTH_TEST),a.setFunc(gl),Ct(!1),tn(Eb),re(i.CULL_FACE),zt(pr);function re(J){d[J]!==!0&&(i.enable(J),d[J]=!0)}function we(J){d[J]!==!1&&(i.disable(J),d[J]=!1)}function He(J,qe){return f[J]!==qe?(i.bindFramebuffer(J,qe),f[J]=qe,J===i.DRAW_FRAMEBUFFER&&(f[i.FRAMEBUFFER]=qe),J===i.FRAMEBUFFER&&(f[i.DRAW_FRAMEBUFFER]=qe),!0):!1}function Be(J,qe){let Le=m,Ye=!1;if(J){Le=p.get(qe),Le===void 0&&(Le=[],p.set(qe,Le));const De=J.textures;if(Le.length!==De.length||Le[0]!==i.COLOR_ATTACHMENT0){for(let Ce=0,je=De.length;Ce<je;Ce++)Le[Ce]=i.COLOR_ATTACHMENT0+Ce;Le.length=De.length,Ye=!0}}else Le[0]!==i.BACK&&(Le[0]=i.BACK,Ye=!0);Ye&&i.drawBuffers(Le)}function pt(J){return _!==J?(i.useProgram(J),_=J,!0):!1}const ln={[Yi]:i.FUNC_ADD,[Cw]:i.FUNC_SUBTRACT,[Rw]:i.FUNC_REVERSE_SUBTRACT};ln[SR]=i.MIN,ln[TR]=i.MAX;const Dt={[Ja]:i.ZERO,[Nw]:i.ONE,[Pw]:i.SRC_COLOR,[Zf]:i.SRC_ALPHA,[Uw]:i.SRC_ALPHA_SATURATE,[Lw]:i.DST_COLOR,[kw]:i.DST_ALPHA,[Dw]:i.ONE_MINUS_SRC_COLOR,[Qf]:i.ONE_MINUS_SRC_ALPHA,[Fw]:i.ONE_MINUS_DST_COLOR,[Iw]:i.ONE_MINUS_DST_ALPHA,[rL]:i.CONSTANT_COLOR,[sL]:i.ONE_MINUS_CONSTANT_COLOR,[aL]:i.CONSTANT_ALPHA,[oL]:i.ONE_MINUS_CONSTANT_ALPHA};function zt(J,qe,Le,Ye,De,Ce,je,Nt,xn,rn){if(J===pr){b===!0&&(we(i.BLEND),b=!1);return}if(b===!1&&(re(i.BLEND),b=!0),J!==Jc){if(J!==v||rn!==R){if((y!==Yi||E!==Yi)&&(i.blendEquation(i.FUNC_ADD),y=Yi,E=Yi),rn)switch(J){case Qr:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case oh:i.blendFunc(i.ONE,i.ONE);break;case lh:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case uh:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:Ee("WebGLState: Invalid blending: ",J);break}else switch(J){case Qr:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case oh:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case lh:Ee("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case uh:Ee("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Ee("WebGLState: Invalid blending: ",J);break}S=null,T=null,N=null,M=null,C.set(0,0,0),D=0,v=J,R=rn}return}De=De||qe,Ce=Ce||Le,je=je||Ye,(qe!==y||De!==E)&&(i.blendEquationSeparate(ln[qe],ln[De]),y=qe,E=De),(Le!==S||Ye!==T||Ce!==N||je!==M)&&(i.blendFuncSeparate(Dt[Le],Dt[Ye],Dt[Ce],Dt[je]),S=Le,T=Ye,N=Ce,M=je),(Nt.equals(C)===!1||xn!==D)&&(i.blendColor(Nt.r,Nt.g,Nt.b,xn),C.copy(Nt),D=xn),v=J,R=!1}function Yt(J,qe){J.side===Xi?we(i.CULL_FACE):re(i.CULL_FACE);let Le=J.side===En;qe&&(Le=!Le),Ct(Le),J.blending===Qr&&J.transparent===!1?zt(pr):zt(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.blendColor,J.blendAlpha,J.premultipliedAlpha),a.setFunc(J.depthFunc),a.setTest(J.depthTest),a.setMask(J.depthWrite),s.setMask(J.colorWrite);const Ye=J.stencilWrite;o.setTest(Ye),Ye&&(o.setMask(J.stencilWriteMask),o.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),o.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Gn(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?re(i.SAMPLE_ALPHA_TO_COVERAGE):we(i.SAMPLE_ALPHA_TO_COVERAGE)}function Ct(J){P!==J&&(J?i.frontFace(i.CW):i.frontFace(i.CCW),P=J)}function tn(J){J!==bR?(re(i.CULL_FACE),J!==L&&(J===Eb?i.cullFace(i.BACK):J===wR?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):we(i.CULL_FACE),L=J}function Z(J){J!==z&&(Y&&i.lineWidth(J),z=J)}function Gn(J,qe,Le){J?(re(i.POLYGON_OFFSET_FILL),(B!==qe||O!==Le)&&(i.polygonOffset(qe,Le),B=qe,O=Le)):we(i.POLYGON_OFFSET_FILL)}function Kt(J){J?re(i.SCISSOR_TEST):we(i.SCISSOR_TEST)}function nn(J){J===void 0&&(J=i.TEXTURE0+V-1),te!==J&&(i.activeTexture(J),te=J)}function ut(J,qe,Le){Le===void 0&&(te===null?Le=i.TEXTURE0+V-1:Le=te);let Ye=U[Le];Ye===void 0&&(Ye={type:void 0,texture:void 0},U[Le]=Ye),(Ye.type!==J||Ye.texture!==qe)&&(te!==Le&&(i.activeTexture(Le),te=Le),i.bindTexture(J,qe||q[J]),Ye.type=J,Ye.texture=qe)}function j(){const J=U[te];J!==void 0&&J.type!==void 0&&(i.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function k(){try{i.compressedTexImage2D(...arguments)}catch(J){Ee("WebGLState:",J)}}function se(){try{i.compressedTexImage3D(...arguments)}catch(J){Ee("WebGLState:",J)}}function Me(){try{i.texSubImage2D(...arguments)}catch(J){Ee("WebGLState:",J)}}function Re(){try{i.texSubImage3D(...arguments)}catch(J){Ee("WebGLState:",J)}}function be(){try{i.compressedTexSubImage2D(...arguments)}catch(J){Ee("WebGLState:",J)}}function dt(){try{i.compressedTexSubImage3D(...arguments)}catch(J){Ee("WebGLState:",J)}}function ze(){try{i.texStorage2D(...arguments)}catch(J){Ee("WebGLState:",J)}}function it(){try{i.texStorage3D(...arguments)}catch(J){Ee("WebGLState:",J)}}function Rt(){try{i.texImage2D(...arguments)}catch(J){Ee("WebGLState:",J)}}function Ie(){try{i.texImage3D(...arguments)}catch(J){Ee("WebGLState:",J)}}function We(J){Te.equals(J)===!1&&(i.scissor(J.x,J.y,J.z,J.w),Te.copy(J))}function ot(J){Fe.equals(J)===!1&&(i.viewport(J.x,J.y,J.z,J.w),Fe.copy(J))}function ct(J,qe){let Le=c.get(qe);Le===void 0&&(Le=new WeakMap,c.set(qe,Le));let Ye=Le.get(J);Ye===void 0&&(Ye=i.getUniformBlockIndex(qe,J.name),Le.set(J,Ye))}function Ve(J,qe){const Ye=c.get(qe).get(J);l.get(qe)!==Ye&&(i.uniformBlockBinding(qe,Ye,J.__bindingPointIndex),l.set(qe,Ye))}function Ot(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},te=null,U={},f={},p=new WeakMap,m=[],_=null,b=!1,v=null,y=null,S=null,T=null,E=null,N=null,M=null,C=new _t(0,0,0),D=0,R=!1,P=null,L=null,z=null,B=null,O=null,Te.set(0,0,i.canvas.width,i.canvas.height),Fe.set(0,0,i.canvas.width,i.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:re,disable:we,bindFramebuffer:He,drawBuffers:Be,useProgram:pt,setBlending:zt,setMaterial:Yt,setFlipSided:Ct,setCullFace:tn,setLineWidth:Z,setPolygonOffset:Gn,setScissorTest:Kt,activeTexture:nn,bindTexture:ut,unbindTexture:j,compressedTexImage2D:k,compressedTexImage3D:se,texImage2D:Rt,texImage3D:Ie,updateUBOMapping:ct,uniformBlockBinding:Ve,texStorage2D:ze,texStorage3D:it,texSubImage2D:Me,texSubImage3D:Re,compressedTexSubImage2D:be,compressedTexSubImage3D:dt,scissor:We,viewport:ot,reset:Ot}}function Tz(i,e,t,n,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Xe,d=new WeakMap;let f;const p=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(j,k){return m?new OffscreenCanvas(j,k):cp("canvas")}function b(j,k,se){let Me=1;const Re=ut(j);if((Re.width>se||Re.height>se)&&(Me=se/Math.max(Re.width,Re.height)),Me<1)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap||typeof VideoFrame<"u"&&j instanceof VideoFrame){const be=Math.floor(Me*Re.width),dt=Math.floor(Me*Re.height);f===void 0&&(f=_(be,dt));const ze=k?_(be,dt):f;return ze.width=be,ze.height=dt,ze.getContext("2d").drawImage(j,0,0,be,dt),Ae("WebGLRenderer: Texture has been resized from ("+Re.width+"x"+Re.height+") to ("+be+"x"+dt+")."),ze}else return"data"in j&&Ae("WebGLRenderer: Image in DataTexture is too big ("+Re.width+"x"+Re.height+")."),j;return j}function v(j){return j.generateMipmaps}function y(j){i.generateMipmap(j)}function S(j){return j.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:j.isWebGL3DRenderTarget?i.TEXTURE_3D:j.isWebGLArrayRenderTarget||j.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function T(j,k,se,Me,Re=!1){if(j!==null){if(i[j]!==void 0)return i[j];Ae("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let be=k;if(k===i.RED&&(se===i.FLOAT&&(be=i.R32F),se===i.HALF_FLOAT&&(be=i.R16F),se===i.UNSIGNED_BYTE&&(be=i.R8)),k===i.RED_INTEGER&&(se===i.UNSIGNED_BYTE&&(be=i.R8UI),se===i.UNSIGNED_SHORT&&(be=i.R16UI),se===i.UNSIGNED_INT&&(be=i.R32UI),se===i.BYTE&&(be=i.R8I),se===i.SHORT&&(be=i.R16I),se===i.INT&&(be=i.R32I)),k===i.RG&&(se===i.FLOAT&&(be=i.RG32F),se===i.HALF_FLOAT&&(be=i.RG16F),se===i.UNSIGNED_BYTE&&(be=i.RG8)),k===i.RG_INTEGER&&(se===i.UNSIGNED_BYTE&&(be=i.RG8UI),se===i.UNSIGNED_SHORT&&(be=i.RG16UI),se===i.UNSIGNED_INT&&(be=i.RG32UI),se===i.BYTE&&(be=i.RG8I),se===i.SHORT&&(be=i.RG16I),se===i.INT&&(be=i.RG32I)),k===i.RGB_INTEGER&&(se===i.UNSIGNED_BYTE&&(be=i.RGB8UI),se===i.UNSIGNED_SHORT&&(be=i.RGB16UI),se===i.UNSIGNED_INT&&(be=i.RGB32UI),se===i.BYTE&&(be=i.RGB8I),se===i.SHORT&&(be=i.RGB16I),se===i.INT&&(be=i.RGB32I)),k===i.RGBA_INTEGER&&(se===i.UNSIGNED_BYTE&&(be=i.RGBA8UI),se===i.UNSIGNED_SHORT&&(be=i.RGBA16UI),se===i.UNSIGNED_INT&&(be=i.RGBA32UI),se===i.BYTE&&(be=i.RGBA8I),se===i.SHORT&&(be=i.RGBA16I),se===i.INT&&(be=i.RGBA32I)),k===i.RGB&&(se===i.UNSIGNED_INT_5_9_9_9_REV&&(be=i.RGB9_E5),se===i.UNSIGNED_INT_10F_11F_11F_REV&&(be=i.R11F_G11F_B10F)),k===i.RGBA){const dt=Re?Fh:bt.getTransfer(Me);se===i.FLOAT&&(be=i.RGBA32F),se===i.HALF_FLOAT&&(be=i.RGBA16F),se===i.UNSIGNED_BYTE&&(be=dt===Ze?i.SRGB8_ALPHA8:i.RGBA8),se===i.UNSIGNED_SHORT_4_4_4_4&&(be=i.RGBA4),se===i.UNSIGNED_SHORT_5_5_5_1&&(be=i.RGB5_A1)}return(be===i.R16F||be===i.R32F||be===i.RG16F||be===i.RG32F||be===i.RGBA16F||be===i.RGBA32F)&&e.get("EXT_color_buffer_float"),be}function E(j,k){let se;return j?k===null||k===yn||k===Jr?se=i.DEPTH24_STENCIL8:k===Qn?se=i.DEPTH32F_STENCIL8:k===js&&(se=i.DEPTH24_STENCIL8,Ae("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):k===null||k===yn||k===Jr?se=i.DEPTH_COMPONENT24:k===Qn?se=i.DEPTH_COMPONENT32F:k===js&&(se=i.DEPTH_COMPONENT16),se}function N(j,k){return v(j)===!0||j.isFramebufferTexture&&j.minFilter!==vn&&j.minFilter!==In?Math.log2(Math.max(k.width,k.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?k.mipmaps.length:1}function M(j){const k=j.target;k.removeEventListener("dispose",M),D(k),k.isVideoTexture&&d.delete(k)}function C(j){const k=j.target;k.removeEventListener("dispose",C),P(k)}function D(j){const k=n.get(j);if(k.__webglInit===void 0)return;const se=j.source,Me=p.get(se);if(Me){const Re=Me[k.__cacheKey];Re.usedTimes--,Re.usedTimes===0&&R(j),Object.keys(Me).length===0&&p.delete(se)}n.remove(j)}function R(j){const k=n.get(j);i.deleteTexture(k.__webglTexture);const se=j.source,Me=p.get(se);delete Me[k.__cacheKey],a.memory.textures--}function P(j){const k=n.get(j);if(j.depthTexture&&(j.depthTexture.dispose(),n.remove(j.depthTexture)),j.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++){if(Array.isArray(k.__webglFramebuffer[Me]))for(let Re=0;Re<k.__webglFramebuffer[Me].length;Re++)i.deleteFramebuffer(k.__webglFramebuffer[Me][Re]);else i.deleteFramebuffer(k.__webglFramebuffer[Me]);k.__webglDepthbuffer&&i.deleteRenderbuffer(k.__webglDepthbuffer[Me])}else{if(Array.isArray(k.__webglFramebuffer))for(let Me=0;Me<k.__webglFramebuffer.length;Me++)i.deleteFramebuffer(k.__webglFramebuffer[Me]);else i.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&i.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&i.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let Me=0;Me<k.__webglColorRenderbuffer.length;Me++)k.__webglColorRenderbuffer[Me]&&i.deleteRenderbuffer(k.__webglColorRenderbuffer[Me]);k.__webglDepthRenderbuffer&&i.deleteRenderbuffer(k.__webglDepthRenderbuffer)}const se=j.textures;for(let Me=0,Re=se.length;Me<Re;Me++){const be=n.get(se[Me]);be.__webglTexture&&(i.deleteTexture(be.__webglTexture),a.memory.textures--),n.remove(se[Me])}n.remove(j)}let L=0;function z(){L=0}function B(){const j=L;return j>=r.maxTextures&&Ae("WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+r.maxTextures),L+=1,j}function O(j){const k=[];return k.push(j.wrapS),k.push(j.wrapT),k.push(j.wrapR||0),k.push(j.magFilter),k.push(j.minFilter),k.push(j.anisotropy),k.push(j.internalFormat),k.push(j.format),k.push(j.type),k.push(j.generateMipmaps),k.push(j.premultiplyAlpha),k.push(j.flipY),k.push(j.unpackAlignment),k.push(j.colorSpace),k.join()}function V(j,k){const se=n.get(j);if(j.isVideoTexture&&Kt(j),j.isRenderTargetTexture===!1&&j.isExternalTexture!==!0&&j.version>0&&se.__version!==j.version){const Me=j.image;if(Me===null)Ae("WebGLRenderer: Texture marked for update but no image data found.");else if(Me.complete===!1)Ae("WebGLRenderer: Texture marked for update but image is incomplete");else{q(se,j,k);return}}else j.isExternalTexture&&(se.__webglTexture=j.sourceTexture?j.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,se.__webglTexture,i.TEXTURE0+k)}function Y(j,k){const se=n.get(j);if(j.isRenderTargetTexture===!1&&j.version>0&&se.__version!==j.version){q(se,j,k);return}else j.isExternalTexture&&(se.__webglTexture=j.sourceTexture?j.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,se.__webglTexture,i.TEXTURE0+k)}function G(j,k){const se=n.get(j);if(j.isRenderTargetTexture===!1&&j.version>0&&se.__version!==j.version){q(se,j,k);return}t.bindTexture(i.TEXTURE_3D,se.__webglTexture,i.TEXTURE0+k)}function W(j,k){const se=n.get(j);if(j.isCubeDepthTexture!==!0&&j.version>0&&se.__version!==j.version){re(se,j,k);return}t.bindTexture(i.TEXTURE_CUBE_MAP,se.__webglTexture,i.TEXTURE0+k)}const te={[bu]:i.REPEAT,[Rr]:i.CLAMP_TO_EDGE,[wu]:i.MIRRORED_REPEAT},U={[vn]:i.NEAREST,[Ww]:i.NEAREST_MIPMAP_NEAREST,[oo]:i.NEAREST_MIPMAP_LINEAR,[In]:i.LINEAR,[eh]:i.LINEAR_MIPMAP_NEAREST,[Nr]:i.LINEAR_MIPMAP_LINEAR},H={[qw]:i.NEVER,[Zw]:i.ALWAYS,[Sp]:i.LESS,[Tp]:i.LEQUAL,[Xw]:i.EQUAL,[Mp]:i.GEQUAL,[Yw]:i.GREATER,[Kw]:i.NOTEQUAL};function le(j,k){if(k.type===Qn&&e.has("OES_texture_float_linear")===!1&&(k.magFilter===In||k.magFilter===eh||k.magFilter===oo||k.magFilter===Nr||k.minFilter===In||k.minFilter===eh||k.minFilter===oo||k.minFilter===Nr)&&Ae("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(j,i.TEXTURE_WRAP_S,te[k.wrapS]),i.texParameteri(j,i.TEXTURE_WRAP_T,te[k.wrapT]),(j===i.TEXTURE_3D||j===i.TEXTURE_2D_ARRAY)&&i.texParameteri(j,i.TEXTURE_WRAP_R,te[k.wrapR]),i.texParameteri(j,i.TEXTURE_MAG_FILTER,U[k.magFilter]),i.texParameteri(j,i.TEXTURE_MIN_FILTER,U[k.minFilter]),k.compareFunction&&(i.texParameteri(j,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(j,i.TEXTURE_COMPARE_FUNC,H[k.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(k.magFilter===vn||k.minFilter!==oo&&k.minFilter!==Nr||k.type===Qn&&e.has("OES_texture_float_linear")===!1)return;if(k.anisotropy>1||n.get(k).__currentAnisotropy){const se=e.get("EXT_texture_filter_anisotropic");i.texParameterf(j,se.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,r.getMaxAnisotropy())),n.get(k).__currentAnisotropy=k.anisotropy}}}function Te(j,k){let se=!1;j.__webglInit===void 0&&(j.__webglInit=!0,k.addEventListener("dispose",M));const Me=k.source;let Re=p.get(Me);Re===void 0&&(Re={},p.set(Me,Re));const be=O(k);if(be!==j.__cacheKey){Re[be]===void 0&&(Re[be]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,se=!0),Re[be].usedTimes++;const dt=Re[j.__cacheKey];dt!==void 0&&(Re[j.__cacheKey].usedTimes--,dt.usedTimes===0&&R(k)),j.__cacheKey=be,j.__webglTexture=Re[be].texture}return se}function Fe(j,k,se){return Math.floor(Math.floor(j/se)/k)}function ie(j,k,se,Me){const be=j.updateRanges;if(be.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,k.width,k.height,se,Me,k.data);else{be.sort((Ie,We)=>Ie.start-We.start);let dt=0;for(let Ie=1;Ie<be.length;Ie++){const We=be[dt],ot=be[Ie],ct=We.start+We.count,Ve=Fe(ot.start,k.width,4),Ot=Fe(We.start,k.width,4);ot.start<=ct+1&&Ve===Ot&&Fe(ot.start+ot.count-1,k.width,4)===Ve?We.count=Math.max(We.count,ot.start+ot.count-We.start):(++dt,be[dt]=ot)}be.length=dt+1;const ze=i.getParameter(i.UNPACK_ROW_LENGTH),it=i.getParameter(i.UNPACK_SKIP_PIXELS),Rt=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,k.width);for(let Ie=0,We=be.length;Ie<We;Ie++){const ot=be[Ie],ct=Math.floor(ot.start/4),Ve=Math.ceil(ot.count/4),Ot=ct%k.width,J=Math.floor(ct/k.width),qe=Ve,Le=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,Ot),i.pixelStorei(i.UNPACK_SKIP_ROWS,J),t.texSubImage2D(i.TEXTURE_2D,0,Ot,J,qe,Le,se,Me,k.data)}j.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,ze),i.pixelStorei(i.UNPACK_SKIP_PIXELS,it),i.pixelStorei(i.UNPACK_SKIP_ROWS,Rt)}}function q(j,k,se){let Me=i.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(Me=i.TEXTURE_2D_ARRAY),k.isData3DTexture&&(Me=i.TEXTURE_3D);const Re=Te(j,k),be=k.source;t.bindTexture(Me,j.__webglTexture,i.TEXTURE0+se);const dt=n.get(be);if(be.version!==dt.__version||Re===!0){t.activeTexture(i.TEXTURE0+se);const ze=bt.getPrimaries(bt.workingColorSpace),it=k.colorSpace===Er?null:bt.getPrimaries(k.colorSpace),Rt=k.colorSpace===Er||ze===it?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,k.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,k.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Rt);let Ie=b(k.image,!1,r.maxTextureSize);Ie=nn(k,Ie);const We=s.convert(k.format,k.colorSpace),ot=s.convert(k.type);let ct=T(k.internalFormat,We,ot,k.colorSpace,k.isVideoTexture);le(Me,k);let Ve;const Ot=k.mipmaps,J=k.isVideoTexture!==!0,qe=dt.__version===void 0||Re===!0,Le=be.dataReady,Ye=N(k,Ie);if(k.isDepthTexture)ct=E(k.format===hr,k.type),qe&&(J?t.texStorage2D(i.TEXTURE_2D,1,ct,Ie.width,Ie.height):t.texImage2D(i.TEXTURE_2D,0,ct,Ie.width,Ie.height,0,We,ot,null));else if(k.isDataTexture)if(Ot.length>0){J&&qe&&t.texStorage2D(i.TEXTURE_2D,Ye,ct,Ot[0].width,Ot[0].height);for(let De=0,Ce=Ot.length;De<Ce;De++)Ve=Ot[De],J?Le&&t.texSubImage2D(i.TEXTURE_2D,De,0,0,Ve.width,Ve.height,We,ot,Ve.data):t.texImage2D(i.TEXTURE_2D,De,ct,Ve.width,Ve.height,0,We,ot,Ve.data);k.generateMipmaps=!1}else J?(qe&&t.texStorage2D(i.TEXTURE_2D,Ye,ct,Ie.width,Ie.height),Le&&ie(k,Ie,We,ot)):t.texImage2D(i.TEXTURE_2D,0,ct,Ie.width,Ie.height,0,We,ot,Ie.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){J&&qe&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Ye,ct,Ot[0].width,Ot[0].height,Ie.depth);for(let De=0,Ce=Ot.length;De<Ce;De++)if(Ve=Ot[De],k.format!==Jn)if(We!==null)if(J){if(Le)if(k.layerUpdates.size>0){const je=kb(Ve.width,Ve.height,k.format,k.type);for(const Nt of k.layerUpdates){const xn=Ve.data.subarray(Nt*je/Ve.data.BYTES_PER_ELEMENT,(Nt+1)*je/Ve.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,De,0,0,Nt,Ve.width,Ve.height,1,We,xn)}k.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,De,0,0,0,Ve.width,Ve.height,Ie.depth,We,Ve.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,De,ct,Ve.width,Ve.height,Ie.depth,0,Ve.data,0,0);else Ae("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else J?Le&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,De,0,0,0,Ve.width,Ve.height,Ie.depth,We,ot,Ve.data):t.texImage3D(i.TEXTURE_2D_ARRAY,De,ct,Ve.width,Ve.height,Ie.depth,0,We,ot,Ve.data)}else{J&&qe&&t.texStorage2D(i.TEXTURE_2D,Ye,ct,Ot[0].width,Ot[0].height);for(let De=0,Ce=Ot.length;De<Ce;De++)Ve=Ot[De],k.format!==Jn?We!==null?J?Le&&t.compressedTexSubImage2D(i.TEXTURE_2D,De,0,0,Ve.width,Ve.height,We,Ve.data):t.compressedTexImage2D(i.TEXTURE_2D,De,ct,Ve.width,Ve.height,0,Ve.data):Ae("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):J?Le&&t.texSubImage2D(i.TEXTURE_2D,De,0,0,Ve.width,Ve.height,We,ot,Ve.data):t.texImage2D(i.TEXTURE_2D,De,ct,Ve.width,Ve.height,0,We,ot,Ve.data)}else if(k.isDataArrayTexture)if(J){if(qe&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Ye,ct,Ie.width,Ie.height,Ie.depth),Le)if(k.layerUpdates.size>0){const De=kb(Ie.width,Ie.height,k.format,k.type);for(const Ce of k.layerUpdates){const je=Ie.data.subarray(Ce*De/Ie.data.BYTES_PER_ELEMENT,(Ce+1)*De/Ie.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ce,Ie.width,Ie.height,1,We,ot,je)}k.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Ie.width,Ie.height,Ie.depth,We,ot,Ie.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,ct,Ie.width,Ie.height,Ie.depth,0,We,ot,Ie.data);else if(k.isData3DTexture)J?(qe&&t.texStorage3D(i.TEXTURE_3D,Ye,ct,Ie.width,Ie.height,Ie.depth),Le&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Ie.width,Ie.height,Ie.depth,We,ot,Ie.data)):t.texImage3D(i.TEXTURE_3D,0,ct,Ie.width,Ie.height,Ie.depth,0,We,ot,Ie.data);else if(k.isFramebufferTexture){if(qe)if(J)t.texStorage2D(i.TEXTURE_2D,Ye,ct,Ie.width,Ie.height);else{let De=Ie.width,Ce=Ie.height;for(let je=0;je<Ye;je++)t.texImage2D(i.TEXTURE_2D,je,ct,De,Ce,0,We,ot,null),De>>=1,Ce>>=1}}else if(Ot.length>0){if(J&&qe){const De=ut(Ot[0]);t.texStorage2D(i.TEXTURE_2D,Ye,ct,De.width,De.height)}for(let De=0,Ce=Ot.length;De<Ce;De++)Ve=Ot[De],J?Le&&t.texSubImage2D(i.TEXTURE_2D,De,0,0,We,ot,Ve):t.texImage2D(i.TEXTURE_2D,De,ct,We,ot,Ve);k.generateMipmaps=!1}else if(J){if(qe){const De=ut(Ie);t.texStorage2D(i.TEXTURE_2D,Ye,ct,De.width,De.height)}Le&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,We,ot,Ie)}else t.texImage2D(i.TEXTURE_2D,0,ct,We,ot,Ie);v(k)&&y(Me),dt.__version=be.version,k.onUpdate&&k.onUpdate(k)}j.__version=k.version}function re(j,k,se){if(k.image.length!==6)return;const Me=Te(j,k),Re=k.source;t.bindTexture(i.TEXTURE_CUBE_MAP,j.__webglTexture,i.TEXTURE0+se);const be=n.get(Re);if(Re.version!==be.__version||Me===!0){t.activeTexture(i.TEXTURE0+se);const dt=bt.getPrimaries(bt.workingColorSpace),ze=k.colorSpace===Er?null:bt.getPrimaries(k.colorSpace),it=k.colorSpace===Er||dt===ze?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,k.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,k.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,it);const Rt=k.isCompressedTexture||k.image[0].isCompressedTexture,Ie=k.image[0]&&k.image[0].isDataTexture,We=[];for(let Ce=0;Ce<6;Ce++)!Rt&&!Ie?We[Ce]=b(k.image[Ce],!0,r.maxCubemapSize):We[Ce]=Ie?k.image[Ce].image:k.image[Ce],We[Ce]=nn(k,We[Ce]);const ot=We[0],ct=s.convert(k.format,k.colorSpace),Ve=s.convert(k.type),Ot=T(k.internalFormat,ct,Ve,k.colorSpace),J=k.isVideoTexture!==!0,qe=be.__version===void 0||Me===!0,Le=Re.dataReady;let Ye=N(k,ot);le(i.TEXTURE_CUBE_MAP,k);let De;if(Rt){J&&qe&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Ye,Ot,ot.width,ot.height);for(let Ce=0;Ce<6;Ce++){De=We[Ce].mipmaps;for(let je=0;je<De.length;je++){const Nt=De[je];k.format!==Jn?ct!==null?J?Le&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je,0,0,Nt.width,Nt.height,ct,Nt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je,Ot,Nt.width,Nt.height,0,Nt.data):Ae("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):J?Le&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je,0,0,Nt.width,Nt.height,ct,Ve,Nt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je,Ot,Nt.width,Nt.height,0,ct,Ve,Nt.data)}}}else{if(De=k.mipmaps,J&&qe){De.length>0&&Ye++;const Ce=ut(We[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Ye,Ot,Ce.width,Ce.height)}for(let Ce=0;Ce<6;Ce++)if(Ie){J?Le&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,We[Ce].width,We[Ce].height,ct,Ve,We[Ce].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Ot,We[Ce].width,We[Ce].height,0,ct,Ve,We[Ce].data);for(let je=0;je<De.length;je++){const xn=De[je].image[Ce].image;J?Le&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je+1,0,0,xn.width,xn.height,ct,Ve,xn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je+1,Ot,xn.width,xn.height,0,ct,Ve,xn.data)}}else{J?Le&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,ct,Ve,We[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Ot,ct,Ve,We[Ce]);for(let je=0;je<De.length;je++){const Nt=De[je];J?Le&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je+1,0,0,ct,Ve,Nt.image[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,je+1,Ot,ct,Ve,Nt.image[Ce])}}}v(k)&&y(i.TEXTURE_CUBE_MAP),be.__version=Re.version,k.onUpdate&&k.onUpdate(k)}j.__version=k.version}function we(j,k,se,Me,Re,be){const dt=s.convert(se.format,se.colorSpace),ze=s.convert(se.type),it=T(se.internalFormat,dt,ze,se.colorSpace),Rt=n.get(k),Ie=n.get(se);if(Ie.__renderTarget=k,!Rt.__hasExternalTextures){const We=Math.max(1,k.width>>be),ot=Math.max(1,k.height>>be);Re===i.TEXTURE_3D||Re===i.TEXTURE_2D_ARRAY?t.texImage3D(Re,be,it,We,ot,k.depth,0,dt,ze,null):t.texImage2D(Re,be,it,We,ot,0,dt,ze,null)}t.bindFramebuffer(i.FRAMEBUFFER,j),Gn(k)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Me,Re,Ie.__webglTexture,0,Z(k)):(Re===i.TEXTURE_2D||Re>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Re<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Me,Re,Ie.__webglTexture,be),t.bindFramebuffer(i.FRAMEBUFFER,null)}function He(j,k,se){if(i.bindRenderbuffer(i.RENDERBUFFER,j),k.depthBuffer){const Me=k.depthTexture,Re=Me&&Me.isDepthTexture?Me.type:null,be=E(k.stencilBuffer,Re),dt=k.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;Gn(k)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Z(k),be,k.width,k.height):se?i.renderbufferStorageMultisample(i.RENDERBUFFER,Z(k),be,k.width,k.height):i.renderbufferStorage(i.RENDERBUFFER,be,k.width,k.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,dt,i.RENDERBUFFER,j)}else{const Me=k.textures;for(let Re=0;Re<Me.length;Re++){const be=Me[Re],dt=s.convert(be.format,be.colorSpace),ze=s.convert(be.type),it=T(be.internalFormat,dt,ze,be.colorSpace);Gn(k)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Z(k),it,k.width,k.height):se?i.renderbufferStorageMultisample(i.RENDERBUFFER,Z(k),it,k.width,k.height):i.renderbufferStorage(i.RENDERBUFFER,it,k.width,k.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Be(j,k,se){const Me=k.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,j),!(k.depthTexture&&k.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Re=n.get(k.depthTexture);if(Re.__renderTarget=k,(!Re.__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),Me){if(Re.__webglInit===void 0&&(Re.__webglInit=!0,k.depthTexture.addEventListener("dispose",M)),Re.__webglTexture===void 0){Re.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,Re.__webglTexture),le(i.TEXTURE_CUBE_MAP,k.depthTexture);const Rt=s.convert(k.depthTexture.format),Ie=s.convert(k.depthTexture.type);let We;k.depthTexture.format===ki?We=i.DEPTH_COMPONENT24:k.depthTexture.format===hr&&(We=i.DEPTH24_STENCIL8);for(let ot=0;ot<6;ot++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0,We,k.width,k.height,0,Rt,Ie,null)}}else V(k.depthTexture,0);const be=Re.__webglTexture,dt=Z(k),ze=Me?i.TEXTURE_CUBE_MAP_POSITIVE_X+se:i.TEXTURE_2D,it=k.depthTexture.format===hr?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(k.depthTexture.format===ki)Gn(k)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,it,ze,be,0,dt):i.framebufferTexture2D(i.FRAMEBUFFER,it,ze,be,0);else if(k.depthTexture.format===hr)Gn(k)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,it,ze,be,0,dt):i.framebufferTexture2D(i.FRAMEBUFFER,it,ze,be,0);else throw new Error("Unknown depthTexture format")}function pt(j){const k=n.get(j),se=j.isWebGLCubeRenderTarget===!0;if(k.__boundDepthTexture!==j.depthTexture){const Me=j.depthTexture;if(k.__depthDisposeCallback&&k.__depthDisposeCallback(),Me){const Re=()=>{delete k.__boundDepthTexture,delete k.__depthDisposeCallback,Me.removeEventListener("dispose",Re)};Me.addEventListener("dispose",Re),k.__depthDisposeCallback=Re}k.__boundDepthTexture=Me}if(j.depthTexture&&!k.__autoAllocateDepthBuffer)if(se)for(let Me=0;Me<6;Me++)Be(k.__webglFramebuffer[Me],j,Me);else{const Me=j.texture.mipmaps;Me&&Me.length>0?Be(k.__webglFramebuffer[0],j,0):Be(k.__webglFramebuffer,j,0)}else if(se){k.__webglDepthbuffer=[];for(let Me=0;Me<6;Me++)if(t.bindFramebuffer(i.FRAMEBUFFER,k.__webglFramebuffer[Me]),k.__webglDepthbuffer[Me]===void 0)k.__webglDepthbuffer[Me]=i.createRenderbuffer(),He(k.__webglDepthbuffer[Me],j,!1);else{const Re=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,be=k.__webglDepthbuffer[Me];i.bindRenderbuffer(i.RENDERBUFFER,be),i.framebufferRenderbuffer(i.FRAMEBUFFER,Re,i.RENDERBUFFER,be)}}else{const Me=j.texture.mipmaps;if(Me&&Me.length>0?t.bindFramebuffer(i.FRAMEBUFFER,k.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer===void 0)k.__webglDepthbuffer=i.createRenderbuffer(),He(k.__webglDepthbuffer,j,!1);else{const Re=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,be=k.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,be),i.framebufferRenderbuffer(i.FRAMEBUFFER,Re,i.RENDERBUFFER,be)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function ln(j,k,se){const Me=n.get(j);k!==void 0&&we(Me.__webglFramebuffer,j,j.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),se!==void 0&&pt(j)}function Dt(j){const k=j.texture,se=n.get(j),Me=n.get(k);j.addEventListener("dispose",C);const Re=j.textures,be=j.isWebGLCubeRenderTarget===!0,dt=Re.length>1;if(dt||(Me.__webglTexture===void 0&&(Me.__webglTexture=i.createTexture()),Me.__version=k.version,a.memory.textures++),be){se.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)if(k.mipmaps&&k.mipmaps.length>0){se.__webglFramebuffer[ze]=[];for(let it=0;it<k.mipmaps.length;it++)se.__webglFramebuffer[ze][it]=i.createFramebuffer()}else se.__webglFramebuffer[ze]=i.createFramebuffer()}else{if(k.mipmaps&&k.mipmaps.length>0){se.__webglFramebuffer=[];for(let ze=0;ze<k.mipmaps.length;ze++)se.__webglFramebuffer[ze]=i.createFramebuffer()}else se.__webglFramebuffer=i.createFramebuffer();if(dt)for(let ze=0,it=Re.length;ze<it;ze++){const Rt=n.get(Re[ze]);Rt.__webglTexture===void 0&&(Rt.__webglTexture=i.createTexture(),a.memory.textures++)}if(j.samples>0&&Gn(j)===!1){se.__webglMultisampledFramebuffer=i.createFramebuffer(),se.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,se.__webglMultisampledFramebuffer);for(let ze=0;ze<Re.length;ze++){const it=Re[ze];se.__webglColorRenderbuffer[ze]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,se.__webglColorRenderbuffer[ze]);const Rt=s.convert(it.format,it.colorSpace),Ie=s.convert(it.type),We=T(it.internalFormat,Rt,Ie,it.colorSpace,j.isXRRenderTarget===!0),ot=Z(j);i.renderbufferStorageMultisample(i.RENDERBUFFER,ot,We,j.width,j.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ze,i.RENDERBUFFER,se.__webglColorRenderbuffer[ze])}i.bindRenderbuffer(i.RENDERBUFFER,null),j.depthBuffer&&(se.__webglDepthRenderbuffer=i.createRenderbuffer(),He(se.__webglDepthRenderbuffer,j,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(be){t.bindTexture(i.TEXTURE_CUBE_MAP,Me.__webglTexture),le(i.TEXTURE_CUBE_MAP,k);for(let ze=0;ze<6;ze++)if(k.mipmaps&&k.mipmaps.length>0)for(let it=0;it<k.mipmaps.length;it++)we(se.__webglFramebuffer[ze][it],j,k,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ze,it);else we(se.__webglFramebuffer[ze],j,k,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0);v(k)&&y(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(dt){for(let ze=0,it=Re.length;ze<it;ze++){const Rt=Re[ze],Ie=n.get(Rt);let We=i.TEXTURE_2D;(j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(We=j.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(We,Ie.__webglTexture),le(We,Rt),we(se.__webglFramebuffer,j,Rt,i.COLOR_ATTACHMENT0+ze,We,0),v(Rt)&&y(We)}t.unbindTexture()}else{let ze=i.TEXTURE_2D;if((j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(ze=j.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ze,Me.__webglTexture),le(ze,k),k.mipmaps&&k.mipmaps.length>0)for(let it=0;it<k.mipmaps.length;it++)we(se.__webglFramebuffer[it],j,k,i.COLOR_ATTACHMENT0,ze,it);else we(se.__webglFramebuffer,j,k,i.COLOR_ATTACHMENT0,ze,0);v(k)&&y(ze),t.unbindTexture()}j.depthBuffer&&pt(j)}function zt(j){const k=j.textures;for(let se=0,Me=k.length;se<Me;se++){const Re=k[se];if(v(Re)){const be=S(j),dt=n.get(Re).__webglTexture;t.bindTexture(be,dt),y(be),t.unbindTexture()}}}const Yt=[],Ct=[];function tn(j){if(j.samples>0){if(Gn(j)===!1){const k=j.textures,se=j.width,Me=j.height;let Re=i.COLOR_BUFFER_BIT;const be=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,dt=n.get(j),ze=k.length>1;if(ze)for(let Rt=0;Rt<k.length;Rt++)t.bindFramebuffer(i.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Rt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,dt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Rt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,dt.__webglMultisampledFramebuffer);const it=j.texture.mipmaps;it&&it.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,dt.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,dt.__webglFramebuffer);for(let Rt=0;Rt<k.length;Rt++){if(j.resolveDepthBuffer&&(j.depthBuffer&&(Re|=i.DEPTH_BUFFER_BIT),j.stencilBuffer&&j.resolveStencilBuffer&&(Re|=i.STENCIL_BUFFER_BIT)),ze){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,dt.__webglColorRenderbuffer[Rt]);const Ie=n.get(k[Rt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ie,0)}i.blitFramebuffer(0,0,se,Me,0,0,se,Me,Re,i.NEAREST),l===!0&&(Yt.length=0,Ct.length=0,Yt.push(i.COLOR_ATTACHMENT0+Rt),j.depthBuffer&&j.resolveDepthBuffer===!1&&(Yt.push(be),Ct.push(be),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Ct)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Yt))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),ze)for(let Rt=0;Rt<k.length;Rt++){t.bindFramebuffer(i.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Rt,i.RENDERBUFFER,dt.__webglColorRenderbuffer[Rt]);const Ie=n.get(k[Rt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,dt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Rt,i.TEXTURE_2D,Ie,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,dt.__webglMultisampledFramebuffer)}else if(j.depthBuffer&&j.resolveDepthBuffer===!1&&l){const k=j.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[k])}}}function Z(j){return Math.min(r.maxSamples,j.samples)}function Gn(j){const k=n.get(j);return j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function Kt(j){const k=a.render.frame;d.get(j)!==k&&(d.set(j,k),j.update())}function nn(j,k){const se=j.colorSpace,Me=j.format,Re=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||se!==Mu&&se!==Er&&(bt.getTransfer(se)===Ze?(Me!==Jn||Re!==Un)&&Ae("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Ee("WebGLTextures: Unsupported texture color space:",se)),k}function ut(j){return typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement?(c.width=j.naturalWidth||j.width,c.height=j.naturalHeight||j.height):typeof VideoFrame<"u"&&j instanceof VideoFrame?(c.width=j.displayWidth,c.height=j.displayHeight):(c.width=j.width,c.height=j.height),c}this.allocateTextureUnit=B,this.resetTextureUnits=z,this.setTexture2D=V,this.setTexture2DArray=Y,this.setTexture3D=G,this.setTextureCube=W,this.rebindTextures=ln,this.setupRenderTarget=Dt,this.updateRenderTargetMipmap=zt,this.updateMultisampleRenderTarget=tn,this.setupDepthRenderbuffer=pt,this.setupFrameBufferTexture=we,this.useMultisampledRTT=Gn,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function Mz(i,e){function t(n,r=Er){let s;const a=bt.getTransfer(r);if(n===Un)return i.UNSIGNED_BYTE;if(n===Z0)return i.UNSIGNED_SHORT_4_4_4_4;if(n===Q0)return i.UNSIGNED_SHORT_5_5_5_1;if(n===J0)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===e_)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===du)return i.BYTE;if(n===fu)return i.SHORT;if(n===js)return i.UNSIGNED_SHORT;if(n===Ti)return i.INT;if(n===yn)return i.UNSIGNED_INT;if(n===Qn)return i.FLOAT;if(n===Wn)return i.HALF_FLOAT;if(n===$w)return i.ALPHA;if(n===bp)return i.RGB;if(n===Jn)return i.RGBA;if(n===ki)return i.DEPTH_COMPONENT;if(n===hr)return i.DEPTH_STENCIL;if(n===wp)return i.RED;if(n===Xh)return i.RED_INTEGER;if(n===dr)return i.RG;if(n===Yh)return i.RG_INTEGER;if(n===Kh)return i.RGBA_INTEGER;if(n===ll||n===ul||n===cl||n===hl)if(a===Ze)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===ll)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===ul)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===cl)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===hl)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===ll)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===ul)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===cl)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===hl)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===ap||n===op||n===lp||n===up)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===ap)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===op)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===lp)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===up)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===dh||n===fh||n===ph||n===gh||n===mh||n===Su||n===_h)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===dh||n===fh)return a===Ze?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===ph)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===gh)return s.COMPRESSED_R11_EAC;if(n===mh)return s.COMPRESSED_SIGNED_R11_EAC;if(n===Su)return s.COMPRESSED_RG11_EAC;if(n===_h)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===yh||n===vh||n===xh||n===bh||n===wh||n===Sh||n===Th||n===Mh||n===Ah||n===Eh||n===Ch||n===Rh||n===Nh||n===Ph)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===yh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===vh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===xh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===bh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===wh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Sh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Th)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Mh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Ah)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Eh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Ch)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Rh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Nh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Ph)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Dh||n===Cb||n===Rb)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Dh)return a===Ze?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Cb)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Rb)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===kh||n===Ih||n===Tu||n===Lh)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===kh)return s.COMPRESSED_RED_RGTC1_EXT;if(n===Ih)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Tu)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Lh)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Jr?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const Az=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Ez=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Cz{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new WR(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new vs({vertexShader:Az,fragmentShader:Ez,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new pi(new Cp(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Rz extends Ca{constructor(e,t){super();const n=this;let r=null,s=1,a=null,o="local-floor",l=1,c=null,d=null,f=null,p=null,m=null,_=null;const b=typeof XRWebGLBinding<"u",v=new Cz,y={},S=t.getContextAttributes();let T=null,E=null;const N=[],M=[],C=new Xe;let D=null;const R=new Mi;R.viewport=new It;const P=new Mi;P.viewport=new It;const L=[R,P],z=new QR;let B=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let re=N[q];return re===void 0&&(re=new v0,N[q]=re),re.getTargetRaySpace()},this.getControllerGrip=function(q){let re=N[q];return re===void 0&&(re=new v0,N[q]=re),re.getGripSpace()},this.getHand=function(q){let re=N[q];return re===void 0&&(re=new v0,N[q]=re),re.getHandSpace()};function V(q){const re=M.indexOf(q.inputSource);if(re===-1)return;const we=N[re];we!==void 0&&(we.update(q.inputSource,q.frame,c||a),we.dispatchEvent({type:q.type,data:q.inputSource}))}function Y(){r.removeEventListener("select",V),r.removeEventListener("selectstart",V),r.removeEventListener("selectend",V),r.removeEventListener("squeeze",V),r.removeEventListener("squeezestart",V),r.removeEventListener("squeezeend",V),r.removeEventListener("end",Y),r.removeEventListener("inputsourceschange",G);for(let q=0;q<N.length;q++){const re=M[q];re!==null&&(M[q]=null,N[q].disconnect(re))}B=null,O=null,v.reset();for(const q in y)delete y[q];e.setRenderTarget(T),m=null,p=null,f=null,r=null,E=null,ie.stop(),n.isPresenting=!1,e.setPixelRatio(D),e.setSize(C.width,C.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){s=q,n.isPresenting===!0&&Ae("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){o=q,n.isPresenting===!0&&Ae("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return f===null&&b&&(f=new XRWebGLBinding(r,t)),f},this.getFrame=function(){return _},this.getSession=function(){return r},this.setSession=async function(q){if(r=q,r!==null){if(T=e.getRenderTarget(),r.addEventListener("select",V),r.addEventListener("selectstart",V),r.addEventListener("selectend",V),r.addEventListener("squeeze",V),r.addEventListener("squeezestart",V),r.addEventListener("squeezeend",V),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",G),S.xrCompatible!==!0&&await t.makeXRCompatible(),D=e.getPixelRatio(),e.getSize(C),b&&"createProjectionLayer"in XRWebGLBinding.prototype){let we=null,He=null,Be=null;S.depth&&(Be=S.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,we=S.stencil?hr:ki,He=S.stencil?Jr:yn);const pt={colorFormat:t.RGBA8,depthFormat:Be,scaleFactor:s};f=this.getBinding(),p=f.createProjectionLayer(pt),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),E=new Ws(p.textureWidth,p.textureHeight,{format:Jn,type:Un,depthTexture:new gr(p.textureWidth,p.textureHeight,He,void 0,void 0,void 0,void 0,void 0,void 0,we),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}else{const we={antialias:S.antialias,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,t,we),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),E=new Ws(m.framebufferWidth,m.framebufferHeight,{format:Jn,type:Un,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}E.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await r.requestReferenceSpace(o),ie.setContext(r),ie.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};function G(q){for(let re=0;re<q.removed.length;re++){const we=q.removed[re],He=M.indexOf(we);He>=0&&(M[He]=null,N[He].disconnect(we))}for(let re=0;re<q.added.length;re++){const we=q.added[re];let He=M.indexOf(we);if(He===-1){for(let pt=0;pt<N.length;pt++)if(pt>=M.length){M.push(we),He=pt;break}else if(M[pt]===null){M[pt]=we,He=pt;break}if(He===-1)break}const Be=N[He];Be&&Be.connect(we)}}const W=new X,te=new X;function U(q,re,we){W.setFromMatrixPosition(re.matrixWorld),te.setFromMatrixPosition(we.matrixWorld);const He=W.distanceTo(te),Be=re.projectionMatrix.elements,pt=we.projectionMatrix.elements,ln=Be[14]/(Be[10]-1),Dt=Be[14]/(Be[10]+1),zt=(Be[9]+1)/Be[5],Yt=(Be[9]-1)/Be[5],Ct=(Be[8]-1)/Be[0],tn=(pt[8]+1)/pt[0],Z=ln*Ct,Gn=ln*tn,Kt=He/(-Ct+tn),nn=Kt*-Ct;if(re.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(nn),q.translateZ(Kt),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert(),Be[10]===-1)q.projectionMatrix.copy(re.projectionMatrix),q.projectionMatrixInverse.copy(re.projectionMatrixInverse);else{const ut=ln+Kt,j=Dt+Kt,k=Z-nn,se=Gn+(He-nn),Me=zt*Dt/j*ut,Re=Yt*Dt/j*ut;q.projectionMatrix.makePerspective(k,se,Me,Re,ut,j),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}}function H(q,re){re===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(re.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(r===null)return;let re=q.near,we=q.far;v.texture!==null&&(v.depthNear>0&&(re=v.depthNear),v.depthFar>0&&(we=v.depthFar)),z.near=P.near=R.near=re,z.far=P.far=R.far=we,(B!==z.near||O!==z.far)&&(r.updateRenderState({depthNear:z.near,depthFar:z.far}),B=z.near,O=z.far),z.layers.mask=q.layers.mask|6,R.layers.mask=z.layers.mask&3,P.layers.mask=z.layers.mask&5;const He=q.parent,Be=z.cameras;H(z,He);for(let pt=0;pt<Be.length;pt++)H(Be[pt],He);Be.length===2?U(z,R,P):z.projectionMatrix.copy(R.projectionMatrix),le(q,z,He)};function le(q,re,we){we===null?q.matrix.copy(re.matrixWorld):(q.matrix.copy(we.matrixWorld),q.matrix.invert(),q.matrix.multiply(re.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(re.projectionMatrix),q.projectionMatrixInverse.copy(re.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=Au*2*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}this.getCamera=function(){return z},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(q){l=q,p!==null&&(p.fixedFoveation=q),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=q)},this.hasDepthSensing=function(){return v.texture!==null},this.getDepthSensingMesh=function(){return v.getMesh(z)},this.getCameraTexture=function(q){return y[q]};let Te=null;function Fe(q,re){if(d=re.getViewerPose(c||a),_=re,d!==null){const we=d.views;m!==null&&(e.setRenderTargetFramebuffer(E,m.framebuffer),e.setRenderTarget(E));let He=!1;we.length!==z.cameras.length&&(z.cameras.length=0,He=!0);for(let Dt=0;Dt<we.length;Dt++){const zt=we[Dt];let Yt=null;if(m!==null)Yt=m.getViewport(zt);else{const tn=f.getViewSubImage(p,zt);Yt=tn.viewport,Dt===0&&(e.setRenderTargetTextures(E,tn.colorTexture,tn.depthStencilTexture),e.setRenderTarget(E))}let Ct=L[Dt];Ct===void 0&&(Ct=new Mi,Ct.layers.enable(Dt),Ct.viewport=new It,L[Dt]=Ct),Ct.matrix.fromArray(zt.transform.matrix),Ct.matrix.decompose(Ct.position,Ct.quaternion,Ct.scale),Ct.projectionMatrix.fromArray(zt.projectionMatrix),Ct.projectionMatrixInverse.copy(Ct.projectionMatrix).invert(),Ct.viewport.set(Yt.x,Yt.y,Yt.width,Yt.height),Dt===0&&(z.matrix.copy(Ct.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),He===!0&&z.cameras.push(Ct)}const Be=r.enabledFeatures;if(Be&&Be.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&b){f=n.getBinding();const Dt=f.getDepthInformation(we[0]);Dt&&Dt.isValid&&Dt.texture&&v.init(Dt,r.renderState)}if(Be&&Be.includes("camera-access")&&b){e.state.unbindTexture(),f=n.getBinding();for(let Dt=0;Dt<we.length;Dt++){const zt=we[Dt].camera;if(zt){let Yt=y[zt];Yt||(Yt=new WR,y[zt]=Yt);const Ct=f.getCameraImage(zt);Yt.sourceTexture=Ct}}}}for(let we=0;we<N.length;we++){const He=M[we],Be=N[we];He!==null&&Be!==void 0&&Be.update(He,re,c||a)}Te&&Te(q,re),re.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:re}),_=null}const ie=new tN;ie.setAnimationLoop(Fe),this.setAnimationLoop=function(q){Te=q},this.dispose=function(){}}}const ql=new ys,Nz=new hn;function Pz(i,e){function t(v,y){v.matrixAutoUpdate===!0&&v.updateMatrix(),y.value.copy(v.matrix)}function n(v,y){y.color.getRGB(v.fogColor.value,OR(i)),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)}function r(v,y,S,T,E){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(v,y):y.isMeshToonMaterial?(s(v,y),f(v,y)):y.isMeshPhongMaterial?(s(v,y),d(v,y)):y.isMeshStandardMaterial?(s(v,y),p(v,y),y.isMeshPhysicalMaterial&&m(v,y,E)):y.isMeshMatcapMaterial?(s(v,y),_(v,y)):y.isMeshDepthMaterial?s(v,y):y.isMeshDistanceMaterial?(s(v,y),b(v,y)):y.isMeshNormalMaterial?s(v,y):y.isLineBasicMaterial?(a(v,y),y.isLineDashedMaterial&&o(v,y)):y.isPointsMaterial?l(v,y,S,T):y.isSpriteMaterial?c(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.bumpMap&&(v.bumpMap.value=y.bumpMap,t(y.bumpMap,v.bumpMapTransform),v.bumpScale.value=y.bumpScale,y.side===En&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,t(y.normalMap,v.normalMapTransform),v.normalScale.value.copy(y.normalScale),y.side===En&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,t(y.displacementMap,v.displacementMapTransform),v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,v.emissiveMapTransform)),y.specularMap&&(v.specularMap.value=y.specularMap,t(y.specularMap,v.specularMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const S=e.get(y),T=S.envMap,E=S.envMapRotation;T&&(v.envMap.value=T,ql.copy(E),ql.x*=-1,ql.y*=-1,ql.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(ql.y*=-1,ql.z*=-1),v.envMapRotation.value.setFromMatrix4(Nz.makeRotationFromEuler(ql)),v.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap&&(v.lightMap.value=y.lightMap,v.lightMapIntensity.value=y.lightMapIntensity,t(y.lightMap,v.lightMapTransform)),y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,v.aoMapTransform))}function a(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform))}function o(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}function l(v,y,S,T){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*S,v.scale.value=T*.5,y.map&&(v.map.value=y.map,t(y.map,v.uvTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function c(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function d(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4)}function f(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap)}function p(v,y){v.metalness.value=y.metalness,y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,v.metalnessMapTransform)),v.roughness.value=y.roughness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,v.roughnessMapTransform)),y.envMap&&(v.envMapIntensity.value=y.envMapIntensity)}function m(v,y,S){v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,v.sheenColorMapTransform)),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,v.sheenRoughnessMapTransform))),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,v.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(v.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===En&&v.clearcoatNormalScale.value.negate())),y.dispersion>0&&(v.dispersion.value=y.dispersion),y.iridescence>0&&(v.iridescence.value=y.iridescence,v.iridescenceIOR.value=y.iridescenceIOR,v.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(v.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,v.iridescenceMapTransform)),y.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=S.texture,v.transmissionSamplerSize.value.set(S.width,S.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,v.transmissionMapTransform)),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(v.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(v.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,v.specularColorMapTransform)),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,v.specularIntensityMapTransform))}function _(v,y){y.matcap&&(v.matcap.value=y.matcap)}function b(v,y){const S=e.get(y).light;v.referencePosition.value.setFromMatrixPosition(S.matrixWorld),v.nearDistance.value=S.shadow.camera.near,v.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Dz(i,e,t,n){let r={},s={},a=[];const o=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(S,T){const E=T.program;n.uniformBlockBinding(S,E)}function c(S,T){let E=r[S.id];E===void 0&&(_(S),E=d(S),r[S.id]=E,S.addEventListener("dispose",v));const N=T.program;n.updateUBOMapping(S,N);const M=e.render.frame;s[S.id]!==M&&(p(S),s[S.id]=M)}function d(S){const T=f();S.__bindingPointIndex=T;const E=i.createBuffer(),N=S.__size,M=S.usage;return i.bindBuffer(i.UNIFORM_BUFFER,E),i.bufferData(i.UNIFORM_BUFFER,N,M),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,T,E),E}function f(){for(let S=0;S<o;S++)if(a.indexOf(S)===-1)return a.push(S),S;return Ee("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(S){const T=r[S.id],E=S.uniforms,N=S.__cache;i.bindBuffer(i.UNIFORM_BUFFER,T);for(let M=0,C=E.length;M<C;M++){const D=Array.isArray(E[M])?E[M]:[E[M]];for(let R=0,P=D.length;R<P;R++){const L=D[R];if(m(L,M,R,N)===!0){const z=L.__offset,B=Array.isArray(L.value)?L.value:[L.value];let O=0;for(let V=0;V<B.length;V++){const Y=B[V],G=b(Y);typeof Y=="number"||typeof Y=="boolean"?(L.__data[0]=Y,i.bufferSubData(i.UNIFORM_BUFFER,z+O,L.__data)):Y.isMatrix3?(L.__data[0]=Y.elements[0],L.__data[1]=Y.elements[1],L.__data[2]=Y.elements[2],L.__data[3]=0,L.__data[4]=Y.elements[3],L.__data[5]=Y.elements[4],L.__data[6]=Y.elements[5],L.__data[7]=0,L.__data[8]=Y.elements[6],L.__data[9]=Y.elements[7],L.__data[10]=Y.elements[8],L.__data[11]=0):(Y.toArray(L.__data,O),O+=G.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,z,L.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function m(S,T,E,N){const M=S.value,C=T+"_"+E;if(N[C]===void 0)return typeof M=="number"||typeof M=="boolean"?N[C]=M:N[C]=M.clone(),!0;{const D=N[C];if(typeof M=="number"||typeof M=="boolean"){if(D!==M)return N[C]=M,!0}else if(D.equals(M)===!1)return D.copy(M),!0}return!1}function _(S){const T=S.uniforms;let E=0;const N=16;for(let C=0,D=T.length;C<D;C++){const R=Array.isArray(T[C])?T[C]:[T[C]];for(let P=0,L=R.length;P<L;P++){const z=R[P],B=Array.isArray(z.value)?z.value:[z.value];for(let O=0,V=B.length;O<V;O++){const Y=B[O],G=b(Y),W=E%N,te=W%G.boundary,U=W+te;E+=te,U!==0&&N-U<G.storage&&(E+=N-U),z.__data=new Float32Array(G.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=E,E+=G.storage}}}const M=E%N;return M>0&&(E+=N-M),S.__size=E,S.__cache={},this}function b(S){const T={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(T.boundary=4,T.storage=4):S.isVector2?(T.boundary=8,T.storage=8):S.isVector3||S.isColor?(T.boundary=16,T.storage=12):S.isVector4?(T.boundary=16,T.storage=16):S.isMatrix3?(T.boundary=48,T.storage=48):S.isMatrix4?(T.boundary=64,T.storage=64):S.isTexture?Ae("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ae("WebGLRenderer: Unsupported uniform value type.",S),T}function v(S){const T=S.target;T.removeEventListener("dispose",v);const E=a.indexOf(T.__bindingPointIndex);a.splice(E,1),i.deleteBuffer(r[T.id]),delete r[T.id],delete s[T.id]}function y(){for(const S in r)i.deleteBuffer(r[S]);a=[],r={},s={}}return{bind:l,update:c,dispose:y}}const kz=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let aa=null;function Iz(){return aa===null&&(aa=new uS(kz,16,16,dr,Wn),aa.name="DFG_LUT",aa.minFilter=In,aa.magFilter=In,aa.wrapS=Rr,aa.wrapT=Rr,aa.generateMipmaps=!1,aa.needsUpdate=!0),aa}class Lz{constructor(e={}){const{canvas:t=NR(),context:n=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1,reversedDepthBuffer:p=!1,outputBufferType:m=Un}=e;this.isWebGLRenderer=!0;let _;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");_=n.getContextAttributes().alpha}else _=a;const b=m,v=new Set([Kh,Yh,Xh]),y=new Set([Un,yn,js,Jr,Z0,Q0]),S=new Uint32Array(4),T=new Int32Array(4);let E=null,N=null;const M=[],C=[];let D=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Di,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const R=this;let P=!1;this._outputColorSpace=lr;let L=0,z=0,B=null,O=-1,V=null;const Y=new It,G=new It;let W=null;const te=new _t(0);let U=0,H=t.width,le=t.height,Te=1,Fe=null,ie=null;const q=new It(0,0,H,le),re=new It(0,0,H,le);let we=!1;const He=new Ep;let Be=!1,pt=!1;const ln=new hn,Dt=new X,zt=new It,Yt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ct=!1;function tn(){return B===null?Te:1}let Z=n;function Gn(F,ae){return t.getContext(F,ae)}try{const F={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ku}`),t.addEventListener("webglcontextlost",Nt,!1),t.addEventListener("webglcontextrestored",xn,!1),t.addEventListener("webglcontextcreationerror",rn,!1),Z===null){const ae="webgl2";if(Z=Gn(ae,F),Z===null)throw Gn(ae)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(F){throw Ee("WebGLRenderer: "+F.message),F}let Kt,nn,ut,j,k,se,Me,Re,be,dt,ze,it,Rt,Ie,We,ot,ct,Ve,Ot,J,qe,Le,Ye,De;function Ce(){Kt=new IB(Z),Kt.init(),Le=new Mz(Z,Kt),nn=new MB(Z,Kt,e,Le),ut=new Sz(Z,Kt),nn.reversedDepthBuffer&&p&&ut.buffers.depth.setReversed(!0),j=new UB(Z),k=new lz,se=new Tz(Z,Kt,ut,k,nn,Le,j),Me=new EB(R),Re=new kB(R),be=new GF(Z),Ye=new SB(Z,be),dt=new LB(Z,be,j,Ye),ze=new BB(Z,dt,be,j),Ot=new OB(Z,nn,se),ot=new AB(k),it=new oz(R,Me,Re,Kt,nn,Ye,ot),Rt=new Pz(R,k),Ie=new cz,We=new mz(Kt),Ve=new wB(R,Me,Re,ut,ze,_,l),ct=new bz(R,ze,nn),De=new Dz(Z,j,nn,ut),J=new TB(Z,Kt,j),qe=new FB(Z,Kt,j),j.programs=it.programs,R.capabilities=nn,R.extensions=Kt,R.properties=k,R.renderLists=Ie,R.shadowMap=ct,R.state=ut,R.info=j}Ce(),b!==Un&&(D=new GB(b,t.width,t.height,r,s));const je=new Rz(R,Z);this.xr=je,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const F=Kt.get("WEBGL_lose_context");F&&F.loseContext()},this.forceContextRestore=function(){const F=Kt.get("WEBGL_lose_context");F&&F.restoreContext()},this.getPixelRatio=function(){return Te},this.setPixelRatio=function(F){F!==void 0&&(Te=F,this.setSize(H,le,!1))},this.getSize=function(F){return F.set(H,le)},this.setSize=function(F,ae,ge=!0){if(je.isPresenting){Ae("WebGLRenderer: Can't change size while VR device is presenting.");return}H=F,le=ae,t.width=Math.floor(F*Te),t.height=Math.floor(ae*Te),ge===!0&&(t.style.width=F+"px",t.style.height=ae+"px"),D!==null&&D.setSize(t.width,t.height),this.setViewport(0,0,F,ae)},this.getDrawingBufferSize=function(F){return F.set(H*Te,le*Te).floor()},this.setDrawingBufferSize=function(F,ae,ge){H=F,le=ae,Te=ge,t.width=Math.floor(F*ge),t.height=Math.floor(ae*ge),this.setViewport(0,0,F,ae)},this.setEffects=function(F){if(b===Un){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(F){for(let ae=0;ae<F.length;ae++)if(F[ae].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}D.setEffects(F||[])},this.getCurrentViewport=function(F){return F.copy(Y)},this.getViewport=function(F){return F.copy(q)},this.setViewport=function(F,ae,ge,de){F.isVector4?q.set(F.x,F.y,F.z,F.w):q.set(F,ae,ge,de),ut.viewport(Y.copy(q).multiplyScalar(Te).round())},this.getScissor=function(F){return F.copy(re)},this.setScissor=function(F,ae,ge,de){F.isVector4?re.set(F.x,F.y,F.z,F.w):re.set(F,ae,ge,de),ut.scissor(G.copy(re).multiplyScalar(Te).round())},this.getScissorTest=function(){return we},this.setScissorTest=function(F){ut.setScissorTest(we=F)},this.setOpaqueSort=function(F){Fe=F},this.setTransparentSort=function(F){ie=F},this.getClearColor=function(F){return F.copy(Ve.getClearColor())},this.setClearColor=function(){Ve.setClearColor(...arguments)},this.getClearAlpha=function(){return Ve.getClearAlpha()},this.setClearAlpha=function(){Ve.setClearAlpha(...arguments)},this.clear=function(F=!0,ae=!0,ge=!0){let de=0;if(F){let ce=!1;if(B!==null){const $e=B.texture.format;ce=v.has($e)}if(ce){const $e=B.texture.type,Je=y.has($e),Ge=Ve.getClearColor(),at=Ve.getClearAlpha(),nt=Ge.r,At=Ge.g,vt=Ge.b;Je?(S[0]=nt,S[1]=At,S[2]=vt,S[3]=at,Z.clearBufferuiv(Z.COLOR,0,S)):(T[0]=nt,T[1]=At,T[2]=vt,T[3]=at,Z.clearBufferiv(Z.COLOR,0,T))}else de|=Z.COLOR_BUFFER_BIT}ae&&(de|=Z.DEPTH_BUFFER_BIT),ge&&(de|=Z.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Z.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Nt,!1),t.removeEventListener("webglcontextrestored",xn,!1),t.removeEventListener("webglcontextcreationerror",rn,!1),Ve.dispose(),Ie.dispose(),We.dispose(),k.dispose(),Me.dispose(),Re.dispose(),ze.dispose(),Ye.dispose(),De.dispose(),it.dispose(),je.dispose(),je.removeEventListener("sessionstart",Al),je.removeEventListener("sessionend",El),ws.stop()};function Nt(F){F.preventDefault(),hp("WebGLRenderer: Context Lost."),P=!0}function xn(){hp("WebGLRenderer: Context Restored."),P=!1;const F=j.autoReset,ae=ct.enabled,ge=ct.autoUpdate,de=ct.needsUpdate,ce=ct.type;Ce(),j.autoReset=F,ct.enabled=ae,ct.autoUpdate=ge,ct.needsUpdate=de,ct.type=ce}function rn(F){Ee("WebGLRenderer: A WebGL context could not be created. Reason: ",F.statusMessage)}function Ur(F){const ae=F.target;ae.removeEventListener("dispose",Ur),tr(ae)}function tr(F){cd(F),k.remove(F)}function cd(F){const ae=k.get(F).programs;ae!==void 0&&(ae.forEach(function(ge){it.releaseProgram(ge)}),F.isShaderMaterial&&it.releaseShaderCache(F))}this.renderBufferDirect=function(F,ae,ge,de,ce,$e){ae===null&&(ae=Yt);const Je=ce.isMesh&&ce.matrixWorld.determinant()<0,Ge=Gp(F,ae,ge,de,ce);ut.setMaterial(de,Je);let at=ge.index,nt=1;if(de.wireframe===!0){if(at=dt.getWireframeAttribute(ge),at===void 0)return;nt=2}const At=ge.drawRange,vt=ge.attributes.position;let Vt=At.start*nt,sn=(At.start+At.count)*nt;$e!==null&&(Vt=Math.max(Vt,$e.start*nt),sn=Math.min(sn,($e.start+$e.count)*nt)),at!==null?(Vt=Math.max(Vt,0),sn=Math.min(sn,at.count)):vt!=null&&(Vt=Math.max(Vt,0),sn=Math.min(sn,vt.count));const Cn=sn-Vt;if(Cn<0||Cn===1/0)return;Ye.setup(ce,de,Ge,ge,at);let Tn,un=J;if(at!==null&&(Tn=be.get(at),un=qe,un.setIndex(Tn)),ce.isMesh)de.wireframe===!0?(ut.setLineWidth(de.wireframeLinewidth*tn()),un.setMode(Z.LINES)):un.setMode(Z.TRIANGLES);else if(ce.isLine){let xt=de.linewidth;xt===void 0&&(xt=1),ut.setLineWidth(xt*tn()),ce.isLineSegments?un.setMode(Z.LINES):ce.isLineLoop?un.setMode(Z.LINE_LOOP):un.setMode(Z.LINE_STRIP)}else ce.isPoints?un.setMode(Z.POINTS):ce.isSprite&&un.setMode(Z.TRIANGLES);if(ce.isBatchedMesh)if(ce._multiDrawInstances!==null)Fn("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),un.renderMultiDrawInstances(ce._multiDrawStarts,ce._multiDrawCounts,ce._multiDrawCount,ce._multiDrawInstances);else if(Kt.get("WEBGL_multi_draw"))un.renderMultiDraw(ce._multiDrawStarts,ce._multiDrawCounts,ce._multiDrawCount);else{const xt=ce._multiDrawStarts,fn=ce._multiDrawCounts,Zt=ce._multiDrawCount,Fi=at?be.get(at).bytesPerElement:1,Qs=k.get(de).currentProgram.getUniforms();for(let ui=0;ui<Zt;ui++)Qs.setValue(Z,"_gl_DrawID",ui),un.render(xt[ui]/Fi,fn[ui])}else if(ce.isInstancedMesh)un.renderInstances(Vt,Cn,ce.count);else if(ge.isInstancedBufferGeometry){const xt=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,fn=Math.min(ge.instanceCount,xt);un.renderInstances(Vt,Cn,fn)}else un.render(Vt,Cn)};function bo(F,ae,ge){F.transparent===!0&&F.side===Xi&&F.forceSinglePass===!1?(F.side=En,F.needsUpdate=!0,Cl(F,ae,ge),F.side=Zr,F.needsUpdate=!0,Cl(F,ae,ge),F.side=Xi):Cl(F,ae,ge)}this.compile=function(F,ae,ge=null){ge===null&&(ge=F),N=We.get(ge),N.init(ae),C.push(N),ge.traverseVisible(function(ce){ce.isLight&&ce.layers.test(ae.layers)&&(N.pushLight(ce),ce.castShadow&&N.pushShadow(ce))}),F!==ge&&F.traverseVisible(function(ce){ce.isLight&&ce.layers.test(ae.layers)&&(N.pushLight(ce),ce.castShadow&&N.pushShadow(ce))}),N.setupLights();const de=new Set;return F.traverse(function(ce){if(!(ce.isMesh||ce.isPoints||ce.isLine||ce.isSprite))return;const $e=ce.material;if($e)if(Array.isArray($e))for(let Je=0;Je<$e.length;Je++){const Ge=$e[Je];bo(Ge,ge,ce),de.add(Ge)}else bo($e,ge,ce),de.add($e)}),N=C.pop(),de},this.compileAsync=function(F,ae,ge=null){const de=this.compile(F,ae,ge);return new Promise(ce=>{function $e(){if(de.forEach(function(Je){k.get(Je).currentProgram.isReady()&&de.delete(Je)}),de.size===0){ce(F);return}setTimeout($e,10)}Kt.get("KHR_parallel_shader_compile")!==null?$e():setTimeout($e,10)})};let hd=null;function Ml(F){hd&&hd(F)}function Al(){ws.stop()}function El(){ws.start()}const ws=new tN;ws.setAnimationLoop(Ml),typeof self<"u"&&ws.setContext(self),this.setAnimationLoop=function(F){hd=F,je.setAnimationLoop(F),F===null?ws.stop():ws.start()},je.addEventListener("sessionstart",Al),je.addEventListener("sessionend",El),this.render=function(F,ae){if(ae!==void 0&&ae.isCamera!==!0){Ee("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(P===!0)return;const ge=je.enabled===!0&&je.isPresenting===!0,de=D!==null&&(B===null||ge)&&D.begin(R,B);if(F.matrixWorldAutoUpdate===!0&&F.updateMatrixWorld(),ae.parent===null&&ae.matrixWorldAutoUpdate===!0&&ae.updateMatrixWorld(),je.enabled===!0&&je.isPresenting===!0&&(D===null||D.isCompositing()===!1)&&(je.cameraAutoUpdate===!0&&je.updateCamera(ae),ae=je.getCamera()),F.isScene===!0&&F.onBeforeRender(R,F,ae,B),N=We.get(F,C.length),N.init(ae),C.push(N),ln.multiplyMatrices(ae.projectionMatrix,ae.matrixWorldInverse),He.setFromProjectionMatrix(ln,fr,ae.reversedDepth),pt=this.localClippingEnabled,Be=ot.init(this.clippingPlanes,pt),E=Ie.get(F,M.length),E.init(),M.push(E),je.enabled===!0&&je.isPresenting===!0){const Je=R.xr.getDepthSensingMesh();Je!==null&&dd(Je,ae,-1/0,R.sortObjects)}dd(F,ae,0,R.sortObjects),E.finish(),R.sortObjects===!0&&E.sort(Fe,ie),Ct=je.enabled===!1||je.isPresenting===!1||je.hasDepthSensing()===!1,Ct&&Ve.addToRenderList(E,F),this.info.render.frame++,Be===!0&&ot.beginShadows();const ce=N.state.shadowsArray;if(ct.render(ce,F,ae),Be===!0&&ot.endShadows(),this.info.autoReset===!0&&this.info.reset(),(de&&D.hasRenderPass())===!1){const Je=E.opaque,Ge=E.transmissive;if(N.setupLights(),ae.isArrayCamera){const at=ae.cameras;if(Ge.length>0)for(let nt=0,At=at.length;nt<At;nt++){const vt=at[nt];Bp(Je,Ge,F,vt)}Ct&&Ve.render(F);for(let nt=0,At=at.length;nt<At;nt++){const vt=at[nt];Op(E,F,vt,vt.viewport)}}else Ge.length>0&&Bp(Je,Ge,F,ae),Ct&&Ve.render(F),Op(E,F,ae)}B!==null&&z===0&&(se.updateMultisampleRenderTarget(B),se.updateRenderTargetMipmap(B)),de&&D.end(R),F.isScene===!0&&F.onAfterRender(R,F,ae),Ye.resetDefaultState(),O=-1,V=null,C.pop(),C.length>0?(N=C[C.length-1],Be===!0&&ot.setGlobalState(R.clippingPlanes,N.state.camera)):N=null,M.pop(),M.length>0?E=M[M.length-1]:E=null};function dd(F,ae,ge,de){if(F.visible===!1)return;if(F.layers.test(ae.layers)){if(F.isGroup)ge=F.renderOrder;else if(F.isLOD)F.autoUpdate===!0&&F.update(ae);else if(F.isLight)N.pushLight(F),F.castShadow&&N.pushShadow(F);else if(F.isSprite){if(!F.frustumCulled||He.intersectsSprite(F)){de&&zt.setFromMatrixPosition(F.matrixWorld).applyMatrix4(ln);const Je=ze.update(F),Ge=F.material;Ge.visible&&E.push(F,Je,Ge,ge,zt.z,null)}}else if((F.isMesh||F.isLine||F.isPoints)&&(!F.frustumCulled||He.intersectsObject(F))){const Je=ze.update(F),Ge=F.material;if(de&&(F.boundingSphere!==void 0?(F.boundingSphere===null&&F.computeBoundingSphere(),zt.copy(F.boundingSphere.center)):(Je.boundingSphere===null&&Je.computeBoundingSphere(),zt.copy(Je.boundingSphere.center)),zt.applyMatrix4(F.matrixWorld).applyMatrix4(ln)),Array.isArray(Ge)){const at=Je.groups;for(let nt=0,At=at.length;nt<At;nt++){const vt=at[nt],Vt=Ge[vt.materialIndex];Vt&&Vt.visible&&E.push(F,Je,Vt,ge,zt.z,vt)}}else Ge.visible&&E.push(F,Je,Ge,ge,zt.z,null)}}const $e=F.children;for(let Je=0,Ge=$e.length;Je<Ge;Je++)dd($e[Je],ae,ge,de)}function Op(F,ae,ge,de){const{opaque:ce,transmissive:$e,transparent:Je}=F;N.setupLightsView(ge),Be===!0&&ot.setGlobalState(R.clippingPlanes,ge),de&&ut.viewport(Y.copy(de)),ce.length>0&&ns(ce,ae,ge),$e.length>0&&ns($e,ae,ge),Je.length>0&&ns(Je,ae,ge),ut.buffers.depth.setTest(!0),ut.buffers.depth.setMask(!0),ut.buffers.color.setMask(!0),ut.setPolygonOffset(!1)}function Bp(F,ae,ge,de){if((ge.isScene===!0?ge.overrideMaterial:null)!==null)return;if(N.state.transmissionRenderTarget[de.id]===void 0){const Vt=Kt.has("EXT_color_buffer_half_float")||Kt.has("EXT_color_buffer_float");N.state.transmissionRenderTarget[de.id]=new Ws(1,1,{generateMipmaps:!0,type:Vt?Wn:Un,minFilter:Nr,samples:nn.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:bt.workingColorSpace})}const $e=N.state.transmissionRenderTarget[de.id],Je=de.viewport||Y;$e.setSize(Je.z*R.transmissionResolutionScale,Je.w*R.transmissionResolutionScale);const Ge=R.getRenderTarget(),at=R.getActiveCubeFace(),nt=R.getActiveMipmapLevel();R.setRenderTarget($e),R.getClearColor(te),U=R.getClearAlpha(),U<1&&R.setClearColor(16777215,.5),R.clear(),Ct&&Ve.render(ge);const At=R.toneMapping;R.toneMapping=Di;const vt=de.viewport;if(de.viewport!==void 0&&(de.viewport=void 0),N.setupLightsView(de),Be===!0&&ot.setGlobalState(R.clippingPlanes,de),ns(F,ge,de),se.updateMultisampleRenderTarget($e),se.updateRenderTargetMipmap($e),Kt.has("WEBGL_multisampled_render_to_texture")===!1){let Vt=!1;for(let sn=0,Cn=ae.length;sn<Cn;sn++){const Tn=ae[sn],{object:un,geometry:xt,material:fn,group:Zt}=Tn;if(fn.side===Xi&&un.layers.test(de.layers)){const Fi=fn.side;fn.side=En,fn.needsUpdate=!0,fd(un,ge,de,xt,fn,Zt),fn.side=Fi,fn.needsUpdate=!0,Vt=!0}}Vt===!0&&(se.updateMultisampleRenderTarget($e),se.updateRenderTargetMipmap($e))}R.setRenderTarget(Ge,at,nt),R.setClearColor(te,U),vt!==void 0&&(de.viewport=vt),R.toneMapping=At}function ns(F,ae,ge){const de=ae.isScene===!0?ae.overrideMaterial:null;for(let ce=0,$e=F.length;ce<$e;ce++){const Je=F[ce],{object:Ge,geometry:at,group:nt}=Je;let At=Je.material;At.allowOverride===!0&&de!==null&&(At=de),Ge.layers.test(ge.layers)&&fd(Ge,ae,ge,at,At,nt)}}function fd(F,ae,ge,de,ce,$e){F.onBeforeRender(R,ae,ge,de,ce,$e),F.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,F.matrixWorld),F.normalMatrix.getNormalMatrix(F.modelViewMatrix),ce.onBeforeRender(R,ae,ge,de,F,$e),ce.transparent===!0&&ce.side===Xi&&ce.forceSinglePass===!1?(ce.side=En,ce.needsUpdate=!0,R.renderBufferDirect(ge,ae,de,ce,F,$e),ce.side=Zr,ce.needsUpdate=!0,R.renderBufferDirect(ge,ae,de,ce,F,$e),ce.side=Xi):R.renderBufferDirect(ge,ae,de,ce,F,$e),F.onAfterRender(R,ae,ge,de,ce,$e)}function Cl(F,ae,ge){ae.isScene!==!0&&(ae=Yt);const de=k.get(F),ce=N.state.lights,$e=N.state.shadowsArray,Je=ce.state.version,Ge=it.getParameters(F,ce.state,$e,ae,ge),at=it.getProgramCacheKey(Ge);let nt=de.programs;de.environment=F.isMeshStandardMaterial?ae.environment:null,de.fog=ae.fog,de.envMap=(F.isMeshStandardMaterial?Re:Me).get(F.envMap||de.environment),de.envMapRotation=de.environment!==null&&F.envMap===null?ae.environmentRotation:F.envMapRotation,nt===void 0&&(F.addEventListener("dispose",Ur),nt=new Map,de.programs=nt);let At=nt.get(at);if(At!==void 0){if(de.currentProgram===At&&de.lightsStateVersion===Je)return pd(F,Ge),At}else Ge.uniforms=it.getUniforms(F),F.onBeforeCompile(Ge,R),At=it.acquireProgram(Ge,at),nt.set(at,At),de.uniforms=Ge.uniforms;const vt=de.uniforms;return(!F.isShaderMaterial&&!F.isRawShaderMaterial||F.clipping===!0)&&(vt.clippingPlanes=ot.uniform),pd(F,Ge),de.needsLights=jp(F),de.lightsStateVersion=Je,de.needsLights&&(vt.ambientLightColor.value=ce.state.ambient,vt.lightProbe.value=ce.state.probe,vt.directionalLights.value=ce.state.directional,vt.directionalLightShadows.value=ce.state.directionalShadow,vt.spotLights.value=ce.state.spot,vt.spotLightShadows.value=ce.state.spotShadow,vt.rectAreaLights.value=ce.state.rectArea,vt.ltc_1.value=ce.state.rectAreaLTC1,vt.ltc_2.value=ce.state.rectAreaLTC2,vt.pointLights.value=ce.state.point,vt.pointLightShadows.value=ce.state.pointShadow,vt.hemisphereLights.value=ce.state.hemi,vt.directionalShadowMap.value=ce.state.directionalShadowMap,vt.directionalShadowMatrix.value=ce.state.directionalShadowMatrix,vt.spotShadowMap.value=ce.state.spotShadowMap,vt.spotLightMatrix.value=ce.state.spotLightMatrix,vt.spotLightMap.value=ce.state.spotLightMap,vt.pointShadowMap.value=ce.state.pointShadowMap,vt.pointShadowMatrix.value=ce.state.pointShadowMatrix),de.currentProgram=At,de.uniformsList=null,At}function zp(F){if(F.uniformsList===null){const ae=F.currentProgram.getUniforms();F.uniformsList=x0.seqWithValue(ae.seq,F.uniforms)}return F.uniformsList}function pd(F,ae){const ge=k.get(F);ge.outputColorSpace=ae.outputColorSpace,ge.batching=ae.batching,ge.batchingColor=ae.batchingColor,ge.instancing=ae.instancing,ge.instancingColor=ae.instancingColor,ge.instancingMorph=ae.instancingMorph,ge.skinning=ae.skinning,ge.morphTargets=ae.morphTargets,ge.morphNormals=ae.morphNormals,ge.morphColors=ae.morphColors,ge.morphTargetsCount=ae.morphTargetsCount,ge.numClippingPlanes=ae.numClippingPlanes,ge.numIntersection=ae.numClipIntersection,ge.vertexAlphas=ae.vertexAlphas,ge.vertexTangents=ae.vertexTangents,ge.toneMapping=ae.toneMapping}function Gp(F,ae,ge,de,ce){ae.isScene!==!0&&(ae=Yt),se.resetTextureUnits();const $e=ae.fog,Je=de.isMeshStandardMaterial?ae.environment:null,Ge=B===null?R.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:Mu,at=(de.isMeshStandardMaterial?Re:Me).get(de.envMap||Je),nt=de.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,At=!!ge.attributes.tangent&&(!!de.normalMap||de.anisotropy>0),vt=!!ge.morphAttributes.position,Vt=!!ge.morphAttributes.normal,sn=!!ge.morphAttributes.color;let Cn=Di;de.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(Cn=R.toneMapping);const Tn=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,un=Tn!==void 0?Tn.length:0,xt=k.get(de),fn=N.state.lights;if(Be===!0&&(pt===!0||F!==V)){const _i=F===V&&de.id===O;ot.setState(de,F,_i)}let Zt=!1;de.version===xt.__version?(xt.needsLights&&xt.lightsStateVersion!==fn.state.version||xt.outputColorSpace!==Ge||ce.isBatchedMesh&&xt.batching===!1||!ce.isBatchedMesh&&xt.batching===!0||ce.isBatchedMesh&&xt.batchingColor===!0&&ce.colorTexture===null||ce.isBatchedMesh&&xt.batchingColor===!1&&ce.colorTexture!==null||ce.isInstancedMesh&&xt.instancing===!1||!ce.isInstancedMesh&&xt.instancing===!0||ce.isSkinnedMesh&&xt.skinning===!1||!ce.isSkinnedMesh&&xt.skinning===!0||ce.isInstancedMesh&&xt.instancingColor===!0&&ce.instanceColor===null||ce.isInstancedMesh&&xt.instancingColor===!1&&ce.instanceColor!==null||ce.isInstancedMesh&&xt.instancingMorph===!0&&ce.morphTexture===null||ce.isInstancedMesh&&xt.instancingMorph===!1&&ce.morphTexture!==null||xt.envMap!==at||de.fog===!0&&xt.fog!==$e||xt.numClippingPlanes!==void 0&&(xt.numClippingPlanes!==ot.numPlanes||xt.numIntersection!==ot.numIntersection)||xt.vertexAlphas!==nt||xt.vertexTangents!==At||xt.morphTargets!==vt||xt.morphNormals!==Vt||xt.morphColors!==sn||xt.toneMapping!==Cn||xt.morphTargetsCount!==un)&&(Zt=!0):(Zt=!0,xt.__version=de.version);let Fi=xt.currentProgram;Zt===!0&&(Fi=Cl(de,ae,ce));let Qs=!1,ui=!1,Rl=!1;const mn=Fi.getUniforms(),Lt=xt.uniforms;if(ut.useProgram(Fi.program)&&(Qs=!0,ui=!0,Rl=!0),de.id!==O&&(O=de.id,ui=!0),Qs||V!==F){ut.buffers.depth.getReversed()&&F.reversedDepth!==!0&&(F._reversedDepth=!0,F.updateProjectionMatrix()),mn.setValue(Z,"projectionMatrix",F.projectionMatrix),mn.setValue(Z,"viewMatrix",F.matrixWorldInverse);const yi=mn.map.cameraPosition;yi!==void 0&&yi.setValue(Z,Dt.setFromMatrixPosition(F.matrixWorld)),nn.logarithmicDepthBuffer&&mn.setValue(Z,"logDepthBufFC",2/(Math.log(F.far+1)/Math.LN2)),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&mn.setValue(Z,"isOrthographic",F.isOrthographicCamera===!0),V!==F&&(V=F,ui=!0,Rl=!0)}if(xt.needsLights&&(fn.state.directionalShadowMap.length>0&&mn.setValue(Z,"directionalShadowMap",fn.state.directionalShadowMap,se),fn.state.spotShadowMap.length>0&&mn.setValue(Z,"spotShadowMap",fn.state.spotShadowMap,se),fn.state.pointShadowMap.length>0&&mn.setValue(Z,"pointShadowMap",fn.state.pointShadowMap,se)),ce.isSkinnedMesh){mn.setOptional(Z,ce,"bindMatrix"),mn.setOptional(Z,ce,"bindMatrixInverse");const _i=ce.skeleton;_i&&(_i.boneTexture===null&&_i.computeBoneTexture(),mn.setValue(Z,"boneTexture",_i.boneTexture,se))}ce.isBatchedMesh&&(mn.setOptional(Z,ce,"batchingTexture"),mn.setValue(Z,"batchingTexture",ce._matricesTexture,se),mn.setOptional(Z,ce,"batchingIdTexture"),mn.setValue(Z,"batchingIdTexture",ce._indirectTexture,se),mn.setOptional(Z,ce,"batchingColorTexture"),ce._colorsTexture!==null&&mn.setValue(Z,"batchingColorTexture",ce._colorsTexture,se));const nr=ge.morphAttributes;if((nr.position!==void 0||nr.normal!==void 0||nr.color!==void 0)&&Ot.update(ce,ge,Fi),(ui||xt.receiveShadow!==ce.receiveShadow)&&(xt.receiveShadow=ce.receiveShadow,mn.setValue(Z,"receiveShadow",ce.receiveShadow)),de.isMeshGouraudMaterial&&de.envMap!==null&&(Lt.envMap.value=at,Lt.flipEnvMap.value=at.isCubeTexture&&at.isRenderTargetTexture===!1?-1:1),de.isMeshStandardMaterial&&de.envMap===null&&ae.environment!==null&&(Lt.envMapIntensity.value=ae.environmentIntensity),Lt.dfgLUT!==void 0&&(Lt.dfgLUT.value=Iz()),ui&&(mn.setValue(Z,"toneMappingExposure",R.toneMappingExposure),xt.needsLights&&Vp(Lt,Rl),$e&&de.fog===!0&&Rt.refreshFogUniforms(Lt,$e),Rt.refreshMaterialUniforms(Lt,de,Te,le,N.state.transmissionRenderTarget[F.id]),x0.upload(Z,zp(xt),Lt,se)),de.isShaderMaterial&&de.uniformsNeedUpdate===!0&&(x0.upload(Z,zp(xt),Lt,se),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&mn.setValue(Z,"center",ce.center),mn.setValue(Z,"modelViewMatrix",ce.modelViewMatrix),mn.setValue(Z,"normalMatrix",ce.normalMatrix),mn.setValue(Z,"modelMatrix",ce.matrixWorld),de.isShaderMaterial||de.isRawShaderMaterial){const _i=de.uniformsGroups;for(let yi=0,Bu=_i.length;yi<Bu;yi++){const Js=_i[yi];De.update(Js,Fi),De.bind(Js,Fi)}}return Fi}function Vp(F,ae){F.ambientLightColor.needsUpdate=ae,F.lightProbe.needsUpdate=ae,F.directionalLights.needsUpdate=ae,F.directionalLightShadows.needsUpdate=ae,F.pointLights.needsUpdate=ae,F.pointLightShadows.needsUpdate=ae,F.spotLights.needsUpdate=ae,F.spotLightShadows.needsUpdate=ae,F.rectAreaLights.needsUpdate=ae,F.hemisphereLights.needsUpdate=ae}function jp(F){return F.isMeshLambertMaterial||F.isMeshToonMaterial||F.isMeshPhongMaterial||F.isMeshStandardMaterial||F.isShadowMaterial||F.isShaderMaterial&&F.lights===!0}this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return z},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(F,ae,ge){const de=k.get(F);de.__autoAllocateDepthBuffer=F.resolveDepthBuffer===!1,de.__autoAllocateDepthBuffer===!1&&(de.__useRenderToTexture=!1),k.get(F.texture).__webglTexture=ae,k.get(F.depthTexture).__webglTexture=de.__autoAllocateDepthBuffer?void 0:ge,de.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(F,ae){const ge=k.get(F);ge.__webglFramebuffer=ae,ge.__useDefaultFramebuffer=ae===void 0};const D_=Z.createFramebuffer();this.setRenderTarget=function(F,ae=0,ge=0){B=F,L=ae,z=ge;let de=null,ce=!1,$e=!1;if(F){const Ge=k.get(F);if(Ge.__useDefaultFramebuffer!==void 0){ut.bindFramebuffer(Z.FRAMEBUFFER,Ge.__webglFramebuffer),Y.copy(F.viewport),G.copy(F.scissor),W=F.scissorTest,ut.viewport(Y),ut.scissor(G),ut.setScissorTest(W),O=-1;return}else if(Ge.__webglFramebuffer===void 0)se.setupRenderTarget(F);else if(Ge.__hasExternalTextures)se.rebindTextures(F,k.get(F.texture).__webglTexture,k.get(F.depthTexture).__webglTexture);else if(F.depthBuffer){const At=F.depthTexture;if(Ge.__boundDepthTexture!==At){if(At!==null&&k.has(At)&&(F.width!==At.image.width||F.height!==At.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");se.setupDepthRenderbuffer(F)}}const at=F.texture;(at.isData3DTexture||at.isDataArrayTexture||at.isCompressedArrayTexture)&&($e=!0);const nt=k.get(F).__webglFramebuffer;F.isWebGLCubeRenderTarget?(Array.isArray(nt[ae])?de=nt[ae][ge]:de=nt[ae],ce=!0):F.samples>0&&se.useMultisampledRTT(F)===!1?de=k.get(F).__webglMultisampledFramebuffer:Array.isArray(nt)?de=nt[ge]:de=nt,Y.copy(F.viewport),G.copy(F.scissor),W=F.scissorTest}else Y.copy(q).multiplyScalar(Te).floor(),G.copy(re).multiplyScalar(Te).floor(),W=we;if(ge!==0&&(de=D_),ut.bindFramebuffer(Z.FRAMEBUFFER,de)&&ut.drawBuffers(F,de),ut.viewport(Y),ut.scissor(G),ut.setScissorTest(W),ce){const Ge=k.get(F.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_CUBE_MAP_POSITIVE_X+ae,Ge.__webglTexture,ge)}else if($e){const Ge=ae;for(let at=0;at<F.textures.length;at++){const nt=k.get(F.textures[at]);Z.framebufferTextureLayer(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0+at,nt.__webglTexture,ge,Ge)}}else if(F!==null&&ge!==0){const Ge=k.get(F.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,Ge.__webglTexture,ge)}O=-1},this.readRenderTargetPixels=function(F,ae,ge,de,ce,$e,Je,Ge=0){if(!(F&&F.isWebGLRenderTarget)){Ee("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let at=k.get(F).__webglFramebuffer;if(F.isWebGLCubeRenderTarget&&Je!==void 0&&(at=at[Je]),at){ut.bindFramebuffer(Z.FRAMEBUFFER,at);try{const nt=F.textures[Ge],At=nt.format,vt=nt.type;if(!nn.textureFormatReadable(At)){Ee("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!nn.textureTypeReadable(vt)){Ee("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ae>=0&&ae<=F.width-de&&ge>=0&&ge<=F.height-ce&&(F.textures.length>1&&Z.readBuffer(Z.COLOR_ATTACHMENT0+Ge),Z.readPixels(ae,ge,de,ce,Le.convert(At),Le.convert(vt),$e))}finally{const nt=B!==null?k.get(B).__webglFramebuffer:null;ut.bindFramebuffer(Z.FRAMEBUFFER,nt)}}},this.readRenderTargetPixelsAsync=async function(F,ae,ge,de,ce,$e,Je,Ge=0){if(!(F&&F.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=k.get(F).__webglFramebuffer;if(F.isWebGLCubeRenderTarget&&Je!==void 0&&(at=at[Je]),at)if(ae>=0&&ae<=F.width-de&&ge>=0&&ge<=F.height-ce){ut.bindFramebuffer(Z.FRAMEBUFFER,at);const nt=F.textures[Ge],At=nt.format,vt=nt.type;if(!nn.textureFormatReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!nn.textureTypeReadable(vt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Vt=Z.createBuffer();Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Vt),Z.bufferData(Z.PIXEL_PACK_BUFFER,$e.byteLength,Z.STREAM_READ),F.textures.length>1&&Z.readBuffer(Z.COLOR_ATTACHMENT0+Ge),Z.readPixels(ae,ge,de,ce,Le.convert(At),Le.convert(vt),0);const sn=B!==null?k.get(B).__webglFramebuffer:null;ut.bindFramebuffer(Z.FRAMEBUFFER,sn);const Cn=Z.fenceSync(Z.SYNC_GPU_COMMANDS_COMPLETE,0);return Z.flush(),await ML(Z,Cn,4),Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Vt),Z.getBufferSubData(Z.PIXEL_PACK_BUFFER,0,$e),Z.deleteBuffer(Vt),Z.deleteSync(Cn),$e}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(F,ae=null,ge=0){const de=Math.pow(2,-ge),ce=Math.floor(F.image.width*de),$e=Math.floor(F.image.height*de),Je=ae!==null?ae.x:0,Ge=ae!==null?ae.y:0;se.setTexture2D(F,0),Z.copyTexSubImage2D(Z.TEXTURE_2D,ge,0,0,Je,Ge,ce,$e),ut.unbindTexture()};const k_=Z.createFramebuffer(),Xn=Z.createFramebuffer();this.copyTextureToTexture=function(F,ae,ge=null,de=null,ce=0,$e=null){$e===null&&(ce!==0?(Fn("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),$e=ce,ce=0):$e=0);let Je,Ge,at,nt,At,vt,Vt,sn,Cn;const Tn=F.isCompressedTexture?F.mipmaps[$e]:F.image;if(ge!==null)Je=ge.max.x-ge.min.x,Ge=ge.max.y-ge.min.y,at=ge.isBox3?ge.max.z-ge.min.z:1,nt=ge.min.x,At=ge.min.y,vt=ge.isBox3?ge.min.z:0;else{const nr=Math.pow(2,-ce);Je=Math.floor(Tn.width*nr),Ge=Math.floor(Tn.height*nr),F.isDataArrayTexture?at=Tn.depth:F.isData3DTexture?at=Math.floor(Tn.depth*nr):at=1,nt=0,At=0,vt=0}de!==null?(Vt=de.x,sn=de.y,Cn=de.z):(Vt=0,sn=0,Cn=0);const un=Le.convert(ae.format),xt=Le.convert(ae.type);let fn;ae.isData3DTexture?(se.setTexture3D(ae,0),fn=Z.TEXTURE_3D):ae.isDataArrayTexture||ae.isCompressedArrayTexture?(se.setTexture2DArray(ae,0),fn=Z.TEXTURE_2D_ARRAY):(se.setTexture2D(ae,0),fn=Z.TEXTURE_2D),Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,ae.flipY),Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ae.premultiplyAlpha),Z.pixelStorei(Z.UNPACK_ALIGNMENT,ae.unpackAlignment);const Zt=Z.getParameter(Z.UNPACK_ROW_LENGTH),Fi=Z.getParameter(Z.UNPACK_IMAGE_HEIGHT),Qs=Z.getParameter(Z.UNPACK_SKIP_PIXELS),ui=Z.getParameter(Z.UNPACK_SKIP_ROWS),Rl=Z.getParameter(Z.UNPACK_SKIP_IMAGES);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,Tn.width),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,Tn.height),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,nt),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,At),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,vt);const mn=F.isDataArrayTexture||F.isData3DTexture,Lt=ae.isDataArrayTexture||ae.isData3DTexture;if(F.isDepthTexture){const nr=k.get(F),_i=k.get(ae),yi=k.get(nr.__renderTarget),Bu=k.get(_i.__renderTarget);ut.bindFramebuffer(Z.READ_FRAMEBUFFER,yi.__webglFramebuffer),ut.bindFramebuffer(Z.DRAW_FRAMEBUFFER,Bu.__webglFramebuffer);for(let Js=0;Js<at;Js++)mn&&(Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,k.get(F).__webglTexture,ce,vt+Js),Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,k.get(ae).__webglTexture,$e,Cn+Js)),Z.blitFramebuffer(nt,At,Je,Ge,Vt,sn,Je,Ge,Z.DEPTH_BUFFER_BIT,Z.NEAREST);ut.bindFramebuffer(Z.READ_FRAMEBUFFER,null),ut.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else if(ce!==0||F.isRenderTargetTexture||k.has(F)){const nr=k.get(F),_i=k.get(ae);ut.bindFramebuffer(Z.READ_FRAMEBUFFER,k_),ut.bindFramebuffer(Z.DRAW_FRAMEBUFFER,Xn);for(let yi=0;yi<at;yi++)mn?Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,nr.__webglTexture,ce,vt+yi):Z.framebufferTexture2D(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,nr.__webglTexture,ce),Lt?Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,_i.__webglTexture,$e,Cn+yi):Z.framebufferTexture2D(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,_i.__webglTexture,$e),ce!==0?Z.blitFramebuffer(nt,At,Je,Ge,Vt,sn,Je,Ge,Z.COLOR_BUFFER_BIT,Z.NEAREST):Lt?Z.copyTexSubImage3D(fn,$e,Vt,sn,Cn+yi,nt,At,Je,Ge):Z.copyTexSubImage2D(fn,$e,Vt,sn,nt,At,Je,Ge);ut.bindFramebuffer(Z.READ_FRAMEBUFFER,null),ut.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else Lt?F.isDataTexture||F.isData3DTexture?Z.texSubImage3D(fn,$e,Vt,sn,Cn,Je,Ge,at,un,xt,Tn.data):ae.isCompressedArrayTexture?Z.compressedTexSubImage3D(fn,$e,Vt,sn,Cn,Je,Ge,at,un,Tn.data):Z.texSubImage3D(fn,$e,Vt,sn,Cn,Je,Ge,at,un,xt,Tn):F.isDataTexture?Z.texSubImage2D(Z.TEXTURE_2D,$e,Vt,sn,Je,Ge,un,xt,Tn.data):F.isCompressedTexture?Z.compressedTexSubImage2D(Z.TEXTURE_2D,$e,Vt,sn,Tn.width,Tn.height,un,Tn.data):Z.texSubImage2D(Z.TEXTURE_2D,$e,Vt,sn,Je,Ge,un,xt,Tn);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,Zt),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,Fi),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,Qs),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,ui),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,Rl),$e===0&&ae.generateMipmaps&&Z.generateMipmap(fn),ut.unbindTexture()},this.initRenderTarget=function(F){k.get(F).__webglFramebuffer===void 0&&se.setupRenderTarget(F)},this.initTexture=function(F){F.isCubeTexture?se.setTextureCube(F,0):F.isData3DTexture?se.setTexture3D(F,0):F.isDataArrayTexture||F.isCompressedArrayTexture?se.setTexture2DArray(F,0):se.setTexture2D(F,0),ut.unbindTexture()},this.resetState=function(){L=0,z=0,B=null,ut.reset(),Ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return fr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=bt._getDrawingBufferColorSpace(e),t.unpackColorSpace=bt._getUnpackColorSpace()}}const nh=new zs,no=new Xe,aN=new X,Hv=new Xe,b0=new Xe,k0=new X,Fb=new X,oN=new hn,lN=new X,uN=new X;let $i=null,da=null;const io=[],dl={NONE:-1,PAN:0,ROTATE:1};class Fz extends r_{constructor(e,t,n=null){super(t,n),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new eN,this.mouseButtons={LEFT:Pi.PAN,MIDDLE:Pi.PAN,RIGHT:Pi.ROTATE},this.touches={ONE:so.PAN},this._onPointerMove=Uz.bind(this),this._onPointerDown=Oz.bind(this),this._onPointerCancel=Bz.bind(this),this._onContextMenu=zz.bind(this),n!==null&&this.connect(n)}connect(e){super.connect(e),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){const t=this.domElement.getBoundingClientRect();no.x=(e.clientX-t.left)/t.width*2-1,no.y=-(e.clientY-t.top)/t.height*2+1}_updateState(e){let t;if(e.pointerType==="touch")t=this.touches.ONE;else switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=null}switch(t){case Pi.PAN:case so.PAN:this.state=dl.PAN;break;case Pi.ROTATE:case so.ROTATE:this.state=dl.ROTATE;break;default:this.state=dl.NONE}}}function Uz(i){const e=this.object,t=this.domElement,n=this.raycaster;if(this.enabled!==!1){if(this._updatePointer(i),n.setFromCamera(no,e),$i)this.state===dl.PAN?n.ray.intersectPlane(nh,k0)&&($i.position.copy(k0.sub(aN).applyMatrix4(oN)),this.dispatchEvent({type:"drag",object:$i})):this.state===dl.ROTATE&&(Hv.subVectors(no,b0).multiplyScalar(this.rotateSpeed),$i.rotateOnWorldAxis(lN,Hv.x),$i.rotateOnWorldAxis(uN.normalize(),-Hv.y),this.dispatchEvent({type:"drag",object:$i})),b0.copy(no);else if(i.pointerType==="mouse"||i.pointerType==="pen")if(io.length=0,n.setFromCamera(no,e),n.intersectObjects(this.objects,this.recursive,io),io.length>0){const r=io[0].object;nh.setFromNormalAndCoplanarPoint(e.getWorldDirection(nh.normal),Fb.setFromMatrixPosition(r.matrixWorld)),da!==r&&da!==null&&(this.dispatchEvent({type:"hoveroff",object:da}),t.style.cursor="auto",da=null),da!==r&&(this.dispatchEvent({type:"hoveron",object:r}),t.style.cursor="pointer",da=r)}else da!==null&&(this.dispatchEvent({type:"hoveroff",object:da}),t.style.cursor="auto",da=null);b0.copy(no)}}function Oz(i){const e=this.object,t=this.domElement,n=this.raycaster;this.enabled!==!1&&(this._updatePointer(i),this._updateState(i),io.length=0,n.setFromCamera(no,e),n.intersectObjects(this.objects,this.recursive,io),io.length>0&&(this.transformGroup===!0?$i=cN(io[0].object):$i=io[0].object,nh.setFromNormalAndCoplanarPoint(e.getWorldDirection(nh.normal),Fb.setFromMatrixPosition($i.matrixWorld)),n.ray.intersectPlane(nh,k0)&&(this.state===dl.PAN?(oN.copy($i.parent.matrixWorld).invert(),aN.copy(k0).sub(Fb.setFromMatrixPosition($i.matrixWorld)),t.style.cursor="move",this.dispatchEvent({type:"dragstart",object:$i})):this.state===dl.ROTATE&&(lN.set(0,1,0).applyQuaternion(e.quaternion).normalize(),uN.set(1,0,0).applyQuaternion(e.quaternion).normalize(),t.style.cursor="move",this.dispatchEvent({type:"dragstart",object:$i})))),b0.copy(no))}function Bz(){this.enabled!==!1&&($i&&(this.dispatchEvent({type:"dragend",object:$i}),$i=null),this.domElement.style.cursor=da?"pointer":"auto",this.state=dl.NONE)}function zz(i){this.enabled!==!1&&i.preventDefault()}function cN(i,e=null){return i.isGroup&&(e=i),i.parent===null?e:cN(i.parent,e)}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const hN="160",Ub=0,Gz=1,FA=1,UA=100,OA=204,BA=205,zA=3,dN=0,fN=300,GA=1e3,dm=1001,VA=1002,jA=1003,Vz=1006,jz=1008,Hz=1009,Wz=1014,$z=1015,qz=1020,Xz=1023,Wv=1026,HA=1027,Yz=3e3,$v=3001,Kz=0,w0="",Os="srgb",pS="srgb-linear",Zz="display-p3",pN="display-p3-linear",Ob="linear",WA="srgb",$A="rec709",qA="p3",wc=7680,XA=519,Qz=515,YA=35044,fm=2e3,KA=2001;class o_{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const ji=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Rp(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ji[i&255]+ji[i>>8&255]+ji[i>>16&255]+ji[i>>24&255]+"-"+ji[e&255]+ji[e>>8&255]+"-"+ji[e>>16&15|64]+ji[e>>24&255]+"-"+ji[t&63|128]+ji[t>>8&255]+"-"+ji[t>>16&255]+ji[t>>24&255]+ji[n&255]+ji[n>>8&255]+ji[n>>16&255]+ji[n>>24&255]).toLowerCase()}function qi(i,e,t){return Math.max(e,Math.min(t,i))}function Jz(i,e){return(i%e+e)%e}function qv(i,e,t){return(1-t)*i+t*e}function ef(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Tr(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}class Jt{constructor(e=0,t=0){Jt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(qi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class vl{constructor(e,t,n,r,s,a,o,l,c){vl.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c)}set(e,t,n,r,s,a,o,l,c){const d=this.elements;return d[0]=e,d[1]=r,d[2]=o,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=a,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],d=n[4],f=n[7],p=n[2],m=n[5],_=n[8],b=r[0],v=r[3],y=r[6],S=r[1],T=r[4],E=r[7],N=r[2],M=r[5],C=r[8];return s[0]=a*b+o*S+l*N,s[3]=a*v+o*T+l*M,s[6]=a*y+o*E+l*C,s[1]=c*b+d*S+f*N,s[4]=c*v+d*T+f*M,s[7]=c*y+d*E+f*C,s[2]=p*b+m*S+_*N,s[5]=p*v+m*T+_*M,s[8]=p*y+m*E+_*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8];return t*a*d-t*o*c-n*s*d+n*o*l+r*s*c-r*a*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],f=d*a-o*c,p=o*l-d*s,m=c*s-a*l,_=t*f+n*p+r*m;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/_;return e[0]=f*b,e[1]=(r*c-d*n)*b,e[2]=(o*n-r*a)*b,e[3]=p*b,e[4]=(d*t-r*l)*b,e[5]=(r*s-o*t)*b,e[6]=m*b,e[7]=(n*l-c*t)*b,e[8]=(a*t-n*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-r*c,r*l,-r*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(Xv.makeScale(e,t)),this}rotate(e){return this.premultiply(Xv.makeRotation(-e)),this}translate(e,t){return this.premultiply(Xv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Xv=new vl;function e5(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function ZA(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const QA={};function Yv(i){i in QA||(QA[i]=!0,console.warn(i))}const JA=new vl().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),eE=new vl().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),pm={[pS]:{transfer:Ob,primaries:$A,toReference:i=>i,fromReference:i=>i},[Os]:{transfer:WA,primaries:$A,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[pN]:{transfer:Ob,primaries:qA,toReference:i=>i.applyMatrix3(eE),fromReference:i=>i.applyMatrix3(JA)},[Zz]:{transfer:WA,primaries:qA,toReference:i=>i.convertSRGBToLinear().applyMatrix3(eE),fromReference:i=>i.applyMatrix3(JA).convertLinearToSRGB()}},t5=new Set([pS,pN]),Ds={enabled:!0,_workingColorSpace:pS,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!t5.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;const n=pm[e].toReference,r=pm[t].fromReference;return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return pm[i].primaries},getTransfer:function(i){return i===w0?Ob:pm[i].transfer}};function ih(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Kv(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Sc;class n5{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Sc===void 0&&(Sc=ZA("canvas")),Sc.width=e.width,Sc.height=e.height;const n=Sc.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Sc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ZA("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=ih(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ih(t[n]/255)*255):t[n]=ih(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let i5=0;class r5{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:i5++}),this.uuid=Rp(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(Zv(r[a].image)):s.push(Zv(r[a]))}else s=Zv(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function Zv(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?n5.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let s5=0;class fl extends o_{constructor(e=fl.DEFAULT_IMAGE,t=fl.DEFAULT_MAPPING,n=dm,r=dm,s=Vz,a=jz,o=Xz,l=Hz,c=fl.DEFAULT_ANISOTROPY,d=w0){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:s5++}),this.uuid=Rp(),this.name="",this.source=new r5(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vl,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(Yv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===$v?Os:w0),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==fN)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case GA:e.x=e.x-Math.floor(e.x);break;case dm:e.x=e.x<0?0:1;break;case VA:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case GA:e.y=e.y-Math.floor(e.y);break;case dm:e.y=e.y<0?0:1;break;case VA:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Yv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Os?$v:Yz}set encoding(e){Yv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===$v?Os:w0}}fl.DEFAULT_IMAGE=null;fl.DEFAULT_MAPPING=fN;fl.DEFAULT_ANISOTROPY=1;class Np{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,o){let l=n[r+0],c=n[r+1],d=n[r+2],f=n[r+3];const p=s[a+0],m=s[a+1],_=s[a+2],b=s[a+3];if(o===0){e[t+0]=l,e[t+1]=c,e[t+2]=d,e[t+3]=f;return}if(o===1){e[t+0]=p,e[t+1]=m,e[t+2]=_,e[t+3]=b;return}if(f!==b||l!==p||c!==m||d!==_){let v=1-o;const y=l*p+c*m+d*_+f*b,S=y>=0?1:-1,T=1-y*y;if(T>Number.EPSILON){const N=Math.sqrt(T),M=Math.atan2(N,y*S);v=Math.sin(v*M)/N,o=Math.sin(o*M)/N}const E=o*S;if(l=l*v+p*E,c=c*v+m*E,d=d*v+_*E,f=f*v+b*E,v===1-o){const N=1/Math.sqrt(l*l+c*c+d*d+f*f);l*=N,c*=N,d*=N,f*=N}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,s,a){const o=n[r],l=n[r+1],c=n[r+2],d=n[r+3],f=s[a],p=s[a+1],m=s[a+2],_=s[a+3];return e[t]=o*_+d*f+l*m-c*p,e[t+1]=l*_+d*p+c*f-o*m,e[t+2]=c*_+d*m+o*p-l*f,e[t+3]=d*_-o*f-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(n/2),d=o(r/2),f=o(s/2),p=l(n/2),m=l(r/2),_=l(s/2);switch(a){case"XYZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"YXZ":this._x=p*d*f+c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"ZXY":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f-p*m*_;break;case"ZYX":this._x=p*d*f-c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f+p*m*_;break;case"YZX":this._x=p*d*f+c*m*_,this._y=c*m*f+p*d*_,this._z=c*d*_-p*m*f,this._w=c*d*f-p*m*_;break;case"XZY":this._x=p*d*f-c*m*_,this._y=c*m*f-p*d*_,this._z=c*d*_+p*m*f,this._w=c*d*f+p*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],d=t[6],f=t[10],p=n+o+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-c)*m,this._z=(a-r)*m}else if(n>o&&n>f){const m=2*Math.sqrt(1+n-o-f);this._w=(d-l)/m,this._x=.25*m,this._y=(r+a)/m,this._z=(s+c)/m}else if(o>f){const m=2*Math.sqrt(1+o-n-f);this._w=(s-c)/m,this._x=(r+a)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+f-n-o);this._w=(a-r)/m,this._x=(s+c)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(qi(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+a*o+r*c-s*l,this._y=r*d+a*l+s*o-n*c,this._z=s*d+a*c+n*l-r*o,this._w=a*d-n*o-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+n*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const m=1-t;return this._w=m*a+t*this._w,this._x=m*n+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),d=Math.atan2(c,o),f=Math.sin((1-t)*d)/c,p=Math.sin(t*d)/c;return this._w=a*f+this._w*p,this._x=n*f+this._x*p,this._y=r*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class fe{constructor(e=0,t=0,n=0){fe.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(tE.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(tE.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*r-o*n),d=2*(o*t-s*r),f=2*(s*n-a*t);return this.x=t+l*c+a*f-o*d,this.y=n+l*d+o*c-s*f,this.z=r+l*f+s*d-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=r*l-s*o,this.y=s*a-n*l,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Qv.copy(this).projectOnVector(e),this.sub(Qv)}reflect(e){return this.sub(Qv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(qi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qv=new fe,tE=new Np;class ed{constructor(e=new fe(1/0,1/0,1/0),t=new fe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(ks.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(ks.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ks.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,ks):ks.fromBufferAttribute(s,a),ks.applyMatrix4(e.matrixWorld),this.expandByPoint(ks);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),gm.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),gm.copy(n.boundingBox)),gm.applyMatrix4(e.matrixWorld),this.union(gm)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ks),ks.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tf),mm.subVectors(this.max,tf),Tc.subVectors(e.a,tf),Mc.subVectors(e.b,tf),Ac.subVectors(e.c,tf),qo.subVectors(Mc,Tc),Xo.subVectors(Ac,Mc),Xl.subVectors(Tc,Ac);let t=[0,-qo.z,qo.y,0,-Xo.z,Xo.y,0,-Xl.z,Xl.y,qo.z,0,-qo.x,Xo.z,0,-Xo.x,Xl.z,0,-Xl.x,-qo.y,qo.x,0,-Xo.y,Xo.x,0,-Xl.y,Xl.x,0];return!Jv(t,Tc,Mc,Ac,mm)||(t=[1,0,0,0,1,0,0,0,1],!Jv(t,Tc,Mc,Ac,mm))?!1:(_m.crossVectors(qo,Xo),t=[_m.x,_m.y,_m.z],Jv(t,Tc,Mc,Ac,mm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ks).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ks).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ha[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ha[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ha[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ha[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ha[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ha[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ha[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ha[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ha),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ha=[new fe,new fe,new fe,new fe,new fe,new fe,new fe,new fe],ks=new fe,gm=new ed,Tc=new fe,Mc=new fe,Ac=new fe,qo=new fe,Xo=new fe,Xl=new fe,tf=new fe,mm=new fe,_m=new fe,Yl=new fe;function Jv(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){Yl.fromArray(i,s);const o=r.x*Math.abs(Yl.x)+r.y*Math.abs(Yl.y)+r.z*Math.abs(Yl.z),l=e.dot(Yl),c=t.dot(Yl),d=n.dot(Yl);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>o)return!1}return!0}const a5=new ed,nf=new fe,ex=new fe;class gS{constructor(e=new fe,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):a5.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;nf.subVectors(e,this.center);const t=nf.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(nf,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ex.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(nf.copy(e.center).add(ex)),this.expandByPoint(nf.copy(e.center).sub(ex))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Wa=new fe,tx=new fe,ym=new fe,Yo=new fe,nx=new fe,vm=new fe,ix=new fe;class gN{constructor(e=new fe,t=new fe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Wa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Wa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Wa.copy(this.origin).addScaledVector(this.direction,t),Wa.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){tx.copy(e).add(t).multiplyScalar(.5),ym.copy(t).sub(e).normalize(),Yo.copy(this.origin).sub(tx);const s=e.distanceTo(t)*.5,a=-this.direction.dot(ym),o=Yo.dot(this.direction),l=-Yo.dot(ym),c=Yo.lengthSq(),d=Math.abs(1-a*a);let f,p,m,_;if(d>0)if(f=a*l-o,p=a*o-l,_=s*d,f>=0)if(p>=-_)if(p<=_){const b=1/d;f*=b,p*=b,m=f*(f+a*p+2*o)+p*(a*f+p+2*l)+c}else p=s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;else p=-s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;else p<=-_?(f=Math.max(0,-(-a*s+o)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c):p<=_?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(f=Math.max(0,-(a*s+o)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+c);else p=a>0?-s:s,f=Math.max(0,-(a*p+o)),m=-f*f+p*(p+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(tx).addScaledVector(ym,p),m}intersectSphere(e,t){Wa.subVectors(e.center,this.origin);const n=Wa.dot(this.direction),r=Wa.dot(Wa)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,o,l;const c=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return c>=0?(n=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(n=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),d>=0?(s=(e.min.y-p.y)*d,a=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,a=(e.min.y-p.y)*d),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),f>=0?(o=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(o=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),n>l||o>r)||((o>n||n!==n)&&(n=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Wa)!==null}intersectTriangle(e,t,n,r,s){nx.subVectors(t,e),vm.subVectors(n,e),ix.crossVectors(nx,vm);let a=this.direction.dot(ix),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Yo.subVectors(this.origin,e);const l=o*this.direction.dot(vm.crossVectors(Yo,vm));if(l<0)return null;const c=o*this.direction.dot(nx.cross(Yo));if(c<0||l+c>a)return null;const d=-o*Yo.dot(ix);return d<0?null:this.at(d/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Zi{constructor(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v){Zi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v)}set(e,t,n,r,s,a,o,l,c,d,f,p,m,_,b,v){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=a,y[9]=o,y[13]=l,y[2]=c,y[6]=d,y[10]=f,y[14]=p,y[3]=m,y[7]=_,y[11]=b,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Zi().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Ec.setFromMatrixColumn(e,0).length(),s=1/Ec.setFromMatrixColumn(e,1).length(),a=1/Ec.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(r),c=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=a*d,m=a*f,_=o*d,b=o*f;t[0]=l*d,t[4]=-l*f,t[8]=c,t[1]=m+_*c,t[5]=p-b*c,t[9]=-o*l,t[2]=b-p*c,t[6]=_+m*c,t[10]=a*l}else if(e.order==="YXZ"){const p=l*d,m=l*f,_=c*d,b=c*f;t[0]=p+b*o,t[4]=_*o-m,t[8]=a*c,t[1]=a*f,t[5]=a*d,t[9]=-o,t[2]=m*o-_,t[6]=b+p*o,t[10]=a*l}else if(e.order==="ZXY"){const p=l*d,m=l*f,_=c*d,b=c*f;t[0]=p-b*o,t[4]=-a*f,t[8]=_+m*o,t[1]=m+_*o,t[5]=a*d,t[9]=b-p*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const p=a*d,m=a*f,_=o*d,b=o*f;t[0]=l*d,t[4]=_*c-m,t[8]=p*c+b,t[1]=l*f,t[5]=b*c+p,t[9]=m*c-_,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const p=a*l,m=a*c,_=o*l,b=o*c;t[0]=l*d,t[4]=b-p*f,t[8]=_*f+m,t[1]=f,t[5]=a*d,t[9]=-o*d,t[2]=-c*d,t[6]=m*f+_,t[10]=p-b*f}else if(e.order==="XZY"){const p=a*l,m=a*c,_=o*l,b=o*c;t[0]=l*d,t[4]=-f,t[8]=c*d,t[1]=p*f+b,t[5]=a*d,t[9]=m*f-_,t[2]=_*f-m,t[6]=o*d,t[10]=b*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(o5,e,l5)}lookAt(e,t,n){const r=this.elements;return Wr.subVectors(e,t),Wr.lengthSq()===0&&(Wr.z=1),Wr.normalize(),Ko.crossVectors(n,Wr),Ko.lengthSq()===0&&(Math.abs(n.z)===1?Wr.x+=1e-4:Wr.z+=1e-4,Wr.normalize(),Ko.crossVectors(n,Wr)),Ko.normalize(),xm.crossVectors(Wr,Ko),r[0]=Ko.x,r[4]=xm.x,r[8]=Wr.x,r[1]=Ko.y,r[5]=xm.y,r[9]=Wr.y,r[2]=Ko.z,r[6]=xm.z,r[10]=Wr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],d=n[1],f=n[5],p=n[9],m=n[13],_=n[2],b=n[6],v=n[10],y=n[14],S=n[3],T=n[7],E=n[11],N=n[15],M=r[0],C=r[4],D=r[8],R=r[12],P=r[1],L=r[5],z=r[9],B=r[13],O=r[2],V=r[6],Y=r[10],G=r[14],W=r[3],te=r[7],U=r[11],H=r[15];return s[0]=a*M+o*P+l*O+c*W,s[4]=a*C+o*L+l*V+c*te,s[8]=a*D+o*z+l*Y+c*U,s[12]=a*R+o*B+l*G+c*H,s[1]=d*M+f*P+p*O+m*W,s[5]=d*C+f*L+p*V+m*te,s[9]=d*D+f*z+p*Y+m*U,s[13]=d*R+f*B+p*G+m*H,s[2]=_*M+b*P+v*O+y*W,s[6]=_*C+b*L+v*V+y*te,s[10]=_*D+b*z+v*Y+y*U,s[14]=_*R+b*B+v*G+y*H,s[3]=S*M+T*P+E*O+N*W,s[7]=S*C+T*L+E*V+N*te,s[11]=S*D+T*z+E*Y+N*U,s[15]=S*R+T*B+E*G+N*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],d=e[2],f=e[6],p=e[10],m=e[14],_=e[3],b=e[7],v=e[11],y=e[15];return _*(+s*l*f-r*c*f-s*o*p+n*c*p+r*o*m-n*l*m)+b*(+t*l*m-t*c*p+s*a*p-r*a*m+r*c*d-s*l*d)+v*(+t*c*f-t*o*m-s*a*f+n*a*m+s*o*d-n*c*d)+y*(-r*o*d-t*l*f+t*o*p+r*a*f-n*a*p+n*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],m=e[11],_=e[12],b=e[13],v=e[14],y=e[15],S=f*v*c-b*p*c+b*l*m-o*v*m-f*l*y+o*p*y,T=_*p*c-d*v*c-_*l*m+a*v*m+d*l*y-a*p*y,E=d*b*c-_*f*c+_*o*m-a*b*m-d*o*y+a*f*y,N=_*f*l-d*b*l-_*o*p+a*b*p+d*o*v-a*f*v,M=t*S+n*T+r*E+s*N;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/M;return e[0]=S*C,e[1]=(b*p*s-f*v*s-b*r*m+n*v*m+f*r*y-n*p*y)*C,e[2]=(o*v*s-b*l*s+b*r*c-n*v*c-o*r*y+n*l*y)*C,e[3]=(f*l*s-o*p*s-f*r*c+n*p*c+o*r*m-n*l*m)*C,e[4]=T*C,e[5]=(d*v*s-_*p*s+_*r*m-t*v*m-d*r*y+t*p*y)*C,e[6]=(_*l*s-a*v*s-_*r*c+t*v*c+a*r*y-t*l*y)*C,e[7]=(a*p*s-d*l*s+d*r*c-t*p*c-a*r*m+t*l*m)*C,e[8]=E*C,e[9]=(_*f*s-d*b*s-_*n*m+t*b*m+d*n*y-t*f*y)*C,e[10]=(a*b*s-_*o*s+_*n*c-t*b*c-a*n*y+t*o*y)*C,e[11]=(d*o*s-a*f*s-d*n*c+t*f*c+a*n*m-t*o*m)*C,e[12]=N*C,e[13]=(d*b*r-_*f*r+_*n*p-t*b*p-d*n*v+t*f*v)*C,e[14]=(_*o*r-a*b*r-_*n*l+t*b*l+a*n*v-t*o*v)*C,e[15]=(a*f*r-d*o*r+d*n*l-t*f*l-a*n*p+t*o*p)*C,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,o=e.y,l=e.z,c=s*a,d=s*o;return this.set(c*a+n,c*o-r*l,c*l+r*o,0,c*o+r*l,d*o+n,d*l-r*a,0,c*l-r*o,d*l+r*a,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,d=a+a,f=o+o,p=s*c,m=s*d,_=s*f,b=a*d,v=a*f,y=o*f,S=l*c,T=l*d,E=l*f,N=n.x,M=n.y,C=n.z;return r[0]=(1-(b+y))*N,r[1]=(m+E)*N,r[2]=(_-T)*N,r[3]=0,r[4]=(m-E)*M,r[5]=(1-(p+y))*M,r[6]=(v+S)*M,r[7]=0,r[8]=(_+T)*C,r[9]=(v-S)*C,r[10]=(1-(p+b))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Ec.set(r[0],r[1],r[2]).length();const a=Ec.set(r[4],r[5],r[6]).length(),o=Ec.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Is.copy(this);const c=1/s,d=1/a,f=1/o;return Is.elements[0]*=c,Is.elements[1]*=c,Is.elements[2]*=c,Is.elements[4]*=d,Is.elements[5]*=d,Is.elements[6]*=d,Is.elements[8]*=f,Is.elements[9]*=f,Is.elements[10]*=f,t.setFromRotationMatrix(Is),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,r,s,a,o=fm){const l=this.elements,c=2*s/(t-e),d=2*s/(n-r),f=(t+e)/(t-e),p=(n+r)/(n-r);let m,_;if(o===fm)m=-(a+s)/(a-s),_=-2*a*s/(a-s);else if(o===KA)m=-a/(a-s),_=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,a,o=fm){const l=this.elements,c=1/(t-e),d=1/(n-r),f=1/(a-s),p=(t+e)*c,m=(n+r)*d;let _,b;if(o===fm)_=(a+s)*f,b=-2*f;else if(o===KA)_=s*f,b=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=b,l[14]=-_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Ec=new fe,Is=new Zi,o5=new fe(0,0,0),l5=new fe(1,1,1),Ko=new fe,xm=new fe,Wr=new fe,nE=new Zi,iE=new Np;class l_{constructor(e=0,t=0,n=0,r=l_.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],l=r[1],c=r[5],d=r[9],f=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(qi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-qi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(qi(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-qi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(qi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-qi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return nE.makeRotationFromQuaternion(e),this.setFromRotationMatrix(nE,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return iE.setFromEuler(this),this.setFromQuaternion(iE,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}l_.DEFAULT_ORDER="XYZ";class u5{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let c5=0;const rE=new fe,Cc=new Np,$a=new Zi,bm=new fe,rf=new fe,h5=new fe,d5=new Np,sE=new fe(1,0,0),aE=new fe(0,1,0),oE=new fe(0,0,1),f5={type:"added"},p5={type:"removed"};class ms extends o_{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:c5++}),this.uuid=Rp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ms.DEFAULT_UP.clone();const e=new fe,t=new l_,n=new Np,r=new fe(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Zi},normalMatrix:{value:new vl}}),this.matrix=new Zi,this.matrixWorld=new Zi,this.matrixAutoUpdate=ms.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ms.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new u5,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Cc.setFromAxisAngle(e,t),this.quaternion.multiply(Cc),this}rotateOnWorldAxis(e,t){return Cc.setFromAxisAngle(e,t),this.quaternion.premultiply(Cc),this}rotateX(e){return this.rotateOnAxis(sE,e)}rotateY(e){return this.rotateOnAxis(aE,e)}rotateZ(e){return this.rotateOnAxis(oE,e)}translateOnAxis(e,t){return rE.copy(e).applyQuaternion(this.quaternion),this.position.add(rE.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(sE,e)}translateY(e){return this.translateOnAxis(aE,e)}translateZ(e){return this.translateOnAxis(oE,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4($a.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?bm.copy(e):bm.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),rf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$a.lookAt(rf,bm,this.up):$a.lookAt(bm,rf,this.up),this.quaternion.setFromRotationMatrix($a),r&&($a.extractRotation(r.matrixWorld),Cc.setFromRotationMatrix($a),this.quaternion.premultiply(Cc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(f5)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(p5)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),$a.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),$a.multiply(e.parent.matrixWorld)),e.applyMatrix4($a),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rf,e,h5),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rf,d5,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const s=t[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++){const o=r[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,d=l.length;c<d;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),d=a(e.images),f=a(e.shapes),p=a(e.skeletons),m=a(e.animations),_=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),d.length>0&&(n.images=d),f.length>0&&(n.shapes=f),p.length>0&&(n.skeletons=p),m.length>0&&(n.animations=m),_.length>0&&(n.nodes=_)}return n.object=r,n;function a(o){const l=[];for(const c in o){const d=o[c];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}ms.DEFAULT_UP=new fe(0,1,0);ms.DEFAULT_MATRIX_AUTO_UPDATE=!0;ms.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ls=new fe,qa=new fe,rx=new fe,Xa=new fe,Rc=new fe,Nc=new fe,lE=new fe,sx=new fe,ax=new fe,ox=new fe;let wm=!1;class Gs{constructor(e=new fe,t=new fe,n=new fe){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ls.subVectors(e,t),r.cross(Ls);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Ls.subVectors(r,t),qa.subVectors(n,t),rx.subVectors(e,t);const a=Ls.dot(Ls),o=Ls.dot(qa),l=Ls.dot(rx),c=qa.dot(qa),d=qa.dot(rx),f=a*c-o*o;if(f===0)return s.set(0,0,0),null;const p=1/f,m=(c*l-o*d)*p,_=(a*d-o*l)*p;return s.set(1-m-_,_,m)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Xa)===null?!1:Xa.x>=0&&Xa.y>=0&&Xa.x+Xa.y<=1}static getUV(e,t,n,r,s,a,o,l){return wm===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),wm=!0),this.getInterpolation(e,t,n,r,s,a,o,l)}static getInterpolation(e,t,n,r,s,a,o,l){return this.getBarycoord(e,t,n,r,Xa)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Xa.x),l.addScaledVector(a,Xa.y),l.addScaledVector(o,Xa.z),l)}static isFrontFacing(e,t,n,r){return Ls.subVectors(n,t),qa.subVectors(e,t),Ls.cross(qa).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ls.subVectors(this.c,this.b),qa.subVectors(this.a,this.b),Ls.cross(qa).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return wm===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),wm=!0),Gs.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}getInterpolation(e,t,n,r,s){return Gs.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Gs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,o;Rc.subVectors(r,n),Nc.subVectors(s,n),sx.subVectors(e,n);const l=Rc.dot(sx),c=Nc.dot(sx);if(l<=0&&c<=0)return t.copy(n);ax.subVectors(e,r);const d=Rc.dot(ax),f=Nc.dot(ax);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*c;if(p<=0&&l>=0&&d<=0)return a=l/(l-d),t.copy(n).addScaledVector(Rc,a);ox.subVectors(e,s);const m=Rc.dot(ox),_=Nc.dot(ox);if(_>=0&&m<=_)return t.copy(s);const b=m*c-l*_;if(b<=0&&c>=0&&_<=0)return o=c/(c-_),t.copy(n).addScaledVector(Nc,o);const v=d*_-m*f;if(v<=0&&f-d>=0&&m-_>=0)return lE.subVectors(s,r),o=(f-d)/(f-d+(m-_)),t.copy(r).addScaledVector(lE,o);const y=1/(v+b+p);return a=b*y,o=p*y,t.copy(n).addScaledVector(Rc,a).addScaledVector(Nc,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const mN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zo={h:0,s:0,l:0},Sm={h:0,s:0,l:0};function lx(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class ml{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Os){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ds.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=Ds.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ds.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=Ds.workingColorSpace){if(e=Jz(e,1),t=qi(t,0,1),n=qi(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=lx(a,s,e+1/3),this.g=lx(a,s,e),this.b=lx(a,s,e-1/3)}return Ds.toWorkingColorSpace(this,r),this}setStyle(e,t=Os){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Os){const n=mN[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ih(e.r),this.g=ih(e.g),this.b=ih(e.b),this}copyLinearToSRGB(e){return this.r=Kv(e.r),this.g=Kv(e.g),this.b=Kv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Os){return Ds.fromWorkingColorSpace(Hi.copy(this),e),Math.round(qi(Hi.r*255,0,255))*65536+Math.round(qi(Hi.g*255,0,255))*256+Math.round(qi(Hi.b*255,0,255))}getHexString(e=Os){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ds.workingColorSpace){Ds.fromWorkingColorSpace(Hi.copy(this),t);const n=Hi.r,r=Hi.g,s=Hi.b,a=Math.max(n,r,s),o=Math.min(n,r,s);let l,c;const d=(o+a)/2;if(o===a)l=0,c=0;else{const f=a-o;switch(c=d<=.5?f/(a+o):f/(2-a-o),a){case n:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-n)/f+2;break;case s:l=(n-r)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Ds.workingColorSpace){return Ds.fromWorkingColorSpace(Hi.copy(this),t),e.r=Hi.r,e.g=Hi.g,e.b=Hi.b,e}getStyle(e=Os){Ds.fromWorkingColorSpace(Hi.copy(this),e);const t=Hi.r,n=Hi.g,r=Hi.b;return e!==Os?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Zo),this.setHSL(Zo.h+e,Zo.s+t,Zo.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Zo),e.getHSL(Sm);const n=qv(Zo.h,Sm.h,t),r=qv(Zo.s,Sm.s,t),s=qv(Zo.l,Sm.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Hi=new ml;ml.NAMES=mN;let g5=0;class mS extends o_{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:g5++}),this.uuid=Rp(),this.name="",this.type="Material",this.blending=FA,this.side=Ub,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=OA,this.blendDst=BA,this.blendEquation=UA,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ml(0,0,0),this.blendAlpha=0,this.depthFunc=zA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=XA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wc,this.stencilZFail=wc,this.stencilZPass=wc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==FA&&(n.blending=this.blending),this.side!==Ub&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==OA&&(n.blendSrc=this.blendSrc),this.blendDst!==BA&&(n.blendDst=this.blendDst),this.blendEquation!==UA&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==zA&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==XA&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==wc&&(n.stencilFail=this.stencilFail),this.stencilZFail!==wc&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==wc&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Bb extends mS{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ml(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const si=new fe,Tm=new Jt;class pu{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=YA,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=$z,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Tm.fromBufferAttribute(this,t),Tm.applyMatrix3(e),this.setXY(t,Tm.x,Tm.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix3(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix4(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyNormalMatrix(e),this.setXYZ(t,si.x,si.y,si.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.transformDirection(e),this.setXYZ(t,si.x,si.y,si.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ef(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Tr(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ef(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ef(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ef(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ef(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),n=Tr(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),n=Tr(n,this.array),r=Tr(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Tr(t,this.array),n=Tr(n,this.array),r=Tr(r,this.array),s=Tr(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==YA&&(e.usage=this.usage),e}}class m5 extends pu{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class _5 extends pu{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class $s extends pu{constructor(e,t,n){super(new Float32Array(e),t,n)}}let y5=0;const cs=new Zi,ux=new ms,Pc=new fe,$r=new ed,sf=new ed,Si=new fe;class xl extends o_{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:y5++}),this.uuid=Rp(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(e5(e)?_5:m5)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new vl().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return cs.makeRotationFromQuaternion(e),this.applyMatrix4(cs),this}rotateX(e){return cs.makeRotationX(e),this.applyMatrix4(cs),this}rotateY(e){return cs.makeRotationY(e),this.applyMatrix4(cs),this}rotateZ(e){return cs.makeRotationZ(e),this.applyMatrix4(cs),this}translate(e,t,n){return cs.makeTranslation(e,t,n),this.applyMatrix4(cs),this}scale(e,t,n){return cs.makeScale(e,t,n),this.applyMatrix4(cs),this}lookAt(e){return ux.lookAt(e),ux.updateMatrix(),this.applyMatrix4(ux.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pc).negate(),this.translate(Pc.x,Pc.y,Pc.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new $s(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ed);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new fe(-1/0,-1/0,-1/0),new fe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];$r.setFromBufferAttribute(s),this.morphTargetsRelative?(Si.addVectors(this.boundingBox.min,$r.min),this.boundingBox.expandByPoint(Si),Si.addVectors(this.boundingBox.max,$r.max),this.boundingBox.expandByPoint(Si)):(this.boundingBox.expandByPoint($r.min),this.boundingBox.expandByPoint($r.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new gS);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new fe,1/0);return}if(e){const n=this.boundingSphere.center;if($r.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];sf.setFromBufferAttribute(o),this.morphTargetsRelative?(Si.addVectors($r.min,sf.min),$r.expandByPoint(Si),Si.addVectors($r.max,sf.max),$r.expandByPoint(Si)):($r.expandByPoint(sf.min),$r.expandByPoint(sf.max))}$r.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)Si.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Si));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,d=o.count;c<d;c++)Si.fromBufferAttribute(o,c),l&&(Pc.fromBufferAttribute(e,c),Si.add(Pc)),r=Math.max(r,n.distanceToSquared(Si))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=t.position.array,s=t.normal.array,a=t.uv.array,o=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pu(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,c=[],d=[];for(let P=0;P<o;P++)c[P]=new fe,d[P]=new fe;const f=new fe,p=new fe,m=new fe,_=new Jt,b=new Jt,v=new Jt,y=new fe,S=new fe;function T(P,L,z){f.fromArray(r,P*3),p.fromArray(r,L*3),m.fromArray(r,z*3),_.fromArray(a,P*2),b.fromArray(a,L*2),v.fromArray(a,z*2),p.sub(f),m.sub(f),b.sub(_),v.sub(_);const B=1/(b.x*v.y-v.x*b.y);isFinite(B)&&(y.copy(p).multiplyScalar(v.y).addScaledVector(m,-b.y).multiplyScalar(B),S.copy(m).multiplyScalar(b.x).addScaledVector(p,-v.x).multiplyScalar(B),c[P].add(y),c[L].add(y),c[z].add(y),d[P].add(S),d[L].add(S),d[z].add(S))}let E=this.groups;E.length===0&&(E=[{start:0,count:n.length}]);for(let P=0,L=E.length;P<L;++P){const z=E[P],B=z.start,O=z.count;for(let V=B,Y=B+O;V<Y;V+=3)T(n[V+0],n[V+1],n[V+2])}const N=new fe,M=new fe,C=new fe,D=new fe;function R(P){C.fromArray(s,P*3),D.copy(C);const L=c[P];N.copy(L),N.sub(C.multiplyScalar(C.dot(L))).normalize(),M.crossVectors(D,L);const B=M.dot(d[P])<0?-1:1;l[P*4]=N.x,l[P*4+1]=N.y,l[P*4+2]=N.z,l[P*4+3]=B}for(let P=0,L=E.length;P<L;++P){const z=E[P],B=z.start,O=z.count;for(let V=B,Y=B+O;V<Y;V+=3)R(n[V+0]),R(n[V+1]),R(n[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new pu(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let p=0,m=n.count;p<m;p++)n.setXYZ(p,0,0,0);const r=new fe,s=new fe,a=new fe,o=new fe,l=new fe,c=new fe,d=new fe,f=new fe;if(e)for(let p=0,m=e.count;p<m;p+=3){const _=e.getX(p+0),b=e.getX(p+1),v=e.getX(p+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,b),a.fromBufferAttribute(t,v),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),o.fromBufferAttribute(n,_),l.fromBufferAttribute(n,b),c.fromBufferAttribute(n,v),o.add(d),l.add(d),c.add(d),n.setXYZ(_,o.x,o.y,o.z),n.setXYZ(b,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),a.fromBufferAttribute(t,p+2),d.subVectors(a,s),f.subVectors(r,s),d.cross(f),n.setXYZ(p+0,d.x,d.y,d.z),n.setXYZ(p+1,d.x,d.y,d.z),n.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Si.fromBufferAttribute(e,t),Si.normalize(),e.setXYZ(t,Si.x,Si.y,Si.z)}toNonIndexed(){function e(o,l){const c=o.array,d=o.itemSize,f=o.normalized,p=new c.constructor(l.length*d);let m=0,_=0;for(let b=0,v=l.length;b<v;b++){o.isInterleavedBufferAttribute?m=l[b]*o.data.stride+o.offset:m=l[b]*d;for(let y=0;y<d;y++)p[_++]=c[m++]}return new pu(p,d,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new xl,n=this.index.array,r=this.attributes;for(const o in r){const l=r[o],c=e(l,n);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let d=0,f=c.length;d<f;d++){const p=c[d],m=e(p,n);l.push(m)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let f=0,p=c.length;f<p;f++){const m=c[f];d.push(m.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r){const d=r[c];this.setAttribute(c,d.clone(t))}const s=e.morphAttributes;for(const c in s){const d=[],f=s[c];for(let p=0,m=f.length;p<m;p++)d.push(f[p].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,d=a.length;c<d;c++){const f=a[c];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const uE=new Zi,Kl=new gN,Mm=new gS,cE=new fe,Dc=new fe,kc=new fe,Ic=new fe,cx=new fe,Am=new fe,Em=new Jt,Cm=new Jt,Rm=new Jt,hE=new fe,dE=new fe,fE=new fe,Nm=new fe,Pm=new fe;class zb extends ms{constructor(e=new xl,t=new Bb){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){Am.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=o[l],f=s[l];d!==0&&(cx.fromBufferAttribute(f,e),a?Am.addScaledVector(cx,d):Am.addScaledVector(cx.sub(t),d))}t.add(Am)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Mm.copy(n.boundingSphere),Mm.applyMatrix4(s),Kl.copy(e.ray).recast(e.near),!(Mm.containsPoint(Kl.origin)===!1&&(Kl.intersectSphere(Mm,cE)===null||Kl.origin.distanceToSquared(cE)>(e.far-e.near)**2))&&(uE.copy(s).invert(),Kl.copy(e.ray).applyMatrix4(uE),!(n.boundingBox!==null&&Kl.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Kl)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(o!==null)if(Array.isArray(a))for(let _=0,b=p.length;_<b;_++){const v=p[_],y=a[v.materialIndex],S=Math.max(v.start,m.start),T=Math.min(o.count,Math.min(v.start+v.count,m.start+m.count));for(let E=S,N=T;E<N;E+=3){const M=o.getX(E),C=o.getX(E+1),D=o.getX(E+2);r=Dm(this,y,e,n,c,d,f,M,C,D),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const _=Math.max(0,m.start),b=Math.min(o.count,m.start+m.count);for(let v=_,y=b;v<y;v+=3){const S=o.getX(v),T=o.getX(v+1),E=o.getX(v+2);r=Dm(this,a,e,n,c,d,f,S,T,E),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let _=0,b=p.length;_<b;_++){const v=p[_],y=a[v.materialIndex],S=Math.max(v.start,m.start),T=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));for(let E=S,N=T;E<N;E+=3){const M=E,C=E+1,D=E+2;r=Dm(this,y,e,n,c,d,f,M,C,D),r&&(r.faceIndex=Math.floor(E/3),r.face.materialIndex=v.materialIndex,t.push(r))}}else{const _=Math.max(0,m.start),b=Math.min(l.count,m.start+m.count);for(let v=_,y=b;v<y;v+=3){const S=v,T=v+1,E=v+2;r=Dm(this,a,e,n,c,d,f,S,T,E),r&&(r.faceIndex=Math.floor(v/3),t.push(r))}}}}function v5(i,e,t,n,r,s,a,o){let l;if(e.side===Gz?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,e.side===Ub,o),l===null)return null;Pm.copy(o),Pm.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(Pm);return c<t.near||c>t.far?null:{distance:c,point:Pm.clone(),object:i}}function Dm(i,e,t,n,r,s,a,o,l,c){i.getVertexPosition(o,Dc),i.getVertexPosition(l,kc),i.getVertexPosition(c,Ic);const d=v5(i,e,t,n,Dc,kc,Ic,Nm);if(d){r&&(Em.fromBufferAttribute(r,o),Cm.fromBufferAttribute(r,l),Rm.fromBufferAttribute(r,c),d.uv=Gs.getInterpolation(Nm,Dc,kc,Ic,Em,Cm,Rm,new Jt)),s&&(Em.fromBufferAttribute(s,o),Cm.fromBufferAttribute(s,l),Rm.fromBufferAttribute(s,c),d.uv1=Gs.getInterpolation(Nm,Dc,kc,Ic,Em,Cm,Rm,new Jt),d.uv2=d.uv1),a&&(hE.fromBufferAttribute(a,o),dE.fromBufferAttribute(a,l),fE.fromBufferAttribute(a,c),d.normal=Gs.getInterpolation(Nm,Dc,kc,Ic,hE,dE,fE,new fe),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const f={a:o,b:l,c,normal:new fe,materialIndex:0};Gs.getNormal(Dc,kc,Ic,f.normal),d.face=f}return d}class x5 extends fl{constructor(e,t,n,r,s,a,o,l,c,d){if(d=d!==void 0?d:Wv,d!==Wv&&d!==HA)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&d===Wv&&(n=Wz),n===void 0&&d===HA&&(n=qz),super(null,r,s,a,o,l,d,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:jA,this.minFilter=l!==void 0?l:jA,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const b5=new x5(1,1);b5.compareFunction=Qz;let _S=class extends ms{constructor(){super(),this.isGroup=!0,this.type="Group"}};class _N extends mS{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ml(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const pE=new fe,gE=new fe,mE=new Zi,hx=new gN,km=new gS;class w5 extends ms{constructor(e=new xl,t=new _N){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)pE.fromBufferAttribute(t,r-1),gE.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=pE.distanceTo(gE);e.setAttribute("lineDistance",new $s(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),km.copy(n.boundingSphere),km.applyMatrix4(r),km.radius+=s,e.ray.intersectsSphere(km)===!1)return;mE.copy(r).invert(),hx.copy(e.ray).applyMatrix4(mE);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=new fe,d=new fe,f=new fe,p=new fe,m=this.isLineSegments?2:1,_=n.index,v=n.attributes.position;if(_!==null){const y=Math.max(0,a.start),S=Math.min(_.count,a.start+a.count);for(let T=y,E=S-1;T<E;T+=m){const N=_.getX(T),M=_.getX(T+1);if(c.fromBufferAttribute(v,N),d.fromBufferAttribute(v,M),hx.distanceSqToSegment(c,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(p);D<e.near||D>e.far||t.push({distance:D,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,a.start),S=Math.min(v.count,a.start+a.count);for(let T=y,E=S-1;T<E;T+=m){if(c.fromBufferAttribute(v,T),d.fromBufferAttribute(v,T+1),hx.distanceSqToSegment(c,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(p);M<e.near||M>e.far||t.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}class yo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let o=0,l=s-1,c;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),c=n[r]-a,c<0)o=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===a)return r/(s-1);const d=n[r],p=n[r+1]-d,m=(a-d)/p;return(r+m)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),l=t||(a.isVector2?new Jt:new fe);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new fe,r=[],s=[],a=[],o=new fe,l=new Zi;for(let m=0;m<=e;m++){const _=m/e;r[m]=this.getTangentAt(_,new fe)}s[0]=new fe,a[0]=new fe;let c=Number.MAX_VALUE;const d=Math.abs(r[0].x),f=Math.abs(r[0].y),p=Math.abs(r[0].z);d<=c&&(c=d,n.set(1,0,0)),f<=c&&(c=f,n.set(0,1,0)),p<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(r[m-1],r[m]),o.length()>Number.EPSILON){o.normalize();const _=Math.acos(qi(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(o,_))}a[m].crossVectors(r[m],s[m])}if(t===!0){let m=Math.acos(qi(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(m=-m);for(let _=1;_<=e;_++)s[_].applyMatrix4(l.makeRotationAxis(r[_],m*_)),a[_].crossVectors(r[_],s[_])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class yN extends yo{constructor(e=0,t=0,n=1,r=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t){const n=t||new Jt,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const d=Math.cos(this.aRotation),f=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*d-m*f+this.aX,c=p*f+m*d+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class S5 extends yN{constructor(e,t,n,r,s,a){super(e,t,n,n,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function yS(){let i=0,e=0,t=0,n=0;function r(s,a,o,l){i=s,e=o,t=-3*s+3*a-2*o-l,n=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){r(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,d,f){let p=(a-s)/c-(o-s)/(c+d)+(o-a)/d,m=(o-a)/d-(l-a)/(d+f)+(l-o)/f;p*=d,m*=d,r(a,o,p,m)},calc:function(s){const a=s*s,o=a*s;return i+e*s+t*a+n*o}}}const Im=new fe,dx=new yS,fx=new yS,px=new yS;class T5 extends yo{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new fe){const n=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,d;this.closed||o>0?c=r[(o-1)%s]:(Im.subVectors(r[0],r[1]).add(r[0]),c=Im);const f=r[o%s],p=r[(o+1)%s];if(this.closed||o+2<s?d=r[(o+2)%s]:(Im.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=Im),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let _=Math.pow(c.distanceToSquared(f),m),b=Math.pow(f.distanceToSquared(p),m),v=Math.pow(p.distanceToSquared(d),m);b<1e-4&&(b=1),_<1e-4&&(_=b),v<1e-4&&(v=b),dx.initNonuniformCatmullRom(c.x,f.x,p.x,d.x,_,b,v),fx.initNonuniformCatmullRom(c.y,f.y,p.y,d.y,_,b,v),px.initNonuniformCatmullRom(c.z,f.z,p.z,d.z,_,b,v)}else this.curveType==="catmullrom"&&(dx.initCatmullRom(c.x,f.x,p.x,d.x,this.tension),fx.initCatmullRom(c.y,f.y,p.y,d.y,this.tension),px.initCatmullRom(c.z,f.z,p.z,d.z,this.tension));return n.set(dx.calc(l),fx.calc(l),px.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new fe().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _E(i,e,t,n,r){const s=(n-e)*.5,a=(r-t)*.5,o=i*i,l=i*o;return(2*t-2*n+s+a)*l+(-3*t+3*n-2*s-a)*o+s*i+t}function M5(i,e){const t=1-i;return t*t*e}function A5(i,e){return 2*(1-i)*i*e}function E5(i,e){return i*i*e}function Uf(i,e,t,n){return M5(i,e)+A5(i,t)+E5(i,n)}function C5(i,e){const t=1-i;return t*t*t*e}function R5(i,e){const t=1-i;return 3*t*t*i*e}function N5(i,e){return 3*(1-i)*i*i*e}function P5(i,e){return i*i*i*e}function Of(i,e,t,n,r){return C5(i,e)+R5(i,t)+N5(i,n)+P5(i,r)}class D5 extends yo{constructor(e=new Jt,t=new Jt,n=new Jt,r=new Jt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Jt){const n=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(Of(e,r.x,s.x,a.x,o.x),Of(e,r.y,s.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vN extends yo{constructor(e=new fe,t=new fe,n=new fe,r=new fe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new fe){const n=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(Of(e,r.x,s.x,a.x,o.x),Of(e,r.y,s.y,a.y,o.y),Of(e,r.z,s.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class k5 extends yo{constructor(e=new Jt,t=new Jt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Jt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Jt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class I5 extends yo{constructor(e=new fe,t=new fe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new fe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new fe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class L5 extends yo{constructor(e=new Jt,t=new Jt,n=new Jt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Jt){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(Uf(e,r.x,s.x,a.x),Uf(e,r.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vS extends yo{constructor(e=new fe,t=new fe,n=new fe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new fe){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(Uf(e,r.x,s.x,a.x),Uf(e,r.y,s.y,a.y),Uf(e,r.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class F5 extends yo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Jt){const n=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,l=r[a===0?a:a-1],c=r[a],d=r[a>r.length-2?r.length-1:a+1],f=r[a>r.length-3?r.length-1:a+2];return n.set(_E(o,l.x,c.x,d.x,f.x),_E(o,l.y,c.y,d.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Jt().fromArray(r))}return this}}var U5=Object.freeze({__proto__:null,ArcCurve:S5,CatmullRomCurve3:T5,CubicBezierCurve:D5,CubicBezierCurve3:vN,EllipseCurve:yN,LineCurve:k5,LineCurve3:I5,QuadraticBezierCurve:L5,QuadraticBezierCurve3:vS,SplineCurve:F5});class u_ extends xl{constructor(e=1,t=1,n=1,r=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const d=[],f=[],p=[],m=[];let _=0;const b=[],v=n/2;let y=0;S(),a===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(d),this.setAttribute("position",new $s(f,3)),this.setAttribute("normal",new $s(p,3)),this.setAttribute("uv",new $s(m,2));function S(){const E=new fe,N=new fe;let M=0;const C=(t-e)/n;for(let D=0;D<=s;D++){const R=[],P=D/s,L=P*(t-e)+e;for(let z=0;z<=r;z++){const B=z/r,O=B*l+o,V=Math.sin(O),Y=Math.cos(O);N.x=L*V,N.y=-P*n+v,N.z=L*Y,f.push(N.x,N.y,N.z),E.set(V,C,Y).normalize(),p.push(E.x,E.y,E.z),m.push(B,1-P),R.push(_++)}b.push(R)}for(let D=0;D<r;D++)for(let R=0;R<s;R++){const P=b[R][D],L=b[R+1][D],z=b[R+1][D+1],B=b[R][D+1];d.push(P,L,B),d.push(L,z,B),M+=6}c.addGroup(y,M,0),y+=M}function T(E){const N=_,M=new Jt,C=new fe;let D=0;const R=E===!0?e:t,P=E===!0?1:-1;for(let z=1;z<=r;z++)f.push(0,v*P,0),p.push(0,P,0),m.push(.5,.5),_++;const L=_;for(let z=0;z<=r;z++){const O=z/r*l+o,V=Math.cos(O),Y=Math.sin(O);C.x=R*Y,C.y=v*P,C.z=R*V,f.push(C.x,C.y,C.z),p.push(0,P,0),M.x=V*.5+.5,M.y=Y*.5*P+.5,m.push(M.x,M.y),_++}for(let z=0;z<r;z++){const B=N+z,O=L+z;E===!0?d.push(O,O+1,B):d.push(O+1,O,B),D+=3}c.addGroup(y,D,E===!0?1:2),y+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new u_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xS extends u_{constructor(e=1,t=1,n=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,n,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new xS(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class dp extends xl{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const d=[],f=new fe,p=new fe,m=[],_=[],b=[],v=[];for(let y=0;y<=n;y++){const S=[],T=y/n;let E=0;y===0&&a===0?E=.5/t:y===n&&l===Math.PI&&(E=-.5/t);for(let N=0;N<=t;N++){const M=N/t;f.x=-e*Math.cos(r+M*s)*Math.sin(a+T*o),f.y=e*Math.cos(a+T*o),f.z=e*Math.sin(r+M*s)*Math.sin(a+T*o),_.push(f.x,f.y,f.z),p.copy(f).normalize(),b.push(p.x,p.y,p.z),v.push(M+E,1-T),S.push(c++)}d.push(S)}for(let y=0;y<n;y++)for(let S=0;S<t;S++){const T=d[y][S+1],E=d[y][S],N=d[y+1][S],M=d[y+1][S+1];(y!==0||a>0)&&m.push(T,E,M),(y!==n-1||l<Math.PI)&&m.push(E,N,M)}this.setIndex(m),this.setAttribute("position",new $s(_,3)),this.setAttribute("normal",new $s(b,3)),this.setAttribute("uv",new $s(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dp(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class bS extends xl{constructor(e=new vS(new fe(-1,-1,0),new fe(-1,1,0),new fe(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new fe,l=new fe,c=new Jt;let d=new fe;const f=[],p=[],m=[],_=[];b(),this.setIndex(_),this.setAttribute("position",new $s(f,3)),this.setAttribute("normal",new $s(p,3)),this.setAttribute("uv",new $s(m,2));function b(){for(let T=0;T<t;T++)v(T);v(s===!1?t:0),S(),y()}function v(T){d=e.getPointAt(T/t,d);const E=a.normals[T],N=a.binormals[T];for(let M=0;M<=r;M++){const C=M/r*Math.PI*2,D=Math.sin(C),R=-Math.cos(C);l.x=R*E.x+D*N.x,l.y=R*E.y+D*N.y,l.z=R*E.z+D*N.z,l.normalize(),p.push(l.x,l.y,l.z),o.x=d.x+n*l.x,o.y=d.y+n*l.y,o.z=d.z+n*l.z,f.push(o.x,o.y,o.z)}}function y(){for(let T=1;T<=t;T++)for(let E=1;E<=r;E++){const N=(r+1)*(T-1)+(E-1),M=(r+1)*T+(E-1),C=(r+1)*T+E,D=(r+1)*(T-1)+E;_.push(N,M,D),_.push(M,C,D)}}function S(){for(let T=0;T<=t;T++)for(let E=0;E<=r;E++)c.x=T/t,c.y=E/r,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new bS(new U5[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class O5 extends mS{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ml(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ml(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kz,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=dN,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:hN}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=hN);function B5(i,e,t){var n,r=1;i==null&&(i=0),e==null&&(e=0),t==null&&(t=0);function s(){var a,o=n.length,l,c=0,d=0,f=0;for(a=0;a<o;++a)l=n[a],c+=l.x||0,d+=l.y||0,f+=l.z||0;for(c=(c/o-i)*r,d=(d/o-e)*r,f=(f/o-t)*r,a=0;a<o;++a)l=n[a],c&&(l.x-=c),d&&(l.y-=d),f&&(l.z-=f)}return s.initialize=function(a){n=a},s.x=function(a){return arguments.length?(i=+a,s):i},s.y=function(a){return arguments.length?(e=+a,s):e},s.z=function(a){return arguments.length?(t=+a,s):t},s.strength=function(a){return arguments.length?(r=+a,s):r},s}function z5(i){const e=+this._x.call(null,i);return xN(this.cover(e),e,i)}function xN(i,e,t){if(isNaN(e))return i;var n,r=i._root,s={data:t},a=i._x0,o=i._x1,l,c,d,f,p;if(!r)return i._root=s,i;for(;r.length;)if((d=e>=(l=(a+o)/2))?a=l:o=l,n=r,!(r=r[f=+d]))return n[f]=s,i;if(c=+i._x.call(null,r.data),e===c)return s.next=r,n?n[f]=s:i._root=s,i;do n=n?n[f]=new Array(2):i._root=new Array(2),(d=e>=(l=(a+o)/2))?a=l:o=l;while((f=+d)==(p=+(c>=l)));return n[p]=r,n[f]=s,i}function G5(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,t=new Float64Array(e);let n=1/0,r=-1/0;for(let s=0,a;s<e;++s)isNaN(a=+this._x.call(null,i[s]))||(t[s]=a,a<n&&(n=a),a>r&&(r=a));if(n>r)return this;this.cover(n).cover(r);for(let s=0;s<e;++s)xN(this,t[s],i[s]);return this}function V5(i){if(isNaN(i=+i))return this;var e=this._x0,t=this._x1;if(isNaN(e))t=(e=Math.floor(i))+1;else{for(var n=t-e||1,r=this._root,s,a;e>i||i>=t;)switch(a=+(i<e),s=new Array(2),s[a]=r,r=s,n*=2,a){case 0:t=e+n;break;case 1:e=t-n;break}this._root&&this._root.length&&(this._root=r)}return this._x0=e,this._x1=t,this}function j5(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function H5(i){return arguments.length?this.cover(+i[0][0]).cover(+i[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function po(i,e,t){this.node=i,this.x0=e,this.x1=t}function W5(i,e){var t,n=this._x0,r,s,a=this._x1,o=[],l=this._root,c,d;for(l&&o.push(new po(l,n,a)),e==null?e=1/0:(n=i-e,a=i+e);c=o.pop();)if(!(!(l=c.node)||(r=c.x0)>a||(s=c.x1)<n))if(l.length){var f=(r+s)/2;o.push(new po(l[1],f,s),new po(l[0],r,f)),(d=+(i>=f))&&(c=o[o.length-1],o[o.length-1]=o[o.length-1-d],o[o.length-1-d]=c)}else{var p=Math.abs(i-+this._x.call(null,l.data));p<e&&(e=p,n=i-p,a=i+p,t=l.data)}return t}function $5(i){if(isNaN(l=+this._x.call(null,i)))return this;var e,t=this._root,n,r,s,a=this._x0,o=this._x1,l,c,d,f,p;if(!t)return this;if(t.length)for(;;){if((d=l>=(c=(a+o)/2))?a=c:o=c,e=t,!(t=t[f=+d]))return this;if(!t.length)break;e[f+1&1]&&(n=e,p=f)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[f]=s:delete e[f],(t=e[0]||e[1])&&t===(e[1]||e[0])&&!t.length&&(n?n[p]=t:this._root=t),this):(this._root=s,this)}function q5(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}function X5(){return this._root}function Y5(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function K5(i){var e=[],t,n=this._root,r,s,a;for(n&&e.push(new po(n,this._x0,this._x1));t=e.pop();)if(!i(n=t.node,s=t.x0,a=t.x1)&&n.length){var o=(s+a)/2;(r=n[1])&&e.push(new po(r,o,a)),(r=n[0])&&e.push(new po(r,s,o))}return this}function Z5(i){var e=[],t=[],n;for(this._root&&e.push(new po(this._root,this._x0,this._x1));n=e.pop();){var r=n.node;if(r.length){var s,a=n.x0,o=n.x1,l=(a+o)/2;(s=r[0])&&e.push(new po(s,a,l)),(s=r[1])&&e.push(new po(s,l,o))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.x1);return this}function Q5(i){return i[0]}function J5(i){return arguments.length?(this._x=i,this):this._x}function bN(i,e){var t=new wS(e??Q5,NaN,NaN);return i==null?t:t.addAll(i)}function wS(i,e,t){this._x=i,this._x0=e,this._x1=t,this._root=void 0}function yE(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var Fr=bN.prototype=wS.prototype;Fr.copy=function(){var i=new wS(this._x,this._x0,this._x1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=yE(e),i;for(t=[{source:e,target:i._root=new Array(2)}];e=t.pop();)for(var r=0;r<2;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(2)}):e.target[r]=yE(n));return i};Fr.add=z5;Fr.addAll=G5;Fr.cover=V5;Fr.data=j5;Fr.extent=H5;Fr.find=W5;Fr.remove=$5;Fr.removeAll=q5;Fr.root=X5;Fr.size=Y5;Fr.visit=K5;Fr.visitAfter=Z5;Fr.x=J5;function e8(i){const e=+this._x.call(null,i),t=+this._y.call(null,i);return wN(this.cover(e,t),e,t,i)}function wN(i,e,t,n){if(isNaN(e)||isNaN(t))return i;var r,s=i._root,a={data:n},o=i._x0,l=i._y0,c=i._x1,d=i._y1,f,p,m,_,b,v,y,S;if(!s)return i._root=a,i;for(;s.length;)if((b=e>=(f=(o+c)/2))?o=f:c=f,(v=t>=(p=(l+d)/2))?l=p:d=p,r=s,!(s=s[y=v<<1|b]))return r[y]=a,i;if(m=+i._x.call(null,s.data),_=+i._y.call(null,s.data),e===m&&t===_)return a.next=s,r?r[y]=a:i._root=a,i;do r=r?r[y]=new Array(4):i._root=new Array(4),(b=e>=(f=(o+c)/2))?o=f:c=f,(v=t>=(p=(l+d)/2))?l=p:d=p;while((y=v<<1|b)===(S=(_>=p)<<1|m>=f));return r[S]=s,r[y]=a,i}function t8(i){var e,t,n=i.length,r,s,a=new Array(n),o=new Array(n),l=1/0,c=1/0,d=-1/0,f=-1/0;for(t=0;t<n;++t)isNaN(r=+this._x.call(null,e=i[t]))||isNaN(s=+this._y.call(null,e))||(a[t]=r,o[t]=s,r<l&&(l=r),r>d&&(d=r),s<c&&(c=s),s>f&&(f=s));if(l>d||c>f)return this;for(this.cover(l,c).cover(d,f),t=0;t<n;++t)wN(this,a[t],o[t],i[t]);return this}function n8(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,r=this._x1,s=this._y1;if(isNaN(t))r=(t=Math.floor(i))+1,s=(n=Math.floor(e))+1;else{for(var a=r-t||1,o=this._root,l,c;t>i||i>=r||n>e||e>=s;)switch(c=(e<n)<<1|i<t,l=new Array(4),l[c]=o,o=l,a*=2,c){case 0:r=t+a,s=n+a;break;case 1:t=r-a,s=n+a;break;case 2:r=t+a,n=s-a;break;case 3:t=r-a,n=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=n,this._x1=r,this._y1=s,this}function i8(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function r8(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function cr(i,e,t,n,r){this.node=i,this.x0=e,this.y0=t,this.x1=n,this.y1=r}function s8(i,e,t){var n,r=this._x0,s=this._y0,a,o,l,c,d=this._x1,f=this._y1,p=[],m=this._root,_,b;for(m&&p.push(new cr(m,r,s,d,f)),t==null?t=1/0:(r=i-t,s=e-t,d=i+t,f=e+t,t*=t);_=p.pop();)if(!(!(m=_.node)||(a=_.x0)>d||(o=_.y0)>f||(l=_.x1)<r||(c=_.y1)<s))if(m.length){var v=(a+l)/2,y=(o+c)/2;p.push(new cr(m[3],v,y,l,c),new cr(m[2],a,y,v,c),new cr(m[1],v,o,l,y),new cr(m[0],a,o,v,y)),(b=(e>=y)<<1|i>=v)&&(_=p[p.length-1],p[p.length-1]=p[p.length-1-b],p[p.length-1-b]=_)}else{var S=i-+this._x.call(null,m.data),T=e-+this._y.call(null,m.data),E=S*S+T*T;if(E<t){var N=Math.sqrt(t=E);r=i-N,s=e-N,d=i+N,f=e+N,n=m.data}}return n}function a8(i){if(isNaN(d=+this._x.call(null,i))||isNaN(f=+this._y.call(null,i)))return this;var e,t=this._root,n,r,s,a=this._x0,o=this._y0,l=this._x1,c=this._y1,d,f,p,m,_,b,v,y;if(!t)return this;if(t.length)for(;;){if((_=d>=(p=(a+l)/2))?a=p:l=p,(b=f>=(m=(o+c)/2))?o=m:c=m,e=t,!(t=t[v=b<<1|_]))return this;if(!t.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(n=e,y=v)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[v]=s:delete e[v],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=s,this)}function o8(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}function l8(){return this._root}function u8(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function c8(i){var e=[],t,n=this._root,r,s,a,o,l;for(n&&e.push(new cr(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!i(n=t.node,s=t.x0,a=t.y0,o=t.x1,l=t.y1)&&n.length){var c=(s+o)/2,d=(a+l)/2;(r=n[3])&&e.push(new cr(r,c,d,o,l)),(r=n[2])&&e.push(new cr(r,s,d,c,l)),(r=n[1])&&e.push(new cr(r,c,a,o,d)),(r=n[0])&&e.push(new cr(r,s,a,c,d))}return this}function h8(i){var e=[],t=[],n;for(this._root&&e.push(new cr(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var r=n.node;if(r.length){var s,a=n.x0,o=n.y0,l=n.x1,c=n.y1,d=(a+l)/2,f=(o+c)/2;(s=r[0])&&e.push(new cr(s,a,o,d,f)),(s=r[1])&&e.push(new cr(s,d,o,l,f)),(s=r[2])&&e.push(new cr(s,a,f,d,c)),(s=r[3])&&e.push(new cr(s,d,f,l,c))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.x1,n.y1);return this}function d8(i){return i[0]}function f8(i){return arguments.length?(this._x=i,this):this._x}function p8(i){return i[1]}function g8(i){return arguments.length?(this._y=i,this):this._y}function SN(i,e,t){var n=new SS(e??d8,t??p8,NaN,NaN,NaN,NaN);return i==null?n:n.addAll(i)}function SS(i,e,t,n,r,s){this._x=i,this._y=e,this._x0=t,this._y0=n,this._x1=r,this._y1=s,this._root=void 0}function vE(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var _r=SN.prototype=SS.prototype;_r.copy=function(){var i=new SS(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=vE(e),i;for(t=[{source:e,target:i._root=new Array(4)}];e=t.pop();)for(var r=0;r<4;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(4)}):e.target[r]=vE(n));return i};_r.add=e8;_r.addAll=t8;_r.cover=n8;_r.data=i8;_r.extent=r8;_r.find=s8;_r.remove=a8;_r.removeAll=o8;_r.root=l8;_r.size=u8;_r.visit=c8;_r.visitAfter=h8;_r.x=f8;_r.y=g8;function m8(i){const e=+this._x.call(null,i),t=+this._y.call(null,i),n=+this._z.call(null,i);return TN(this.cover(e,t,n),e,t,n,i)}function TN(i,e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n))return i;var s,a=i._root,o={data:r},l=i._x0,c=i._y0,d=i._z0,f=i._x1,p=i._y1,m=i._z1,_,b,v,y,S,T,E,N,M,C,D;if(!a)return i._root=o,i;for(;a.length;)if((E=e>=(_=(l+f)/2))?l=_:f=_,(N=t>=(b=(c+p)/2))?c=b:p=b,(M=n>=(v=(d+m)/2))?d=v:m=v,s=a,!(a=a[C=M<<2|N<<1|E]))return s[C]=o,i;if(y=+i._x.call(null,a.data),S=+i._y.call(null,a.data),T=+i._z.call(null,a.data),e===y&&t===S&&n===T)return o.next=a,s?s[C]=o:i._root=o,i;do s=s?s[C]=new Array(8):i._root=new Array(8),(E=e>=(_=(l+f)/2))?l=_:f=_,(N=t>=(b=(c+p)/2))?c=b:p=b,(M=n>=(v=(d+m)/2))?d=v:m=v;while((C=M<<2|N<<1|E)===(D=(T>=v)<<2|(S>=b)<<1|y>=_));return s[D]=a,s[C]=o,i}function _8(i){Array.isArray(i)||(i=Array.from(i));const e=i.length,t=new Float64Array(e),n=new Float64Array(e),r=new Float64Array(e);let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,d=-1/0;for(let f=0,p,m,_,b;f<e;++f)isNaN(m=+this._x.call(null,p=i[f]))||isNaN(_=+this._y.call(null,p))||isNaN(b=+this._z.call(null,p))||(t[f]=m,n[f]=_,r[f]=b,m<s&&(s=m),m>l&&(l=m),_<a&&(a=_),_>c&&(c=_),b<o&&(o=b),b>d&&(d=b));if(s>l||a>c||o>d)return this;this.cover(s,a,o).cover(l,c,d);for(let f=0;f<e;++f)TN(this,t[f],n[f],r[f],i[f]);return this}function y8(i,e,t){if(isNaN(i=+i)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._z0,a=this._x1,o=this._y1,l=this._z1;if(isNaN(n))a=(n=Math.floor(i))+1,o=(r=Math.floor(e))+1,l=(s=Math.floor(t))+1;else{for(var c=a-n||1,d=this._root,f,p;n>i||i>=a||r>e||e>=o||s>t||t>=l;)switch(p=(t<s)<<2|(e<r)<<1|i<n,f=new Array(8),f[p]=d,d=f,c*=2,p){case 0:a=n+c,o=r+c,l=s+c;break;case 1:n=a-c,o=r+c,l=s+c;break;case 2:a=n+c,r=o-c,l=s+c;break;case 3:n=a-c,r=o-c,l=s+c;break;case 4:a=n+c,o=r+c,s=l-c;break;case 5:n=a-c,o=r+c,s=l-c;break;case 6:a=n+c,r=o-c,s=l-c;break;case 7:n=a-c,r=o-c,s=l-c;break}this._root&&this._root.length&&(this._root=d)}return this._x0=n,this._y0=r,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this}function v8(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}function x8(i){return arguments.length?this.cover(+i[0][0],+i[0][1],+i[0][2]).cover(+i[1][0],+i[1][1],+i[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Pn(i,e,t,n,r,s,a){this.node=i,this.x0=e,this.y0=t,this.z0=n,this.x1=r,this.y1=s,this.z1=a}function b8(i,e,t,n){var r,s=this._x0,a=this._y0,o=this._z0,l,c,d,f,p,m,_=this._x1,b=this._y1,v=this._z1,y=[],S=this._root,T,E;for(S&&y.push(new Pn(S,s,a,o,_,b,v)),n==null?n=1/0:(s=i-n,a=e-n,o=t-n,_=i+n,b=e+n,v=t+n,n*=n);T=y.pop();)if(!(!(S=T.node)||(l=T.x0)>_||(c=T.y0)>b||(d=T.z0)>v||(f=T.x1)<s||(p=T.y1)<a||(m=T.z1)<o))if(S.length){var N=(l+f)/2,M=(c+p)/2,C=(d+m)/2;y.push(new Pn(S[7],N,M,C,f,p,m),new Pn(S[6],l,M,C,N,p,m),new Pn(S[5],N,c,C,f,M,m),new Pn(S[4],l,c,C,N,M,m),new Pn(S[3],N,M,d,f,p,C),new Pn(S[2],l,M,d,N,p,C),new Pn(S[1],N,c,d,f,M,C),new Pn(S[0],l,c,d,N,M,C)),(E=(t>=C)<<2|(e>=M)<<1|i>=N)&&(T=y[y.length-1],y[y.length-1]=y[y.length-1-E],y[y.length-1-E]=T)}else{var D=i-+this._x.call(null,S.data),R=e-+this._y.call(null,S.data),P=t-+this._z.call(null,S.data),L=D*D+R*R+P*P;if(L<n){var z=Math.sqrt(n=L);s=i-z,a=e-z,o=t-z,_=i+z,b=e+z,v=t+z,r=S.data}}return r}const w8=(i,e,t,n,r,s)=>Math.sqrt((i-n)**2+(e-r)**2+(t-s)**2);function S8(i,e,t,n){const r=[],s=i-n,a=e-n,o=t-n,l=i+n,c=e+n,d=t+n;return this.visit((f,p,m,_,b,v,y)=>{if(!f.length)do{const S=f.data;w8(i,e,t,this._x(S),this._y(S),this._z(S))<=n&&r.push(S)}while(f=f.next);return p>l||m>c||_>d||b<s||v<a||y<o}),r}function T8(i){if(isNaN(p=+this._x.call(null,i))||isNaN(m=+this._y.call(null,i))||isNaN(_=+this._z.call(null,i)))return this;var e,t=this._root,n,r,s,a=this._x0,o=this._y0,l=this._z0,c=this._x1,d=this._y1,f=this._z1,p,m,_,b,v,y,S,T,E,N,M;if(!t)return this;if(t.length)for(;;){if((S=p>=(b=(a+c)/2))?a=b:c=b,(T=m>=(v=(o+d)/2))?o=v:d=v,(E=_>=(y=(l+f)/2))?l=y:f=y,e=t,!(t=t[N=E<<2|T<<1|S]))return this;if(!t.length)break;(e[N+1&7]||e[N+2&7]||e[N+3&7]||e[N+4&7]||e[N+5&7]||e[N+6&7]||e[N+7&7])&&(n=e,M=N)}for(;t.data!==i;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[N]=s:delete e[N],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[M]=t:this._root=t),this):(this._root=s,this)}function M8(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}function A8(){return this._root}function E8(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}function C8(i){var e=[],t,n=this._root,r,s,a,o,l,c,d;for(n&&e.push(new Pn(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!i(n=t.node,s=t.x0,a=t.y0,o=t.z0,l=t.x1,c=t.y1,d=t.z1)&&n.length){var f=(s+l)/2,p=(a+c)/2,m=(o+d)/2;(r=n[7])&&e.push(new Pn(r,f,p,m,l,c,d)),(r=n[6])&&e.push(new Pn(r,s,p,m,f,c,d)),(r=n[5])&&e.push(new Pn(r,f,a,m,l,p,d)),(r=n[4])&&e.push(new Pn(r,s,a,m,f,p,d)),(r=n[3])&&e.push(new Pn(r,f,p,o,l,c,m)),(r=n[2])&&e.push(new Pn(r,s,p,o,f,c,m)),(r=n[1])&&e.push(new Pn(r,f,a,o,l,p,m)),(r=n[0])&&e.push(new Pn(r,s,a,o,f,p,m))}return this}function R8(i){var e=[],t=[],n;for(this._root&&e.push(new Pn(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var r=n.node;if(r.length){var s,a=n.x0,o=n.y0,l=n.z0,c=n.x1,d=n.y1,f=n.z1,p=(a+c)/2,m=(o+d)/2,_=(l+f)/2;(s=r[0])&&e.push(new Pn(s,a,o,l,p,m,_)),(s=r[1])&&e.push(new Pn(s,p,o,l,c,m,_)),(s=r[2])&&e.push(new Pn(s,a,m,l,p,d,_)),(s=r[3])&&e.push(new Pn(s,p,m,l,c,d,_)),(s=r[4])&&e.push(new Pn(s,a,o,_,p,m,f)),(s=r[5])&&e.push(new Pn(s,p,o,_,c,m,f)),(s=r[6])&&e.push(new Pn(s,a,m,_,p,d,f)),(s=r[7])&&e.push(new Pn(s,p,m,_,c,d,f))}t.push(n)}for(;n=t.pop();)i(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function N8(i){return i[0]}function P8(i){return arguments.length?(this._x=i,this):this._x}function D8(i){return i[1]}function k8(i){return arguments.length?(this._y=i,this):this._y}function I8(i){return i[2]}function L8(i){return arguments.length?(this._z=i,this):this._z}function MN(i,e,t,n){var r=new TS(e??N8,t??D8,n??I8,NaN,NaN,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}function TS(i,e,t,n,r,s,a,o,l){this._x=i,this._y=e,this._z=t,this._x0=n,this._y0=r,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this._root=void 0}function xE(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}var Li=MN.prototype=TS.prototype;Li.copy=function(){var i=new TS(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return i;if(!e.length)return i._root=xE(e),i;for(t=[{source:e,target:i._root=new Array(8)}];e=t.pop();)for(var r=0;r<8;++r)(n=e.source[r])&&(n.length?t.push({source:n,target:e.target[r]=new Array(8)}):e.target[r]=xE(n));return i};Li.add=m8;Li.addAll=_8;Li.cover=y8;Li.data=v8;Li.extent=x8;Li.find=b8;Li.findAllWithinRadius=S8;Li.remove=T8;Li.removeAll=M8;Li.root=A8;Li.size=E8;Li.visit=C8;Li.visitAfter=R8;Li.x=P8;Li.y=k8;Li.z=L8;function lo(i){return function(){return i}}function eo(i){return(i()-.5)*1e-6}function F8(i){return i.index}function bE(i,e){var t=i.get(e);if(!t)throw new Error("node not found: "+e);return t}function U8(i){var e=F8,t=p,n,r=lo(30),s,a,o,l,c,d,f=1;i==null&&(i=[]);function p(y){return 1/Math.min(l[y.source.index],l[y.target.index])}function m(y){for(var S=0,T=i.length;S<f;++S)for(var E=0,N,M,C,D=0,R=0,P=0,L,z;E<T;++E)N=i[E],M=N.source,C=N.target,D=C.x+C.vx-M.x-M.vx||eo(d),o>1&&(R=C.y+C.vy-M.y-M.vy||eo(d)),o>2&&(P=C.z+C.vz-M.z-M.vz||eo(d)),L=Math.sqrt(D*D+R*R+P*P),L=(L-s[E])/L*y*n[E],D*=L,R*=L,P*=L,C.vx-=D*(z=c[E]),o>1&&(C.vy-=R*z),o>2&&(C.vz-=P*z),M.vx+=D*(z=1-z),o>1&&(M.vy+=R*z),o>2&&(M.vz+=P*z)}function _(){if(a){var y,S=a.length,T=i.length,E=new Map(a.map((M,C)=>[e(M,C,a),M])),N;for(y=0,l=new Array(S);y<T;++y)N=i[y],N.index=y,typeof N.source!="object"&&(N.source=bE(E,N.source)),typeof N.target!="object"&&(N.target=bE(E,N.target)),l[N.source.index]=(l[N.source.index]||0)+1,l[N.target.index]=(l[N.target.index]||0)+1;for(y=0,c=new Array(T);y<T;++y)N=i[y],c[y]=l[N.source.index]/(l[N.source.index]+l[N.target.index]);n=new Array(T),b(),s=new Array(T),v()}}function b(){if(a)for(var y=0,S=i.length;y<S;++y)n[y]=+t(i[y],y,i)}function v(){if(a)for(var y=0,S=i.length;y<S;++y)s[y]=+r(i[y],y,i)}return m.initialize=function(y,...S){a=y,d=S.find(T=>typeof T=="function")||Math.random,o=S.find(T=>[1,2,3].includes(T))||2,_()},m.links=function(y){return arguments.length?(i=y,_(),m):i},m.id=function(y){return arguments.length?(e=y,m):e},m.iterations=function(y){return arguments.length?(f=+y,m):f},m.strength=function(y){return arguments.length?(t=typeof y=="function"?y:lo(+y),b(),m):t},m.distance=function(y){return arguments.length?(r=typeof y=="function"?y:lo(+y),v(),m):r},m}var O8={value:()=>{}};function AN(){for(var i=0,e=arguments.length,t={},n;i<e;++i){if(!(n=arguments[i]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new S0(t)}function S0(i){this._=i}function B8(i,e){return i.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}S0.prototype=AN.prototype={constructor:S0,on:function(i,e){var t=this._,n=B8(i+"",t),r,s=-1,a=n.length;if(arguments.length<2){for(;++s<a;)if((r=(i=n[s]).type)&&(r=z8(t[r],i.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(i=n[s]).type)t[r]=wE(t[r],i.name,e);else if(e==null)for(r in t)t[r]=wE(t[r],i.name,null);return this},copy:function(){var i={},e=this._;for(var t in e)i[t]=e[t].slice();return new S0(i)},call:function(i,e){if((r=arguments.length-2)>0)for(var t=new Array(r),n=0,r,s;n<r;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(s=this._[i],n=0,r=s.length;n<r;++n)s[n].value.apply(e,t)},apply:function(i,e,t){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],r=0,s=n.length;r<s;++r)n[r].value.apply(e,t)}};function z8(i,e){for(var t=0,n=i.length,r;t<n;++t)if((r=i[t]).name===e)return r.value}function wE(i,e,t){for(var n=0,r=i.length;n<r;++n)if(i[n].name===e){i[n]=O8,i=i.slice(0,n).concat(i.slice(n+1));break}return t!=null&&i.push({name:e,value:t}),i}var Bh=0,Ef=0,af=0,EN=1e3,I0,Cf,L0=0,Eu=0,c_=0,fp=typeof performance=="object"&&performance.now?performance:Date,CN=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function RN(){return Eu||(CN(G8),Eu=fp.now()+c_)}function G8(){Eu=0}function Gb(){this._call=this._time=this._next=null}Gb.prototype=NN.prototype={constructor:Gb,restart:function(i,e,t){if(typeof i!="function")throw new TypeError("callback is not a function");t=(t==null?RN():+t)+(e==null?0:+e),!this._next&&Cf!==this&&(Cf?Cf._next=this:I0=this,Cf=this),this._call=i,this._time=t,Vb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vb())}};function NN(i,e,t){var n=new Gb;return n.restart(i,e,t),n}function V8(){RN(),++Bh;for(var i=I0,e;i;)(e=Eu-i._time)>=0&&i._call.call(void 0,e),i=i._next;--Bh}function SE(){Eu=(L0=fp.now())+c_,Bh=Ef=0;try{V8()}finally{Bh=0,H8(),Eu=0}}function j8(){var i=fp.now(),e=i-L0;e>EN&&(c_-=e,L0=i)}function H8(){for(var i,e=I0,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),i=e,e=e._next):(t=e._next,e._next=null,e=i?i._next=t:I0=t);Cf=i,Vb(n)}function Vb(i){if(!Bh){Ef&&(Ef=clearTimeout(Ef));var e=i-Eu;e>24?(i<1/0&&(Ef=setTimeout(SE,i-fp.now()-c_)),af&&(af=clearInterval(af))):(af||(L0=fp.now(),af=setInterval(j8,EN)),Bh=1,CN(SE))}}const W8=1664525,$8=1013904223,TE=4294967296;function q8(){let i=1;return()=>(i=(W8*i+$8)%TE)/TE}var ME=3;function gx(i){return i.x}function AE(i){return i.y}function X8(i){return i.z}var Y8=10,K8=Math.PI*(3-Math.sqrt(5)),Z8=Math.PI*20/(9+Math.sqrt(221));function Q8(i,e){e=e||2;var t=Math.min(ME,Math.max(1,Math.round(e))),n,r=1,s=.001,a=1-Math.pow(s,1/300),o=0,l=.6,c=new Map,d=NN(m),f=AN("tick","end"),p=q8();i==null&&(i=[]);function m(){_(),f.call("tick",n),r<s&&(d.stop(),f.call("end",n))}function _(y){var S,T=i.length,E;y===void 0&&(y=1);for(var N=0;N<y;++N)for(r+=(o-r)*a,c.forEach(function(M){M(r)}),S=0;S<T;++S)E=i[S],E.fx==null?E.x+=E.vx*=l:(E.x=E.fx,E.vx=0),t>1&&(E.fy==null?E.y+=E.vy*=l:(E.y=E.fy,E.vy=0)),t>2&&(E.fz==null?E.z+=E.vz*=l:(E.z=E.fz,E.vz=0));return n}function b(){for(var y=0,S=i.length,T;y<S;++y){if(T=i[y],T.index=y,T.fx!=null&&(T.x=T.fx),T.fy!=null&&(T.y=T.fy),T.fz!=null&&(T.z=T.fz),isNaN(T.x)||t>1&&isNaN(T.y)||t>2&&isNaN(T.z)){var E=Y8*(t>2?Math.cbrt(.5+y):t>1?Math.sqrt(.5+y):y),N=y*K8,M=y*Z8;t===1?T.x=E:t===2?(T.x=E*Math.cos(N),T.y=E*Math.sin(N)):(T.x=E*Math.sin(N)*Math.cos(M),T.y=E*Math.cos(N),T.z=E*Math.sin(N)*Math.sin(M))}(isNaN(T.vx)||t>1&&isNaN(T.vy)||t>2&&isNaN(T.vz))&&(T.vx=0,t>1&&(T.vy=0),t>2&&(T.vz=0))}}function v(y){return y.initialize&&y.initialize(i,p,t),y}return b(),n={tick:_,restart:function(){return d.restart(m),n},stop:function(){return d.stop(),n},numDimensions:function(y){return arguments.length?(t=Math.min(ME,Math.max(1,Math.round(y))),c.forEach(v),n):t},nodes:function(y){return arguments.length?(i=y,b(),c.forEach(v),n):i},alpha:function(y){return arguments.length?(r=+y,n):r},alphaMin:function(y){return arguments.length?(s=+y,n):s},alphaDecay:function(y){return arguments.length?(a=+y,n):+a},alphaTarget:function(y){return arguments.length?(o=+y,n):o},velocityDecay:function(y){return arguments.length?(l=1-y,n):1-l},randomSource:function(y){return arguments.length?(p=y,c.forEach(v),n):p},force:function(y,S){return arguments.length>1?(S==null?c.delete(y):c.set(y,v(S)),n):c.get(y)},find:function(){var y=Array.prototype.slice.call(arguments),S=y.shift()||0,T=(t>1?y.shift():null)||0,E=(t>2?y.shift():null)||0,N=y.shift()||1/0,M=0,C=i.length,D,R,P,L,z,B;for(N*=N,M=0;M<C;++M)z=i[M],D=S-z.x,R=T-(z.y||0),P=E-(z.z||0),L=D*D+R*R+P*P,L<N&&(B=z,N=L);return B},on:function(y,S){return arguments.length>1?(f.on(y,S),n):f.on(y)}}}function J8(){var i,e,t,n,r,s=lo(-30),a,o=1,l=1/0,c=.81;function d(_){var b,v=i.length,y=(e===1?bN(i,gx):e===2?SN(i,gx,AE):e===3?MN(i,gx,AE,X8):null).visitAfter(p);for(r=_,b=0;b<v;++b)t=i[b],y.visit(m)}function f(){if(i){var _,b=i.length,v;for(a=new Array(b),_=0;_<b;++_)v=i[_],a[v.index]=+s(v,_,i)}}function p(_){var b=0,v,y,S=0,T,E,N,M,C=_.length;if(C){for(T=E=N=M=0;M<C;++M)(v=_[M])&&(y=Math.abs(v.value))&&(b+=v.value,S+=y,T+=y*(v.x||0),E+=y*(v.y||0),N+=y*(v.z||0));b*=Math.sqrt(4/C),_.x=T/S,e>1&&(_.y=E/S),e>2&&(_.z=N/S)}else{v=_,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do b+=a[v.data.index];while(v=v.next)}_.value=b}function m(_,b,v,y,S){if(!_.value)return!0;var T=[v,y,S][e-1],E=_.x-t.x,N=e>1?_.y-t.y:0,M=e>2?_.z-t.z:0,C=T-b,D=E*E+N*N+M*M;if(C*C/c<D)return D<l&&(E===0&&(E=eo(n),D+=E*E),e>1&&N===0&&(N=eo(n),D+=N*N),e>2&&M===0&&(M=eo(n),D+=M*M),D<o&&(D=Math.sqrt(o*D)),t.vx+=E*_.value*r/D,e>1&&(t.vy+=N*_.value*r/D),e>2&&(t.vz+=M*_.value*r/D)),!0;if(_.length||D>=l)return;(_.data!==t||_.next)&&(E===0&&(E=eo(n),D+=E*E),e>1&&N===0&&(N=eo(n),D+=N*N),e>2&&M===0&&(M=eo(n),D+=M*M),D<o&&(D=Math.sqrt(o*D)));do _.data!==t&&(C=a[_.data.index]*r/D,t.vx+=E*C,e>1&&(t.vy+=N*C),e>2&&(t.vz+=M*C));while(_=_.next)}return d.initialize=function(_,...b){i=_,n=b.find(v=>typeof v=="function")||Math.random,e=b.find(v=>[1,2,3].includes(v))||2,f()},d.strength=function(_){return arguments.length?(s=typeof _=="function"?_:lo(+_),f(),d):s},d.distanceMin=function(_){return arguments.length?(o=_*_,d):Math.sqrt(o)},d.distanceMax=function(_){return arguments.length?(l=_*_,d):Math.sqrt(l)},d.theta=function(_){return arguments.length?(c=_*_,d):Math.sqrt(c)},d}function eG(i,e,t,n){var r,s,a=lo(.1),o,l;typeof i!="function"&&(i=lo(+i)),e==null&&(e=0),t==null&&(t=0),n==null&&(n=0);function c(f){for(var p=0,m=r.length;p<m;++p){var _=r[p],b=_.x-e||1e-6,v=(_.y||0)-t||1e-6,y=(_.z||0)-n||1e-6,S=Math.sqrt(b*b+v*v+y*y),T=(l[p]-S)*o[p]*f/S;_.vx+=b*T,s>1&&(_.vy+=v*T),s>2&&(_.vz+=y*T)}}function d(){if(r){var f,p=r.length;for(o=new Array(p),l=new Array(p),f=0;f<p;++f)l[f]=+i(r[f],f,r),o[f]=isNaN(l[f])?0:+a(r[f],f,r)}}return c.initialize=function(f,...p){r=f,s=p.find(m=>[1,2,3].includes(m))||2,d()},c.strength=function(f){return arguments.length?(a=typeof f=="function"?f:lo(+f),d(),c):a},c.radius=function(f){return arguments.length?(i=typeof f=="function"?f:lo(+f),d(),c):i},c.x=function(f){return arguments.length?(e=+f,c):e},c.y=function(f){return arguments.length?(t=+f,c):t},c.z=function(f){return arguments.length?(n=+f,c):n},c}function tG(i){iG(i);const e=nG(i);return i.on=e.on,i.off=e.off,i.fire=e.fire,i}function nG(i){let e=Object.create(null);return{on:function(t,n,r){if(typeof n!="function")throw new Error("callback is expected to be a function");let s=e[t];return s||(s=e[t]=[]),s.push({callback:n,ctx:r}),i},off:function(t,n){if(typeof t>"u")return e=Object.create(null),i;if(e[t])if(typeof n!="function")delete e[t];else{const a=e[t];for(let o=0;o<a.length;++o)a[o].callback===n&&a.splice(o,1)}return i},fire:function(t){const n=e[t];if(!n)return i;let r;arguments.length>1&&(r=Array.prototype.slice.call(arguments,1));for(let s=0;s<n.length;++s){const a=n[s];a.callback.apply(a.ctx,r)}return i}}}function iG(i){if(!i)throw new Error("Eventify cannot use falsy object as events subject");const e=["on","fire","off"];for(let t=0;t<e.length;++t)if(i.hasOwnProperty(e[t]))throw new Error("Subject cannot be eventified, since it already has property '"+e[t]+"'")}function rG(i){if(i=i||{},"uniqueLinkId"in i&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),i.multigraph=i.uniqueLinkId),i.multigraph===void 0&&(i.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,t=new Map,n={},r=0,s=i.multigraph?E:T,a=[],o=G,l=G,c=G,d=G,f={version:20,addNode:b,addLink:S,removeLink:D,removeNode:y,getNode:v,getNodeCount:N,getLinkCount:M,getEdgeCount:M,getLinksCount:M,getNodesCount:N,getLinks:C,forEachNode:U,forEachLinkedNode:O,forEachLink:B,beginUpdate:c,endUpdate:d,clear:z,hasLink:P,hasNode:v,getLink:P,getLinkById:L};return tG(f),p(),f;function p(){var H=f.on;f.on=le;function le(){return f.beginUpdate=c=W,f.endUpdate=d=te,o=m,l=_,f.on=H,H.apply(f,arguments)}}function m(H,le){a.push({link:H,changeType:le})}function _(H,le){a.push({node:H,changeType:le})}function b(H,le){if(H===void 0)throw new Error("Invalid node identifier");c();var Te=v(H);return Te?(Te.data=le,l(Te,"update")):(Te=new sG(H,le),l(Te,"add")),e.set(H,Te),d(),Te}function v(H){return e.get(H)}function y(H){var le=v(H);if(!le)return!1;c();var Te=le.links;return Te&&(Te.forEach(R),le.links=null),e.delete(H),l(le,"remove"),d(),!0}function S(H,le,Te){c();var Fe=v(H)||b(H),ie=v(le)||b(le),q=s(H,le,Te),re=t.has(q.id);return t.set(q.id,q),EE(Fe,q),H!==le&&EE(ie,q),o(q,re?"update":"add"),d(),q}function T(H,le,Te){var Fe=Lm(H,le),ie=t.get(Fe);return ie?(ie.data=Te,ie):new CE(H,le,Te,Fe)}function E(H,le,Te){var Fe=Lm(H,le),ie=n.hasOwnProperty(Fe);if(ie||P(H,le)){ie||(n[Fe]=0);var q="@"+ ++n[Fe];Fe=Lm(H+q,le+q)}return new CE(H,le,Te,Fe)}function N(){return e.size}function M(){return t.size}function C(H){var le=v(H);return le?le.links:null}function D(H,le){return le!==void 0&&(H=P(H,le)),R(H)}function R(H){if(!H||!t.get(H.id))return!1;c(),t.delete(H.id);var le=v(H.fromId),Te=v(H.toId);return le&&le.links.delete(H),Te&&Te.links.delete(H),o(H,"remove"),d(),!0}function P(H,le){if(!(H===void 0||le===void 0))return t.get(Lm(H,le))}function L(H){if(H!==void 0)return t.get(H)}function z(){c(),U(function(H){y(H.id)}),d()}function B(H){if(typeof H=="function")for(var le=t.values(),Te=le.next();!Te.done;){if(H(Te.value))return!0;Te=le.next()}}function O(H,le,Te){var Fe=v(H);if(Fe&&Fe.links&&typeof le=="function")return Te?Y(Fe.links,H,le):V(Fe.links,H,le)}function V(H,le,Te){for(var Fe,ie=H.values(),q=ie.next();!q.done;){var re=q.value,we=re.fromId===le?re.toId:re.fromId;if(Fe=Te(e.get(we),re),Fe)return!0;q=ie.next()}}function Y(H,le,Te){for(var Fe,ie=H.values(),q=ie.next();!q.done;){var re=q.value;if(re.fromId===le&&(Fe=Te(e.get(re.toId),re),Fe))return!0;q=ie.next()}}function G(){}function W(){r+=1}function te(){r-=1,r===0&&a.length>0&&(f.fire("changed",a),a.length=0)}function U(H){if(typeof H!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+H);for(var le=e.values(),Te=le.next();!Te.done;){if(H(Te.value))return!0;Te=le.next()}}}function sG(i,e){this.id=i,this.links=null,this.data=e}function EE(i,e){i.links?i.links.add(e):i.links=new Set([e])}function CE(i,e,t,n){this.fromId=i,this.toId=e,this.data=t,this.id=n}function Lm(i,e){return i.toString()+" "+e.toString()}var Fm={exports:{}},Lc={exports:{}},mx,RE;function PN(){return RE||(RE=1,mx=function(e){return e===0?"x":e===1?"y":e===2?"z":"c"+(e+1)}),mx}var _x,NE;function td(){if(NE)return _x;NE=1;const i=PN();return _x=function(t){return n;function n(r,s){let a=s&&s.indent||0,o=s&&s.join!==void 0?s.join:`
`,l=Array(a+1).join(" "),c=[];for(let d=0;d<t;++d){let f=i(d),p=d===0?"":l;c.push(p+r.replace(/{var}/g,f))}return c.join(o)}},_x}var PE;function aG(){if(PE)return Lc.exports;PE=1;const i=td();Lc.exports=e,Lc.exports.generateCreateBodyFunctionBody=t,Lc.exports.getVectorCode=r,Lc.exports.getBodyCode=n;function e(s,a){let o=t(s,a),{Body:l}=new Function(o)();return l}function t(s,a){return`
${r(s,a)}
${n(s)}
return {Body: Body, Vector: Vector};
`}function n(s){let a=i(s),o=a("{var}",{join:", "});return`
function Body(${o}) {
  this.isPinned = false;
  this.pos = new Vector(${o});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${o}) {
  ${a("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function r(s,a){let o=i(s),l="";return a&&(l=`${o(`
	   var v{var};
	Object.defineProperty(this, '{var}', {
	  set: function(v) { 
	    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
	    v{var} = v; 
	  },
	  get: function() { return v{var}; }
	});`)}`),`function Vector(${o("{var}",{join:", "})}) {
  ${l}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${o('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${o("this.{var} = v.{var};",{indent:4})}
    } else {
      ${o('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${o("this.{var} = ",{join:""})}0;
  };`}return Lc.exports}var Ya={exports:{}},DE;function oG(){if(DE)return Ya.exports;DE=1;const i=td(),e=PN();Ya.exports=t,Ya.exports.generateQuadTreeFunctionBody=n,Ya.exports.getInsertStackCode=l,Ya.exports.getQuadNodeCode=o,Ya.exports.isSamePosition=r,Ya.exports.getChildBodyCode=a,Ya.exports.setChildBodyCode=s;function t(c){let d=n(c);return new Function(d)()}function n(c){let d=i(c),f=Math.pow(2,c);return`
${l()}
${o(c)}
${r(c)}
${a(c)}
${s(c)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${b("      node.")}
      node.body = null;
      node.mass = ${d("node.mass_{var} = ",{join:""})}0;
      ${d("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${d("var d{var};",{indent:4})}
    var r; 
    ${d("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${d("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${d("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${d("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${d("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${d("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${d("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${d("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${d("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${d("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < , treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${e(0)} - node.min_${e(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${d("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${_()}
        }
      }
    }

    ${d("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${d("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${d("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${d("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${d("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${d("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${d("root.min_{var} = {var}min;",{indent:4})}
    ${d("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${d("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${d("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${d("var min_{var} = node.min_{var};",{indent:8})}
        ${d("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${m(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${d("child.min_{var} = min_{var};",{indent:10})}
          ${d("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${d("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${d("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function m(v){let y=[],S=Array(v+1).join(" ");for(let T=0;T<c;++T)y.push(S+`if (${e(T)} > max_${e(T)}) {`),y.push(S+`  quadIdx = quadIdx + ${Math.pow(2,T)};`),y.push(S+`  min_${e(T)} = max_${e(T)};`),y.push(S+`  max_${e(T)} = node.max_${e(T)};`),y.push(S+"}");return y.join(`
`)}function _(){let v=Array(11).join(" "),y=[];for(let S=0;S<f;++S)y.push(v+`if (node.quad${S}) {`),y.push(v+`  queue[pushIdx] = node.quad${S};`),y.push(v+"  queueLength += 1;"),y.push(v+"  pushIdx += 1;"),y.push(v+"}");return y.join(`
`)}function b(v){let y=[];for(let S=0;S<f;++S)y.push(`${v}quad${S} = null;`);return y.join(`
`)}}function r(c){let d=i(c);return`
  function isSamePosition(point1, point2) {
    ${d("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${d("d{var} < 1e-8",{join:" && "})};
  }  
`}function s(c){var d=Math.pow(2,c);return`
function setChild(node, idx, child) {
  ${f()}
}`;function f(){let p=[];for(let m=0;m<d;++m){let _=m===0?"  ":"  else ";p.push(`${_}if (idx === ${m}) node.quad${m} = child;`)}return p.join(`
`)}}function a(c){return`function getChild(node, idx) {
${d()}
  return null;
}`;function d(){let f=[],p=Math.pow(2,c);for(let m=0;m<p;++m)f.push(`  if (idx === ${m}) return node.quad${m};`);return f.join(`
`)}}function o(c){let d=i(c),f=Math.pow(2,c);var p=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${m("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${d("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${d("this.min_{var} = 0;",{indent:2})}
  ${d("this.max_{var} = 0;",{indent:2})}
}
`;return p;function m(_){let b=[];for(let v=0;v<f;++v)b.push(`${_}quad${v} = null;`);return b.join(`
`)}}function l(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}return Ya.exports}var Um={exports:{}},kE;function lG(){if(kE)return Um.exports;kE=1,Um.exports=e,Um.exports.generateFunctionBody=t;const i=td();function e(n){let r=t(n);return new Function("bodies","settings","random",r)}function t(n){let r=i(n);return`
  var boundingBox = {
    ${r("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${r("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${r("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${r("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${r("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${r("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${r("var max_{var} = -Infinity;",{indent:4})}
    ${r("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${r("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${r("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${r("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${r("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${r("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}return Um.exports}var Om={exports:{}},IE;function uG(){if(IE)return Om.exports;IE=1;const i=td();Om.exports=e,Om.exports.generateCreateDragForceFunctionBody=t;function e(n){let r=t(n);return new Function("options",r)}function t(n){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${i(n)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}return Om.exports}var Bm={exports:{}},LE;function cG(){if(LE)return Bm.exports;LE=1;const i=td();Bm.exports=e,Bm.exports.generateCreateSpringForceFunctionBody=t;function e(n){let r=t(n);return new Function("options","random",r)}function t(n){let r=i(n);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${r("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${r("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${r("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${r("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${r("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${r("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}return Bm.exports}var zm={exports:{}},FE;function hG(){if(FE)return zm.exports;FE=1;const i=td();zm.exports=e,zm.exports.generateIntegratorFunctionBody=t;function e(n){let r=t(n);return new Function("bodies","timeStep","adaptiveTimeStepWeight",r)}function t(n){let r=i(n);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${r("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${r("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${r("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${r("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${r("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${r("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${r("body.pos.{var} += d{var};",{indent:4})}

    ${r("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${r("t{var} * t{var}",{join:" + "})})/length;
`}return zm.exports}var yx,UE;function dG(){if(UE)return yx;UE=1,yx=i;function i(e,t,n,r){this.from=e,this.to=t,this.length=n,this.coefficient=r}return yx}var vx,OE;function fG(){if(OE)return vx;OE=1,vx=i;function i(e,t){var n;if(e||(e={}),t){for(n in t)if(t.hasOwnProperty(n)){var r=e.hasOwnProperty(n),s=typeof t[n],a=!r||typeof e[n]!==s;a?e[n]=t[n]:s==="object"&&(e[n]=i(e[n],t[n]))}}return e}return vx}var xx,BE;function DN(){if(BE)return xx;BE=1;function i(n){t(n);const r=e(n);return n.on=r.on,n.off=r.off,n.fire=r.fire,n}function e(n){let r=Object.create(null);return{on:function(s,a,o){if(typeof a!="function")throw new Error("callback is expected to be a function");let l=r[s];return l||(l=r[s]=[]),l.push({callback:a,ctx:o}),n},off:function(s,a){if(typeof s>"u")return r=Object.create(null),n;if(r[s])if(typeof a!="function")delete r[s];else{const o=r[s];for(let l=0;l<o.length;++l)o[l].callback===a&&o.splice(l,1)}return n},fire:function(s){const a=r[s];if(!a)return n;let o;arguments.length>1&&(o=Array.prototype.slice.call(arguments,1));for(let l=0;l<a.length;++l){const c=a[l];c.callback.apply(c.ctx,o)}return n}}}function t(n){if(!n)throw new Error("Eventify cannot use falsy object as events subject");const r=["on","fire","off"];for(let s=0;s<r.length;++s)if(n.hasOwnProperty(r[s]))throw new Error("Subject cannot be eventified, since it already has property '"+r[s]+"'")}return xx=i,xx}var of={exports:{}},zE;function pG(){if(zE)return of.exports;zE=1,of.exports=i,of.exports.random=i,of.exports.randomIterator=o;function i(l){var c=typeof l=="number"?l:+new Date;return new e(c)}function e(l){this.seed=l}e.prototype.next=a,e.prototype.nextDouble=s,e.prototype.uniform=s,e.prototype.gaussian=t,e.prototype.random=s;function t(){var l,c,d;do c=this.nextDouble()*2-1,d=this.nextDouble()*2-1,l=c*c+d*d;while(l>=1||l===0);return c*Math.sqrt(-2*Math.log(l)/l)}e.prototype.levy=n;function n(){var l=1.5,c=Math.pow(r(1+l)*Math.sin(Math.PI*l/2)/(r((1+l)/2)*l*Math.pow(2,(l-1)/2)),1/l);return this.gaussian()*c/Math.pow(Math.abs(this.gaussian()),1/l)}function r(l){return Math.sqrt(2*Math.PI/l)*Math.pow(1/Math.E*(l+1/(12*l-1/(10*l))),l)}function s(){var l=this.seed;return l=l+2127912214+(l<<12)&4294967295,l=(l^3345072700^l>>>19)&4294967295,l=l+374761393+(l<<5)&4294967295,l=(l+3550635116^l<<9)&4294967295,l=l+4251993797+(l<<3)&4294967295,l=(l^3042594569^l>>>16)&4294967295,this.seed=l,(l&268435455)/268435456}function a(l){return Math.floor(this.nextDouble()*l)}function o(l,c){var d=c||i();if(typeof d.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:p,shuffle:f};function f(){var m,_,b;for(m=l.length-1;m>0;--m)_=d.next(m+1),b=l[_],l[_]=l[m],l[m]=b;return l}function p(m){var _,b,v;for(_=l.length-1;_>0;--_)b=d.next(_+1),v=l[b],l[b]=l[_],l[_]=v,m(v);l.length&&m(l[0])}}return of.exports}var bx,GE;function VE(){if(GE)return bx;GE=1,bx=o;var i=aG(),e=oG(),t=lG(),n=uG(),r=cG(),s=hG(),a={};function o(d){var f=dG(),p=fG(),m=DN();if(d){if(d.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(d.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}d=p(d,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var _=a[d.dimensions];if(!_){var b=d.dimensions;_={Body:i(b,d.debug),createQuadTree:e(b),createBounds:t(b),createDragForce:n(b),createSpringForce:r(b),integrate:s(b)},a[b]=_}var v=_.Body,y=_.createQuadTree,S=_.createBounds,T=_.createDragForce,E=_.createSpringForce,N=_.integrate,M=ie=>new v(ie),C=pG().random(42),D=[],R=[],P=y(d,C),L=S(D,d,C),z=E(d,C),B=T(d),O=0,V=[],Y=new Map,G=0;U("nbody",Te),U("spring",Fe);var W={bodies:D,quadTree:P,springs:R,settings:d,addForce:U,removeForce:H,getForces:le,step:function(){for(var ie=0;ie<V.length;++ie)V[ie](G);var q=N(D,d.timeStep,d.adaptiveTimeStepWeight);return G+=1,q},addBody:function(ie){if(!ie)throw new Error("Body is required");return D.push(ie),ie},addBodyAt:function(ie){if(!ie)throw new Error("Body position is required");var q=M(ie);return D.push(q),q},removeBody:function(ie){if(ie){var q=D.indexOf(ie);if(!(q<0))return D.splice(q,1),D.length===0&&L.reset(),!0}},addSpring:function(ie,q,re,we){if(!ie||!q)throw new Error("Cannot add null spring to force simulator");typeof re!="number"&&(re=-1);var He=new f(ie,q,re,we>=0?we:-1);return R.push(He),He},getTotalMovement:function(){return O},removeSpring:function(ie){if(ie){var q=R.indexOf(ie);if(q>-1)return R.splice(q,1),!0}},getBestNewBodyPosition:function(ie){return L.getBestNewPosition(ie)},getBBox:te,getBoundingBox:te,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(ie){return ie!==void 0?(d.gravity=ie,P.options({gravity:ie}),this):d.gravity},theta:function(ie){return ie!==void 0?(d.theta=ie,P.options({theta:ie}),this):d.theta},random:C};return l(d,W),m(W),W;function te(){return L.update(),L.box}function U(ie,q){if(Y.has(ie))throw new Error("Force "+ie+" is already added");Y.set(ie,q),V.push(q)}function H(ie){var q=V.indexOf(Y.get(ie));q<0||(V.splice(q,1),Y.delete(ie))}function le(){return Y}function Te(){if(D.length!==0){P.insertBodies(D);for(var ie=D.length;ie--;){var q=D[ie];q.isPinned||(q.reset(),P.updateBodyForce(q),B.update(q))}}}function Fe(){for(var ie=R.length;ie--;)z.update(R[ie])}}function l(d,f){for(var p in d)c(d,f,p)}function c(d,f,p){if(d.hasOwnProperty(p)&&typeof f[p]!="function"){var m=Number.isFinite(d[p]);m?f[p]=function(_){if(_!==void 0){if(!Number.isFinite(_))throw new Error("Value of "+p+" should be a valid number.");return d[p]=_,f}return d[p]}:f[p]=function(_){return _!==void 0?(d[p]=_,f):d[p]}}}return bx}var jE;function gG(){if(jE)return Fm.exports;jE=1,Fm.exports=e,Fm.exports.simulator=VE();var i=DN();function e(n,r){if(!n)throw new Error("Graph structure cannot be undefined");var s=r&&r.createSimulator||VE(),a=s(r);if(Array.isArray(r))throw new Error("Physics settings is expected to be an object");var o=n.version>19?Y:V;r&&typeof r.nodeMass=="function"&&(o=r.nodeMass);var l=new Map,c={},d=0,f=a.settings.springTransform||t;M(),T();var p=!1,m={step:function(){if(d===0)return _(!0),!0;var G=a.step();m.lastMove=G,m.fire("step");var W=G/d,te=W<=.01;return _(te),te},getNodePosition:function(G){return O(G).pos},setNodePosition:function(G){var W=O(G);W.setPosition.apply(W,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(G){var W=c[G];if(W)return{from:W.from.pos,to:W.to.pos}},getGraphRect:function(){return a.getBBox()},forEachBody:b,pinNode:function(G,W){var te=O(G.id);te.isPinned=!!W},isNodePinned:function(G){return O(G.id).isPinned},dispose:function(){n.off("changed",N),m.fire("disposed")},getBody:S,getSpring:y,getForceVectorLength:v,simulator:a,graph:n,lastMove:0};return i(m),m;function _(G){p!==G&&(p=G,E(G))}function b(G){l.forEach(G)}function v(){var G=0,W=0;return b(function(te){G+=Math.abs(te.force.x),W+=Math.abs(te.force.y)}),Math.sqrt(G*G+W*W)}function y(G,W){var te;if(W===void 0)typeof G!="object"?te=G:te=G.id;else{var U=n.hasLink(G,W);if(!U)return;te=U.id}return c[te]}function S(G){return l.get(G)}function T(){n.on("changed",N)}function E(G){m.fire("stable",G)}function N(G){for(var W=0;W<G.length;++W){var te=G[W];te.changeType==="add"?(te.node&&C(te.node.id),te.link&&R(te.link)):te.changeType==="remove"&&(te.node&&D(te.node),te.link&&P(te.link))}d=n.getNodesCount()}function M(){d=0,n.forEachNode(function(G){C(G.id),d+=1}),n.forEachLink(R)}function C(G){var W=l.get(G);if(!W){var te=n.getNode(G);if(!te)throw new Error("initBody() was called with unknown node id");var U=te.position;if(!U){var H=L(te);U=a.getBestNewBodyPosition(H)}W=a.addBodyAt(U),W.id=G,l.set(G,W),z(G),B(te)&&(W.isPinned=!0)}}function D(G){var W=G.id,te=l.get(W);te&&(l.delete(W),a.removeBody(te))}function R(G){z(G.fromId),z(G.toId);var W=l.get(G.fromId),te=l.get(G.toId),U=a.addSpring(W,te,G.length);f(G,U),c[G.id]=U}function P(G){var W=c[G.id];if(W){var te=n.getNode(G.fromId),U=n.getNode(G.toId);te&&z(te.id),U&&z(U.id),delete c[G.id],a.removeSpring(W)}}function L(G){var W=[];if(!G.links)return W;for(var te=Math.min(G.links.length,2),U=0;U<te;++U){var H=G.links[U],le=H.fromId!==G.id?l.get(H.fromId):l.get(H.toId);le&&le.pos&&W.push(le)}return W}function z(G){var W=l.get(G);if(W.mass=o(G),Number.isNaN(W.mass))throw new Error("Node mass should be a number")}function B(G){return G&&(G.isPinned||G.data&&G.data.isPinned)}function O(G){var W=l.get(G);return W||(C(G),W=l.get(G)),W}function V(G){var W=n.getLinks(G);return W?1+W.length/3:1}function Y(G){var W=n.getLinks(G);return W?1+W.size/3:1}}function t(){}return Fm.exports}var mG=gG();const _G=K0(mG);function jb(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var yG=typeof global=="object"&&global&&global.Object===Object&&global,vG=typeof self=="object"&&self&&self.Object===Object&&self,kN=yG||vG||Function("return this")(),wx=function(){return kN.Date.now()},xG=/\s/;function bG(i){for(var e=i.length;e--&&xG.test(i.charAt(e)););return e}var wG=/^\s+/;function SG(i){return i&&i.slice(0,bG(i)+1).replace(wG,"")}var F0=kN.Symbol,IN=Object.prototype,TG=IN.hasOwnProperty,MG=IN.toString,lf=F0?F0.toStringTag:void 0;function AG(i){var e=TG.call(i,lf),t=i[lf];try{i[lf]=void 0;var n=!0}catch{}var r=MG.call(i);return n&&(e?i[lf]=t:delete i[lf]),r}var EG=Object.prototype,CG=EG.toString;function RG(i){return CG.call(i)}var NG="[object Null]",PG="[object Undefined]",HE=F0?F0.toStringTag:void 0;function DG(i){return i==null?i===void 0?PG:NG:HE&&HE in Object(i)?AG(i):RG(i)}function kG(i){return i!=null&&typeof i=="object"}var IG="[object Symbol]";function LG(i){return typeof i=="symbol"||kG(i)&&DG(i)==IG}var WE=NaN,FG=/^[-+]0x[0-9a-f]+$/i,UG=/^0b[01]+$/i,OG=/^0o[0-7]+$/i,BG=parseInt;function $E(i){if(typeof i=="number")return i;if(LG(i))return WE;if(jb(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=jb(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=SG(i);var t=UG.test(i);return t||OG.test(i)?BG(i.slice(2),t?2:8):FG.test(i)?WE:+i}var zG="Expected a function",GG=Math.max,VG=Math.min;function jG(i,e,t){var n,r,s,a,o,l,c=0,d=!1,f=!1,p=!0;if(typeof i!="function")throw new TypeError(zG);e=$E(e)||0,jb(t)&&(d=!!t.leading,f="maxWait"in t,s=f?GG($E(t.maxWait)||0,e):s,p="trailing"in t?!!t.trailing:p);function m(M){var C=n,D=r;return n=r=void 0,c=M,a=i.apply(D,C),a}function _(M){return c=M,o=setTimeout(y,e),d?m(M):a}function b(M){var C=M-l,D=M-c,R=e-C;return f?VG(R,s-D):R}function v(M){var C=M-l,D=M-c;return l===void 0||C>=e||C<0||f&&D>=s}function y(){var M=wx();if(v(M))return S(M);o=setTimeout(y,b(M))}function S(M){return o=void 0,p&&n?m(M):(n=r=void 0,a)}function T(){o!==void 0&&clearTimeout(o),c=0,n=l=r=o=void 0}function E(){return o===void 0?a:S(wx())}function N(){var M=wx(),C=v(M);if(n=arguments,r=this,l=M,C){if(o===void 0)return _(l);if(f)return clearTimeout(o),o=setTimeout(y,e),m(l)}return o===void 0&&(o=setTimeout(y,e)),a}return N.cancel=T,N.flush=E,N}function qE(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function HG(i){if(Array.isArray(i))return i}function WG(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function $G(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function qG(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function XG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YG(i,e){return HG(i)||qG(i,e)||KG(i,e)||XG()}function KG(i,e){if(i){if(typeof i=="string")return qE(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qE(i,e):void 0}}var ZG=$G(function i(e,t){var n=t.default,r=n===void 0?null:n,s=t.triggerUpdate,a=s===void 0?!0:s,o=t.onChange,l=o===void 0?function(c,d){}:o;WG(this,i),this.name=e,this.defaultVal=r,this.triggerUpdate=a,this.onChange=l});function h_(i){var e=i.stateInit,t=e===void 0?function(){return{}}:e,n=i.props,r=n===void 0?{}:n,s=i.methods,a=s===void 0?{}:s,o=i.aliases,l=o===void 0?{}:o,c=i.init,d=c===void 0?function(){}:c,f=i.update,p=f===void 0?function(){}:f,m=Object.keys(r).map(function(_){return new ZG(_,r[_])});return function _(){for(var b=arguments.length,v=new Array(b),y=0;y<b;y++)v[y]=arguments[y];var S=!!(this instanceof _&&this.constructor),T=S?v.shift():void 0,E=v[0],N=E===void 0?{}:E,M=Object.assign({},t instanceof Function?t(N):t,{initialised:!1}),C={};function D(L){return R(L,N),P(),D}var R=function(z,B){d.call(D,z,M,B),M.initialised=!0},P=jG(function(){M.initialised&&(p.call(D,M,C),C={})},1);return m.forEach(function(L){D[L.name]=z(L);function z(B){var O=B.name,V=B.triggerUpdate,Y=V===void 0?!1:V,G=B.onChange,W=G===void 0?function(H,le){}:G,te=B.defaultVal,U=te===void 0?null:te;return function(H){var le=M[O];if(!arguments.length)return le;var Te=H===void 0?U:H;return M[O]=Te,W.call(D,Te,M,le),!C.hasOwnProperty(O)&&(C[O]=le),Y&&P(),D}}}),Object.keys(a).forEach(function(L){D[L]=function(){for(var z,B=arguments.length,O=new Array(B),V=0;V<B;V++)O[V]=arguments[V];return(z=a[L]).call.apply(z,[D,M].concat(O))}}),Object.entries(l).forEach(function(L){var z=YG(L,2),B=z[0],O=z[1];return D[B]=D[O]}),D.resetProps=function(){return m.forEach(function(L){D[L.name](L.defaultVal)}),D},D.resetProps(),M._rerender=P,S&&T&&D(T),D}}var Xt=(function(i){return typeof i=="function"?i:typeof i=="string"?function(e){return e[i]}:function(e){return i}});class XE extends Map{constructor(e,t=e6){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(YE(this,e))}has(e){return super.has(YE(this,e))}set(e,t){return super.set(QG(this,e),t)}delete(e){return super.delete(JG(this,e))}}function YE({_intern:i,_key:e},t){const n=e(t);return i.has(n)?i.get(n):t}function QG({_intern:i,_key:e},t){const n=e(t);return i.has(n)?i.get(n):(i.set(n,t),t)}function JG({_intern:i,_key:e},t){const n=e(t);return i.has(n)&&(t=i.get(n),i.delete(n)),t}function e6(i){return i!==null&&typeof i=="object"?i.valueOf():i}function t6(i,e){let t;if(e===void 0)for(const n of i)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let r of i)(r=e(r,++n,i))!=null&&(t<r||t===void 0&&r>=r)&&(t=r)}return t}function n6(i,e){let t;if(e===void 0)for(const n of i)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let r of i)(r=e(r,++n,i))!=null&&(t>r||t===void 0&&r>=r)&&(t=r)}return t}function Hb(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function i6(i){if(Array.isArray(i))return i}function r6(i){if(Array.isArray(i))return Hb(i)}function LN(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function s6(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a6(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Wi(i,e){return i.get(LN(i,e))}function Fc(i,e,t){s6(i,e),e.set(i,t)}function Gm(i,e,t){return i.set(LN(i,e),t),t}function o6(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,m6(n.key),n)}}function l6(i,e,t){return e&&o6(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function u6(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function c6(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function h6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f6(i,e){return i6(i)||c6(i,e)||FN(i,e)||h6()}function p6(i){return r6(i)||u6(i)||FN(i)||d6()}function g6(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function m6(i){var e=g6(i,"string");return typeof e=="symbol"?e:e+""}function FN(i,e){if(i){if(typeof i=="string")return Hb(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Hb(i,e):void 0}}var Uc=new WeakMap,uf=new WeakMap,Oc=new WeakMap,Sx=new WeakMap,Tx=new WeakMap,Mx=new WeakMap,_6=(function(){function i(){a6(this,i),Fc(this,Uc,new Map),Fc(this,uf,new Map),Fc(this,Oc,function(e){return e}),Fc(this,Sx,function(){return{}}),Fc(this,Tx,function(){}),Fc(this,Mx,function(){})}return l6(i,[{key:"getObj",value:function(t){return Wi(Uc,this).get(Wi(Oc,this).call(this,t))}},{key:"getData",value:function(t){return Wi(uf,this).get(t)}},{key:"entries",value:function(){return p6(Wi(uf,this).entries()).map(function(t){var n=f6(t,2),r=n[0],s=n[1];return[s,r]})}},{key:"id",value:function(t){return Gm(Oc,this,Xt(t)),this}},{key:"onCreateObj",value:function(t){return Gm(Sx,this,t),this}},{key:"onUpdateObj",value:function(t){return Gm(Tx,this,t),this}},{key:"onRemoveObj",value:function(t){return Gm(Mx,this,t),this}},{key:"digest",value:function(t){var n=this;t.filter(function(s){return!Wi(Uc,n).has(Wi(Oc,n).call(n,s))}).forEach(function(s){var a=Wi(Sx,n).call(n,s);Wi(Uc,n).set(Wi(Oc,n).call(n,s),a),Wi(uf,n).set(a,s)});var r=new Map(t.map(function(s){return[Wi(Oc,n).call(n,s),s]}));return Wi(Uc,this).forEach(function(s,a){r.has(a)?Wi(Tx,n).call(n,s,r.get(a)):(Wi(Mx,n).call(n,s,a),Wi(Uc,n).delete(a),Wi(uf,n).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])})();function y6(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i);break}return this}const KE=Symbol("implicit");function UN(){var i=new XE,e=[],t=[],n=KE;function r(s){let a=i.get(s);if(a===void 0){if(n!==KE)return n;i.set(s,a=e.push(s)-1)}return t[a%t.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],i=new XE;for(const a of s)i.has(a)||i.set(a,e.push(a)-1);return r},r.range=function(s){return arguments.length?(t=Array.from(s),r):t.slice()},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return UN(e,t).unknown(n)},y6.apply(r,arguments),r}function v6(i){for(var e=i.length/6|0,t=new Array(e),n=0;n<e;)t[n]="#"+i.slice(n*6,++n*6);return t}const x6=v6("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function U0(i){"@babel/helpers - typeof";return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U0(i)}var b6=/^\s+/,w6=/\s+$/;function yt(i,e){if(i=i||"",e=e||{},i instanceof yt)return i;if(!(this instanceof yt))return new yt(i,e);var t=S6(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}yt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,n,r,s,a,o;return t=e.r/255,n=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),n<=.03928?a=n/12.92:a=Math.pow((n+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*a+.0722*o},setAlpha:function(e){return this._a=ON(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=QE(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=QE(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=ZE(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=ZE(this._r,this._g,this._b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return JE(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return E6(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Hn(this._r,255)*100)+"%",g:Math.round(Hn(this._g,255)*100)+"%",b:Math.round(Hn(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Hn(this._r,255)*100)+"%, "+Math.round(Hn(this._g,255)*100)+"%, "+Math.round(Hn(this._b,255)*100)+"%)":"rgba("+Math.round(Hn(this._r,255)*100)+"%, "+Math.round(Hn(this._g,255)*100)+"%, "+Math.round(Hn(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:B6[JE(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+eC(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=yt(e);n="#"+eC(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return yt(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(P6,arguments)},brighten:function(){return this._applyModification(D6,arguments)},darken:function(){return this._applyModification(k6,arguments)},desaturate:function(){return this._applyModification(C6,arguments)},saturate:function(){return this._applyModification(R6,arguments)},greyscale:function(){return this._applyModification(N6,arguments)},spin:function(){return this._applyModification(I6,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(U6,arguments)},complement:function(){return this._applyCombination(L6,arguments)},monochromatic:function(){return this._applyCombination(O6,arguments)},splitcomplement:function(){return this._applyCombination(F6,arguments)},triad:function(){return this._applyCombination(tC,[3])},tetrad:function(){return this._applyCombination(tC,[4])}};yt.fromRatio=function(i,e){if(U0(i)=="object"){var t={};for(var n in i)i.hasOwnProperty(n)&&(n==="a"?t[n]=i[n]:t[n]=Rf(i[n]));i=t}return yt(i,e)};function S6(i){var e={r:0,g:0,b:0},t=1,n=null,r=null,s=null,a=!1,o=!1;return typeof i=="string"&&(i=j6(i)),U0(i)=="object"&&(Ka(i.r)&&Ka(i.g)&&Ka(i.b)?(e=T6(i.r,i.g,i.b),a=!0,o=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Ka(i.h)&&Ka(i.s)&&Ka(i.v)?(n=Rf(i.s),r=Rf(i.v),e=A6(i.h,n,r),a=!0,o="hsv"):Ka(i.h)&&Ka(i.s)&&Ka(i.l)&&(n=Rf(i.s),s=Rf(i.l),e=M6(i.h,n,s),a=!0,o="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=ON(t),{ok:a,format:i.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function T6(i,e,t){return{r:Hn(i,255)*255,g:Hn(e,255)*255,b:Hn(t,255)*255}}function ZE(i,e,t){i=Hn(i,255),e=Hn(e,255),t=Hn(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,a,o=(n+r)/2;if(n==r)s=a=0;else{var l=n-r;switch(a=o>.5?l/(2-n-r):l/(n+r),n){case i:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-i)/l+2;break;case t:s=(i-e)/l+4;break}s/=6}return{h:s,s:a,l:o}}function M6(i,e,t){var n,r,s;i=Hn(i,360),e=Hn(e,100),t=Hn(t,100);function a(c,d,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?c+(d-c)*6*f:f<1/2?d:f<2/3?c+(d-c)*(2/3-f)*6:c}if(e===0)n=r=s=t;else{var o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;n=a(l,o,i+1/3),r=a(l,o,i),s=a(l,o,i-1/3)}return{r:n*255,g:r*255,b:s*255}}function QE(i,e,t){i=Hn(i,255),e=Hn(e,255),t=Hn(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s,a,o=n,l=n-r;if(a=n===0?0:l/n,n==r)s=0;else{switch(n){case i:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-i)/l+2;break;case t:s=(i-e)/l+4;break}s/=6}return{h:s,s:a,v:o}}function A6(i,e,t){i=Hn(i,360)*6,e=Hn(e,100),t=Hn(t,100);var n=Math.floor(i),r=i-n,s=t*(1-e),a=t*(1-r*e),o=t*(1-(1-r)*e),l=n%6,c=[t,a,s,s,o,t][l],d=[o,t,t,a,s,s][l],f=[s,s,o,t,t,a][l];return{r:c*255,g:d*255,b:f*255}}function JE(i,e,t,n){var r=[Hs(Math.round(i).toString(16)),Hs(Math.round(e).toString(16)),Hs(Math.round(t).toString(16))];return n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function E6(i,e,t,n,r){var s=[Hs(Math.round(i).toString(16)),Hs(Math.round(e).toString(16)),Hs(Math.round(t).toString(16)),Hs(BN(n))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function eC(i,e,t,n){var r=[Hs(BN(n)),Hs(Math.round(i).toString(16)),Hs(Math.round(e).toString(16)),Hs(Math.round(t).toString(16))];return r.join("")}yt.equals=function(i,e){return!i||!e?!1:yt(i).toRgbString()==yt(e).toRgbString()};yt.random=function(){return yt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function C6(i,e){e=e===0?0:e||10;var t=yt(i).toHsl();return t.s-=e/100,t.s=d_(t.s),yt(t)}function R6(i,e){e=e===0?0:e||10;var t=yt(i).toHsl();return t.s+=e/100,t.s=d_(t.s),yt(t)}function N6(i){return yt(i).desaturate(100)}function P6(i,e){e=e===0?0:e||10;var t=yt(i).toHsl();return t.l+=e/100,t.l=d_(t.l),yt(t)}function D6(i,e){e=e===0?0:e||10;var t=yt(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),yt(t)}function k6(i,e){e=e===0?0:e||10;var t=yt(i).toHsl();return t.l-=e/100,t.l=d_(t.l),yt(t)}function I6(i,e){var t=yt(i).toHsl(),n=(t.h+e)%360;return t.h=n<0?360+n:n,yt(t)}function L6(i){var e=yt(i).toHsl();return e.h=(e.h+180)%360,yt(e)}function tC(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=yt(i).toHsl(),n=[yt(i)],r=360/e,s=1;s<e;s++)n.push(yt({h:(t.h+s*r)%360,s:t.s,l:t.l}));return n}function F6(i){var e=yt(i).toHsl(),t=e.h;return[yt(i),yt({h:(t+72)%360,s:e.s,l:e.l}),yt({h:(t+216)%360,s:e.s,l:e.l})]}function U6(i,e,t){e=e||6,t=t||30;var n=yt(i).toHsl(),r=360/t,s=[yt(i)];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(yt(n));return s}function O6(i,e){e=e||6;for(var t=yt(i).toHsv(),n=t.h,r=t.s,s=t.v,a=[],o=1/e;e--;)a.push(yt({h:n,s:r,v:s})),s=(s+o)%1;return a}yt.mix=function(i,e,t){t=t===0?0:t||50;var n=yt(i).toRgb(),r=yt(e).toRgb(),s=t/100,a={r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a};return yt(a)};yt.readability=function(i,e){var t=yt(i),n=yt(e);return(Math.max(t.getLuminance(),n.getLuminance())+.05)/(Math.min(t.getLuminance(),n.getLuminance())+.05)};yt.isReadable=function(i,e,t){var n=yt.readability(i,e),r,s;switch(s=!1,r=H6(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=n>=4.5;break;case"AAlarge":s=n>=3;break;case"AAAsmall":s=n>=7;break}return s};yt.mostReadable=function(i,e,t){var n=null,r=0,s,a,o,l;t=t||{},a=t.includeFallbackColors,o=t.level,l=t.size;for(var c=0;c<e.length;c++)s=yt.readability(i,e[c]),s>r&&(r=s,n=yt(e[c]));return yt.isReadable(i,n,{level:o,size:l})||!a?n:(t.includeFallbackColors=!1,yt.mostReadable(i,["#fff","#000"],t))};var Wb=yt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},B6=yt.hexNames=z6(Wb);function z6(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function ON(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function Hn(i,e){G6(i)&&(i="100%");var t=V6(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}function d_(i){return Math.min(1,Math.max(0,i))}function Xr(i){return parseInt(i,16)}function G6(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}function V6(i){return typeof i=="string"&&i.indexOf("%")!=-1}function Hs(i){return i.length==1?"0"+i:""+i}function Rf(i){return i<=1&&(i=i*100+"%"),i}function BN(i){return Math.round(parseFloat(i)*255).toString(16)}function nC(i){return Xr(i)/255}var Us=(function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Ka(i){return!!Us.CSS_UNIT.exec(i)}function j6(i){i=i.replace(b6,"").replace(w6,"").toLowerCase();var e=!1;if(Wb[i])i=Wb[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=Us.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=Us.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=Us.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=Us.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=Us.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=Us.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=Us.hex8.exec(i))?{r:Xr(t[1]),g:Xr(t[2]),b:Xr(t[3]),a:nC(t[4]),format:e?"name":"hex8"}:(t=Us.hex6.exec(i))?{r:Xr(t[1]),g:Xr(t[2]),b:Xr(t[3]),format:e?"name":"hex"}:(t=Us.hex4.exec(i))?{r:Xr(t[1]+""+t[1]),g:Xr(t[2]+""+t[2]),b:Xr(t[3]+""+t[3]),a:nC(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=Us.hex3.exec(i))?{r:Xr(t[1]+""+t[1]),g:Xr(t[2]+""+t[2]),b:Xr(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function H6(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function $b(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function W6(i){if(Array.isArray(i))return i}function $6(i){if(Array.isArray(i))return $b(i)}function zN(i,e,t){if(typeof i=="function"?i===e:i.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function q6(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function GN(i,e,t){return e=zh(e),tV(i,MS()?Reflect.construct(e,t||[],zh(i).constructor):e.apply(i,t))}function X6(i,e){if(e.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VN(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Ax(i,e){return i.get(zN(i,e))}function iC(i,e,t){X6(i,e),e.set(i,t)}function rC(i,e,t){return i.set(zN(i,e),t),t}function jN(i,e,t){if(MS())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return r}function Y6(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,$N(n.key),n)}}function HN(i,e,t){return e&&Y6(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function f_(i,e,t){return(e=$N(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function qb(){return qb=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var n=nV(i,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?i:t):r.value}},qb.apply(null,arguments)}function zh(i){return zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zh(i)}function WN(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Xb(i,e)}function MS(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MS=function(){return!!i})()}function K6(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Z6(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function Q6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sC(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function eV(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sC(Object(t),!0).forEach(function(n){f_(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):sC(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function tV(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q6(i)}function Xb(i,e){return Xb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Xb(i,e)}function Bf(i,e){return W6(i)||Z6(i,e)||qN(i,e)||Q6()}function nV(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=zh(i))!==null;);return i}function Ex(i,e,t,n){var r=qb(zh(i.prototype),e,t);return typeof r=="function"?function(s){return r.apply(t,s)}:r}function Bs(i){return $6(i)||K6(i)||qN(i)||J6()}function iV(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function $N(i){var e=iV(i,"string");return typeof e=="symbol"?e:e+""}function Yb(i){"@babel/helpers - typeof";return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yb(i)}function qN(i,e){if(i){if(typeof i=="string")return $b(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$b(i,e):void 0}}var XN=function(e){e instanceof Array?e.forEach(XN):(e.map&&e.map.dispose(),e.dispose())},YN=function(e){e.geometry&&e.geometry.dispose(),e.material&&XN(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(YN)},Kb=function(e){for(;e.children.length;){var t=e.children[0];e.remove(t),YN(t)}},Cx=new WeakMap,Vm=new WeakMap,cf=(function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.dataBindAttr,a=s===void 0?"__data":s,o=r.objBindAttr,l=o===void 0?"__threeObj":o;return VN(this,e),n=GN(this,e),f_(n,"scene",void 0),iC(n,Cx,void 0),iC(n,Vm,void 0),n.scene=t,rC(Cx,n,a),rC(Vm,n,l),n.onRemoveObj(function(){}),n}return WN(e,i),HN(e,[{key:"onCreateObj",value:function(n){var r=this;return Ex(e,"onCreateObj",this)([function(s){var a=n(s);return s[Ax(Vm,r)]=a,a[Ax(Cx,r)]=s,r.scene.add(a),a}]),this}},{key:"onRemoveObj",value:function(n){var r=this;return Ex(e,"onRemoveObj",this)([function(s,a){var o=Ex(e,"getData",r)([s]);n(s,a),r.scene.remove(s),Kb(s),delete o[Ax(Vm,r)]}]),this}}])})(_6),hf=function(e){return isNaN(e)?parseInt(yt(e).toHex(),16):e},Rx=function(e){return isNaN(e)?yt(e).getAlpha():1},rV=UN(x6);function aC(i,e,t){!e||typeof t!="string"||i.filter(function(n){return!n[t]}).forEach(function(n){n[t]=rV(e(n))})}function sV(i,e){var t=i.nodes,n=i.links,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.nodeFilter,a=s===void 0?function(){return!0}:s,o=r.onLoopError,l=o===void 0?function(m){throw"Invalid DAG structure! Found cycle in node path: ".concat(m.join(" -> "),".")}:o,c={};t.forEach(function(m){return c[e(m)]={data:m,out:[],depth:-1,skip:!a(m)}}),n.forEach(function(m){var _=m.source,b=m.target,v=E(_),y=E(b);if(!c.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!c.hasOwnProperty(y))throw"Missing target node with id: ".concat(y);var S=c[v],T=c[y];S.out.push(T);function E(N){return Yb(N)==="object"?e(N):N}});var d=[];p(Object.values(c));var f=Object.assign.apply(Object,[{}].concat(Bs(Object.entries(c).filter(function(m){var _=Bf(m,2),b=_[1];return!b.skip}).map(function(m){var _=Bf(m,2),b=_[0],v=_[1];return f_({},b,v.depth)}))));return f;function p(m){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var E=m[y];if(_.indexOf(E)!==-1){var N=[].concat(Bs(_.slice(_.indexOf(E))),[E]).map(function(M){return e(M.data)});return d.some(function(M){return M.length===N.length&&M.every(function(C,D){return C===N[D]})})||(d.push(N),l(N)),1}b>E.depth&&(E.depth=b,p(E.out,[].concat(Bs(_),[E]),b+(E.skip?0:1)))},y=0,S=m.length;y<S;y++)v()}}var Et=window.THREE?window.THREE:{Group:_S,Mesh:zb,MeshLambertMaterial:O5,Color:ml,BufferGeometry:xl,BufferAttribute:pu,Matrix4:Zi,Vector3:fe,SphereGeometry:dp,CylinderGeometry:u_,TubeGeometry:bS,ConeGeometry:xS,Line:w5,LineBasicMaterial:_N,QuadraticBezierCurve3:vS,CubicBezierCurve3:vN,Box3:ed},oC={graph:rG,forcelayout:_G},aV=2,Nx=new Et.BufferGeometry().setAttribute?"setAttribute":"addAttribute",jm=new Et.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",oV=h_({props:{jsonUrl:{onChange:function(e,t){var n=this;e&&!t.fetchingJson&&(t.fetchingJson=!0,t.onLoading(),fetch(e).then(function(r){return r.json()}).then(function(r){t.fetchingJson=!1,t.onFinishLoading(r),n.graphData(r)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,t){t.engineRunning=!1}},numDimensions:{default:3,onChange:function(e,t){var n=t.d3ForceLayout.force("charge");n&&n.strength(e>2?-60:-30),e<3&&r(t.graphData.nodes,"z"),e<2&&r(t.graphData.nodes,"y");function r(s,a){s.forEach(function(o){delete o[a],delete o["v".concat(a)]})}}},dagMode:{onChange:function(e,t){!e&&t.forceEngine==="d3"&&(t.graphData.nodes||[]).forEach(function(n){return n.fx=n.fy=n.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},linkDirectionalParticleThreeObject:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.velocityDecay(e)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(e){return e._flushObjects=!0,e._rerender(),this},d3Force:function(e,t,n){return n===void 0?e.d3ForceLayout.force(t):(e.d3ForceLayout.force(t,n),this)},d3ReheatSimulation:function(e){return e.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},tickFrame:function(e){var t=e.forceEngine!=="ngraph";return e.engineRunning&&n(),r(),s(),this;function n(){++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||t&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.layout[t?"tick":"step"](),e.onEngineTick());var a=Xt(e.nodeThreeObjectExtend);e.nodeDataMapper.entries().forEach(function(p){var m=Bf(p,2),_=m[0],b=m[1];if(b){var v=t?_:e.layout.getNodePosition(_[e.nodeId]),y=a(_);(!e.nodePositionUpdate||!e.nodePositionUpdate(y?b.children[0]:b,{x:v.x,y:v.y,z:v.z},_)||y)&&(b.position.x=v.x,b.position.y=v.y||0,b.position.z=v.z||0)}});var o=Xt(e.linkWidth),l=Xt(e.linkCurvature),c=Xt(e.linkCurveRotation),d=Xt(e.linkThreeObjectExtend);e.linkDataMapper.entries().forEach(function(p){var m=Bf(p,2),_=m[0],b=m[1];if(b){var v=t?_:e.layout.getLinkPosition(e.layout.graph.getLink(_.source,_.target).id),y=v[t?"source":"from"],S=v[t?"target":"to"];if(!(!y||!S||!y.hasOwnProperty("x")||!S.hasOwnProperty("x"))){f(_);var T=d(_);if(!(e.linkPositionUpdate&&e.linkPositionUpdate(T?b.children[1]:b,{start:{x:y.x,y:y.y,z:y.z},end:{x:S.x,y:S.y,z:S.z}},_)&&!T)){var E=30,N=_.__curve,M=b.children.length?b.children[0]:b;if(M.type==="Line"){if(N){var D=N.getPoints(E);M.geometry.getAttribute("position").array.length!==D.length*3&&M.geometry[Nx]("position",new Et.BufferAttribute(new Float32Array(D.length*3),3)),M.geometry.setFromPoints(D)}else{var C=M.geometry.getAttribute("position");(!C||!C.array||C.array.length!==6)&&M.geometry[Nx]("position",C=new Et.BufferAttribute(new Float32Array(6),3)),C.array[0]=y.x,C.array[1]=y.y||0,C.array[2]=y.z||0,C.array[3]=S.x,C.array[4]=S.y||0,C.array[5]=S.z||0,C.needsUpdate=!0}M.geometry.computeBoundingSphere()}else if(M.type==="Mesh")if(N){M.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(M.position.set(0,0,0),M.rotation.set(0,0,0),M.scale.set(1,1,1));var V=Math.ceil(o(_)*10)/10,Y=V/2,G=new Et.TubeGeometry(N,E,Y,e.linkResolution,!1);M.geometry.dispose(),M.geometry=G}else{if(!M.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var R=Math.ceil(o(_)*10)/10,P=R/2,L=new Et.CylinderGeometry(P,P,1,e.linkResolution,1,!1);L[jm](new Et.Matrix4().makeTranslation(0,1/2,0)),L[jm](new Et.Matrix4().makeRotationX(Math.PI/2)),M.geometry.dispose(),M.geometry=L}var z=new Et.Vector3(y.x,y.y||0,y.z||0),B=new Et.Vector3(S.x,S.y||0,S.z||0),O=z.distanceTo(B);M.position.x=z.x,M.position.y=z.y,M.position.z=z.z,M.scale.z=O,M.parent.localToWorld(B),M.lookAt(B)}}}}});function f(p){var m=t?p:e.layout.getLinkPosition(e.layout.graph.getLink(p.source,p.target).id),_=m[t?"source":"from"],b=m[t?"target":"to"];if(!(!_||!b||!_.hasOwnProperty("x")||!b.hasOwnProperty("x"))){var v=l(p);if(!v)p.__curve=null;else{var y=new Et.Vector3(_.x,_.y||0,_.z||0),S=new Et.Vector3(b.x,b.y||0,b.z||0),T=y.distanceTo(S),E,N=c(p);if(T>0){var M=b.x-_.x,C=b.y-_.y||0,D=new Et.Vector3().subVectors(S,y),R=D.clone().multiplyScalar(v).cross(M!==0||C!==0?new Et.Vector3(0,0,1):new Et.Vector3(0,1,0)).applyAxisAngle(D.normalize(),N).add(new Et.Vector3().addVectors(y,S).divideScalar(2));E=new Et.QuadraticBezierCurve3(y,R,S)}else{var P=v*70,L=-N,z=L+Math.PI/2;E=new Et.CubicBezierCurve3(y,new Et.Vector3(P*Math.cos(z),P*Math.sin(z),0).add(y),new Et.Vector3(P*Math.cos(L),P*Math.sin(L),0).add(y),S)}p.__curve=E}}}}function r(){var a=Xt(e.linkDirectionalArrowRelPos),o=Xt(e.linkDirectionalArrowLength),l=Xt(e.nodeVal);e.arrowDataMapper.entries().forEach(function(c){var d=Bf(c,2),f=d[0],p=d[1];if(p){var m=t?f:e.layout.getLinkPosition(e.layout.graph.getLink(f.source,f.target).id),_=m[t?"source":"from"],b=m[t?"target":"to"];if(!(!_||!b||!_.hasOwnProperty("x")||!b.hasOwnProperty("x"))){var v=Math.cbrt(Math.max(0,l(_)||1))*e.nodeRelSize,y=Math.cbrt(Math.max(0,l(b)||1))*e.nodeRelSize,S=o(f),T=a(f),E=f.__curve?function(P){return f.__curve.getPoint(P)}:function(P){var L=function(B,O,V,Y){return O[B]+(V[B]-O[B])*Y||0};return{x:L("x",_,b,P),y:L("y",_,b,P),z:L("z",_,b,P)}},N=f.__curve?f.__curve.getLength():Math.sqrt(["x","y","z"].map(function(P){return Math.pow((b[P]||0)-(_[P]||0),2)}).reduce(function(P,L){return P+L},0)),M=v+S+(N-v-y-S)*T,C=E(M/N),D=E((M-S)/N);["x","y","z"].forEach(function(P){return p.position[P]=D[P]});var R=jN(Et.Vector3,Bs(["x","y","z"].map(function(P){return C[P]})));p.parent.localToWorld(R),p.lookAt(R)}}})}function s(){var a=Xt(e.linkDirectionalParticleSpeed),o=Xt(e.linkDirectionalParticleOffset);e.graphData.links.forEach(function(l){var c=e.particlesDataMapper.getObj(l),d=c&&c.children,f=l.__singleHopPhotonsObj&&l.__singleHopPhotonsObj.children;if(!((!f||!f.length)&&(!d||!d.length))){var p=t?l:e.layout.getLinkPosition(e.layout.graph.getLink(l.source,l.target).id),m=p[t?"source":"from"],_=p[t?"target":"to"];if(!(!m||!_||!m.hasOwnProperty("x")||!_.hasOwnProperty("x"))){var b=a(l),v=Math.abs(o(l)),y=l.__curve?function(T){return l.__curve.getPoint(T)}:function(T){var E=function(M,C,D,R){return C[M]+(D[M]-C[M])*R||0};return{x:E("x",m,_,T),y:E("y",m,_,T),z:E("z",m,_,T)}},S=[].concat(Bs(d||[]),Bs(f||[]));S.forEach(function(T,E){var N=T.parent.__linkThreeObjType==="singleHopPhotons";if(T.hasOwnProperty("__progressRatio")||(T.__progressRatio=N?0:(E+v)/d.length),T.__progressRatio+=b,T.__progressRatio>=1)if(!N)T.__progressRatio=T.__progressRatio%1;else{T.parent.remove(T),Kb(T);return}var M=T.__progressRatio,C=y(M);T.geometry.type!=="SphereGeometry"&&T.lookAt(C.x,C.y,C.z),["x","y","z"].forEach(function(D){return T.position[D]=C[D]})})}}})}},emitParticle:function(e,t){if(t&&e.graphData.links.includes(t)){if(!t.__singleHopPhotonsObj){var n=new Et.Group;n.__linkThreeObjType="singleHopPhotons",t.__singleHopPhotonsObj=n,e.graphScene.add(n)}var r=Xt(e.linkDirectionalParticleThreeObject)(t);if(r&&e.linkDirectionalParticleThreeObject===r&&(r=r.clone()),!r){var s=Xt(e.linkDirectionalParticleWidth),a=Math.ceil(s(t)*10)/10/2,o=e.linkDirectionalParticleResolution,l=new Et.SphereGeometry(a,o,o),c=Xt(e.linkColor),d=Xt(e.linkDirectionalParticleColor),f=d(t)||c(t)||"#f0f0f0",p=new Et.Color(hf(f)),m=e.linkOpacity*3,_=new Et.MeshLambertMaterial({color:p,transparent:!0,opacity:m});r=new Et.Mesh(l,_)}t.__singleHopPhotonsObj.add(r)}return this},getGraphBbox:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!e.initialised)return null;var n=(function r(s){var a=[];if(s.geometry){s.geometry.computeBoundingBox();var o=new Et.Box3;o.copy(s.geometry.boundingBox).applyMatrix4(s.matrixWorld),a.push(o)}return a.concat.apply(a,Bs((s.children||[]).filter(function(l){return!l.hasOwnProperty("__graphObjType")||l.__graphObjType==="node"&&t(l.__data)}).map(r)))})(e.graphScene);return n.length?Object.assign.apply(Object,Bs(["x","y","z"].map(function(r){return f_({},r,[n6(n,function(s){return s.min[r]}),t6(n,function(s){return s.max[r]})])}))):null}},stateInit:function(){return{d3ForceLayout:Q8().force("link",U8()).force("charge",J8()).force("center",B5()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,t){t.graphScene=e,t.nodeDataMapper=new cf(e,{objBindAttr:"__threeObj"}),t.linkDataMapper=new cf(e,{objBindAttr:"__lineObj"}),t.arrowDataMapper=new cf(e,{objBindAttr:"__arrowObj"}),t.particlesDataMapper=new cf(e,{objBindAttr:"__photonsObj"})},update:function(e,t){var n=function(q){return q.some(function(re){return t.hasOwnProperty(re)})};if(e.engineRunning=!1,typeof e.onUpdate=="function"&&e.onUpdate(),e.nodeAutoColorBy!==null&&n(["nodeAutoColorBy","graphData","nodeColor"])&&aC(e.graphData.nodes,Xt(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&n(["linkAutoColorBy","graphData","linkColor"])&&aC(e.graphData.links,Xt(e.linkAutoColorBy),e.linkColor),e._flushObjects||n(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var r=Xt(e.nodeThreeObject),s=Xt(e.nodeThreeObjectExtend),a=Xt(e.nodeVal),o=Xt(e.nodeColor),l=Xt(e.nodeVisibility),c={},d={};(e._flushObjects||n(["nodeThreeObject","nodeThreeObjectExtend"]))&&e.nodeDataMapper.clear(),e.nodeDataMapper.onCreateObj(function(ie){var q=r(ie),re=s(ie);q&&e.nodeThreeObject===q&&(q=q.clone());var we;return q&&!re?we=q:(we=new Et.Mesh,we.__graphDefaultObj=!0,q&&re&&we.add(q)),we.__graphObjType="node",we}).onUpdateObj(function(ie,q){if(ie.__graphDefaultObj){var re=a(q)||1,we=Math.cbrt(re)*e.nodeRelSize,He=e.nodeResolution;(!ie.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||ie.geometry.parameters.radius!==we||ie.geometry.parameters.widthSegments!==He)&&(c.hasOwnProperty(re)||(c[re]=new Et.SphereGeometry(we,He,He)),ie.geometry.dispose(),ie.geometry=c[re]);var Be=o(q),pt=new Et.Color(hf(Be||"#ffffaa")),ln=e.nodeOpacity*Rx(Be);(ie.material.type!=="MeshLambertMaterial"||!ie.material.color.equals(pt)||ie.material.opacity!==ln)&&(d.hasOwnProperty(Be)||(d[Be]=new Et.MeshLambertMaterial({color:pt,transparent:!0,opacity:ln})),ie.material.dispose(),ie.material=d[Be])}}).digest(e.graphData.nodes.filter(l))}if(e._flushObjects||n(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","linkDirectionalParticleThreeObject"])){var f=Xt(e.linkThreeObject),p=Xt(e.linkThreeObjectExtend),m=Xt(e.linkMaterial),_=Xt(e.linkVisibility),b=Xt(e.linkColor),v=Xt(e.linkWidth),y={},S={},T={},E=e.graphData.links.filter(_);if((e._flushObjects||n(["linkThreeObject","linkThreeObjectExtend","linkWidth"]))&&e.linkDataMapper.clear(),e.linkDataMapper.onRemoveObj(function(ie){var q=ie.__data&&ie.__data.__singleHopPhotonsObj;q&&(q.parent.remove(q),Kb(q),delete ie.__data.__singleHopPhotonsObj)}).onCreateObj(function(ie){var q=f(ie),re=p(ie);q&&e.linkThreeObject===q&&(q=q.clone());var we;if(!q||re){var He=!!v(ie);if(He)we=new Et.Mesh;else{var Be=new Et.BufferGeometry;Be[Nx]("position",new Et.BufferAttribute(new Float32Array(6),3)),we=new Et.Line(Be)}}var pt;return q?re?(pt=new Et.Group,pt.__graphDefaultObj=!0,pt.add(we),pt.add(q)):pt=q:(pt=we,pt.__graphDefaultObj=!0),pt.renderOrder=10,pt.__graphObjType="link",pt}).onUpdateObj(function(ie,q){if(ie.__graphDefaultObj){var re=ie.children.length?ie.children[0]:ie,we=Math.ceil(v(q)*10)/10,He=!!we;if(He){var Be=we/2,pt=e.linkResolution;if(!re.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||re.geometry.parameters.radiusTop!==Be||re.geometry.parameters.radialSegments!==pt){if(!y.hasOwnProperty(we)){var ln=new Et.CylinderGeometry(Be,Be,1,pt,1,!1);ln[jm](new Et.Matrix4().makeTranslation(0,1/2,0)),ln[jm](new Et.Matrix4().makeRotationX(Math.PI/2)),y[we]=ln}re.geometry.dispose(),re.geometry=y[we]}}var Dt=m(q);if(Dt)re.material=Dt;else{var zt=b(q),Yt=new Et.Color(hf(zt||"#f0f0f0")),Ct=e.linkOpacity*Rx(zt),tn=He?"MeshLambertMaterial":"LineBasicMaterial";if(re.material.type!==tn||!re.material.color.equals(Yt)||re.material.opacity!==Ct){var Z=He?S:T;Z.hasOwnProperty(zt)||(Z[zt]=new Et[tn]({color:Yt,transparent:Ct<1,opacity:Ct,depthWrite:Ct>=1})),re.material.dispose(),re.material=Z[zt]}}}}).digest(E),e.linkDirectionalArrowLength||t.hasOwnProperty("linkDirectionalArrowLength")){var N=Xt(e.linkDirectionalArrowLength),M=Xt(e.linkDirectionalArrowColor);e.arrowDataMapper.onCreateObj(function(){var ie=new Et.Mesh(void 0,new Et.MeshLambertMaterial({transparent:!0}));return ie.__linkThreeObjType="arrow",ie}).onUpdateObj(function(ie,q){var re=N(q),we=e.linkDirectionalArrowResolution;if(!ie.geometry.type.match(/^Cone(Buffer)?Geometry$/)||ie.geometry.parameters.height!==re||ie.geometry.parameters.radialSegments!==we){var He=new Et.ConeGeometry(re*.25,re,we);He.translate(0,re/2,0),He.rotateX(Math.PI/2),ie.geometry.dispose(),ie.geometry=He}var Be=M(q)||b(q)||"#f0f0f0";ie.material.color=new Et.Color(hf(Be)),ie.material.opacity=e.linkOpacity*3*Rx(Be)}).digest(E.filter(N))}if(e.linkDirectionalParticles||t.hasOwnProperty("linkDirectionalParticles")){var C=Xt(e.linkDirectionalParticles),D=Xt(e.linkDirectionalParticleWidth),R=Xt(e.linkDirectionalParticleColor),P=Xt(e.linkDirectionalParticleThreeObject),L={},z={};e.particlesDataMapper.onCreateObj(function(){var ie=new Et.Group;return ie.__linkThreeObjType="photons",ie.__photonDataMapper=new cf(ie),ie}).onUpdateObj(function(ie,q){var re=!!ie.children.length&&ie.children[0],we=P(q),He,Be;if(we)He=we.geometry,Be=we.material;else{var pt=Math.ceil(D(q)*10)/10/2,ln=e.linkDirectionalParticleResolution;re&&re.geometry.parameters.radius===pt&&re.geometry.parameters.widthSegments===ln?He=re.geometry:(z.hasOwnProperty(pt)||(z[pt]=new Et.SphereGeometry(pt,ln,ln)),He=z[pt]);var Dt=R(q)||b(q)||"#f0f0f0",zt=new Et.Color(hf(Dt)),Yt=e.linkOpacity*3;re&&re.material.color.equals(zt)&&re.material.opacity===Yt?Be=re.material:(L.hasOwnProperty(Dt)||(L[Dt]=new Et.MeshLambertMaterial({color:zt,transparent:!0,opacity:Yt})),Be=L[Dt])}re&&(re.geometry!==He&&re.geometry.dispose(),re.material!==Be&&re.material.dispose());var Ct=Math.round(Math.abs(C(q)));ie.__photonDataMapper.id(function(tn){return tn.idx}).onCreateObj(function(){return new Et.Mesh(He,Be)}).onUpdateObj(function(tn){tn.geometry=He,tn.material=Be}).digest(Bs(new Array(Ct)).map(function(tn,Z){return{idx:Z}}))}).digest(E.filter(C))}}if(e._flushObjects=!1,n(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){e.engineRunning=!1,e.graphData.links.forEach(function(ie){ie.source=ie[e.linkSource],ie.target=ie[e.linkTarget]});var B=e.forceEngine!=="ngraph",O;if(B){(O=e.d3ForceLayout).stop().alpha(1).numDimensions(e.numDimensions).nodes(e.graphData.nodes);var V=e.d3ForceLayout.force("link");V&&V.id(function(ie){return ie[e.nodeId]}).links(e.graphData.links);var Y=e.dagMode&&sV(e.graphData,function(ie){return ie[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),G=Math.max.apply(Math,Bs(Object.values(Y||[]))),W=e.dagLevelDistance||e.graphData.nodes.length/(G||1)*aV*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu","zin","zout"].includes(t.dagMode)){var te=["lr","rl"].includes(t.dagMode)?"fx":["td","bu"].includes(t.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(ie){return delete ie[te]})}if(["lr","rl","td","bu","zin","zout"].includes(e.dagMode)){var U=["rl","td","zout"].includes(e.dagMode),H=function(q){return(Y[q[e.nodeId]]-G/2)*W*(U?-1:1)},le=["lr","rl"].includes(e.dagMode)?"fx":["td","bu"].includes(e.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(ie){return ie[le]=H(ie)})}e.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?eG(function(ie){var q=Y[ie[e.nodeId]]||-1;return(e.dagMode==="radialin"?G-q:q)*W}).strength(function(ie){return e.dagNodeFilter(ie)?1:0}):null)}else{var Te=oC.graph();e.graphData.nodes.forEach(function(ie){Te.addNode(ie[e.nodeId])}),e.graphData.links.forEach(function(ie){Te.addLink(ie.source,ie.target)}),O=oC.forcelayout(Te,eV({dimensions:e.numDimensions},e.ngraphPhysics)),O.graph=Te}for(var Fe=0;Fe<e.warmupTicks&&!(B&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin);Fe++)O[B?"tick":"step"]();e.layout=O,this.resetCountdown()}e.engineRunning=!0,e.onFinishUpdate()}});function lV(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=(function(r){function s(){var a;VN(this,s);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return a=GN(this,s,[].concat(l)),a.__kapsuleInstance=jN(i,[].concat(Bs(t?[a]:[]),l)),a}return WN(s,r),HN(s)})(e);return Object.keys(i()).forEach(function(r){return n.prototype[r]=function(){var s,a=(s=this.__kapsuleInstance)[r].apply(s,arguments);return a===this.__kapsuleInstance?this:a}}),n}var uV=window.THREE?window.THREE:{Group:_S},KN=lV(oV,uV.Group,!0);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const cV=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],Px=new WeakMap;class hV{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=cV,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:r,object:s}=e;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:a,height:o}=e.context;t.bufferWidth=a,t.bufferHeight=o}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return!!(e.context.modelViewMatrix||e.context.modelNormalViewMatrix||e.context.getAO||e.context.getShadow)}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e,t){const{object:n,material:r,geometry:s}=e,a=this.getRenderObjectData(e);if(a.worldMatrix.equals(n.matrixWorld)!==!0)return a.worldMatrix.copy(n.matrixWorld),!1;const o=a.material;for(const v in o){const y=o[v],S=r[v];if(y.equals!==void 0){if(y.equals(S)===!1)return y.copy(S),!1}else if(S.isTexture===!0){if(y.id!==S.id||y.version!==S.version)return y.id=S.id,y.version=S.version,!1}else if(y!==S)return o[v]=S,!1}if(o.transmission>0){const{width:v,height:y}=e.context;if(a.bufferWidth!==v||a.bufferHeight!==y)return a.bufferWidth=v,a.bufferHeight=y,!1}const l=a.geometry,c=s.attributes,d=l.attributes,f=Object.keys(d),p=Object.keys(c);if(l.id!==s.id)return l.id=s.id,!1;if(f.length!==p.length)return a.geometry.attributes=this.getAttributesData(c),!1;for(const v of f){const y=d[v],S=c[v];if(S===void 0)return delete d[v],!1;if(y.version!==S.version)return y.version=S.version,!1}const m=s.index,_=l.indexVersion,b=m?m.version:null;if(_!==b)return l.indexVersion=b,!1;if(l.drawRange.start!==s.drawRange.start||l.drawRange.count!==s.drawRange.count)return l.drawRange.start=s.drawRange.start,l.drawRange.count=s.drawRange.count,!1;if(a.morphTargetInfluences){let v=!1;for(let y=0;y<a.morphTargetInfluences.length;y++)a.morphTargetInfluences[y]!==n.morphTargetInfluences[y]&&(a.morphTargetInfluences[y]=n.morphTargetInfluences[y],v=!0);if(v)return!1}if(a.lights){for(let v=0;v<t.length;v++)if(a.lights[v].map!==t[v].map)return!1}return a.center&&a.center.equals(n.center)===!1?(a.center.copy(n.center),!0):(e.bundle!==null&&(a.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const n of e)n.isSpotLight===!0&&n.map!==null&&t.push({map:n.map.version});return t}getLights(e,t){if(Px.has(e)){const r=Px.get(e);if(r.renderId===t)return r.lightsData}const n=this.getLightsData(e.getLights());return Px.set(e,{renderId:t,lightsData:n}),n}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;if(r||s)return!1;const a=this.getLights(e.lightsNode,n);return this.equals(e,a)!==!0}}function AS(i,e=0){let t=3735928559^e,n=1103547991^e;if(i instanceof Array)for(let r=0,s;r<i.length;r++)s=i[r],t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);else for(let r=0,s;r<i.length;r++)s=i.charCodeAt(r),t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const p_=i=>AS(i),Pp=i=>AS(i),zf=(...i)=>AS(i),dV=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),lC=new WeakMap;function ZN(i){return dV.get(i)}function O0(i){if(i==null)return null;const e=typeof i;return i.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":i.isVector2===!0?"vec2":i.isVector3===!0?"vec3":i.isVector4===!0?"vec4":i.isMatrix2===!0?"mat2":i.isMatrix3===!0?"mat3":i.isMatrix4===!0?"mat4":i.isColor===!0?"color":i instanceof ArrayBuffer?"ArrayBuffer":null}function ES(i,...e){const t=i?i.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),i==="color"?new _t(...e):t==="vec2"?new Xe(...e):t==="vec3"?new X(...e):t==="vec4"?new It(...e):t==="mat2"?new i_(...e):t==="mat3"?new Ft(...e):t==="mat4"?new hn(...e):i==="bool"?e[0]||!1:i==="float"||i==="int"||i==="uint"?e[0]||0:i==="string"?e[0]||"":i==="ArrayBuffer"?pV(e[0]):null}function QN(i){let e=lC.get(i);return e===void 0&&(e={},lC.set(i,e)),e}function fV(i){let e="";const t=new Uint8Array(i);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function pV(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0)).buffer}const Hm={VERTEX:"vertex"},Ut={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},ps={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},gV=["fragment","vertex"],uC=["setup","analyze","generate"],cC=[...gV,"compute"],nd=["x","y","z","w"],mV={analyze:"setup",generate:"analyze"};let _V=0;class ft extends Ca{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Ut.NONE,this.updateBeforeType=Ut.NONE,this.updateAfterType=Ut.NONE,this.uuid=D0.generateUUID(),this.version=0,this.name="",this.global=!1,this.parents=!1,this.isNode=!0,this._beforeNodes=null,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:_V++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,Ut.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Ut.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Ut.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of this._getChildren())yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}_getChildren(e=new Set){const t=[];e.add(this);for(const n of Object.getOwnPropertyNames(this)){const r=this[n];if(!(n.startsWith("_")===!0||e.has(r))){if(Array.isArray(r)===!0)for(let s=0;s<r.length;s++){const a=r[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}else if(r&&r.isNode===!0)t.push({property:n,childNode:r});else if(r&&Object.getPrototypeOf(r)===Object.prototype)for(const s in r){if(s.startsWith("_")===!0)continue;const a=r[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}}}return t}getCacheKey(e=!1,t=null){if(e=e||this.version!==this._cacheKeyVersion,e===!0||this._cacheKey===null){t===null&&(t=new Set);const n=[];for(const{property:r,childNode:s}of this._getChildren(t))n.push(p_(r.slice(0,-4)),s.getCacheKey(e,t));this._cacheKey=zf(Pp(n),this.customCacheKey()),this._cacheKeyVersion=this.version}return this._cacheKey}customCacheKey(){return this.id}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(n===1){const r=e.getNodeProperties(this);for(const s of Object.values(r))s&&s.isNode===!0&&s.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){Ae("Abstract function.")}updateAfter(){Ae("Abstract function.")}update(){Ae("Abstract function.")}before(e){return this._beforeNodes===null&&(this._beforeNodes=[]),this._beforeNodes.push(e),this}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);if(this._beforeNodes!==null){const l=this._beforeNodes;this._beforeNodes=null;for(const c of l)c.build(e,t);this._beforeNodes=l}const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const s=mV[e.buildStage];if(s&&r.buildStages[s]!==!0){const l=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(l)}e.addNode(this),e.addChain(this);let a=null;const o=e.getBuildStage();if(o==="setup"){this.updateReference(e);const l=e.getNodeProperties(this);if(l.initialized!==!0){l.initialized=!0,l.outputNode=this.setup(e)||l.outputNode||null;for(const c of Object.values(l))if(c&&c.isNode===!0){if(c.parents===!0){const d=e.getNodeProperties(c);d.parents=d.parents||[],d.parents.push(this)}c.build(e)}}a=l.outputNode}else if(o==="analyze")this.analyze(e,t);else if(o==="generate"){if(this.generate.length<2){const c=this.getNodeType(e),d=e.getDataFromNode(this);a=d.snippet,a===void 0?d.generated===void 0?(d.generated=!0,a=this.generate(e)||"",d.snippet=a):(Ae("Node: Recursion detected.",this),a="/* Recursion detected. */"):d.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,c,t)}else a=this.generate(e,t)||"";a===""&&t!==null&&t!=="void"&&t!=="OutputType"&&(Ee(`TSL: Invalid generated code, expected a "${t}".`),a=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),a}getSerializeChildren(){return this._getChildren()}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:s,childNode:a}of t)s!==void 0?(n[r]===void 0&&(n[r]=Number.isInteger(s)?[]:{}),n[r][s]=a.toJSON(e.meta).uuid):n[r]=a.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const s of e.inputNodes[n])r.push(t[s]);this[n]=r}else if(typeof e.inputNodes[n]=="object"){const r={};for(const s in e.inputNodes[n]){const a=e.inputNodes[n][s];r[s]=t[a]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function a(o){const l=[];for(const c in o){const d=o[c];delete d.metadata,l.push(d)}return l}if(r){const o=a(e.textures),l=a(e.images),c=a(e.nodes);o.length>0&&(s.textures=o),l.length>0&&(s.images=l),c.length>0&&(s.nodes=c)}return s}}class id extends ft{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${r} ]`}}class JN extends ft{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),s=n.build(e,r);return e.format(s,r,t)}}class oi extends ft{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const a=super.build(e,r),o=e.getVarFromNode(this,null,r),l=e.getPropertyName(o);return e.addLineFlowCode(`${l} = ${a}`,this),s.snippet=a,s.propertyName=l,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class yV extends oi{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),s=this.nodes,a=e.getComponentType(n),o=[];let l=0;for(const d of s){if(l>=r){Ee(`TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let f=d.getNodeType(e),p=e.getTypeLength(f),m;if(l+p>r&&(Ee(`TSL: Length of '${n}()' data exceeds maximum length of output type.`),p=r-l,f=e.getTypeFromLength(p)),l+=p,m=d.build(e,f),e.getComponentType(f)!==a){const b=e.getTypeFromLength(p,a);m=e.format(m,f,b)}o.push(m)}const c=`${e.getType(n)}( ${o.join(", ")} )`;return e.format(c,n,t)}}const vV=nd.join("");class xV extends ft{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(nd.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let s=null;if(r>1){let a=null;this.getVectorLength()>=r&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=n.build(e,a);this.components.length===r&&this.components===vV.slice(0,this.components.length)?s=e.format(l,a,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=n.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class bV extends oi{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,s=this.getNodeType(e),a=e.getComponentType(r.getNodeType(e)),o=e.getTypeFromLength(n.length,a),l=r.build(e,o),c=t.build(e,s),d=e.getTypeLength(s),f=[];for(let p=0;p<d;p++){const m=nd[p];m===n[0]?(f.push(l),p+=n.length-1):f.push(c+"."+m)}return`${e.getType(s)}( ${f.join(", ")} )`}}class wV extends oi{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),s=n.build(e),a=e.getVarFromNode(this),o=e.getPropertyName(a);e.addLineFlowCode(o+" = "+s,this);const l=e.getTypeLength(r),c=[];let d=0;for(let f=0;f<l;f++){const p=nd[f];p===t[d]?(c.push("1.0 - "+(o+"."+p)),d++):c.push(o+"."+p)}return`${e.getType(r)}( ${c.join(", ")} )`}}class CS extends ft{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?O0(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=O0(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=fV(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?ES(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){Ae("Abstract function.")}}const hC=/float|u?int/;class Ra extends CS{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return hC.test(n)&&hC.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class SV extends ft{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return this.structNode.isMemberNode&&this.structNode.hasMember(e)===!1?!1:this.structNode.getMemberType(e,this.property)!=="void"}getNodeType(e){return this.hasMember(e)===!1?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(this.hasMember(e)===!1)return"float";const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}generate(e){if(this.hasMember(e)===!1){Ae(`TSL: Member "${this.property}" does not exist in struct.`);const n=this.getNodeType(e);return e.generateConst(n)}return this.structNode.build(e)+"."+this.property}}let Cu=null;const Zb=new Map;function ve(i,e){if(Zb.has(i)){Ae(`TSL: Redefinition of method chaining '${i}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${i} is not a function`);Zb.set(i,e),i!=="assign"&&(ft.prototype[i]=function(...t){return this.isStackNode?this.addToStack(e(...t)):e(this,...t)},ft.prototype[i+"Assign"]=function(...t){return this.isStackNode?this.assign(t[0],e(...t)):this.assign(e(this,...t))})}const TV=i=>i.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),dC=i=>TV(i).split("").sort().join("");ft.prototype.assign=function(...i){if(this.isStackNode!==!0)return Cu!==null?Cu.assign(this,...i):Ee("TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const e=Zb.get("assign");return this.addToStack(e(...i))}};ft.prototype.toVarIntent=function(){return this};ft.prototype.get=function(i){return new SV(this,i)};const Gf={};function Wm(i,e,t){Gf[i]=Gf[e]=Gf[t]={get(){this._cache=this._cache||{};let a=this._cache[i];return a===void 0&&(a=new xV(this,i),this._cache[i]=a),a},set(a){this[i].assign(Qe(a))}};const n=i.toUpperCase(),r=e.toUpperCase(),s=t.toUpperCase();ft.prototype["set"+n]=ft.prototype["set"+r]=ft.prototype["set"+s]=function(a){const o=dC(i);return new bV(this,o,Qe(a))},ft.prototype["flip"+n]=ft.prototype["flip"+r]=ft.prototype["flip"+s]=function(){const a=dC(i);return new wV(this,a)}}const oa=["x","y","z","w"],la=["r","g","b","a"],ua=["s","t","p","q"];for(let i=0;i<4;i++){let e=oa[i],t=la[i],n=ua[i];Wm(e,t,n);for(let r=0;r<4;r++){e=oa[i]+oa[r],t=la[i]+la[r],n=ua[i]+ua[r],Wm(e,t,n);for(let s=0;s<4;s++){e=oa[i]+oa[r]+oa[s],t=la[i]+la[r]+la[s],n=ua[i]+ua[r]+ua[s],Wm(e,t,n);for(let a=0;a<4;a++)e=oa[i]+oa[r]+oa[s]+oa[a],t=la[i]+la[r]+la[s]+la[a],n=ua[i]+ua[r]+ua[s]+ua[a],Wm(e,t,n)}}}for(let i=0;i<32;i++)Gf[i]={get(){this._cache=this._cache||{};let e=this._cache[i];return e===void 0&&(e=new id(this,new Ra(i,"uint")),this._cache[i]=e),e},set(e){this[i].assign(Qe(e))}};Object.defineProperties(ft.prototype,Gf);const fC=new WeakMap,MV=function(i,e=null){const t=O0(i);return t==="node"?i:e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string"?Qe(Qb(i,e)):t==="shader"?i.isFn?i:Se(i):i},AV=function(i,e=null){for(const t in i)i[t]=Qe(i[t],e);return i},EV=function(i,e=null){const t=i.length;for(let n=0;n<t;n++)i[n]=Qe(i[n],e);return i},eP=function(i,e=null,t=null,n=null){function r(d){return n!==null?(d=Qe(Object.assign(d,n)),n.intent===!0&&(d=d.toVarIntent())):d=Qe(d),d}let s,a=e,o,l;function c(d){let f;return a?f=/[a-z]/i.test(a)?a+"()":a:f=i.type,o!==void 0&&d.length<o?(Ee(`TSL: "${f}" parameter length is less than minimum required.`),d.concat(new Array(o-d.length).fill(0))):l!==void 0&&d.length>l?(Ee(`TSL: "${f}" parameter length exceeds limit.`),d.slice(0,l)):d}return e===null?s=(...d)=>r(new i(...rh(c(d)))):t!==null?(t=Qe(t),s=(...d)=>r(new i(e,...rh(c(d)),t))):s=(...d)=>r(new i(e,...rh(c(d)))),s.setParameterLength=(...d)=>(d.length===1?o=l=d[0]:d.length===2&&([o,l]=d),s),s.setName=d=>(a=d,s),s},CV=function(i,...e){return new i(...rh(e))};class RV extends ft{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getElementType(e){return this.getOutputNode(e).getElementType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:n}=this,r=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",a=s||"default";if(r[a])return r[a];const o=e.subBuildFn,l=e.fnCall;e.subBuildFn=s,e.fnCall=this;let c=null;if(t.layout){let d=fC.get(e.constructor);d===void 0&&(d=new WeakMap,fC.set(e.constructor,d));let f=d.get(t);f===void 0&&(f=Qe(e.buildFunctionNode(t)),d.set(t,f)),e.addInclude(f);const p=n?NV(n):null;c=Qe(f.call(p))}else{const d=new Proxy(e,{get:(b,v,y)=>{let S;return Symbol.iterator===v?S=function*(){yield void 0}:S=Reflect.get(b,v,y),S}}),f=n?PV(n):null,p=Array.isArray(n)?n.length>0:n!==null,m=t.jsFunc,_=p||m.length>1?m(f,d):m(d);c=Qe(_)}return e.subBuildFn=o,e.fnCall=l,t.once&&(r[a]=c),c}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getSubBuildOutput(this);return t[n]=t[n]||this.setupOutput(e),t[n].subBuild=e.getClosestSubBuild(this),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),s=e.getNodeProperties(this),a=e.getSubBuildOutput(this),o=this.getOutputNode(e),l=e.fnCall;if(e.fnCall=this,r==="setup"){const c=e.getSubBuildProperty("initialized",this);if(s[c]!==!0&&(s[c]=!0,s[a]=this.getOutputNode(e),s[a].build(e),this.shaderNode.subBuilds))for(const d of e.chaining){const f=e.getDataFromNode(d,"any");f.subBuilds=f.subBuilds||new Set;for(const p of this.shaderNode.subBuilds)f.subBuilds.add(p)}n=s[a]}else r==="analyze"?o.build(e,t):r==="generate"&&(n=o.build(e,t)||"");return e.fnCall=l,n}}function NV(i){let e;return DS(i),i[0]&&(i[0].isNode||Object.getPrototypeOf(i[0])!==Object.prototype)?e=[...i]:e=i[0],e}function PV(i){let e=0;return DS(i),new Proxy(i,{get:(t,n,r)=>{let s;if(n==="length")return s=i.length,s;if(Symbol.iterator===n)s=function*(){for(const a of i)yield Qe(a)};else{if(i.length>0)if(Object.getPrototypeOf(i[0])===Object.prototype){const a=i[0];a[n]===void 0?s=a[e++]:s=Reflect.get(a,n,r)}else i[0]instanceof ft&&(i[n]===void 0?s=i[e++]:s=Reflect.get(i,n,r));else s=Reflect.get(t,n,r);s=Qe(s)}return s}})}class DV extends ft{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}getLayout(){return this.layout}call(e=null){return new RV(this,e)}setup(){return this.call()}}const kV=[!1,!0],IV=[0,1,2,3],LV=[-1,-2],tP=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],RS=new Map;for(const i of kV)RS.set(i,new Ra(i));const NS=new Map;for(const i of IV)NS.set(i,new Ra(i,"uint"));const PS=new Map([...NS].map(i=>new Ra(i.value,"int")));for(const i of LV)PS.set(i,new Ra(i,"int"));const g_=new Map([...PS].map(i=>new Ra(i.value)));for(const i of tP)g_.set(i,new Ra(i));for(const i of tP)g_.set(-i,new Ra(-i));const m_={bool:RS,uint:NS,ints:PS,float:g_},pC=new Map([...RS,...g_]),Qb=(i,e)=>pC.has(i)?pC.get(i):i.isNode===!0?i:new Ra(i,e),li=function(i,e=null){return(...t)=>{for(const r of t)if(r===void 0)return Ee(`TSL: Invalid parameter for the type "${i}".`),new Ra(0,i);if((t.length===0||!["bool","float","int","uint"].includes(i)&&t.every(r=>{const s=typeof r;return s!=="object"&&s!=="function"}))&&(t=[ES(i,...t)]),t.length===1&&e!==null&&e.has(t[0]))return $m(e.get(t[0]));if(t.length===1){const r=Qb(t[0],i);return r.nodeType===i?$m(r):$m(new JN(r,i))}const n=t.map(r=>Qb(r));return $m(new yV(n,i))}},gC=i=>typeof i=="object"&&i!==null?i.value:i,FV=i=>i!=null?i.nodeType||i.convertTo||(typeof i=="string"?i:null):null;function Nf(i,e){return new DV(i,e)}const Qe=(i,e=null)=>MV(i,e),$m=(i,e=null)=>Qe(i,e).toVarIntent(),DS=(i,e=null)=>new AV(i,e),rh=(i,e=null)=>new EV(i,e),on=(i,e=null,t=null,n=null)=>new eP(i,e,t,n),Oe=(i,...e)=>new CV(i,...e),tt=(i,e=null,t=null,n={})=>new eP(i,e,t,{...n,intent:!0});let UV=0;class OV extends ft{constructor(e,t=null){super();let n=null;t!==null&&(typeof t=="object"?n=t.return:(typeof t=="string"?n=t:Ee("TSL: Invalid layout type."),t=null)),this.shaderNode=new Nf(e,n),t!==null&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if(typeof e.inputs!="object"){const n={name:"fn"+UV++,type:t,inputs:[]};for(const r in e)r!=="return"&&n.inputs.push({name:r,type:e[r]});e=n}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return this.shaderNode.nodeType==="void"&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return Ee('TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}}function Se(i,e=null){const t=new OV(i,e);return new Proxy(()=>{},{apply(n,r,s){return t.call(...s)},get(n,r,s){return Reflect.get(t,r,s)},set(n,r,s,a){return Reflect.set(t,r,s,a)}})}const B0=i=>{Cu=i},nP=()=>Cu,Sn=(...i)=>Cu.If(...i);function iP(i){return Cu&&Cu.addToStack(i),i}ve("toStack",iP);const BV=new li("color"),_e=new li("float",m_.float),Dn=new li("int",m_.ints),Wt=new li("uint",m_.uint),kS=new li("bool",m_.bool),st=new li("vec2"),pa=new li("ivec2"),rP=new li("uvec2"),zV=new li("bvec2"),ye=new li("vec3"),sP=new li("ivec3"),aP=new li("uvec3"),GV=new li("bvec3"),kt=new li("vec4"),oP=new li("ivec4"),lP=new li("uvec4"),VV=new li("bvec4"),IS=new li("mat2"),Ji=new li("mat3"),gu=new li("mat4");ve("toColor",BV);ve("toFloat",_e);ve("toInt",Dn);ve("toUint",Wt);ve("toBool",kS);ve("toVec2",st);ve("toIVec2",pa);ve("toUVec2",rP);ve("toBVec2",zV);ve("toVec3",ye);ve("toIVec3",sP);ve("toUVec3",aP);ve("toBVec3",GV);ve("toVec4",kt);ve("toIVec4",oP);ve("toUVec4",lP);ve("toBVec4",VV);ve("toMat2",IS);ve("toMat3",Ji);ve("toMat4",gu);const jV=on(id).setParameterLength(2),HV=(i,e)=>Qe(new JN(Qe(i),e));ve("element",jV);ve("convert",HV);ve("append",i=>(Ae("TSL: .append() has been renamed to .toStack()."),iP(i)));class dn extends ft{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}customCacheKey(){return p_(this.type+":"+(this.name||"")+":"+(this.varying?"1":"0"))}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const pl=(i,e)=>new dn(i,e),z0=(i,e)=>new dn(i,e,!0),_n=Oe(dn,"vec4","DiffuseColor"),Xc=Oe(dn,"vec3","DiffuseContribution"),mC=Oe(dn,"vec3","EmissiveColor"),ro=Oe(dn,"float","Roughness"),al=Oe(dn,"float","Metalness"),Jb=Oe(dn,"float","Clearcoat"),G0=Oe(dn,"float","ClearcoatRoughness"),hs=Oe(dn,"vec3","Sheen"),su=Oe(dn,"float","SheenRoughness"),LS=Oe(dn,"float","Iridescence"),ew=Oe(dn,"float","IridescenceIOR"),tw=Oe(dn,"float","IridescenceThickness"),nw=Oe(dn,"float","AlphaT"),nu=Oe(dn,"float","Anisotropy"),T0=Oe(dn,"vec3","AnisotropyT"),sh=Oe(dn,"vec3","AnisotropyB"),Ru=Oe(dn,"color","SpecularColor"),Kc=Oe(dn,"color","SpecularColorBlended"),Vf=Oe(dn,"float","SpecularF90"),iw=Oe(dn,"float","Shininess"),jf=Oe(dn,"vec4","Output"),Dx=Oe(dn,"float","dashSize"),_C=Oe(dn,"float","gapSize"),M0=Oe(dn,"float","IOR"),rw=Oe(dn,"float","Transmission"),uP=Oe(dn,"float","Thickness"),cP=Oe(dn,"float","AttenuationDistance"),hP=Oe(dn,"color","AttenuationColor"),dP=Oe(dn,"float","Dispersion");class fP extends ft{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const WV=i=>new fP(i),FS=(i,e=0)=>new fP(i,!0,e),$V=FS("frame"),wt=FS("render"),pP=WV("object");class Dp extends CS{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=pP}setName(e){return this.name=e,this}label(e){return Ae('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(n=>{const r=e(n,this);r!==void 0&&(this.value=r)},t)}getInputType(e){let t=super.getInputType(e);return t==="bool"&&(t="uint"),t}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const a=s.getInputType(e),o=e.getUniformFromNode(s,a,e.shaderStage,this.name||e.context.nodeName),l=e.getPropertyName(o);e.context.nodeName!==void 0&&delete e.context.nodeName;let c=l;if(n==="bool"){const d=e.getDataFromNode(this);let f=d.propertyName;if(f===void 0){const p=e.getVarFromNode(this,null,"bool");f=e.getPropertyName(p),d.propertyName=f,c=e.format(l,a,n),e.addLineFlowCode(`${f} = ${c}`,this)}c=f}return e.format(c,n,t)}}const Mt=(i,e)=>{const t=FV(e||i);if(t===i&&(i=ES(t)),i&&i.isNode===!0){let n=i.value;i.traverse(r=>{r.isConstNode===!0&&(n=r.value)}),i=n}return new Dp(i,t)};class yC extends oi{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return this.nodeType===null?this.values[0].getNodeType(e):this.nodeType}getElementType(e){return this.getNodeType(e)}getMemberType(e,t){return this.nodeType===null?this.values[0].getMemberType(e,t):super.getMemberType(e,t)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const qV=(...i)=>{let e;if(i.length===1){const t=i[0];e=new yC(null,t.length,t)}else{const t=i[0],n=i[1];e=new yC(t,n)}return Qe(e)};ve("toArray",(i,e)=>qV(Array(e).fill(i)));class XV extends oi{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return nd.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=t.getScope(),s=e.getDataFromNode(r);s.assign=!0;const a=e.getNodeProperties(this);a.sourceNode=n,a.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),s=this.needsSplitAssign(e),a=n.build(e),o=n.getNodeType(e),l=r.build(e,o),c=r.getNodeType(e),d=e.getDataFromNode(this);let f;if(d.initialized===!0)t!=="void"&&(f=a);else if(s){const p=e.getVarFromNode(this,null,o),m=e.getPropertyName(p);e.addLineFlowCode(`${m} = ${l}`,this);const _=n.node,v=_.node.context({assign:!0}).build(e);for(let y=0;y<_.components.length;y++){const S=_.components[y];e.addLineFlowCode(`${v}.${S} = ${m}[ ${y} ]`,this)}t!=="void"&&(f=a)}else f=`${a} = ${l}`,(t==="void"||c==="void")&&(e.addLineFlowCode(f,this),t!=="void"&&(f=a));return d.initialized=!0,e.format(f,o,t)}}const YV=on(XV).setParameterLength(2);ve("assign",YV);class KV extends oi{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),s=this.parameters,a=(l,c)=>{const d=c.type,f=d==="pointer";let p;return f?p="&"+l.build(e):p=l.build(e,d),p};if(Array.isArray(s)){if(s.length>r.length)Ee("TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(Ee("TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(_e(0));for(let l=0;l<s.length;l++)t.push(a(s[l],r[l]))}else for(const l of r){const c=s[l.name];c!==void 0?t.push(a(c,l)):(Ee(`TSL: Input '${l.name}' not found in 'Fn()'.`),t.push(a(_e(0),l)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const ZV=(i,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?rh(e):DS(e[0]),new KV(Qe(i),e));ve("call",ZV);const QV={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class qn extends oi{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let s=new qn(e,t,n);for(let a=0;a<r.length-1;a++)s=new qn(e,s,r[a]);t=s,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(QV[this.op],t)}getNodeType(e,t=null){const n=this.op,r=this.aNode,s=this.bNode,a=r.getNodeType(e),o=s?s.getNodeType(e):null;if(a==="void"||o==="void")return t||"void";if(n==="%")return a;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(a);if(n==="!"||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">="){const l=Math.max(e.getTypeLength(a),e.getTypeLength(o));return l>1?`bvec${l}`:"bool"}else{if(e.isMatrix(a)){if(o==="float")return a;if(e.isVector(o))return e.getVectorFromMatrix(a);if(e.isMatrix(o))return a}else if(e.isMatrix(o)){if(a==="float")return o;if(e.isVector(a))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(a)?o:a}}generate(e,t){const n=this.op,{aNode:r,bNode:s}=this,a=this.getNodeType(e,t);let o=null,l=null;a!=="void"?(o=r.getNodeType(e),l=s?s.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(o)?l=o:e.isVector(l)?o=l:o!==l&&(o=l="float"):n===">>"||n==="<<"?(o=a,l=e.changeComponentType(l,"uint")):n==="%"?(o=a,l=e.isInteger(o)&&e.isInteger(l)?l:o):e.isMatrix(o)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(o):e.isMatrix(l)||(o=l=a):e.isMatrix(l)?o==="float"?o="float":e.isVector(o)?o=e.getVectorFromMatrix(l):o=l=a:o=l=a):o=l=a;const c=r.build(e,o),d=s?s.build(e,l):null,f=e.getFunctionOperator(n);if(t!=="void"){const p=e.renderer.coordinateSystem===fr;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return p?e.isVector(o)?e.format(`${this.getOperatorMethod(e,t)}( ${c}, ${d} )`,a,t):e.format(`( ${c} ${n} ${d} )`,a,t):e.format(`( ${c} ${n} ${d} )`,a,t);if(n==="%")return e.isInteger(l)?e.format(`( ${c} % ${d} )`,a,t):e.format(`${this.getOperatorMethod(e,a)}( ${c}, ${d} )`,a,t);if(n==="!"||n==="~")return e.format(`(${n}${c})`,o,t);if(f)return e.format(`${f}( ${c}, ${d} )`,a,t);if(e.isMatrix(o)&&l==="float")return e.format(`( ${d} ${n} ${c} )`,a,t);if(o==="float"&&e.isMatrix(l))return e.format(`${c} ${n} ${d}`,a,t);{let m=`( ${c} ${n} ${d} )`;return!p&&a==="bool"&&e.isVector(o)&&e.isVector(l)&&(m=`all${m}`),e.format(m,a,t)}}else if(o!=="void")return f?e.format(`${f}( ${c}, ${d} )`,a,t):e.isMatrix(o)&&l==="float"?e.format(`${d} ${n} ${c}`,a,t):e.format(`${c} ${n} ${d}`,a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ir=tt(qn,"+").setParameterLength(2,1/0).setName("add"),Ar=tt(qn,"-").setParameterLength(2,1/0).setName("sub"),Bt=tt(qn,"*").setParameterLength(2,1/0).setName("mul"),Ta=tt(qn,"/").setParameterLength(2,1/0).setName("div"),US=tt(qn,"%").setParameterLength(2).setName("mod"),gP=tt(qn,"==").setParameterLength(2).setName("equal"),JV=tt(qn,"!=").setParameterLength(2).setName("notEqual"),ej=tt(qn,"<").setParameterLength(2).setName("lessThan"),tj=tt(qn,">").setParameterLength(2).setName("greaterThan"),nj=tt(qn,"<=").setParameterLength(2).setName("lessThanEqual"),ij=tt(qn,">=").setParameterLength(2).setName("greaterThanEqual"),rj=tt(qn,"&&").setParameterLength(2,1/0).setName("and"),sj=tt(qn,"||").setParameterLength(2,1/0).setName("or"),aj=tt(qn,"!").setParameterLength(1).setName("not"),oj=tt(qn,"^^").setParameterLength(2).setName("xor"),lj=tt(qn,"&").setParameterLength(2).setName("bitAnd"),uj=tt(qn,"~").setParameterLength(1).setName("bitNot"),cj=tt(qn,"|").setParameterLength(2).setName("bitOr"),hj=tt(qn,"^").setParameterLength(2).setName("bitXor"),dj=tt(qn,"<<").setParameterLength(2).setName("shiftLeft"),fj=tt(qn,">>").setParameterLength(2).setName("shiftRight"),pj=Se(([i])=>(i.addAssign(1),i)),gj=Se(([i])=>(i.subAssign(1),i)),mj=Se(([i])=>{const e=Dn(i).toConst();return i.addAssign(1),e}),_j=Se(([i])=>{const e=Dn(i).toConst();return i.subAssign(1),e});ve("add",Ir);ve("sub",Ar);ve("mul",Bt);ve("div",Ta);ve("mod",US);ve("equal",gP);ve("notEqual",JV);ve("lessThan",ej);ve("greaterThan",tj);ve("lessThanEqual",nj);ve("greaterThanEqual",ij);ve("and",rj);ve("or",sj);ve("not",aj);ve("xor",oj);ve("bitAnd",lj);ve("bitNot",uj);ve("bitOr",cj);ve("bitXor",hj);ve("shiftLeft",dj);ve("shiftRight",fj);ve("incrementBefore",pj);ve("decrementBefore",gj);ve("increment",mj);ve("decrement",_j);const yj=(i,e)=>(Ae('TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),US(Dn(i),Dn(e)));ve("modInt",yj);class oe extends oi{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===oe.MAX||e===oe.MIN)&&arguments.length>3){let s=new oe(e,t,n);for(let a=2;a<arguments.length-1;a++)s=new oe(e,s,arguments[a]);t=s,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(r)?0:e.getTypeLength(r);return s>a&&s>o?t:a>o?n:o>s?r:t}getNodeType(e){const t=this.method;return t===oe.LENGTH||t===oe.DISTANCE||t===oe.DOT?"float":t===oe.CROSS?"vec3":t===oe.ALL||t===oe.ANY?"bool":t===oe.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let s=null;if(r===oe.ONE_MINUS)s=Ar(1,t);else if(r===oe.RECIPROCAL)s=Ta(1,t);else if(r===oe.DIFFERENCE)s=Kr(Ar(t,n));else if(r===oe.TRANSFORM_DIRECTION){let a=t,o=n;e.isMatrix(a.getNodeType(e))?o=kt(ye(o),0):a=kt(ye(a),0);const l=Bt(a,o).xyz;s=qs(l)}return s!==null?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const s=this.getNodeType(e),a=this.getInputType(e),o=this.aNode,l=this.bNode,c=this.cNode,d=e.renderer.coordinateSystem;if(r===oe.NEGATE)return e.format("( - "+o.build(e,a)+" )",s,t);{const f=[];return r===oe.CROSS?f.push(o.build(e,s),l.build(e,s)):d===fr&&r===oe.STEP?f.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":a),l.build(e,a)):d===fr&&(r===oe.MIN||r===oe.MAX)?f.push(o.build(e,a),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":a)):r===oe.REFRACT?f.push(o.build(e,a),l.build(e,a),c.build(e,"float")):r===oe.MIX?f.push(o.build(e,a),l.build(e,a),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a)):(d===Sa&&r===oe.ATAN&&l!==null&&(r="atan2"),e.shaderStage!=="fragment"&&(r===oe.DFDX||r===oe.DFDY)&&(Ae(`TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),f.push(o.build(e,a)),l!==null&&f.push(l.build(e,a)),c!==null&&f.push(c.build(e,a))),e.format(`${e.getMethod(r,s)}( ${f.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}oe.ALL="all";oe.ANY="any";oe.RADIANS="radians";oe.DEGREES="degrees";oe.EXP="exp";oe.EXP2="exp2";oe.LOG="log";oe.LOG2="log2";oe.SQRT="sqrt";oe.INVERSE_SQRT="inversesqrt";oe.FLOOR="floor";oe.CEIL="ceil";oe.NORMALIZE="normalize";oe.FRACT="fract";oe.SIN="sin";oe.COS="cos";oe.TAN="tan";oe.ASIN="asin";oe.ACOS="acos";oe.ATAN="atan";oe.ABS="abs";oe.SIGN="sign";oe.LENGTH="length";oe.NEGATE="negate";oe.ONE_MINUS="oneMinus";oe.DFDX="dFdx";oe.DFDY="dFdy";oe.ROUND="round";oe.RECIPROCAL="reciprocal";oe.TRUNC="trunc";oe.FWIDTH="fwidth";oe.TRANSPOSE="transpose";oe.DETERMINANT="determinant";oe.INVERSE="inverse";oe.EQUALS="equals";oe.MIN="min";oe.MAX="max";oe.STEP="step";oe.REFLECT="reflect";oe.DISTANCE="distance";oe.DIFFERENCE="difference";oe.DOT="dot";oe.CROSS="cross";oe.POW="pow";oe.TRANSFORM_DIRECTION="transformDirection";oe.MIX="mix";oe.CLAMP="clamp";oe.REFRACT="refract";oe.SMOOTHSTEP="smoothstep";oe.FACEFORWARD="faceforward";const mP=_e(1e-6),vj=_e(Math.PI),xj=tt(oe,oe.ALL).setParameterLength(1),bj=tt(oe,oe.ANY).setParameterLength(1),wj=tt(oe,oe.RADIANS).setParameterLength(1),Sj=tt(oe,oe.DEGREES).setParameterLength(1),_P=tt(oe,oe.EXP).setParameterLength(1),pp=tt(oe,oe.EXP2).setParameterLength(1),yP=tt(oe,oe.LOG).setParameterLength(1),go=tt(oe,oe.LOG2).setParameterLength(1),uo=tt(oe,oe.SQRT).setParameterLength(1),Tj=tt(oe,oe.INVERSE_SQRT).setParameterLength(1),mu=tt(oe,oe.FLOOR).setParameterLength(1),OS=tt(oe,oe.CEIL).setParameterLength(1),qs=tt(oe,oe.NORMALIZE).setParameterLength(1),Ma=tt(oe,oe.FRACT).setParameterLength(1),Yr=tt(oe,oe.SIN).setParameterLength(1),ga=tt(oe,oe.COS).setParameterLength(1),Mj=tt(oe,oe.TAN).setParameterLength(1),Aj=tt(oe,oe.ASIN).setParameterLength(1),vP=tt(oe,oe.ACOS).setParameterLength(1),xP=tt(oe,oe.ATAN).setParameterLength(1,2),Kr=tt(oe,oe.ABS).setParameterLength(1),bP=tt(oe,oe.SIGN).setParameterLength(1),mo=tt(oe,oe.LENGTH).setParameterLength(1),wP=tt(oe,oe.NEGATE).setParameterLength(1),Ej=tt(oe,oe.ONE_MINUS).setParameterLength(1),SP=tt(oe,oe.DFDX).setParameterLength(1),TP=tt(oe,oe.DFDY).setParameterLength(1),Cj=tt(oe,oe.ROUND).setParameterLength(1),Rj=tt(oe,oe.RECIPROCAL).setParameterLength(1),Nj=tt(oe,oe.TRUNC).setParameterLength(1),MP=tt(oe,oe.FWIDTH).setParameterLength(1),Pj=tt(oe,oe.TRANSPOSE).setParameterLength(1),Dj=tt(oe,oe.DETERMINANT).setParameterLength(1),kj=tt(oe,oe.INVERSE).setParameterLength(1),Ij=(i,e)=>(Ae('TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),gP(i,e)),Gh=tt(oe,oe.MIN).setParameterLength(2,1/0),Ii=tt(oe,oe.MAX).setParameterLength(2,1/0),AP=tt(oe,oe.STEP).setParameterLength(2),Lj=tt(oe,oe.REFLECT).setParameterLength(2),Fj=tt(oe,oe.DISTANCE).setParameterLength(2),Uj=tt(oe,oe.DIFFERENCE).setParameterLength(2),Nu=tt(oe,oe.DOT).setParameterLength(2),Pu=tt(oe,oe.CROSS).setParameterLength(2),__=tt(oe,oe.POW).setParameterLength(2),EP=i=>Bt(i,i),Oj=i=>Bt(i,i,i),CP=i=>Bt(i,i,i,i),Bj=tt(oe,oe.TRANSFORM_DIRECTION).setParameterLength(2),zj=i=>Bt(bP(i),__(Kr(i),1/3)),RP=i=>Nu(i,i),wn=tt(oe,oe.MIX).setParameterLength(3),_l=(i,e=0,t=1)=>Qe(new oe(oe.CLAMP,Qe(i),Qe(e),Qe(t))),BS=i=>_l(i),NP=tt(oe,oe.REFRACT).setParameterLength(3),_o=tt(oe,oe.SMOOTHSTEP).setParameterLength(3),Gj=tt(oe,oe.FACEFORWARD).setParameterLength(3),Vj=Se(([i])=>{const n=43758.5453,r=Nu(i.xy,st(12.9898,78.233)),s=US(r,vj);return Ma(Yr(s).mul(n))}),jj=(i,e,t)=>wn(e,t,i),Hj=(i,e,t)=>_o(e,t,i),Wj=(i,e)=>AP(e,i),$j=(i,e)=>(Ae('TSL: "atan2" is overloaded. Use "atan" instead.'),xP(i,e));ve("all",xj);ve("any",bj);ve("equals",Ij);ve("radians",wj);ve("degrees",Sj);ve("exp",_P);ve("exp2",pp);ve("log",yP);ve("log2",go);ve("sqrt",uo);ve("inverseSqrt",Tj);ve("floor",mu);ve("ceil",OS);ve("normalize",qs);ve("fract",Ma);ve("sin",Yr);ve("cos",ga);ve("tan",Mj);ve("asin",Aj);ve("acos",vP);ve("atan",xP);ve("abs",Kr);ve("sign",bP);ve("length",mo);ve("lengthSq",RP);ve("negate",wP);ve("oneMinus",Ej);ve("dFdx",SP);ve("dFdy",TP);ve("round",Cj);ve("reciprocal",Rj);ve("trunc",Nj);ve("fwidth",MP);ve("atan2",$j);ve("min",Gh);ve("max",Ii);ve("step",Wj);ve("reflect",Lj);ve("distance",Fj);ve("dot",Nu);ve("cross",Pu);ve("pow",__);ve("pow2",EP);ve("pow3",Oj);ve("pow4",CP);ve("transformDirection",Bj);ve("mix",jj);ve("clamp",_l);ve("refract",NP);ve("smoothstep",Hj);ve("faceForward",Gj);ve("difference",Uj);ve("saturate",BS);ve("cbrt",zj);ve("transpose",Pj);ve("determinant",Dj);ve("inverse",kj);ve("rand",Vj);class qj extends ft{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const r=t.getNodeType(e);if(n!==null){const s=n.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(r))return s}return r}setup(e){const t=this.condNode,n=this.ifNode.isolate(),r=this.elseNode?this.elseNode.isolate():null,s=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const a=e.context.uniformFlow,o=e.getNodeProperties(this);o.condNode=t,o.ifNode=a?n:n.context({nodeBlock:n}),o.elseNode=r?a?r:r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:a,elseNode:o}=e.getNodeProperties(this),l=e.currentFunctionNode,c=t!=="void",d=c?pl(n).build(e):"";r.nodeProperty=d;const f=s.build(e,"bool");if(e.context.uniformFlow&&o!==null){const _=a.build(e,n),b=o.build(e,n),v=e.getTernary(f,_,b);return e.format(v,n,t)}e.addFlowCode(`
${e.tab}if ( ${f} ) {

`).addFlowTab();let m=a.build(e,n);if(m&&(c?m=d+" = "+m+";":(m="return "+m+";",l===null&&(Ae("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),m="// "+m))),e.removeFlowTab().addFlowCode(e.tab+"	"+m+`

`+e.tab+"}"),o!==null){e.addFlowCode(` else {

`).addFlowTab();let _=o.build(e,n);_&&(c?_=d+" = "+_+";":(_="return "+_+";",l===null&&(Ae("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),_="// "+_))),e.removeFlowTab().addFlowCode(e.tab+"	"+_+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(d,n,t)}}const Pr=on(qj).setParameterLength(2,3);ve("select",Pr);class PP extends ft{static get type(){return"ContextNode"}constructor(e=null,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getFlowContextData(){const e=[];return this.traverse(t=>{t.isContextNode===!0&&e.push(t.value)}),Object.assign({},...e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}setup(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}generate(e,t){const n=e.addContext(this.value),r=this.node.build(e,t);return e.setContext(n),r}}const Uu=(i=null,e={})=>{let t=i;return(t===null||t.isNode!==!0)&&(e=t||e,t=null),new PP(t,e)},Xj=i=>Uu(i,{uniformFlow:!0}),DP=(i,e)=>Uu(i,{nodeName:e});function Yj(i,e,t=null){return Uu(t,{getShadow:({light:n,shadowColorNode:r})=>e===n?r.mul(i):r})}function Kj(i,e=null){return Uu(e,{getAO:(t,{material:n})=>n.transparent===!0?t:t!==null?t.mul(i):i})}function Zj(i,e){return Ae('TSL: "label()" has been deprecated. Use "setName()" instead.'),DP(i,e)}ve("context",Uu);ve("label",Zj);ve("uniformFlow",Xj);ve("setName",DP);ve("builtinShadowContext",(i,e,t)=>Yj(e,t,i));ve("builtinAOContext",(i,e)=>Kj(e,i));class A0 extends ft{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}isIntent(e){return e.getDataFromNode(this).forceDeclaration===!0?!1:this.intent}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}isAssign(e){return e.getDataFromNode(this).assign}build(...e){const t=e[0];if(this._hasStack(t)===!1&&t.buildStage==="setup"&&(t.context.nodeLoop||t.context.nodeBlock)){let n=!1;if(this.node.isShaderCallNodeInternal&&this.node.shaderNode.getLayout()===null&&t.fnCall&&t.fnCall.shaderNode&&t.getDataFromNode(this.node.shaderNode).hasLoop){const a=t.getDataFromNode(this);a.forceDeclaration=!0,n=!0}const r=t.getBaseStack();n?r.addToStackBefore(this):r.addToStack(this)}return this.isIntent(t)&&this.isAssign(t)!==!0?this.node.build(...e):super.build(...e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:s}=e,a=s.backend.isWebGPUBackend===!0;let o=!1,l=!1;r&&(o=e.isDeterministic(t),l=a?r:o);const c=this.getNodeType(e);if(c=="void")return this.isIntent(e)!==!0&&Ee('TSL: ".toVar()" can not be used with void type.'),t.build(e);const d=e.getVectorType(c),f=t.build(e,d),p=e.getVarFromNode(this,n,d,void 0,l),m=e.getPropertyName(p);let _=m;if(l)if(a)_=o?`const ${m}`:`let ${m}`;else{const b=t.getArrayCount(e);_=`const ${e.getVar(p.type,m,b)}`}return e.addLineFlowCode(`${_} = ${f}`,this),m}_hasStack(e){return e.getDataFromNode(this).stack!==void 0}}const zS=on(A0),Qj=(i,e=null)=>zS(i,e).toStack(),Jj=(i,e=null)=>zS(i,e,!0).toStack(),e9=i=>zS(i).setIntent(!0).toStack();ve("toVar",Qj);ve("toConst",Jj);ve("toVarIntent",e9);class t9 extends ft{static get type(){return"SubBuild"}constructor(e,t,n=null){super(n),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const n=this.node.build(e,...t);return e.removeSubBuild(),n}}const Hf=(i,e,t=null)=>Qe(new t9(Qe(i),e,t));class n9 extends ft{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const r=this.name,s=this.getNodeType(e),a=this.interpolationType,o=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,s,a,o),t.node=Hf(this.node,"VERTEX")}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(Hm.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(Hm.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),n=e.getNodeProperties(this),r=this.setupVarying(e);if(n[t]===void 0){const s=this.getNodeType(e),a=e.getPropertyName(r,Hm.VERTEX);e.flowNodeFromShaderStage(Hm.VERTEX,n.node,s,a),n[t]=a}return e.getPropertyName(r)}}const vo=on(n9).setParameterLength(1,2),i9=i=>vo(i);ve("toVarying",vo);ve("toVertexStage",i9);ve("varying",(...i)=>(Ae("TSL: .varying() has been renamed to .toVarying()."),vo(...i)));ve("vertexStage",(...i)=>(Ae("TSL: .vertexStage() has been renamed to .toVertexStage()."),vo(...i)));const r9=Se(([i])=>{const e=i.mul(.9478672986).add(.0521327014).pow(2.4),t=i.mul(.0773993808),n=i.lessThanEqual(.04045);return wn(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),s9=Se(([i])=>{const e=i.pow(.41666).mul(1.055).sub(.055),t=i.mul(12.92),n=i.lessThanEqual(.0031308);return wn(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),GS="WorkingColorSpace",a9="OutputColorSpace";class kP extends oi{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===GS?bt.workingColorSpace:t===a9?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return bt.enabled===!1||n===r||!n||!r||(bt.getTransfer(n)===Ze&&(s=kt(r9(s.rgb),s.a)),bt.getPrimaries(n)!==bt.getPrimaries(r)&&(s=kt(Ji(bt._getMatrix(new Ft,n,r)).mul(s.rgb),s.a)),bt.getTransfer(r)===Ze&&(s=kt(s9(s.rgb),s.a))),s}}const o9=(i,e)=>Qe(new kP(Qe(i),GS,e)),VS=(i,e)=>Qe(new kP(Qe(i),e,GS));ve("workingToColorSpace",o9);ve("colorSpaceToWorking",VS);let l9=class extends id{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class IP extends ft{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=Ut.OBJECT}setGroup(e){return this.group=e,this}element(e){return new l9(this,Qe(e))}setNodeType(e){const t=Mt(null,e);this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const u9=(i,e,t)=>new IP(i,e,t);class c9 extends IP{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(wt)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const h9=(i,e,t=null)=>new c9(i,e,t);class d9 extends oi{static get type(){return"ToneMappingNode"}constructor(e,t=p9,n=null){super("vec3"),this._toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return zf(this._toneMapping)}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup(e){const t=this.colorNode||e.context.color,n=this._toneMapping;if(n===Di)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(n);return s!==null?r=kt(s(t.rgb,this.exposureNode),t.a):(Ee("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const f9=(i,e,t)=>Qe(new d9(i,Qe(e),Qe(t))),p9=h9("toneMappingExposure","float");ve("toneMapping",(i,e,t)=>f9(e,t,i));const vC=new WeakMap;function xC(i,e){let t=vC.get(i);return t===void 0&&(t=new GR(i,e),vC.set(i,t)),t}class Qo extends CS{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Uh,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&e.itemSize<=4&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=e.getTypeLength(t),r=this.value,s=this.bufferStride||n,a=this.bufferOffset;let o;r.isInterleavedBuffer===!0?o=r:r.isBufferAttribute===!0?o=xC(r.array,s):o=xC(r,s);const l=new lS(o,n,a);o.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=vo(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}function jS(i,e=null,t=0,n=0,r=Uh,s=!1){return e==="mat3"||e===null&&i.itemSize===9?Ji(new Qo(i,"vec3",9,0).setUsage(r).setInstanced(s),new Qo(i,"vec3",9,3).setUsage(r).setInstanced(s),new Qo(i,"vec3",9,6).setUsage(r).setInstanced(s)):e==="mat4"||e===null&&i.itemSize===16?gu(new Qo(i,"vec4",16,0).setUsage(r).setInstanced(s),new Qo(i,"vec4",16,4).setUsage(r).setInstanced(s),new Qo(i,"vec4",16,8).setUsage(r).setInstanced(s),new Qo(i,"vec4",16,12).setUsage(r).setInstanced(s)):new Qo(i,e,t,n)}const LP=(i,e=null,t=0,n=0)=>jS(i,e,t,n),bC=(i,e=null,t=0,n=0)=>jS(i,e,t,n,Uh,!0),wC=(i,e=null,t=0,n=0)=>jS(i,e,t,n,Yc,!0);ve("toAttribute",i=>LP(i.value));class g9 extends ft{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=Ut.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return Ae('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const FP=(i,e=[64])=>{(e.length===0||e.length>3)&&Ee("TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let t=0;t<e.length;t++){const n=e[t];(typeof n!="number"||n<=0||!Number.isInteger(n))&&Ee(`TSL: compute() workgroupSize element at index [ ${t} ] must be a positive integer`)}for(;e.length<3;)e.push(1);return Qe(new g9(Qe(i),e))},m9=(i,e,t)=>FP(i,t).setCount(e);ve("compute",m9);ve("computeKernel",FP);class _9 extends ft{static get type(){return"IsolateNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isIsolateNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(n),s}setParent(e){return this.parent=e,this}getParent(){return this.parent}}const Wf=i=>new _9(Qe(i));function y9(i,e=!0){return Ae('TSL: "cache()" has been deprecated. Use "isolate()" instead.'),Wf(i).setParent(e)}ve("cache",y9);ve("isolate",Wf);class v9 extends ft{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const x9=on(v9).setParameterLength(2);ve("bypass",x9);class UP extends ft{static get type(){return"RemapNode"}constructor(e,t,n,r=_e(0),s=_e(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:s,doClamp:a}=this;let o=e.sub(t).div(n.sub(t));return a===!0&&(o=o.clamp()),o.mul(s.sub(r)).add(r)}}const b9=on(UP,null,null,{doClamp:!1}).setParameterLength(3,5),w9=on(UP).setParameterLength(3,5);ve("remap",b9);ve("remapClamp",w9);class E0 extends ft{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if(n==="void")e.addLineFlowCode(r,this);else return e.format(r,n,t)}}const Vh=on(E0).setParameterLength(1,2),S9=i=>(i?Pr(i,Vh("discard")):Vh("discard")).toStack();ve("discard",S9);class T9 extends oi{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this._toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup({context:e}){let t=this.colorNode||e.color;const n=(this._toneMapping!==null?this._toneMapping:e.toneMapping)||Di,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Er;return n!==Di&&(t=t.toneMapping(n)),r!==Er&&r!==bt.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const M9=(i,e=null,t=null)=>Qe(new T9(Qe(i),e,t));ve("renderOutput",M9);class A9 extends oi{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let a="";return a+="// #"+r+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+n+` /* ... */
`,a+="// #"+s+`#
`,t!==null?t(e,a):hp(a),n}}const E9=(i,e=null)=>Qe(new A9(Qe(i),e)).toStack();ve("debug",E9);class OP{constructor(){this._renderer=null,this.currentFrame=null}get nodeFrame(){return this._renderer._nodes.nodeFrame}setRenderer(e){return this._renderer=e,this}getRenderer(){return this._renderer}init(){}begin(){}finish(){}inspect(){}computeAsync(){}beginCompute(){}finishCompute(){}beginRender(){}finishRender(){}copyTextureToTexture(){}copyFramebufferToTexture(){}}class C9 extends ft{static get type(){return"InspectorNode"}constructor(e,t="",n=null){super(),this.node=e,this.name=t,this.callback=n,this.updateType=Ut.FRAME,this.isInspectorNode=!0}getName(){return this.name||this.node.name}update(e){e.renderer.inspector.inspect(this)}getNodeType(e){return this.node.getNodeType(e)}setup(e){let t=this.node;return e.context.inspector===!0&&this.callback!==null&&(t=this.callback(t)),e.renderer.backend.isWebGPUBackend!==!0&&e.renderer.inspector.constructor!==OP&&Fn('TSL: ".toInspector()" is only available with WebGPU.'),t}}function R9(i,e="",t=null){return i=Qe(i),i.before(new C9(i,e,t))}ve("toInspector",R9);class BP extends ft{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),a=e.getTypeFromAttribute(s),o=e.getAttribute(t,a);return e.shaderStage==="vertex"?e.format(o.name,a,n):vo(this).build(e,n)}else return Ae(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const yl=(i,e=null)=>new BP(i,e),rd=(i=0)=>yl("uv"+(i>0?i:""),"vec2");class N9 extends ft{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const _u=on(N9).setParameterLength(1,2);class P9 extends Dp{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Ut.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:r,height:s}=n;this.value=Math.log2(Math.max(r,s))}}}const D9=on(P9).setParameterLength(1),zP=new er;class sd extends Dp{static get type(){return"TextureNode"}constructor(e=zP,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Ut.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this._flipYUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===yn?"uvec4":this.value.type===Ti?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return rd(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Mt(this.value.matrix)),this._matrixUniform.mul(ye(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this}setupUV(e,t){return e.isFlipY()&&(this._flipYUniform===null&&(this._flipYUniform=Mt(!1)),t=t.toVar(),this.sampler?t=this._flipYUniform.select(t.flipY(),t):t=this._flipYUniform.select(t.setY(Dn(_u(this,this.levelNode).y).sub(t.y).sub(1)),t)),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");const r=Se(()=>{let a=this.uvNode;return(a===null||e.context.forceUVContext===!0)&&e.context.getUV&&(a=e.context.getUV(this,e)),a||(a=this.getDefaultUV()),this.updateMatrix===!0&&(a=this.getTransformedUV(a)),a=this.setupUV(e,a),this.updateType=this._matrixUniform!==null||this._flipYUniform!==null?Ut.OBJECT:Ut.NONE,a})();let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,n,r,s,a,o,l,c){const d=this.value;let f;return s?f=e.generateTextureBias(d,t,n,s,a,c):l?f=e.generateTextureGrad(d,t,n,l,a,c):o?f=e.generateTextureCompare(d,t,n,o,a,c):this.sampler===!1?f=e.generateTextureLoad(d,t,n,r,a,c):r?f=e.generateTextureLevel(d,t,n,r,a,c):f=e.generateTexture(d,t,n,a,c),f}generate(e,t){const n=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const a=e.getDataFromNode(this);let o=a.propertyName;if(o===void 0){const{uvNode:d,levelNode:f,biasNode:p,compareNode:m,depthNode:_,gradNode:b,offsetNode:v}=r,y=this.generateUV(e,d),S=f?f.build(e,"float"):null,T=p?p.build(e,"float"):null,E=_?_.build(e,"int"):null,N=m?m.build(e,"float"):null,M=b?[b[0].build(e,"vec2"),b[1].build(e,"vec2")]:null,C=v?this.generateOffset(e,v):null,D=e.getVarFromNode(this);o=e.getPropertyName(D);const R=this.generateSnippet(e,s,y,S,T,E,N,M,C);e.addLineFlowCode(`${o} = ${R}`,this),a.snippet=R,a.propertyName=o}let l=o;const c=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(l=VS(Vh(l,c),n.colorSpace).setup(e).build(e,c)),e.format(l,c,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return Ae("TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=Qe(e).mul(D9(t)),t.referenceNode=this.getBase();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===vn||n.magFilter===vn)&&(Ae("TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Qe(t)}level(e){const t=this.clone();return t.levelNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}size(e){return _u(this,e)}bias(e){const t=this.clone();return t.biasNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}grad(e,t){const n=this.clone();return n.gradNode=[Qe(e),Qe(t)],n.referenceNode=this.getBase(),Qe(n)}depth(e){const t=this.clone();return t.depthNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}offset(e){const t=this.clone();return t.offsetNode=Qe(e),t.referenceNode=this.getBase(),Qe(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix();const n=this._flipYUniform;n!==null&&(n.value=e.image instanceof ImageBitmap&&e.flipY===!0||e.isRenderTargetTexture===!0||e.isFramebufferTexture===!0||e.isDepthTexture===!0)}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const k9=on(sd).setParameterLength(1,4).setName("texture"),kn=(i=zP,e=null,t=null,n=null)=>{let r;return i&&i.isTextureNode===!0?(r=Qe(i.clone()),r.referenceNode=i.getBase(),e!==null&&(r.uvNode=Qe(e)),t!==null&&(r.levelNode=Qe(t)),n!==null&&(r.biasNode=Qe(n))):r=k9(i,e,t,n),r},ds=(...i)=>kn(...i).setSampler(!1);class HS extends Dp{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n,this.updateRanges=[]}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const GP=(i,e,t)=>new HS(i,e,t);class I9 extends id{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class L9 extends HS{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?O0(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=Ut.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let r=0;r<e.length;r++){const s=r*4;t[s]=e[r]}else if(n==="color")for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.r,t[s+1]=a.g,t[s+2]=a.b||0}else if(n==="mat2")for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+3]=a.elements[3]}else if(n==="mat3")for(let r=0;r<e.length;r++){const s=r*16,a=e[r];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+4]=a.elements[3],t[s+5]=a.elements[4],t[s+6]=a.elements[5],t[s+8]=a.elements[6],t[s+9]=a.elements[7],t[s+10]=a.elements[8],t[s+15]=1}else if(n==="mat4")for(let r=0;r<e.length;r++){const s=r*16,a=e[r];for(let o=0;o<a.elements.length;o++)t[s+o]=a.elements[o]}else for(let r=0;r<e.length;r++){const s=r*4,a=e[r];t[s]=a.x,t[s+1]=a.y,t[s+2]=a.z||0,t[s+3]=a.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const s=this.paddedType,a=e.getTypeLength(s);return n.charAt(0)==="i"&&(r=Int32Array),n.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*a),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return new I9(this,Qe(e))}}const Vs=(i,e)=>new L9(i,e);class F9 extends ft{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const kp=on(F9).setParameterLength(1);let df,ff;class Rn extends ft{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===Rn.DPR?"float":this.scope===Rn.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Ut.NONE;return(this.scope===Rn.SIZE||this.scope===Rn.VIEWPORT||this.scope===Rn.DPR)&&(e=Ut.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===Rn.VIEWPORT?t!==null?ff.copy(t.viewport):(e.getViewport(ff),ff.multiplyScalar(e.getPixelRatio())):this.scope===Rn.DPR?this._output.value=e.getPixelRatio():t!==null?(df.width=t.width,df.height=t.height):e.getDrawingBufferSize(df)}setup(){const e=this.scope;let t=null;return e===Rn.SIZE?t=Mt(df||(df=new Xe)):e===Rn.VIEWPORT?t=Mt(ff||(ff=new It)):e===Rn.DPR?t=Mt(1):t=st(ad.div(sw)),this._output=t,t}generate(e){if(this.scope===Rn.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(sw).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}Rn.COORDINATE="coordinate";Rn.VIEWPORT="viewport";Rn.SIZE="size";Rn.UV="uv";Rn.DPR="dpr";const U9=Oe(Rn,Rn.DPR),ah=Oe(Rn,Rn.UV),sw=Oe(Rn,Rn.SIZE),ad=Oe(Rn,Rn.COORDINATE),VP=Oe(Rn,Rn.VIEWPORT),O9=VP.zw;VP.xy;const WS=Mt(0,"uint").setName("u_cameraIndex").setGroup(FS("cameraIndex")).toVarying("v_cameraIndex"),au=Mt("float").setName("cameraNear").setGroup(wt).onRenderUpdate(({camera:i})=>i.near),ou=Mt("float").setName("cameraFar").setGroup(wt).onRenderUpdate(({camera:i})=>i.far),$f=Se(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const r of i.cameras)t.push(r.projectionMatrix);e=Vs(t).setGroup(wt).setName("cameraProjectionMatrices").element(i.isMultiViewCamera?kp("gl_ViewID_OVR"):WS).toConst("cameraProjectionMatrix")}else e=Mt("mat4").setName("cameraProjectionMatrix").setGroup(wt).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),xo=Se(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(const r of i.cameras)t.push(r.matrixWorldInverse);e=Vs(t).setGroup(wt).setName("cameraViewMatrices").element(i.isMultiViewCamera?kp("gl_ViewID_OVR"):WS).toConst("cameraViewMatrix")}else e=Mt("mat4").setName("cameraViewMatrix").setGroup(wt).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),B9=Se(({camera:i})=>{let e;if(i.isArrayCamera&&i.cameras.length>0){const t=[];for(let r=0,s=i.cameras.length;r<s;r++)t.push(new X);e=Vs(t).setGroup(wt).setName("cameraPositions").onRenderUpdate(({camera:r},s)=>{const a=r.cameras,o=s.array;for(let l=0,c=a.length;l<c;l++)o[l].setFromMatrixPosition(a[l].matrixWorld)}).element(i.isMultiViewCamera?kp("gl_ViewID_OVR"):WS).toConst("cameraPosition")}else e=Mt(new X).setName("cameraPosition").setGroup(wt).onRenderUpdate(({camera:t},n)=>n.value.setFromMatrixPosition(t.matrixWorld));return e}).once()(),SC=new t_;class Mn extends ft{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Ut.OBJECT,this.uniformNode=new Dp(null)}getNodeType(){const e=this.scope;if(e===Mn.WORLD_MATRIX)return"mat4";if(e===Mn.POSITION||e===Mn.VIEW_POSITION||e===Mn.DIRECTION||e===Mn.SCALE)return"vec3";if(e===Mn.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,r=this.scope;if(r===Mn.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===Mn.POSITION)n.value=n.value||new X,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===Mn.SCALE)n.value=n.value||new X,n.value.setFromMatrixScale(t.matrixWorld);else if(r===Mn.DIRECTION)n.value=n.value||new X,t.getWorldDirection(n.value);else if(r===Mn.VIEW_POSITION){const s=e.camera;n.value=n.value||new X,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(s.matrixWorldInverse)}else if(r===Mn.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),SC.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),n.value=SC.radius}}generate(e){const t=this.scope;return t===Mn.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===Mn.POSITION||t===Mn.VIEW_POSITION||t===Mn.DIRECTION||t===Mn.SCALE?this.uniformNode.nodeType="vec3":t===Mn.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Mn.WORLD_MATRIX="worldMatrix";Mn.POSITION="position";Mn.SCALE="scale";Mn.VIEW_POSITION="viewPosition";Mn.DIRECTION="direction";Mn.RADIUS="radius";const z9=on(Mn,Mn.POSITION).setParameterLength(1);class xs extends Mn{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}xs.DIRECTION;const Du=Oe(xs,xs.WORLD_MATRIX);xs.POSITION;xs.SCALE;xs.VIEW_POSITION;xs.RADIUS;const G9=Mt(new Ft).onObjectUpdate(({object:i},e)=>e.value.getNormalMatrix(i.matrixWorld)),Ip=Se(i=>i.context.modelViewMatrix||V9).once()().toVar("modelViewMatrix"),V9=xo.mul(Du),TC=Se(i=>(i.context.isHighPrecisionModelViewMatrix=!0,Mt("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),MC=Se(i=>{const e=i.context.isHighPrecisionModelViewMatrix;return Mt("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),y_=yl("position","vec3"),Ai=y_.toVarying("positionLocal"),AC=y_.toVarying("positionPrevious"),jh=Se(i=>Du.mul(Ai).xyz.toVarying(i.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),jP=Se(()=>Ai.transformDirection(Du).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),ti=Se(i=>i.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),Nn=Se(i=>{let e;return i.camera.isOrthographicCamera?e=ye(0,0,1):e=ti.negate().toVarying("v_positionViewDirection").normalize(),e.toVar("positionViewDirection")},"vec3").once(["POSITION"])();class j9 extends ft{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{material:t}=e;return t.side===En?"false":e.getFrontFacing()}}const H9=Oe(j9),HP=_e(H9).mul(2).sub(1),Lp=Se(([i],{material:e})=>{const t=e.side;return t===En?i=i.mul(-1):t===Xi&&(i=i.mul(HP)),i}),WP=yl("normal","vec3"),Aa=Se(i=>i.geometry.hasAttribute("normal")===!1?(Ae('TSL: Vertex attribute "normal" not found on geometry.'),ye(0,1,0)):WP,"vec3").once()().toVar("normalLocal"),W9=ti.dFdx().cross(ti.dFdy()).normalize().toVar("normalFlat"),gp=Se(i=>{let e;return i.material.flatShading===!0?e=W9:e=$P(Aa).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),$9=Se(i=>{let e=gp.transformDirection(xo);return i.material.flatShading!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Qt=Se(({subBuildFn:i,material:e,context:t})=>{let n;return i==="NORMAL"||i==="VERTEX"?(n=gp,e.flatShading!==!0&&(n=Lp(n))):n=t.setupNormal().context({getUV:null}),n},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),od=Qt.transformDirection(xo).toVar("normalWorld"),Zc=Se(({subBuildFn:i,context:e})=>{let t;return i==="NORMAL"||i==="VERTEX"?t=Qt:t=e.setupClearcoatNormal().context({getUV:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),q9=Se(([i,e=Du])=>{const t=Ji(e),n=i.div(ye(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),$P=Se(([i],e)=>{const t=e.context.modelNormalViewMatrix;if(t)return t.transformDirection(i);const n=G9.mul(i);return xo.transformDirection(n)});Se(()=>(Ae('TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),Qt)).once(["NORMAL","VERTEX"])();Se(()=>(Ae('TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),od)).once(["NORMAL","VERTEX"])();Se(()=>(Ae('TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),Zc)).once(["NORMAL","VERTEX"])();const EC=new ys,kx=new hn,X9=Mt(0).onReference(({material:i})=>i).onObjectUpdate(({material:i})=>i.refractionRatio),Ix=Mt(1).onReference(({material:i})=>i).onObjectUpdate(function({material:i,scene:e}){return i.envMap?i.envMapIntensity:e.environmentIntensity}),qP=Mt(new hn).onReference(function(i){return i.material}).onObjectUpdate(function({material:i,scene:e}){const t=e.environment!==null&&i.envMap===null?e.environmentRotation:i.envMapRotation;return t?(EC.copy(t),kx.makeRotationFromEuler(EC)):kx.identity(),kx}),Y9=Nn.negate().reflect(Qt),K9=Nn.negate().refract(Qt,X9),Z9=Y9.transformDirection(xo).toVar("reflectVector"),Q9=K9.transformDirection(xo).toVar("reflectVector"),J9=new Ap;class e7 extends sd{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return this.value.isDepthTexture===!0?"cubeDepthTexture":"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===Xs?Z9:e.mapping===wa?Q9:(Ee('CubeTextureNode: Mapping "%s" not supported.',e.mapping),ye(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return n.isDepthTexture===!0?e.renderer.coordinateSystem===Sa?ye(t.x,t.y.negate(),t.z):t:((e.renderer.coordinateSystem===Sa||!n.isRenderTargetTexture)&&(t=ye(t.x.negate(),t.yz)),qP.mul(t))}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}}const t7=on(e7).setParameterLength(1,4).setName("cubeTexture"),Cr=(i=J9,e=null,t=null,n=null)=>{let r;return i&&i.isCubeTextureNode===!0?(r=Qe(i.clone()),r.referenceNode=i,e!==null&&(r.uvNode=Qe(e)),t!==null&&(r.levelNode=Qe(t)),n!==null&&(r.biasNode=Qe(n))):r=t7(i,e,t,n),r};class n7 extends id{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class $S extends ft{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=Ut.OBJECT}element(e){return new n7(this,Qe(e))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return Ae('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;this.count!==null?t=GP(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Vs(null,e):e==="texture"?t=kn(null):e==="cubeTexture"?t=Cr(null):t=Mt(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.setName(this.name),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const bn=(i,e,t)=>new $S(i,e,t),CC=(i,e,t,n)=>new $S(i,e,n,t);class i7 extends $S{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const il=(i,e,t=null)=>new i7(i,e,t),XP=rd(),r7=ti.dFdx(),s7=ti.dFdy(),YP=XP.dFdx(),KP=XP.dFdy(),ZP=Qt,QP=s7.cross(ZP),JP=ZP.cross(r7),aw=QP.mul(YP.x).add(JP.mul(KP.x)),ow=QP.mul(YP.y).add(JP.mul(KP.y)),RC=aw.dot(aw).max(ow.dot(ow)),e3=RC.equal(0).select(0,RC.inverseSqrt()),a7=aw.mul(e3).toVar("tangentViewFrame"),o7=ow.mul(e3).toVar("bitangentViewFrame"),t3=yl("tangent","vec4"),qS=t3.xyz.toVar("tangentLocal"),n3=Se(({subBuildFn:i,geometry:e,material:t})=>{let n;return i==="VERTEX"||e.hasAttribute("tangent")?n=Ip.mul(kt(qS,0)).xyz.toVarying("v_tangentView").normalize():n=a7,t.flatShading!==!0&&(n=Lp(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),l7=Se(([i,e],{subBuildFn:t,material:n})=>{let r=i.mul(t3.w).xyz;return t==="NORMAL"&&n.flatShading!==!0&&(r=r.toVarying(e)),r}).once(["NORMAL"]),u7=Se(({subBuildFn:i,geometry:e,material:t})=>{let n;return i==="VERTEX"||e.hasAttribute("tangent")?n=l7(Qt.cross(n3),"v_bitangentView").normalize():n=o7,t.flatShading!==!0&&(n=Lp(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),Pf=Ji(n3,u7,Qt).toVar("TBNViewMatrix"),c7=Se(()=>{let i=sh.cross(Nn);return i=i.cross(sh).normalize(),i=wn(i,Qt,nu.mul(ro.oneMinus()).oneMinus().pow2().pow2()).normalize(),i}).once()(),h7=i=>Qe(i).mul(.5).add(.5),NC=i=>ye(i,uo(BS(_e(1).sub(Nu(i,i)))));class d7 extends oi{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=ba,this.unpackNormalMode=pv}setup({material:e}){const{normalMapType:t,scaleNode:n,unpackNormalMode:r}=this;let s=this.node.mul(2).sub(1);if(t===ba?r===RR?s=NC(s.xy):r===cL?s=NC(s.yw):r!==pv&&console.error(`THREE.NodeMaterial: Unexpected unpack normal mode: ${r}`):r!==pv&&console.error(`THREE.NodeMaterial: Normal map type '${t}' is not compatible with unpack normal mode '${r}'`),n!==null){let o=n;e.flatShading===!0&&(o=Lp(o)),s=ye(s.xy.mul(o),s.z)}let a=null;return t===CR?a=$P(s):t===ba?a=Pf.mul(s).normalize():(Ee(`NodeMaterial: Unsupported normal map type: ${t}`),a=Qt),a}}const PC=on(d7).setParameterLength(1,2),f7=Se(({textureNode:i,bumpScale:e})=>{const t=r=>i.isolate().context({getUV:s=>r(s.uvNode||rd()),forceUVContext:!0}),n=_e(t(r=>r));return st(_e(t(r=>r.add(r.dFdx()))).sub(n),_e(t(r=>r.add(r.dFdy()))).sub(n)).mul(e)}),p7=Se(i=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=i,r=e.dFdx().normalize(),s=e.dFdy().normalize(),a=t,o=s.cross(a),l=a.cross(r),c=r.dot(o).mul(HP),d=c.sign().mul(n.x.mul(o).add(n.y.mul(l)));return c.abs().mul(t).sub(d).normalize()});class g7 extends oi{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=f7({textureNode:this.textureNode,bumpScale:e});return p7({surf_pos:ti,surf_norm:Qt,dHdxy:t})}}const m7=on(g7).setParameterLength(1,2),DC=new Map;class xe extends ft{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=DC.get(e);return n===void 0&&(n=il(e,t),DC.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===xe.COLOR){const s=t.color!==void 0?this.getColor(n):ye();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(n===xe.OPACITY){const s=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(n===xe.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=_e(1);else if(n===xe.SPECULAR_INTENSITY){const s=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s}else if(n===xe.SPECULAR_COLOR){const s=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(n).rgb):r=s}else if(n===xe.ROUGHNESS){const s=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).g):r=s}else if(n===xe.METALNESS){const s=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(n).b):r=s}else if(n===xe.EMISSIVE){const s=this.getFloat("emissiveIntensity"),a=this.getColor(n).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=a.mul(this.getTexture(n)):r=a}else if(n===xe.NORMAL)t.normalMap?(r=PC(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType,(t.normalMap.format==dr||t.normalMap.format==Tu||t.normalMap.format==Su)&&(r.unpackNormalMode=RR)):t.bumpMap?r=m7(this.getTexture("bump").r,this.getFloat("bumpScale")):r=Qt;else if(n===xe.CLEARCOAT){const s=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===xe.CLEARCOAT_ROUGHNESS){const s=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).r):r=s}else if(n===xe.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=PC(this.getTexture(n),this.getCache(n+"Scale","vec2")):r=Qt;else if(n===xe.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(n===xe.SHEEN_ROUGHNESS){const s=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(n).a):r=s,r=r.clamp(1e-4,1)}else if(n===xe.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(n);r=IS(pf.x,pf.y,pf.y.negate(),pf.x).mul(s.rg.mul(2).sub(st(1)).normalize().mul(s.b))}else r=pf;else if(n===xe.IRIDESCENCE_THICKNESS){const s=bn("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const a=bn("0","float",t.iridescenceThicknessRange);r=s.sub(a).mul(this.getTexture(n).g).add(a)}else r=s}else if(n===xe.TRANSMISSION){const s=this.getFloat(n);t.transmissionMap?r=s.mul(this.getTexture(n).r):r=s}else if(n===xe.THICKNESS){const s=this.getFloat(n);t.thicknessMap?r=s.mul(this.getTexture(n).g):r=s}else if(n===xe.IOR)r=this.getFloat(n);else if(n===xe.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===xe.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===xe.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):_e(0);else{const s=this.getNodeType(e);r=this.getCache(n,s)}return r}}xe.ALPHA_TEST="alphaTest";xe.COLOR="color";xe.OPACITY="opacity";xe.SHININESS="shininess";xe.SPECULAR="specular";xe.SPECULAR_STRENGTH="specularStrength";xe.SPECULAR_INTENSITY="specularIntensity";xe.SPECULAR_COLOR="specularColor";xe.REFLECTIVITY="reflectivity";xe.ROUGHNESS="roughness";xe.METALNESS="metalness";xe.NORMAL="normal";xe.CLEARCOAT="clearcoat";xe.CLEARCOAT_ROUGHNESS="clearcoatRoughness";xe.CLEARCOAT_NORMAL="clearcoatNormal";xe.EMISSIVE="emissive";xe.ROTATION="rotation";xe.SHEEN="sheen";xe.SHEEN_ROUGHNESS="sheenRoughness";xe.ANISOTROPY="anisotropy";xe.IRIDESCENCE="iridescence";xe.IRIDESCENCE_IOR="iridescenceIOR";xe.IRIDESCENCE_THICKNESS="iridescenceThickness";xe.IOR="ior";xe.TRANSMISSION="transmission";xe.THICKNESS="thickness";xe.ATTENUATION_DISTANCE="attenuationDistance";xe.ATTENUATION_COLOR="attenuationColor";xe.LINE_SCALE="scale";xe.LINE_DASH_SIZE="dashSize";xe.LINE_GAP_SIZE="gapSize";xe.LINE_WIDTH="linewidth";xe.LINE_DASH_OFFSET="dashOffset";xe.POINT_SIZE="size";xe.DISPERSION="dispersion";xe.LIGHT_MAP="light";xe.AO="ao";const _7=Oe(xe,xe.ALPHA_TEST),y7=Oe(xe,xe.COLOR),v7=Oe(xe,xe.SHININESS),x7=Oe(xe,xe.EMISSIVE),i3=Oe(xe,xe.OPACITY),b7=Oe(xe,xe.SPECULAR),kC=Oe(xe,xe.SPECULAR_INTENSITY),w7=Oe(xe,xe.SPECULAR_COLOR),C0=Oe(xe,xe.SPECULAR_STRENGTH),Lx=Oe(xe,xe.REFLECTIVITY),S7=Oe(xe,xe.ROUGHNESS),T7=Oe(xe,xe.METALNESS),M7=Oe(xe,xe.NORMAL),A7=Oe(xe,xe.CLEARCOAT),E7=Oe(xe,xe.CLEARCOAT_ROUGHNESS),C7=Oe(xe,xe.CLEARCOAT_NORMAL),R7=Oe(xe,xe.ROTATION),N7=Oe(xe,xe.SHEEN),P7=Oe(xe,xe.SHEEN_ROUGHNESS),D7=Oe(xe,xe.ANISOTROPY),k7=Oe(xe,xe.IRIDESCENCE),I7=Oe(xe,xe.IRIDESCENCE_IOR),L7=Oe(xe,xe.IRIDESCENCE_THICKNESS),F7=Oe(xe,xe.TRANSMISSION),U7=Oe(xe,xe.THICKNESS),O7=Oe(xe,xe.IOR),B7=Oe(xe,xe.ATTENUATION_DISTANCE),z7=Oe(xe,xe.ATTENUATION_COLOR),G7=Oe(xe,xe.LINE_SCALE),V7=Oe(xe,xe.LINE_DASH_SIZE),j7=Oe(xe,xe.LINE_GAP_SIZE);xe.LINE_WIDTH;const H7=Oe(xe,xe.LINE_DASH_OFFSET),W7=Oe(xe,xe.POINT_SIZE),$7=Oe(xe,xe.DISPERSION),r3=Oe(xe,xe.LIGHT_MAP),q7=Oe(xe,xe.AO),pf=Mt(new Xe).onReference(function(i){return i.material}).onRenderUpdate(function({material:i}){this.value.set(i.anisotropy*Math.cos(i.anisotropyRotation),i.anisotropy*Math.sin(i.anisotropyRotation))}),X7=Se(i=>i.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class Y7 extends id{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const n=this.storageBufferNode.structTypeNode;return n?n.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let n;const r=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&r!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?n=e.generatePBO(this):n=this.node.build(e):n=super.generate(e),r!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}const K7=on(Y7).setParameterLength(2);class Z7 extends HS{static get type(){return"StorageBufferNode"}constructor(e,t=null,n=0){let r,s=null;t&&t.isStruct?(r="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(n=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(r=ZN(e.itemSize),n=e.count):r=t,super(e,r,n),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=ps.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return K7(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(ps.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=LP(this.value),this._varying=vo(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:n}=this.getAttributeData(),r=n.build(e);return e.registerTransform(r,t),r}}const IC=(i,e=null,t=0)=>new Z7(i,e,t);class zn extends ft{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r;if(n===zn.VERTEX)r=e.getVertexIndex();else if(n===zn.INSTANCE)r=e.getInstanceIndex();else if(n===zn.DRAW)r=e.getDrawIndex();else if(n===zn.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===zn.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(n===zn.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=vo(this).build(e,t),s}}zn.VERTEX="vertex";zn.INSTANCE="instance";zn.SUBGROUP="subgroup";zn.INVOCATION_LOCAL="invocationLocal";zn.INVOCATION_SUBGROUP="invocationSubgroup";zn.DRAW="draw";const Q7=Oe(zn,zn.VERTEX),qf=Oe(zn,zn.INSTANCE);zn.SUBGROUP;zn.INVOCATION_SUBGROUP;zn.INVOCATION_LOCAL;const J7=Oe(zn,zn.DRAW);class eH extends ft{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Ut.FRAME,this.buffer=null,this.bufferColor=null}get isStorageMatrix(){const{instanceMatrix:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}get isStorageColor(){const{instanceColor:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}setup(e){const{instanceMatrix:t,instanceColor:n,isStorageMatrix:r,isStorageColor:s}=this,{count:a}=t;let{instanceMatrixNode:o,instanceColorNode:l}=this;if(o===null){if(r)o=IC(t,"mat4",Math.max(a,1)).element(qf);else if(a<=1e3)o=GP(t.array,"mat4",Math.max(a,1)).element(qf);else{const d=new BF(t.array,16,1);this.buffer=d;const f=t.usage===Yc?wC:bC,p=[f(d,"vec4",16,0),f(d,"vec4",16,4),f(d,"vec4",16,8),f(d,"vec4",16,12)];o=gu(...p)}this.instanceMatrixNode=o}if(n&&l===null){if(s)l=IC(n,"vec3",Math.max(n.count,1)).element(qf);else{const d=new cF(n.array,3),f=n.usage===Yc?wC:bC;this.bufferColor=d,l=ye(f(d,"vec3",3,0))}this.instanceColorNode=l}const c=o.mul(Ai).xyz;if(Ai.assign(c),e.hasGeometryAttribute("normal")){const d=q9(Aa,o);Aa.assign(d)}this.instanceColorNode!==null&&z0("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.buffer!==null&&this.isStorageMatrix!==!0&&(this.buffer.clearUpdateRanges(),this.buffer.updateRanges.push(...this.instanceMatrix.updateRanges),this.instanceMatrix.usage!==Yc&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version)),this.instanceColor&&this.bufferColor!==null&&this.isStorageColor!==!0&&(this.bufferColor.clearUpdateRanges(),this.bufferColor.updateRanges.push(...this.instanceColor.updateRanges),this.instanceColor.usage!==Yc&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version))}}class tH extends eH{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:r}=e;super(t,n,r),this.instancedMesh=e}}const nH=on(tH).setParameterLength(1);class iH extends ft{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=qf:this.batchingIdNode=J7);const n=Se(([_])=>{const b=Dn(_u(ds(this.batchMesh._indirectTexture),0).x).toConst(),v=Dn(_).mod(b).toConst(),y=Dn(_).div(b).toConst();return ds(this.batchMesh._indirectTexture,pa(v,y)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(Dn(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=Dn(_u(ds(r),0).x).toConst(),a=_e(n).mul(4).toInt().toConst(),o=a.mod(s).toConst(),l=a.div(s).toConst(),c=gu(ds(r,pa(o,l)),ds(r,pa(o.add(1),l)),ds(r,pa(o.add(2),l)),ds(r,pa(o.add(3),l))),d=this.batchMesh._colorsTexture;if(d!==null){const b=Se(([v])=>{const y=Dn(_u(ds(d),0).x).toConst(),S=v,T=S.mod(y).toConst(),E=S.div(y).toConst();return ds(d,pa(T,E)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);z0("vec3","vBatchColor").assign(b)}const f=Ji(c);Ai.assign(c.mul(Ai));const p=Aa.div(ye(f[0].dot(f[0]),f[1].dot(f[1]),f[2].dot(f[2]))),m=f.mul(p).xyz;Aa.assign(m),e.hasGeometryAttribute("tangent")&&qS.mulAssign(f)}}const rH=on(iH).setParameterLength(1),LC=new WeakMap;class sH extends ft{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=Ut.OBJECT,this.skinIndexNode=yl("skinIndex","uvec4"),this.skinWeightNode=yl("skinWeight","vec4"),this.bindMatrixNode=bn("bindMatrix","mat4"),this.bindMatrixInverseNode=bn("bindMatrixInverse","mat4"),this.boneMatricesNode=CC("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Ai,this.toPositionNode=Ai,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:a}=this,o=e.element(n.x),l=e.element(n.y),c=e.element(n.z),d=e.element(n.w),f=s.mul(t),p=Ir(o.mul(r.x).mul(f),l.mul(r.y).mul(f),c.mul(r.z).mul(f),d.mul(r.w).mul(f));return a.mul(p).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Aa){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:a}=this,o=e.element(n.x),l=e.element(n.y),c=e.element(n.z),d=e.element(n.w);let f=Ir(r.x.mul(o),r.y.mul(l),r.z.mul(c),r.w.mul(d));return f=a.mul(f).mul(s),f.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=CC("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,AC)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||QN(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&AC.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();Aa.assign(n),e.hasGeometryAttribute("tangent")&&qS.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;LC.get(t)!==e.frameId&&(LC.set(t,e.frameId),this.previousBoneMatricesNode!==null&&(t.previousBoneMatrices===null&&(t.previousBoneMatrices=new Float32Array(t.boneMatrices)),t.previousBoneMatrices.set(t.boneMatrices)),t.update())}}const aH=i=>new sH(i);class oH extends ft{static get type(){return"LoopNode"}constructor(e=[]){super("void"),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let o=0,l=this.params.length-1;o<l;o++){const c=this.params[o],d=c.isNode!==!0&&c.name||this.getVarName(o),f=c.isNode!==!0&&c.type||"int";n[d]=Vh(d,f)}const r=e.addStack(),s=this.params[this.params.length-1](n);t.returnsNode=s.context({nodeLoop:s}),t.stackNode=r;const a=this.params[0];if(a.isNode!==!0&&typeof a.update=="function"){const o=Se(this.params[0].update)(n);t.updateNode=o.context({nodeLoop:o})}return e.removeStack(),t}setup(e){if(this.getProperties(e),e.fnCall){const t=e.getDataFromNode(e.fnCall.shaderNode);t.hasLoop=!0}}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let a=0,o=n.length-1;a<o;a++){const l=n[a];let c=!1,d=null,f=null,p=null,m=null,_=null,b=null;l.isNode?l.getNodeType(e)==="bool"?(c=!0,m="bool",f=l.build(e,m)):(m="int",p=this.getVarName(a),d="0",f=l.build(e,m),_="<"):(m=l.type||"int",p=l.name||this.getVarName(a),d=l.start,f=l.end,_=l.condition,b=l.update,typeof d=="number"?d=e.generateConst(m,d):d&&d.isNode&&(d=d.build(e,m)),typeof f=="number"?f=e.generateConst(m,f):f&&f.isNode&&(f=f.build(e,m)),d!==void 0&&f===void 0?(d=d+" - 1",f="0",_=">="):f!==void 0&&d===void 0&&(d="0",_="<"),_===void 0&&(Number(d)>Number(f)?_=">=":_="<"));let v;if(c)v=`while ( ${f} )`;else{const y={start:d,end:f},S=y.start,T=y.end;let E;const N=()=>_.includes("<")?"+=":"-=";if(b!=null)switch(typeof b){case"function":E=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":E=p+" "+N()+" "+e.generateConst(m,b);break;case"string":E=p+" "+b;break;default:b.isNode?E=p+" "+N()+" "+b.build(e):(Ee("TSL: 'Loop( { update: ... } )' is not a function, string or number."),E="break /* invalid update */")}else m==="int"||m==="uint"?b=_.includes("<")?"++":"--":b=N()+" 1.",E=p+" "+b;const M=e.getVar(m,p)+" = "+S,C=p+" "+_+" "+T;v=`for ( ${M}; ${C}; ${E} )`}e.addFlowCode((a===0?`
`:"")+e.tab+v+` {

`).addFlowTab()}const s=r.build(e,"void");t.returnsNode.build(e,"void"),e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,o=this.params.length-1;a<o;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();e.addFlowTab()}}const fs=(...i)=>new oH(rh(i,"int")).toStack(),lH=()=>Vh("break").toStack(),Fx=new WeakMap,qr=new It,FC=Se(({bufferMap:i,influence:e,stride:t,width:n,depth:r,offset:s})=>{const a=Dn(Q7).mul(t).add(s),o=a.div(n),l=a.sub(o.mul(n));return ds(i,pa(l,o)).depth(r).xyz.mul(e)});function uH(i){const e=i.morphAttributes.position!==void 0,t=i.morphAttributes.normal!==void 0,n=i.morphAttributes.color!==void 0,r=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,s=r!==void 0?r.length:0;let a=Fx.get(i);if(a===void 0||a.count!==s){let S=function(){v.dispose(),Fx.delete(i),i.removeEventListener("dispose",S)};var o=S;a!==void 0&&a.texture.dispose();const l=i.morphAttributes.position||[],c=i.morphAttributes.normal||[],d=i.morphAttributes.color||[];let f=0;e===!0&&(f=1),t===!0&&(f=2),n===!0&&(f=3);let p=i.attributes.position.count*f,m=1;const _=4096;p>_&&(m=Math.ceil(p/_),p=_);const b=new Float32Array(p*m*4*s),v=new tS(b,p,m,s);v.type=Qn,v.needsUpdate=!0;const y=f*4;for(let T=0;T<s;T++){const E=l[T],N=c[T],M=d[T],C=p*m*4*T;for(let D=0;D<E.count;D++){const R=D*y;e===!0&&(qr.fromBufferAttribute(E,D),b[C+R+0]=qr.x,b[C+R+1]=qr.y,b[C+R+2]=qr.z,b[C+R+3]=0),t===!0&&(qr.fromBufferAttribute(N,D),b[C+R+4]=qr.x,b[C+R+5]=qr.y,b[C+R+6]=qr.z,b[C+R+7]=0),n===!0&&(qr.fromBufferAttribute(M,D),b[C+R+8]=qr.x,b[C+R+9]=qr.y,b[C+R+10]=qr.z,b[C+R+11]=M.itemSize===4?qr.w:1)}}a={count:s,texture:v,stride:f,size:new Xe(p,m)},Fx.set(i,a),i.addEventListener("dispose",S)}return a}class cH extends ft{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Mt(1),this.updateType=Ut.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=s!==void 0?s.length:0,{texture:o,stride:l,size:c}=uH(t);n===!0&&Ai.mulAssign(this.morphBaseInfluence),r===!0&&Aa.mulAssign(this.morphBaseInfluence);const d=Dn(c.width);fs(a,({i:f})=>{const p=_e(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?p.assign(ds(this.mesh.morphTexture,pa(Dn(f).add(1),Dn(qf))).r):p.assign(bn("morphTargetInfluences","float").element(f).toVar()),Sn(p.notEqual(0),()=>{n===!0&&Ai.addAssign(FC({bufferMap:o,influence:p,stride:l,width:d,depth:f,offset:Dn(0)})),r===!0&&Aa.addAssign(FC({bufferMap:o,influence:p,stride:l,width:d,depth:f,offset:Dn(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const hH=on(cH).setParameterLength(1);class ld extends ft{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class dH extends ld{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class fH extends PP{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=ye().toVar("directDiffuse"),r=ye().toVar("directSpecular"),s=ye().toVar("indirectDiffuse"),a=ye().toVar("indirectSpecular"),o={directDiffuse:n,directSpecular:r,indirectDiffuse:s,indirectSpecular:a};return{radiance:ye().toVar("radiance"),irradiance:ye().toVar("irradiance"),iblIrradiance:ye().toVar("iblIrradiance"),ambientOcclusion:_e(1).toVar("ambientOcclusion"),reflectedLight:o,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const pH=on(fH);class gH extends ld{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const Bc=new Xe;class s3 extends sd{static get type(){return"ViewportTextureNode"}constructor(e=ah,t=null,n=null){let r=null;n===null?(r=new jR,r.minFilter=Nr,n=r):r=n,super(n,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=r,this.isOutputTextureNode=!0,this.updateBeforeType=Ut.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,n;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,n=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,n=this._cacheTextures),e===null)return t;if(n.has(e)===!1){const r=t.clone();n.set(e,r)}return n.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,n=t.getRenderTarget();n===null?t.getDrawingBufferSize(Bc):Bc.set(n.width,n.height);const r=this.getTextureForReference(n);(r.image.width!==Bc.width||r.image.height!==Bc.height)&&(r.image.width=Bc.width,r.image.height=Bc.height,r.needsUpdate=!0);const s=r.generateMipmaps;r.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(r),r.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const a3=on(s3,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let qm=null;class mH extends s3{static get type(){return"ViewportDepthTextureNode"}constructor(e=ah,t=null){qm===null&&(qm=new gr),super(e,t,qm)}getTextureForReference(){return qm}}const _H=on(mH).setParameterLength(0,2);class Dr extends ft{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Dr.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Dr.DEPTH_BASE)n!==null&&(r=u3().assign(n));else if(t===Dr.DEPTH)e.isPerspectiveCamera?r=yH(ti.z,au,ou):r=Xf(ti.z,au,ou);else if(t===Dr.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const s=o3(n,au,ou);r=Xf(s,au,ou)}else r=n;else r=Xf(ti.z,au,ou);return r}}Dr.DEPTH_BASE="depthBase";Dr.DEPTH="depth";Dr.LINEAR_DEPTH="linearDepth";const Xf=(i,e,t)=>i.add(e).div(e.sub(t)),yH=(i,e,t)=>e.add(i).mul(t).div(t.sub(e).mul(i)),o3=(i,e,t)=>e.mul(t).div(t.sub(e).mul(i).sub(t)),l3=(i,e,t)=>{e=e.max(1e-6).toVar();const n=go(i.negate().div(e)),r=go(t.div(e));return n.div(r)},u3=on(Dr,Dr.DEPTH_BASE),c3=Oe(Dr,Dr.DEPTH),vH=on(Dr,Dr.LINEAR_DEPTH).setParameterLength(0,1);_H();c3.assign=i=>u3(i);class _s extends ft{static get type(){return"ClippingNode"}constructor(e=_s.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===_s.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===_s.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return Se(()=>{const n=_e().toVar("distanceToPlane"),r=_e().toVar("distanceToGradient"),s=_e(1).toVar("clipOpacity"),a=t.length;if(this.hardwareClipping===!1&&a>0){const l=Vs(t).setGroup(wt);fs(a,({i:c})=>{const d=l.element(c);n.assign(ti.dot(d.xyz).negate().add(d.w)),r.assign(n.fwidth().div(2)),s.mulAssign(_o(r.negate(),r,n))})}const o=e.length;if(o>0){const l=Vs(e).setGroup(wt),c=_e(1).toVar("intersectionClipOpacity");fs(o,({i:d})=>{const f=l.element(d);n.assign(ti.dot(f.xyz).negate().add(f.w)),r.assign(n.fwidth().div(2)),c.mulAssign(_o(r.negate(),r,n).oneMinus())}),s.mulAssign(c.oneMinus())}_n.a.mulAssign(s),_n.a.equal(0).discard()})()}setupDefault(e,t){return Se(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const s=Vs(t).setGroup(wt);fs(n,({i:a})=>{const o=s.element(a);ti.dot(o.xyz).greaterThan(o.w).discard()})}const r=e.length;if(r>0){const s=Vs(e).setGroup(wt),a=kS(!0).toVar("clipped");fs(r,({i:o})=>{const l=s.element(o);a.assign(ti.dot(l.xyz).greaterThan(l.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),Se(()=>{const r=Vs(e).setGroup(wt),s=kp(t.getClipDistance());fs(n,({i:a})=>{const o=r.element(a),l=ti.dot(o.xyz).sub(o.w).negate();s.element(a).assign(l)})})()}}_s.ALPHA_TO_COVERAGE="alphaToCoverage";_s.DEFAULT="default";_s.HARDWARE="hardware";const xH=()=>new _s,bH=()=>new _s(_s.ALPHA_TO_COVERAGE),wH=()=>new _s(_s.HARDWARE),SH=.05,UC=Se(([i])=>Ma(Bt(1e4,Yr(Bt(17,i.x).add(Bt(.1,i.y)))).mul(Ir(.1,Kr(Yr(Bt(13,i.y).add(i.x))))))),OC=Se(([i])=>UC(st(UC(i.xy),i.z))),TH=Se(([i])=>{const e=Ii(mo(SP(i.xyz)),mo(TP(i.xyz))),t=_e(1).div(_e(SH).mul(e)).toVar("pixScale"),n=st(pp(mu(go(t))),pp(OS(go(t)))),r=st(OC(mu(n.x.mul(i.xyz))),OC(mu(n.y.mul(i.xyz)))),s=Ma(go(t)),a=Ir(Bt(s.oneMinus(),r.x),Bt(s,r.y)),o=Gh(s,s.oneMinus()),l=ye(a.mul(a).div(Bt(2,o).mul(Ar(1,o))),a.sub(Bt(.5,o)).div(Ar(1,o)),Ar(1,Ar(1,a).mul(Ar(1,a)).div(Bt(2,o).mul(Ar(1,o))))),c=a.lessThan(o.oneMinus()).select(a.lessThan(o).select(l.x,l.y),l.z);return _l(c,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class MH extends BP{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let r;return n===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new It(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const AH=(i=0)=>new MH(i),EH=Se(([i])=>kt(i.rgb.mul(i.a),i.a),{color:"vec4",return:"vec4"});class ni extends Qi{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,this.contextNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{Ae('NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}_getNodeChildren(){const e=[];for(const t of Object.getOwnPropertyNames(this)){if(t.startsWith("_")===!0)continue;const n=this[t];n&&n.isNode===!0&&e.push({property:t,childNode:n})}return e}customProgramCacheKey(){const e=[];for(const{property:t,childNode:n}of this._getNodeChildren())e.push(p_(t.slice(0,-4)),n.getCacheKey());return this.type+Pp(e)}build(e){this.setup(e)}setupObserver(e){return new hV(e)}setup(e){e.context.setupNormal=()=>Hf(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();t.contextNode.isContextNode===!0?e.context={...e.context,...t.contextNode.getFlowContextData()}:Ee('NodeMaterial: "renderer.contextNode" must be an instance of `context()`.'),this.contextNode!==null&&(this.contextNode.isContextNode===!0?e.context={...e.context,...this.contextNode.getFlowContextData()}:Ee('NodeMaterial: "material.contextNode" must be an instance of `context()`.')),e.addStack();const r=Hf(this.setupVertex(e),"VERTEX"),s=this.vertexNode||r;e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let a;const o=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const l=this.setupLighting(e);o!==null&&e.stack.addToStack(o);const c=kt(l,_n.a).max(0);a=this.setupOutput(e,c),jf.assign(a);const d=this.outputNode!==null;if(d&&(a=this.outputNode),e.context.getOutput&&(a=e.context.getOutput(a,e)),n!==null){const f=t.getMRT(),p=this.mrtNode;f!==null?(d&&jf.assign(a),a=f,p!==null&&(a=f.merge(p))):p!==null&&(a=p)}}else{let l=this.fragmentNode;l.isOutputStructNode!==!0&&(l=kt(l)),a=this.setupOutput(e,l)}e.stack.outputNode=a,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let r=null;if(t.length>0||n.length>0){const s=e.renderer.currentSamples;this.alphaToCoverage&&s>1?r=bH():e.stack.addToStack(xH())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.addToStack(wH()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?r=l3(ti.z,au,ou):r=Xf(ti.z,au,ou))}r!==null&&c3.assign(r).toStack()}setupPositionView(){return Ip.mul(Ai).xyz}setupModelViewProjection(){return $f.mul(ti)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),X7}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&hH(t).toStack(),t.isSkinnedMesh===!0&&aH(t).toStack(),this.displacementMap){const r=il("displacementMap","texture"),s=il("displacementScale","float"),a=il("displacementBias","float");Ai.addAssign(Aa.normalize().mul(r.x.mul(s).add(a)))}return t.isBatchedMesh&&rH(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&nH(t).toStack(),this.positionNode!==null&&Ai.assign(Hf(this.positionNode,"POSITION","vec3")),Ai}setupDiffuseColor(e){const{object:t,geometry:n}=e;this.maskNode!==null&&kS(this.maskNode).not().discard();let r=this.colorNode?kt(this.colorNode):y7;this.vertexColors===!0&&n.hasAttribute("color")&&(r=r.mul(AH())),t.instanceColor&&(r=z0("vec3","vInstanceColor").mul(r)),t.isBatchedMesh&&t._colorsTexture&&(r=z0("vec3","vBatchColor").mul(r)),_n.assign(r);const s=this.opacityNode?_e(this.opacityNode):i3;_n.a.assign(_n.a.mul(s));let a=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(a=this.alphaTestNode!==null?_e(this.alphaTestNode):_7,this.alphaToCoverage===!0?(_n.a=_o(a,a.add(MP(_n.a)),_n.a),_n.a.lessThanEqual(0).discard()):_n.a.lessThanEqual(a).discard()),this.alphaHash===!0&&_n.a.lessThan(TH(Ai)).discard(),e.isOpaque()&&_n.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?ye(0):_n.rgb}setupNormal(){return this.normalNode?ye(this.normalNode):M7}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?il("envMap","cubeTexture"):il("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new gH(r3)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);r&&r.isLightingNode&&t.push(r);let s=this.aoNode;s===null&&e.material.aoMap&&(s=q7),e.context.getAO&&(s=e.context.getAO(s,e)),s&&t.push(new dH(s));let a=this.lightsNode||e.lightsNode;return t.length>0&&(a=e.renderer.lighting.createNode([...a.getLights(),...t])),a}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:s}=this,o=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(o&&o.getScope().hasLights){const c=this.setupLightingModel(e)||null;l=pH(o,c,n,r)}else n!==null&&(l=ye(r!==null?wn(l,n,r):n));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(mC.assign(ye(s||x7)),l=l.add(mC)),l}setupFog(e,t){const n=e.fogNode;return n&&(jf.assign(t),t=kt(n.toVar())),t}setupPremultipliedAlpha(e,t){return EH(t)}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),this.premultipliedAlpha===!0&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const n in e){const r=e[n];this[n]===void 0&&(this[n]=r,r&&r.clone&&(this[n]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=Qi.prototype.toJSON.call(this,e);n.inputNodes={};for(const{property:s,childNode:a}of this._getNodeChildren())n.inputNodes[s]=a.toJSON(e).uuid;function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=r(e.textures),a=r(e.images),o=r(e.nodes);s.length>0&&(n.textures=s),a.length>0&&(n.images=a),o.length>0&&(n.nodes=o)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.aoNode=e.aoNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,this.contextNode=e.contextNode,super.copy(e)}}const CH=new VR;class RH extends ni{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(CH),this.setValues(e)}}const NH=new AF;class PH extends ni{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(NH),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?_e(this.offsetNode):H7,t=this.dashScaleNode?_e(this.dashScaleNode):G7,n=this.dashSizeNode?_e(this.dashSizeNode):V7,r=this.gapSizeNode?_e(this.gapSizeNode):j7;Dx.assign(n),_C.assign(r);const s=vo(yl("lineDistance").mul(t));(e?s.add(e):s).mod(Dx.add(_C)).greaterThan(Dx).discard()}}const DH=new bF;class kH extends ni{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(DH),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?_e(this.opacityNode):i3;_n.assign(VS(kt(h7(Qt),e),lr))}}const h3=Se(([i=jP])=>{const e=i.z.atan(i.x).mul(1/(Math.PI*2)).add(.5),t=i.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return st(e,t)});class d3 extends oS{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new Lu(5,5,5),a=h3(jP),o=new ni;o.colorNode=kn(t,a,0),o.side=En,o.blending=pr;const l=new pi(s,o),c=new n_;c.add(l),t.minFilter===Nr&&(t.minFilter=In);const d=new zR(1,10,this),f=e.getMRT();return e.setMRT(null),d.update(e,c),e.setMRT(f),t.minFilter=n,t.currentGenerateMipmaps=r,l.geometry.dispose(),l.material.dispose(),this}}const Yf=new WeakMap;class IH extends oi{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Cr(null);const t=new Ap;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Ut.RENDER}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:n[r.property];if(s&&s.isTexture){const a=s.mapping;if(a===ch||a===hh){if(Yf.has(s)){const o=Yf.get(s);BC(o,s.mapping),this._cubeTexture=o}else{const o=s.image;if(LH(o)){const l=new d3(o.height);l.fromEquirectangularTexture(t,s),BC(l.texture,s.mapping),this._cubeTexture=l.texture,Yf.set(s,l.texture),s.addEventListener("dispose",f3)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function LH(i){return i==null?!1:i.height>0}function f3(i){const e=i.target;e.removeEventListener("dispose",f3);const t=Yf.get(e);t!==void 0&&(Yf.delete(e),t.dispose())}function BC(i,e){e===ch?i.mapping=Xs:e===hh&&(i.mapping=wa)}const p3=on(IH).setParameterLength(1);class XS extends ld{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=p3(this.envNode)}}class FH extends ld{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=_e(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class v_{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class g3 extends v_{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,r=e.irradianceLightMap;n.indirectDiffuse.assign(kt(0)),r?n.indirectDiffuse.addAssign(r):n.indirectDiffuse.addAssign(kt(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(_n.rgb)}finish(e){const{material:t,context:n}=e,r=n.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case xp:r.rgb.assign(wn(r.rgb,r.rgb.mul(s.rgb),C0.mul(Lx)));break;case MR:r.rgb.assign(wn(r.rgb,s.rgb,C0.mul(Lx)));break;case AR:r.rgb.addAssign(s.rgb.mul(C0.mul(Lx)));break;default:Ae("BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const UH=new ma;class OH extends ni{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(UH),this.setValues(e)}setupNormal(){return Lp(gp)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new XS(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new FH(r3)),t}setupOutgoingLight(){return _n.rgb}setupLightingModel(){return new g3}}const mp=Se(({f0:i,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return i.mul(n.oneMinus()).add(e.mul(n))}),Hh=Se(i=>i.diffuseColor.mul(1/Math.PI)),BH=()=>_e(.25),zH=Se(({dotNH:i})=>iw.mul(_e(.5)).add(1).mul(_e(1/Math.PI)).mul(i.pow(iw))),GH=Se(({lightDirection:i})=>{const e=i.add(Nn).normalize(),t=Qt.dot(e).clamp(),n=Nn.dot(e).clamp(),r=mp({f0:Ru,f90:1,dotVH:n}),s=BH(),a=zH({dotNH:t});return r.mul(s).mul(a)});class m3 extends g3{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Qt.dot(e).clamp().mul(t);n.directDiffuse.addAssign(s.mul(Hh({diffuseColor:_n.rgb}))),this.specular===!0&&n.directSpecular.addAssign(s.mul(GH({lightDirection:e})).mul(C0))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(Hh({diffuseColor:_n}))),r.indirectDiffuse.mulAssign(t)}}const VH=new wF;class jH extends ni{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(VH),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new XS(t):null}setupLightingModel(){return new m3(!1)}}const HH=new vF;class WH extends ni{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(HH),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new XS(t):null}setupLightingModel(){return new m3}setupVariants(){const e=(this.shininessNode?_e(this.shininessNode):v7).max(1e-4);iw.assign(e);const t=this.specularNode||b7;Ru.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const $H=Se(i=>{if(i.geometry.hasAttribute("normal")===!1)return _e(0);const e=gp.dFdx().abs().max(gp.dFdy().abs());return e.x.max(e.y).max(e.z)}),_3=Se(i=>{const{roughness:e}=i,t=$H();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),qH=Se(({alpha:i,dotNL:e,dotNV:t})=>{const n=i.pow2(),r=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return Ta(.5,r.add(s).max(mP))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),XH=Se(({alphaT:i,alphaB:e,dotTV:t,dotBV:n,dotTL:r,dotBL:s,dotNV:a,dotNL:o})=>{const l=o.mul(ye(i.mul(t),e.mul(n),a).length()),c=a.mul(ye(i.mul(r),e.mul(s),o).length());return Ta(.5,l.add(c))}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),YH=Se(({alpha:i,dotNH:e})=>{const t=i.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),KH=_e(1/Math.PI),ZH=Se(({alphaT:i,alphaB:e,dotNH:t,dotTH:n,dotBH:r})=>{const s=i.mul(e),a=ye(e.mul(n),i.mul(r),s.mul(t)),o=a.dot(a),l=s.div(o);return KH.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),y3=Se(({lightDirection:i,f0:e,f90:t,roughness:n,f:r,normalView:s=Qt,USE_IRIDESCENCE:a,USE_ANISOTROPY:o})=>{const l=n.pow2(),c=i.add(Nn).normalize(),d=s.dot(i).clamp(),f=s.dot(Nn).clamp(),p=s.dot(c).clamp(),m=Nn.dot(c).clamp();let _=mp({f0:e,f90:t,dotVH:m}),b,v;if(gC(a)&&(_=LS.mix(_,r)),gC(o)){const y=T0.dot(i),S=T0.dot(Nn),T=T0.dot(c),E=sh.dot(i),N=sh.dot(Nn),M=sh.dot(c);b=XH({alphaT:nw,alphaB:l,dotTV:S,dotBV:N,dotTL:y,dotBL:E,dotNV:f,dotNL:d}),v=ZH({alphaT:nw,alphaB:l,dotNH:p,dotTH:T,dotBH:M})}else b=qH({alpha:l,dotNL:d,dotNV:f}),v=YH({alpha:l,dotNH:p});return _.mul(b).mul(v)}),QH=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let ca=null;const V0=Se(({roughness:i,dotNV:e})=>{ca===null&&(ca=new uS(QH,16,16,dr,Wn),ca.name="DFG_LUT",ca.minFilter=In,ca.magFilter=In,ca.wrapS=Rr,ca.wrapT=Rr,ca.generateMipmaps=!1,ca.needsUpdate=!0);const t=st(i,e);return kn(ca,t).rg}),JH=Se(({lightDirection:i,f0:e,f90:t,roughness:n,f:r,USE_IRIDESCENCE:s,USE_ANISOTROPY:a})=>{const o=y3({lightDirection:i,f0:e,f90:t,roughness:n,f:r,USE_IRIDESCENCE:s,USE_ANISOTROPY:a}),l=Qt.dot(i).clamp(),c=Qt.dot(Nn).clamp(),d=V0({roughness:n,dotNV:c}),f=V0({roughness:n,dotNV:l}),p=e.mul(d.x).add(t.mul(d.y)),m=e.mul(f.x).add(t.mul(f.y)),_=d.x.add(d.y),b=f.x.add(f.y),v=_e(1).sub(_),y=_e(1).sub(b),S=e.add(e.oneMinus().mul(.047619)),T=p.mul(m).mul(S).div(_e(1).sub(v.mul(y).mul(S).mul(S)).add(mP)),E=v.mul(y),N=T.mul(E);return o.add(N)}),v3=Se(i=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:r}=i,s=V0({dotNV:e,roughness:r});return t.mul(s.x).add(n.mul(s.y))}),zC=Se(({f:i,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),r=n.mul(n),s=n.mul(r,r).clamp(0,.9999);return i.sub(ye(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),eW=Se(({roughness:i,dotNH:e})=>{const t=i.pow2(),n=_e(1).div(t),s=e.pow2().oneMinus().max(.0078125);return _e(2).add(n).mul(s.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),tW=Se(({dotNV:i,dotNL:e})=>_e(1).div(_e(4).mul(e.add(i).sub(e.mul(i))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),nW=Se(({lightDirection:i})=>{const e=i.add(Nn).normalize(),t=Qt.dot(i).clamp(),n=Qt.dot(Nn).clamp(),r=Qt.dot(e).clamp(),s=eW({roughness:su,dotNH:r}),a=tW({dotNV:n,dotNL:t});return hs.mul(s).mul(a)}),iW=Se(({N:i,V:e,roughness:t})=>{const s=.0078125,a=i.dot(e).saturate(),o=st(t,a.oneMinus().sqrt());return o.assign(o.mul(.984375).add(s)),o}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),rW=Se(({f:i})=>{const e=i.length();return Ii(e.mul(e).add(i.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Xm=Se(({v1:i,v2:e})=>{const t=i.dot(e),n=t.abs().toVar(),r=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),s=n.add(4.1616724).mul(n).add(3.417594).toVar(),a=r.div(s),o=t.greaterThan(0).select(a,Ii(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return i.cross(e).mul(o)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),GC=Se(({N:i,V:e,P:t,mInv:n,p0:r,p1:s,p2:a,p3:o})=>{const l=s.sub(r).toVar(),c=o.sub(r).toVar(),d=l.cross(c),f=ye().toVar();return Sn(d.dot(t.sub(r)).greaterThanEqual(0),()=>{const p=e.sub(i.mul(e.dot(i))).normalize(),m=i.cross(p).negate(),_=n.mul(Ji(p,m,i).transpose()).toVar(),b=_.mul(r.sub(t)).normalize().toVar(),v=_.mul(s.sub(t)).normalize().toVar(),y=_.mul(a.sub(t)).normalize().toVar(),S=_.mul(o.sub(t)).normalize().toVar(),T=ye(0).toVar();T.addAssign(Xm({v1:b,v2:v})),T.addAssign(Xm({v1:v,v2:y})),T.addAssign(Xm({v1:y,v2:S})),T.addAssign(Xm({v1:S,v2:b})),f.assign(ye(rW({f:T})))}),f}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),x_=1/6,x3=i=>Bt(x_,Bt(i,Bt(i,i.negate().add(3)).sub(3)).add(1)),lw=i=>Bt(x_,Bt(i,Bt(i,Bt(3,i).sub(6))).add(4)),b3=i=>Bt(x_,Bt(i,Bt(i,Bt(-3,i).add(3)).add(3)).add(1)),uw=i=>Bt(x_,__(i,3)),VC=i=>x3(i).add(lw(i)),jC=i=>b3(i).add(uw(i)),HC=i=>Ir(-1,lw(i).div(x3(i).add(lw(i)))),WC=i=>Ir(1,uw(i).div(b3(i).add(uw(i)))),$C=(i,e,t)=>{const n=i.uvNode,r=Bt(n,e.zw).add(.5),s=mu(r),a=Ma(r),o=VC(a.x),l=jC(a.x),c=HC(a.x),d=WC(a.x),f=HC(a.y),p=WC(a.y),m=st(s.x.add(c),s.y.add(f)).sub(.5).mul(e.xy),_=st(s.x.add(d),s.y.add(f)).sub(.5).mul(e.xy),b=st(s.x.add(c),s.y.add(p)).sub(.5).mul(e.xy),v=st(s.x.add(d),s.y.add(p)).sub(.5).mul(e.xy),y=VC(a.y).mul(Ir(o.mul(i.sample(m).level(t)),l.mul(i.sample(_).level(t)))),S=jC(a.y).mul(Ir(o.mul(i.sample(b).level(t)),l.mul(i.sample(v).level(t))));return y.add(S)},sW=Se(([i,e])=>{const t=st(i.size(Dn(e))),n=st(i.size(Dn(e.add(1)))),r=Ta(1,t),s=Ta(1,n),a=$C(i,kt(r,t),mu(e)),o=$C(i,kt(s,n),OS(e));return Ma(e).mix(a,o)}),qC=Se(([i,e,t,n,r])=>{const s=ye(NP(e.negate(),qs(i),Ta(1,n))),a=ye(mo(r[0].xyz),mo(r[1].xyz),mo(r[2].xyz));return qs(s).mul(t.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),aW=Se(([i,e])=>i.mul(_l(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),oW=a3(),lW=a3(),XC=Se(([i,e,t],{material:n})=>{const s=(n.side===En?oW:lW).sample(i),a=go(sw.x).mul(aW(e,t));return sW(s,a)}),YC=Se(([i,e,t])=>(Sn(t.notEqual(0),()=>{const n=yP(e).negate().div(t);return _P(n.negate().mul(i))}),ye(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),uW=Se(([i,e,t,n,r,s,a,o,l,c,d,f,p,m,_])=>{let b,v;if(_){b=kt().toVar(),v=ye().toVar();const N=d.sub(1).mul(_.mul(.025)),M=ye(d.sub(N),d,d.add(N));fs({start:0,end:3},({i:C})=>{const D=M.element(C),R=qC(i,e,f,D,o),P=a.add(R),L=c.mul(l.mul(kt(P,1))),z=st(L.xy.div(L.w)).toVar();z.addAssign(1),z.divAssign(2),z.assign(st(z.x,z.y.oneMinus()));const B=XC(z,t,D);b.element(C).assign(B.element(C)),b.a.addAssign(B.a),v.element(C).assign(n.element(C).mul(YC(mo(R),p,m).element(C)))}),b.a.divAssign(3)}else{const N=qC(i,e,f,d,o),M=a.add(N),C=c.mul(l.mul(kt(M,1))),D=st(C.xy.div(C.w)).toVar();D.addAssign(1),D.divAssign(2),D.assign(st(D.x,D.y.oneMinus())),b=XC(D,t,d),v=n.mul(YC(mo(N),p,m))}const y=v.rgb.mul(b.rgb),S=i.dot(e).clamp(),T=ye(v3({dotNV:S,specularColor:r,specularF90:s,roughness:t})),E=v.r.add(v.g,v.b).div(3);return kt(T.oneMinus().mul(y),b.a.oneMinus().mul(E).oneMinus())}),cW=Ji(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),hW=i=>{const e=i.sqrt();return ye(1).add(e).div(ye(1).sub(e))},KC=(i,e)=>i.sub(e).div(i.add(e)).pow2(),dW=(i,e)=>{const t=i.mul(2*Math.PI*1e-9),n=ye(54856e-17,44201e-17,52481e-17),r=ye(1681e3,1795300,2208400),s=ye(43278e5,93046e5,66121e5),a=_e(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let o=n.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return o=ye(o.x.add(a),o.y,o.z).div(10685e-11),cW.mul(o)},ZC=Se(({outsideIOR:i,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:r})=>{const s=wn(i,e,_o(0,.03,n)),o=i.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();Sn(o.lessThan(0),()=>ye(1));const l=o.sqrt(),c=KC(s,i),d=mp({f0:c,f90:1,dotVH:t}),f=d.oneMinus(),p=s.lessThan(i).select(Math.PI,0),m=_e(Math.PI).sub(p),_=hW(r.clamp(0,.9999)),b=KC(_,s.toVec3()),v=mp({f0:b,f90:1,dotVH:l}),y=ye(_.x.lessThan(s).select(Math.PI,0),_.y.lessThan(s).select(Math.PI,0),_.z.lessThan(s).select(Math.PI,0)),S=s.mul(n,l,2),T=ye(m).add(y),E=d.mul(v).clamp(1e-5,.9999),N=E.sqrt(),M=f.pow2().mul(v).div(ye(1).sub(E)),D=d.add(M).toVar(),R=M.sub(f).toVar();return fs({start:1,end:2,condition:"<=",name:"m"},({m:P})=>{R.mulAssign(N);const L=dW(_e(P).mul(S),_e(P).mul(T)).mul(2);D.addAssign(R.mul(L))}),D.max(ye(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),gf=Se(({normal:i,viewDir:e,roughness:t})=>{const n=i.dot(e).saturate(),r=t.mul(t),s=t.add(.1).reciprocal(),a=_e(-1.9362).add(t.mul(1.0678)).add(r.mul(.4573)).sub(s.mul(.8469)),o=_e(-.6014).add(t.mul(.5538)).sub(r.mul(.467)).sub(s.mul(.1255));return a.mul(n).add(o).exp().saturate()}),Ux=ye(.04),Ox=_e(1);class w3 extends v_{constructor(e=!1,t=!1,n=!1,r=!1,s=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=s,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null,this.iridescenceF0Dielectric=null,this.iridescenceF0Metallic=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=ye().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=ye().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=ye().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=ye().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=ye().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=Qt.dot(Nn).clamp(),n=ZC({outsideIOR:_e(1),eta2:ew,cosTheta1:t,thinFilmThickness:tw,baseF0:Ru}),r=ZC({outsideIOR:_e(1),eta2:ew,cosTheta1:t,thinFilmThickness:tw,baseF0:_n.rgb});this.iridescenceFresnel=wn(n,r,al),this.iridescenceF0Dielectric=zC({f:n,f90:1,dotVH:t}),this.iridescenceF0Metallic=zC({f:r,f90:1,dotVH:t}),this.iridescenceF0=wn(this.iridescenceF0Dielectric,this.iridescenceF0Metallic,al)}if(this.transmission===!0){const t=jh,n=B9.sub(jh).normalize(),r=od,s=e.context;s.backdrop=uW(r,n,ro,Xc,Kc,Vf,t,Du,xo,$f,M0,uP,hP,cP,this.dispersion?dP:null),s.backdropAlpha=rw,_n.a.mulAssign(wn(1,s.backdrop.a,rw))}super.start(e)}computeMultiscattering(e,t,n,r,s=null){const a=Qt.dot(Nn).clamp(),o=V0({roughness:ro,dotNV:a}),l=s?LS.mix(r,s):r,c=l.mul(o.x).add(n.mul(o.y)),f=o.x.add(o.y).oneMinus(),p=l.add(l.oneMinus().mul(.047619)),m=c.mul(p).div(f.mul(p).oneMinus());e.addAssign(c),t.addAssign(m.mul(f))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Qt.dot(e).clamp().mul(t).toVar();if(this.sheen===!0){this.sheenSpecularDirect.addAssign(s.mul(nW({lightDirection:e})));const a=gf({normal:Qt,viewDir:Nn,roughness:su}),o=gf({normal:Qt,viewDir:e,roughness:su}),l=hs.r.max(hs.g).max(hs.b).mul(a.max(o)).oneMinus();s.mulAssign(l)}if(this.clearcoat===!0){const o=Zc.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(o.mul(y3({lightDirection:e,f0:Ux,f90:Ox,roughness:G0,normalView:Zc})))}n.directDiffuse.addAssign(s.mul(Hh({diffuseColor:Xc}))),n.directSpecular.addAssign(s.mul(JH({lightDirection:e,f0:Kc,f90:1,roughness:ro,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:s,ltc_1:a,ltc_2:o}){const l=t.add(n).sub(r),c=t.sub(n).sub(r),d=t.sub(n).add(r),f=t.add(n).add(r),p=Qt,m=Nn,_=ti.toVar(),b=iW({N:p,V:m,roughness:ro}),v=a.sample(b).toVar(),y=o.sample(b).toVar(),S=Ji(ye(v.x,0,v.y),ye(0,1,0),ye(v.z,0,v.w)).toVar(),T=Kc.mul(y.x).add(Kc.oneMinus().mul(y.y)).toVar();s.directSpecular.addAssign(e.mul(T).mul(GC({N:p,V:m,P:_,mInv:S,p0:l,p1:c,p2:d,p3:f}))),s.directDiffuse.addAssign(e.mul(Xc).mul(GC({N:p,V:m,P:_,mInv:Ji(1,0,0,0,1,0,0,0,1),p0:l,p1:c,p2:d,p3:f})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context,r=t.mul(Hh({diffuseColor:Xc})).toVar();if(this.sheen===!0){const s=gf({normal:Qt,viewDir:Nn,roughness:su}),a=hs.r.max(hs.g).max(hs.b).mul(s).oneMinus();r.mulAssign(a)}n.indirectDiffuse.addAssign(r)}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(hs,gf({normal:Qt,viewDir:Nn,roughness:su}))),this.clearcoat===!0){const v=Zc.dot(Nn).clamp(),y=v3({dotNV:v,specularColor:Ux,specularF90:Ox,roughness:G0});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(y))}const s=ye().toVar("singleScatteringDielectric"),a=ye().toVar("multiScatteringDielectric"),o=ye().toVar("singleScatteringMetallic"),l=ye().toVar("multiScatteringMetallic");this.computeMultiscattering(s,a,Vf,Ru,this.iridescenceF0Dielectric),this.computeMultiscattering(o,l,Vf,_n.rgb,this.iridescenceF0Metallic);const c=wn(s,o,al),d=wn(a,l,al),f=s.add(a),p=Xc.mul(f.oneMinus()),m=n.mul(1/Math.PI),_=t.mul(c).add(d.mul(m)).toVar(),b=p.mul(m).toVar();if(this.sheen===!0){const v=gf({normal:Qt,viewDir:Nn,roughness:su}),y=hs.r.max(hs.g).max(hs.b).mul(v).oneMinus();_.mulAssign(y),b.mulAssign(y)}r.indirectSpecular.addAssign(_),r.indirectDiffuse.addAssign(b)}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,s=Qt.dot(Nn).clamp().add(t),a=ro.mul(-16).oneMinus().negate().exp2(),o=t.sub(s.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(o)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=Zc.dot(Nn).clamp(),r=mp({dotVH:n,f0:Ux,f90:Ox}),s=t.mul(Jb.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(Jb));t.assign(s)}if(this.sheen===!0){const n=t.add(this.sheenSpecularDirect,this.sheenSpecularIndirect.mul(1/Math.PI));t.assign(n)}}}const QC=_e(1),cw=_e(-2),Ym=_e(.8),Bx=_e(-1),Km=_e(.4),zx=_e(2),Zm=_e(.305),Gx=_e(3),JC=_e(.21),fW=_e(4),e2=_e(4),pW=_e(16),gW=Se(([i])=>{const e=ye(Kr(i)).toVar(),t=_e(-1).toVar();return Sn(e.x.greaterThan(e.z),()=>{Sn(e.x.greaterThan(e.y),()=>{t.assign(Pr(i.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Pr(i.y.greaterThan(0),1,4))})}).Else(()=>{Sn(e.z.greaterThan(e.y),()=>{t.assign(Pr(i.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Pr(i.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),mW=Se(([i,e])=>{const t=st().toVar();return Sn(e.equal(0),()=>{t.assign(st(i.z,i.y).div(Kr(i.x)))}).ElseIf(e.equal(1),()=>{t.assign(st(i.x.negate(),i.z.negate()).div(Kr(i.y)))}).ElseIf(e.equal(2),()=>{t.assign(st(i.x.negate(),i.y).div(Kr(i.z)))}).ElseIf(e.equal(3),()=>{t.assign(st(i.z.negate(),i.y).div(Kr(i.x)))}).ElseIf(e.equal(4),()=>{t.assign(st(i.x.negate(),i.z).div(Kr(i.y)))}).Else(()=>{t.assign(st(i.x,i.y).div(Kr(i.z)))}),Bt(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),_W=Se(([i])=>{const e=_e(0).toVar();return Sn(i.greaterThanEqual(Ym),()=>{e.assign(QC.sub(i).mul(Bx.sub(cw)).div(QC.sub(Ym)).add(cw))}).ElseIf(i.greaterThanEqual(Km),()=>{e.assign(Ym.sub(i).mul(zx.sub(Bx)).div(Ym.sub(Km)).add(Bx))}).ElseIf(i.greaterThanEqual(Zm),()=>{e.assign(Km.sub(i).mul(Gx.sub(zx)).div(Km.sub(Zm)).add(zx))}).ElseIf(i.greaterThanEqual(JC),()=>{e.assign(Zm.sub(i).mul(fW.sub(Gx)).div(Zm.sub(JC)).add(Gx))}).Else(()=>{e.assign(_e(-2).mul(go(Bt(1.16,i))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),yW=Se(([i,e])=>{const t=i.toVar();t.assign(Bt(2,t).sub(1));const n=ye(t,1).toVar();return Sn(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),vW=Se(([i,e,t,n,r,s])=>{const a=_e(t),o=ye(e),l=_l(_W(a),cw,s),c=Ma(l),d=mu(l),f=ye(_p(i,o,d,n,r,s)).toVar();return Sn(c.notEqual(0),()=>{const p=ye(_p(i,o,d.add(1),n,r,s)).toVar();f.assign(wn(f,p,c))}),f}),_p=Se(([i,e,t,n,r,s])=>{const a=_e(t).toVar(),o=ye(e),l=_e(gW(o)).toVar(),c=_e(Ii(e2.sub(a),0)).toVar();a.assign(Ii(a,e2));const d=_e(pp(a)).toVar(),f=st(mW(o,l).mul(d.sub(2)).add(1)).toVar();return Sn(l.greaterThan(2),()=>{f.y.addAssign(d),l.subAssign(3)}),f.x.addAssign(l.mul(d)),f.x.addAssign(c.mul(Bt(3,pW))),f.y.addAssign(Bt(4,pp(s).sub(d))),f.x.mulAssign(n),f.y.mulAssign(r),i.sample(f).grad(st(),st())}),Vx=Se(({envMap:i,mipInt:e,outputDirection:t,theta:n,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const l=ga(n),c=t.mul(l).add(r.cross(t).mul(Yr(n))).add(r.mul(r.dot(t).mul(l.oneMinus())));return _p(i,c,e,s,a,o)}),xW=Se(({n:i,latitudinal:e,poleAxis:t,outputDirection:n,weights:r,samples:s,dTheta:a,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:f})=>{const p=ye(Pr(e,t,Pu(t,n))).toVar();Sn(p.equal(ye(0)),()=>{p.assign(ye(n.z,0,n.x.negate()))}),p.assign(qs(p));const m=ye().toVar();return m.addAssign(r.element(0).mul(Vx({theta:0,axis:p,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:f}))),fs({start:Dn(1),end:i},({i:_})=>{Sn(_.greaterThanEqual(s),()=>{lH()});const b=_e(a.mul(_e(_))).toVar();m.addAssign(r.element(_).mul(Vx({theta:b.mul(-1),axis:p,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:f}))),m.addAssign(r.element(_).mul(Vx({theta:b,axis:p,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:f})))}),kt(m,1)}),bW=Se(([i])=>{const e=Wt(i).toVar();return e.assign(e.shiftLeft(Wt(16)).bitOr(e.shiftRight(Wt(16)))),e.assign(e.bitAnd(Wt(1431655765)).shiftLeft(Wt(1)).bitOr(e.bitAnd(Wt(2863311530)).shiftRight(Wt(1)))),e.assign(e.bitAnd(Wt(858993459)).shiftLeft(Wt(2)).bitOr(e.bitAnd(Wt(3435973836)).shiftRight(Wt(2)))),e.assign(e.bitAnd(Wt(252645135)).shiftLeft(Wt(4)).bitOr(e.bitAnd(Wt(4042322160)).shiftRight(Wt(4)))),e.assign(e.bitAnd(Wt(16711935)).shiftLeft(Wt(8)).bitOr(e.bitAnd(Wt(4278255360)).shiftRight(Wt(8)))),_e(e).mul(23283064365386963e-26)}),wW=Se(([i,e])=>st(_e(i).div(_e(e)),bW(i))),SW=Se(([i,e,t])=>{const n=ye(e).toVar(),r=_e(t),s=r.mul(r).toVar(),a=qs(ye(s.mul(n.x),s.mul(n.y),n.z)).toVar(),o=a.x.mul(a.x).add(a.y.mul(a.y)),l=Pr(o.greaterThan(0),ye(a.y.negate(),a.x,0).div(uo(o)),ye(1,0,0)).toVar(),c=Pu(a,l).toVar(),d=uo(i.x),f=Bt(2,3.14159265359).mul(i.y),p=d.mul(ga(f)).toVar(),m=d.mul(Yr(f)).toVar(),_=Bt(.5,a.z.add(1));m.assign(_.oneMinus().mul(uo(p.mul(p).oneMinus())).add(_.mul(m)));const b=l.mul(p).add(c.mul(m)).add(a.mul(uo(Ii(0,p.mul(p).add(m.mul(m)).oneMinus()))));return qs(ye(s.mul(b.x),s.mul(b.y),Ii(0,b.z)))}),TW=Se(({roughness:i,mipInt:e,envMap:t,N_immutable:n,GGX_SAMPLES:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const l=ye(n).toVar(),c=ye(0).toVar(),d=_e(0).toVar();return Sn(i.lessThan(.001),()=>{c.assign(_p(t,l,e,s,a,o))}).Else(()=>{const f=Pr(Kr(l.z).lessThan(.999),ye(0,0,1),ye(1,0,0)),p=qs(Pu(f,l)).toVar(),m=Pu(l,p).toVar();fs({start:Wt(0),end:r},({i:_})=>{const b=wW(_,r),v=SW(b,ye(0,0,1),i),y=qs(p.mul(v.x).add(m.mul(v.y)).add(l.mul(v.z))),S=qs(y.mul(Nu(l,y).mul(2)).sub(l)),T=Ii(Nu(l,S),0);Sn(T.greaterThan(0),()=>{const E=_p(t,S,e,s,a,o);c.addAssign(E.mul(T)),d.addAssign(T)})}),Sn(d.greaterThan(0),()=>{c.assign(c.div(d))})}),kt(c,1)}),ol=4,t2=[.125,.215,.35,.446,.526,.582],lu=20,MW=512,mf=new Qh(-1,1,1,-1,0,1),AW=new Mi(90,1),n2=new _t;let jx=null,Hx=0,Wx=0;const EW=new X,j0=new WeakMap,CW=[3,1,5,0,4,2],$x=yW(rd(),yl("faceIndex")).normalize(),b_=ye($x.x,$x.y,$x.z);class RW{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._ggxMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:o=EW,renderTarget:l=null}=s;if(this._setSize(a),this._hasInitialized===!1){Ae('PMREMGenerator: ".fromScene()" called before the backend is initialized. Try using "await renderer.init()" instead.');const d=l||this._allocateTarget();return s.renderTarget=d,this.fromSceneAsync(e,t,n,r,s),d}jx=this._renderer.getRenderTarget(),Hx=this._renderer.getActiveCubeFace(),Wx=this._renderer.getActiveMipmapLevel();const c=l||this._allocateTarget();return c.depthBuffer=!0,this._init(c),this._sceneToCubeUV(e,n,r,c,o),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}async fromSceneAsync(e,t=0,n=.1,r=100,s={}){return Fn('PMREMGenerator: ".fromSceneAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this.fromScene(e,t,n,r,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){Ae('PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using "await renderer.init()" instead.'),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return Fn('PMREMGenerator: ".fromEquirectangularAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){Ae("PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return Fn('PMREMGenerator: ".fromCubemapAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=r2(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=s2(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===Xs||e.mapping===wa?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(jx,Hx,Wx),e.scissorTest=!1,zc(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),jx=this._renderer.getRenderTarget(),Hx=this._renderer.getActiveCubeFace(),Wx=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return i2(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=i2(e.width,e.height);const{_lodMax:t}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=NW(t)),this._blurMaterial=PW(t,e.width,e.height),this._ggxMaterial=DW(t,e.width,e.height)}}async _compileMaterial(e){const t=new pi(new es,e);await this._renderer.compile(t,mf)}_sceneToCubeUV(e,t,n,r,s){const a=AW;a.near=t,a.far=n;const o=[1,1,1,1,-1,1],l=[1,-1,1,-1,1,-1],c=this._renderer,d=c.autoClear;c.getClearColor(n2),c.autoClear=!1,this._backgroundBox===null&&(this._backgroundBox=new pi(new Lu,new ma({name:"PMREM.Background",side:En,depthWrite:!1,depthTest:!1})));const f=this._backgroundBox,p=f.material;let m=!1;const _=e.background;_?_.isColor&&(p.color.copy(_),e.background=null,m=!0):(p.color.copy(n2),m=!0),c.setRenderTarget(r),c.clear(),m&&c.render(f,a);for(let b=0;b<6;b++){const v=b%3;v===0?(a.up.set(0,o[b],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x+l[b],s.y,s.z)):v===1?(a.up.set(0,0,o[b]),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y+l[b],s.z)):(a.up.set(0,o[b],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y,s.z+l[b]));const y=this._cubeSize;zc(r,v*y,b>2?y:0,y,y),c.render(e,a)}c.autoClear=d,e.background=_}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Xs||e.mapping===wa;r?this._cubemapMaterial===null&&(this._cubemapMaterial=r2(e)):this._equirectMaterial===null&&(this._equirectMaterial=s2(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=s;const o=this._cubeSize;zc(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,mf)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const l=j0.get(a),c=n/(this._lodMeshes.length-1),d=t/(this._lodMeshes.length-1),f=Math.sqrt(c*c-d*d),p=0+c*1.25,m=f*p,{_lodMax:_}=this,b=this._sizeLods[n],v=3*b*(n>_-ol?n-_+ol:0),y=4*(this._cubeSize-b);e.texture.frame=(e.texture.frame||0)+1,l.envMap.value=e.texture,l.roughness.value=m,l.mipInt.value=_-t,zc(s,v,y,3*b,2*b),r.setRenderTarget(s),r.render(o,mf),s.texture.frame=(s.texture.frame||0)+1,l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=_-n,zc(e,v,y,3*b,2*b),r.setRenderTarget(e),r.render(o,mf)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Ee("blur direction must be either latitudinal or longitudinal!");const d=3,f=this._lodMeshes[r];f.material=c;const p=j0.get(c),m=this._sizeLods[n]-1,_=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*lu-1),b=s/_,v=isFinite(s)?1+Math.floor(d*b):lu;v>lu&&Ae(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${lu}`);const y=[];let S=0;for(let C=0;C<lu;++C){const D=C/b,R=Math.exp(-D*D/2);y.push(R),C===0?S+=R:C<v&&(S+=2*R)}for(let C=0;C<y.length;C++)y[C]=y[C]/S;e.texture.frame=(e.texture.frame||0)+1,p.envMap.value=e.texture,p.samples.value=v,p.weights.array=y,p.latitudinal.value=a==="latitudinal"?1:0,o&&(p.poleAxis.value=o);const{_lodMax:T}=this;p.dTheta.value=_,p.mipInt.value=T-n;const E=this._sizeLods[r],N=3*E*(r>T-ol?r-T+ol:0),M=4*(this._cubeSize-E);zc(t,N,M,3*E,2*E),l.setRenderTarget(t),l.render(f,mf)}}function NW(i){const e=[],t=[],n=[];let r=i;const s=i-ol+1+t2.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);e.push(o);let l=1/o;a>i-ol?l=t2[a-i+ol-1]:a===0&&(l=0),t.push(l);const c=1/(o-2),d=-c,f=1+c,p=[d,d,f,d,f,f,d,d,f,f,d,f],m=6,_=6,b=3,v=2,y=1,S=new Float32Array(b*_*m),T=new Float32Array(v*_*m),E=new Float32Array(y*_*m);for(let M=0;M<m;M++){const C=M%3*2/3-1,D=M>2?0:-1,R=[C,D,0,C+2/3,D,0,C+2/3,D+1,0,C,D,0,C+2/3,D+1,0,C,D+1,0],P=CW[M];S.set(R,b*_*P),T.set(p,v*_*P);const L=[P,P,P,P,P,P];E.set(L,y*_*P)}const N=new es;N.setAttribute("position",new Ki(S,b)),N.setAttribute("uv",new Ki(T,v)),N.setAttribute("faceIndex",new Ki(E,y)),n.push(new pi(N,null)),r>ol&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function i2(i,e){const t={magFilter:In,minFilter:In,generateMipmaps:!1,type:Wn,format:Jn,colorSpace:Mu},n=new Iu(i,e,t);return n.texture.mapping=xu,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function zc(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function w_(i){const e=new ni;return e.depthTest=!1,e.depthWrite=!1,e.blending=pr,e.name=`PMREM_${i}`,e}function PW(i,e,t){const n=Vs(new Array(lu).fill(0)),r=Mt(new X(0,1,0)),s=Mt(0),a=_e(lu),o=Mt(0),l=Mt(1),c=kn(),d=Mt(0),f=_e(1/e),p=_e(1/t),m=_e(i),_={n:a,latitudinal:o,weights:n,poleAxis:r,outputDirection:b_,dTheta:s,samples:l,envMap:c,mipInt:d,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:m},b=w_("blur");return b.fragmentNode=xW({..._,latitudinal:o.equal(1)}),j0.set(b,_),b}function DW(i,e,t){const n=kn(),r=Mt(0),s=Mt(0),a=_e(1/e),o=_e(1/t),l=_e(i),c={envMap:n,roughness:r,mipInt:s,CUBEUV_TEXEL_WIDTH:a,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l},d=w_("ggx");return d.fragmentNode=TW({...c,N_immutable:b_,GGX_SAMPLES:Wt(MW)}),j0.set(d,c),d}function r2(i){const e=w_("cubemap");return e.fragmentNode=Cr(i,b_),e}function s2(i){const e=w_("equirect");return e.fragmentNode=kn(i,h3(b_),0),e}const a2=new WeakMap;function kW(i){const e=Math.log2(i)-2,t=1/i;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:t,maxMip:e}}function IW(i,e,t){const n=LW(e);let r=n.get(i);if((r!==void 0?r.pmremVersion:-1)!==i.pmremVersion){const a=i.image;if(i.isCubeTexture)if(UW(a))r=t.fromCubemap(i,r);else return null;else if(OW(a))r=t.fromEquirectangular(i,r);else return null;r.pmremVersion=i.pmremVersion,n.set(i,r)}return r.texture}function LW(i){let e=a2.get(i);return e===void 0&&(e=new WeakMap,a2.set(i,e)),e}class FW extends oi{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new er;r.isRenderTargetTexture=!0,this._texture=kn(r),this._width=Mt(0),this._height=Mt(0),this._maxMip=Mt(0),this.updateBeforeType=Ut.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=kW(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=IW(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new RW(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this,e)),t=qP.mul(ye(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),vW(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function UW(i){if(i==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)i[n]!==void 0&&e++;return e===t}function OW(i){return i==null?!1:i.height>0}const S3=on(FW).setParameterLength(1,3),o2=new WeakMap;class BW extends ld{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const f=n.isTextureNode?n.value:t[n.property];let p=o2.get(f);p===void 0&&(p=S3(f),o2.set(f,p)),n=p}const s=t.useAnisotropy===!0||t.anisotropy>0?c7:Qt,a=n.context(l2(ro,s)).mul(Ix),o=n.context(zW(od)).mul(Math.PI).mul(Ix),l=Wf(a),c=Wf(o);e.context.radiance.addAssign(l),e.context.iblIrradiance.addAssign(c);const d=e.context.lightingModel.clearcoatRadiance;if(d){const f=n.context(l2(G0,Zc)).mul(Ix),p=Wf(f);d.addAssign(p)}}}const l2=(i,e)=>{let t=null;return{getUV:()=>(t===null&&(t=Nn.negate().reflect(e),t=CP(i).mix(t,e).normalize(),t=t.transformDirection(xo)),t),getTextureLevel:()=>i}},zW=i=>({getUV:()=>i,getTextureLevel:()=>_e(1)}),GW=new YR;class T3 extends ni{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(GW),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new BW(t):null}setupLightingModel(){return new w3}setupSpecular(){const e=wn(ye(.04),_n.rgb,al);Ru.assign(ye(.04)),Kc.assign(e),Vf.assign(1)}setupVariants(){const e=this.metalnessNode?_e(this.metalnessNode):T7;al.assign(e);let t=this.roughnessNode?_e(this.roughnessNode):S7;t=_3({roughness:t}),ro.assign(t),this.setupSpecular(),Xc.assign(_n.rgb.mul(e.oneMinus()))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const VW=new yF;class jW extends T3{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(VW),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?_e(this.iorNode):O7;M0.assign(e),Ru.assign(Gh(EP(M0.sub(1).div(M0.add(1))).mul(w7),ye(1)).mul(kC)),Kc.assign(wn(Ru,_n.rgb,al)),Vf.assign(wn(kC,1,al))}setupLightingModel(){return new w3(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?_e(this.clearcoatNode):A7,n=this.clearcoatRoughnessNode?_e(this.clearcoatRoughnessNode):E7;Jb.assign(t),G0.assign(_3({roughness:n}))}if(this.useSheen){const t=this.sheenNode?ye(this.sheenNode):N7,n=this.sheenRoughnessNode?_e(this.sheenRoughnessNode):P7;hs.assign(t),su.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?_e(this.iridescenceNode):k7,n=this.iridescenceIORNode?_e(this.iridescenceIORNode):I7,r=this.iridescenceThicknessNode?_e(this.iridescenceThicknessNode):L7;LS.assign(t),ew.assign(n),tw.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?st(this.anisotropyNode):D7).toVar();nu.assign(t.length()),Sn(nu.equal(0),()=>{t.assign(st(1,0))}).Else(()=>{t.divAssign(st(nu)),nu.assign(nu.saturate())}),nw.assign(nu.pow2().mix(ro.pow2(),1)),T0.assign(Pf[0].mul(t.x).add(Pf[1].mul(t.y))),sh.assign(Pf[1].mul(t.x).sub(Pf[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?_e(this.transmissionNode):F7,n=this.thicknessNode?_e(this.thicknessNode):U7,r=this.attenuationDistanceNode?_e(this.attenuationDistanceNode):B7,s=this.attenuationColorNode?ye(this.attenuationColorNode):z7;if(rw.assign(t),uP.assign(n),cP.assign(r),hP.assign(s),this.useDispersion){const a=this.dispersionNode?_e(this.dispersionNode):$7;dP.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?ye(this.clearcoatNormalNode):C7}setup(e){e.context.setupClearcoatNormal=()=>Hf(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const HW=Se(({normal:i,lightDirection:e,builder:t})=>{const n=i.dot(e),r=st(n.mul(.5).add(.5),0);if(t.material.gradientMap){const s=il("gradientMap","texture").context({getUV:()=>r});return ye(s.r)}else{const s=r.fwidth().mul(.5);return wn(ye(.7),ye(1),_o(_e(.7).sub(s.x),_e(.7).add(s.x),r.x))}});class WW extends v_{direct({lightDirection:e,lightColor:t,reflectedLight:n},r){const s=HW({normal:WP,lightDirection:e,builder:r}).mul(t);n.directDiffuse.addAssign(s.mul(Hh({diffuseColor:_n.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(n.mul(Hh({diffuseColor:_n}))),r.indirectDiffuse.mulAssign(t)}}const $W=new xF;class qW extends ni{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues($W),this.setValues(e)}setupLightingModel(){return new WW}}const XW=Se(()=>{const i=ye(Nn.z,0,Nn.x.negate()).normalize(),e=Nn.cross(i);return st(i.dot(Qt),e.dot(Qt)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),YW=new MF;class KW extends ni{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(YW),this.setValues(e)}setupVariants(e){const t=XW;let n;e.material.matcap?n=il("matcap","texture").context({getUV:()=>t}):n=ye(wn(.2,.8,t.y)),_n.rgb.mulAssign(n.rgb)}}class ZW extends oi{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),a=t.sin();return IS(s,a,a.negate(),s).mul(n)}else{const s=t,a=gu(kt(1,0,0,0),kt(0,ga(s.x),Yr(s.x).negate(),0),kt(0,Yr(s.x),ga(s.x),0),kt(0,0,0,1)),o=gu(kt(ga(s.y),0,Yr(s.y),0),kt(0,1,0,0),kt(Yr(s.y).negate(),0,ga(s.y),0),kt(0,0,0,1)),l=gu(kt(ga(s.z),Yr(s.z).negate(),0,0),kt(Yr(s.z),ga(s.z),0,0),kt(0,0,1,0),kt(0,0,0,1));return a.mul(o).mul(l).mul(kt(n,1)).xyz}}}const M3=on(ZW).setParameterLength(2),QW=new uF;class A3 extends ni{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(QW),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,{positionNode:r,rotationNode:s,scaleNode:a,sizeAttenuation:o}=this,l=Ip.mul(ye(r||0));let c=st(Du[0].xyz.length(),Du[1].xyz.length());a!==null&&(c=c.mul(st(a))),n.isPerspectiveCamera&&o===!1&&(c=c.mul(l.z.negate()));let d=y_.xy;if(t.center&&t.center.isVector2===!0){const m=u9("center","vec2",t);d=d.sub(m.sub(.5))}d=d.mul(c);const f=_e(s||R7),p=M3(d,f);return kt(l.xy.add(p),l.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const JW=new pF,e$=new Xe;class t$ extends A3{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(JW),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return Ip.mul(ye(e||Ai)).xyz}setupVertexSprite(e){const{material:t,camera:n}=e,{rotationNode:r,scaleNode:s,sizeNode:a,sizeAttenuation:o}=this;let l=super.setupVertex(e);if(t.isNodeMaterial!==!0)return l;let c=a!==null?st(a):W7;c=c.mul(U9),n.isPerspectiveCamera&&o===!0&&(c=c.mul(n$.div(ti.z.negate()))),s&&s.isNode&&(c=c.mul(st(s)));let d=y_.xy;if(r&&r.isNode){const f=_e(r);d=M3(d,f)}return d=d.mul(c),d=d.div(O9.div(2)),d=d.mul(l.w),l=l.add(kt(d,0,0)),l}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const n$=Mt(1).onFrameUpdate(function({renderer:i}){const e=i.getSize(e$);this.value=.5*e.y});class i$ extends v_{constructor(){super(),this.shadowNode=_e(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){_n.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(_n.rgb)}}const r$=new mF;class s$ extends ni{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(r$),this.setValues(e)}setupLightingModel(){return new i$}}pl("vec3");pl("vec3");pl("vec3");class a${constructor(e,t,n){this.renderer=e,this.nodes=t,this.info=n,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.renderer._inspector.begin(),this._animationLoop!==null&&this._animationLoop(t,n),this.renderer._inspector.finish()};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Ks{constructor(){this.weakMaps={}}_getWeakMap(e){const t=e.length;let n=this.weakMaps[t];return n===void 0&&(n=new WeakMap,this.weakMaps[t]=n),n}get(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this._getWeakMap(e);for(let r=0;r<e.length-1;r++){const s=e[r];n.has(s)===!1&&n.set(s,new WeakMap),n=n.get(s)}return n.set(e[e.length-1],t),this}delete(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}let o$=0;function l$(i){const e=Object.keys(i);let t=Object.getPrototypeOf(i);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const r in n)if(n[r]!==void 0){const s=n[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class u${constructor(e,t,n,r,s,a,o,l,c,d){this.id=o$++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=r,this.material=s,this.scene=a,this.camera=o,this.lightsNode=l,this.context=c,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=d,this.clippingContextCacheKey=d!==null?d.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getIndirectOffset(){return this._geometries.getIndirectOffset(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set,s={};for(const a of e){let o;if(a.node&&a.node.attribute?o=a.node.attribute:(o=t.getAttribute(a.name),s[a.name]=o.version),o===void 0)continue;n.push(o);const l=o.isInterleavedBufferAttribute?o.data:o;r.add(l)}return this.attributes=n,this.attributesId=s,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:s}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),o=this.getIndex(),l=o!==null;let c=1;if(n.isInstancedBufferGeometry===!0?c=n.instanceCount:e.count!==void 0&&(c=Math.max(0,e.count)),c===0)return null;if(a.instanceCount=c,e.isBatchedMesh===!0)return a;let d=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(d=2);let f=s.start*d,p=(s.start+s.count)*d;r!==null&&(f=Math.max(f,r.start*d),p=Math.min(p,(r.start+r.count)*d));const m=n.attributes.position;let _=1/0;l?_=o.count:m!=null&&(_=m.count),f=Math.max(f,0),p=Math.min(p,_);const b=p-f;return b<0||b===1/0?null:(a.vertexCount=b,a.firstVertex=f,a)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[n];t+="morph-"+n+",";for(let s=0,a=r.length;s<a;s++){const o=r[s];t+=o.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:n}=this;let r=t.customProgramCacheKey();for(const s of l$(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const a=t[s];let o;if(a!==null){const l=typeof a;l==="number"?o=a!==0?"1":"0":l==="object"?(o="{",a.isTexture&&(o+=a.mapping,n.backend.isWebGPUBackend===!0&&(o+=a.magFilter,o+=a.minFilter,o+=a.wrapS,o+=a.wrapT,o+=a.wrapR)),o+="}"):o=String(a)}else o=String(a);r+=o+","}return r+=this.clippingContextCacheKey+",",e.geometry&&(r+=this.getGeometryCacheKey()),e.skeleton&&(r+=e.skeleton.bones.length+","),e.isBatchedMesh&&(r+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(r+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1||Array.isArray(e.morphTargetInfluences))&&(r+=e.uuid+","),r+=this.context.id+",",r+=e.receiveShadow+",",p_(r)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const t in e){const n=this.geometry.getAttribute(t);if(n===void 0||e[t]!==n.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=zf(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=zf(e,1)),e=zf(e,this.camera.id,this.renderer.contextNode.id,this.renderer.contextNode.version),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Zl=[];class c${constructor(e,t,n,r,s,a){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=s,this.info=a,this.chainMaps={}}get(e,t,n,r,s,a,o,l){const c=this.getChainMap(l);Zl[0]=e,Zl[1]=t,Zl[2]=a,Zl[3]=s;let d=c.get(Zl);return d===void 0?(d=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,s,a,o,l),c.set(Zl,d)):(d.updateClipping(o),d.needsGeometryUpdate&&d.setGeometry(e.geometry),(d.version!==t.version||d.needsUpdate)&&(d.initialCacheKey!==d.getCacheKey()?(d.dispose(),d=this.get(e,t,n,r,s,a,o,l)):d.version=t.version)),Zl.length=0,d}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Ks)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,s,a,o,l,c,d,f){const p=this.getChainMap(f),m=new u$(e,t,n,r,s,a,o,l,c,d);return m.onDispose=()=>{this.pipelines.delete(m),this.bindings.deleteForRender(m),this.nodes.delete(m),p.delete(m.getChainArray())},m}}class bl{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const gs={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},rl=16,h$=211,d$=212;class f$ extends bl{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===gs.VERTEX?this.backend.createAttribute(e):t===gs.INDEX?this.backend.createIndexAttribute(e):t===gs.STORAGE?this.backend.createStorageAttribute(e):t===gs.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(n.version<r.version||r.usage===Yc)&&(this.backend.updateAttribute(e),n.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function E3(i){return i.index!==null?i.index.version:i.attributes.position.version}function u2(i){const e=[],t=i.index,n=i.attributes.position;if(t!==null){const s=t.array;for(let a=0,o=s.length;a<o;a+=3){const l=s[a+0],c=s[a+1],d=s[a+2];e.push(l,c,c,d,d,l)}}else{const s=n.array;for(let a=0,o=s.length/3-1;a<o;a+=3){const l=a+0,c=a+1,d=a+2;e.push(l,c,c,d,d,l)}}const r=new(Qw(e)?sS:rS)(e,1);return r.version=E3(i),r}class p$ extends bl{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap,this._geometryDisposeListeners=new Map}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,a=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of a)this.attributes.delete(l);const o=this.wireframes.get(t);o!==void 0&&this.attributes.delete(o),t.removeEventListener("dispose",r),this._geometryDisposeListeners.delete(t)};t.addEventListener("dispose",r),this._geometryDisposeListeners.set(t,r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,gs.STORAGE):this.updateAttribute(s,gs.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,gs.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,gs.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndirectOffset(e){return e.geometry.indirectOffset}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(n.wireframe===!0){const s=this.wireframes;let a=s.get(t);a===void 0?(a=u2(t),s.set(t,a)):a.version!==E3(t)&&(this.attributes.delete(a),a=u2(t),s.set(t,a)),r=a}return r}dispose(){for(const[e,t]of this._geometryDisposeListeners.entries())e.removeEventListener("dispose",t);this._geometryDisposeListeners.clear()}}class g${constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):Ee("WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class C3{constructor(e){this.cacheKey=e,this.usedTimes=0}}class m$ extends C3{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class _$ extends C3{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let y$=0;class qx{constructor(e,t,n,r=null,s=null){this.id=y$++,this.code=e,this.stage=t,this.name=n,this.transforms=r,this.attributes=s,this.usedTimes=0}}class v$ extends bl{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let o=this.programs.compute.get(a.computeShader);o===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),o=new qx(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,o),n.createProgram(o));const l=this._getComputeCacheKey(e,o);let c=this.caches.get(l);c===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),c=this._getComputePipeline(e,o,l,t)),c.usedTimes++,o.usedTimes++,r.version=e.version,r.pipeline=c}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),o=e.material?e.material.name:"";let l=this.programs.vertex.get(a.vertexShader);l===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),l=new qx(a.vertexShader,"vertex",o),this.programs.vertex.set(a.vertexShader,l),n.createProgram(l));let c=this.programs.fragment.get(a.fragmentShader);c===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),c=new qx(a.fragmentShader,"fragment",o),this.programs.fragment.set(a.fragmentShader,c),n.createProgram(c));const d=this._getRenderCacheKey(e,l,c);let f=this.caches.get(d);f===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),f=this._getRenderPipeline(e,l,c,d,t)):e.pipeline=f,f.usedTimes++,l.usedTimes++,c.usedTimes++,r.pipeline=f}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let s=this.caches.get(n);return s===void 0&&(s=new _$(n,t),this.caches.set(n,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,n,r,s){r=r||this._getRenderCacheKey(e,t,n);let a=this.caches.get(r);return a===void 0&&(a=new m$(r,t,n),this.caches.set(r,a),e.pipeline=a,this.backend.createRenderPipeline(e,s)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class x$ extends bl{constructor(e,t,n,r,s,a){super(),this.backend=e,this.textures=n,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=a,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const r=this.get(n);r.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),r.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}deleteForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}deleteForRender(e){const t=e.getBindings();for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isSampler)this.textures.updateSampler(t.texture);else if(t.isStorageBuffer){const n=t.attribute,r=n.isIndirectStorageBufferAttribute?gs.INDIRECT:gs.STORAGE;this.attributes.update(n,r)}}_update(e,t){const{backend:n}=this;let r=!1,s=!0,a=0,o=0;for(const l of e.bindings)if(this.nodes.updateGroup(l)!==!1){if(l.isStorageBuffer){const d=l.attribute,f=d.isIndirectStorageBufferAttribute?gs.INDIRECT:gs.STORAGE;this.attributes.update(d,f)}if(l.isUniformBuffer)l.update()&&n.updateBinding(l);else if(l.isSampledTexture){const d=l.update(),f=l.texture,p=this.textures.get(f);if(d&&(this.textures.updateTexture(f),l.generation!==p.generation&&(l.generation=p.generation,r=!0,s=!1)),n.get(f).externalTexture!==void 0||p.isDefaultTexture?s=!1:(a=a*10+f.id,o+=f.version),f.isStorageTexture===!0&&f.mipmapsAutoUpdate===!0){const _=this.get(f);l.store===!0?_.needsMipmap=!0:this.textures.needsMipmaps(f)&&_.needsMipmap===!0&&(this.backend.generateMipmaps(f),_.needsMipmap=!1)}}else if(l.isSampler&&l.update()){const f=this.textures.updateSampler(l.texture);l.samplerKey!==f&&(l.samplerKey=f,r=!0,s=!1)}}r===!0&&this.backend.updateBindings(e,t,s?a:0,o)}}function b$(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?i.z-e.z:i.id-e.id}function c2(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function h2(i){return(i.transmission>0||i.transmissionNode&&i.transmissionNode.isNode)&&i.side===Xi&&i.forceSinglePass===!1}class w${constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,s,a,o){let l=this.renderItems[this.renderItemsIndex];return l===void 0?(l={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:s,group:a,clippingContext:o},this.renderItems[this.renderItemsIndex]=l):(l.id=e.id,l.object=e,l.geometry=t,l.material=n,l.groupOrder=r,l.renderOrder=e.renderOrder,l.z=s,l.group=a,l.clippingContext=o),this.renderItemsIndex++,l}push(e,t,n,r,s,a,o){const l=this.getNextRenderItem(e,t,n,r,s,a,o);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(h2(n)&&this.transparentDoublePass.push(l),this.transparent.push(l)):this.opaque.push(l)}unshift(e,t,n,r,s,a,o){const l=this.getNextRenderItem(e,t,n,r,s,a,o);n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(h2(n)&&this.transparentDoublePass.unshift(l),this.transparent.unshift(l)):this.opaque.unshift(l)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||b$),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||c2),this.transparent.length>1&&this.transparent.sort(t||c2)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const _f=[];class S${constructor(e){this.lighting=e,this.lists=new Ks}get(e,t){const n=this.lists;_f[0]=e,_f[1]=t;let r=n.get(_f);return r===void 0&&(r=new w$(this.lighting,e,t),n.set(_f,r)),_f.length=0,r}dispose(){this.lists=new Ks}}let T$=0;class M${constructor(){this.id=T$++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new It,this.scissor=!1,this.scissorValue=new It,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return R3(this)}}function R3(i){const{textures:e,activeCubeFace:t,activeMipmapLevel:n}=i,r=[t,n];for(const s of e)r.push(s.id);return Pp(r)}const Gc=[],A$=new n_,E$=new aS;class C${constructor(){this.chainMaps={}}get(e,t,n=null,r=null){Gc[0]=e,Gc[1]=t,r!==null&&(Gc[2]=r);let s;if(n===null)s="default";else{const l=n.texture.format;s=`${n.textures.length}:${l}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const a=this._getChainMap(s);let o=a.get(Gc);return o===void 0&&(o=new M$,a.set(Gc,o)),Gc.length=0,n!==null&&(o.sampleCount=n.samples===0?1:n.samples),o}getForClear(e=null){return this.get(A$,E$,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Ks)}dispose(){this.chainMaps={}}}const R$=new X;class N$ extends bl{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=e.samples===0?1:e.samples,s=n.depthTextureMips||(n.depthTextureMips={}),a=e.textures,o=this.getSize(a[0]),l=o.width>>t,c=o.height>>t;let d=e.depthTexture||s[t];const f=e.depthBuffer===!0||e.stencilBuffer===!0;let p=!1;d===void 0&&f&&(d=new gr,d.format=e.stencilBuffer?hr:ki,d.type=e.stencilBuffer?Jr:yn,d.image.width=l,d.image.height=c,d.image.depth=o.depth,d.renderTarget=e,d.isArrayTexture=e.multiview===!0&&o.depth>1,s[t]=d),(n.width!==o.width||o.height!==n.height)&&(p=!0,d&&(d.needsUpdate=!0,d.image.width=l,d.image.height=c,d.image.depth=d.isArrayTexture?d.image.depth:1)),n.width=o.width,n.height=o.height,n.textures=a,n.depthTexture=d||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(p=!0,d&&(d.needsUpdate=!0),n.sampleCount=r);const m={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let _=0;_<a.length;_++){const b=a[_];p&&(b.needsUpdate=!0),this.updateTexture(b,m)}d&&this.updateTexture(d,m)}n.initialized!==!0&&(n.initialized=!0,n.onDispose=()=>{this._destroyRenderTarget(e)},e.addEventListener("dispose",n.onDispose))}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&n.initialized===!0&&s.destroyTexture(e),e.isFramebufferTexture){const c=this.renderer.getRenderTarget();c?e.type=c.texture.type:e.type=Un}const{width:a,height:o,depth:l}=this.getSize(e);if(t.width=a,t.height=o,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,o):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,r||e.isStorageTexture===!0||e.isExternalTexture===!0)s.createTexture(e,t),n.generation=e.version;else if(e.version>0){const c=e.image;if(c===void 0)Ae("Renderer: Texture marked for update but image is undefined.");else if(c.complete===!1)Ae("Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const f=[];for(const p of e.images)f.push(p);t.images=f}else t.image=c;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(s.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t);const d=e.isStorageTexture===!0&&e.mipmapsAutoUpdate===!1;t.needsMipmaps&&e.mipmaps.length===0&&!d&&s.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else s.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;n.initialized!==!0&&(n.initialized=!0,n.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&bt.enabled===!0&&bt.getTransfer(e.colorSpace)!==Ze&&Ae("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace."),n.onDispose=()=>{this._destroyTexture(e)},e.addEventListener("dispose",n.onDispose)),n.version=e.version}updateSampler(e){return this.backend.updateSampler(e)}getSize(e,t=R$){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?(t.width=n.videoWidth||1,t.height=n.videoHeight||1,t.depth=1):typeof VideoFrame<"u"&&n instanceof VideoFrame?(t.width=n.displayWidth||1,t.height=n.displayHeight||1,t.depth=1):(t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return e.mipmaps.length>0?r=e.mipmaps.length:e.isCompressedTexture===!0?r=1:r=Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return e.generateMipmaps===!0||e.mipmaps.length>0}_destroyRenderTarget(e){if(this.has(e)===!0){const t=this.get(e),n=t.textures,r=t.depthTexture;e.removeEventListener("dispose",t.onDispose);for(let s=0;s<n.length;s++)this._destroyTexture(n[s]);r&&this._destroyTexture(r),this.delete(e),this.backend.delete(e)}}_destroyTexture(e){if(this.has(e)===!0){const t=this.get(e);e.removeEventListener("dispose",t.onDispose);const n=t.isDefaultTexture;this.backend.destroyTexture(e,n),this.delete(e),this.info.memory.textures--}}}class YS extends _t{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class P$ extends dn{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getMemberType(e,t){const n=this.getNodeType(e),r=e.getStructTypeNode(n);let s;return r!==null?s=r.getMemberType(e,t):(Ee(`TSL: Member "${t}" not found in struct "${n}".`),s="float"),s}getHash(){return this.uuid}generate(){return this.name}}class D$ extends ft{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this._currentNode=null,this.isStackNode=!0}getElementType(e){return this.hasOutput?this.outputNode.getElementType(e):"void"}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}addToStack(e,t=this.nodes.length){return e.isNode!==!0?(Ee("TSL: Invalid node added to stack."),this):(this.nodes.splice(t,0,e),this)}addToStackBefore(e){const t=this._currentNode?this.nodes.indexOf(this._currentNode):0;return this.addToStack(e,t)}If(e,t){const n=new Nf(t);return this._currentCond=Pr(e,n),this.addToStack(this._currentCond)}ElseIf(e,t){const n=new Nf(t),r=Pr(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new Nf(e),this}Switch(e){return this._expressionNode=Qe(e),this}Case(...e){const t=[];if(e.length>=2)for(let o=0;o<e.length-1;o++)t.push(this._expressionNode.equal(Qe(e[o])));else Ee("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],r=new Nf(n);let s=t[0];for(let o=1;o<t.length;o++)s=s.or(t[o]);const a=Pr(s,r);return this._currentCond===null?(this._currentCond=a,this.addToStack(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())r.isVarNode&&r.isIntent(e)&&r.isAssign(e)!==!0||(t["node"+n++]=r);return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...t){const n=nP(),r=e.buildStage;B0(this),e.setActiveStack(this);const s=c=>{if(this._currentNode=c,!(c.isVarNode&&c.isIntent(e)&&c.isAssign(e)!==!0)){if(r==="setup")c.build(e);else if(r==="analyze")c.build(e,this);else if(r==="generate"){const d=e.getDataFromNode(c,"any").stages,f=d&&d[e.shaderStage];if(c.isVarNode&&f&&f.length===1&&f[0]&&f[0].isStackNode)return;c.build(e,"void")}}},a=[...this.nodes];for(const c of a)s(c);this._currentNode=null;const o=this.nodes.filter(c=>a.indexOf(c)===-1);for(const c of o)s(c);let l;return this.hasOutput?l=this.outputNode.build(e,...t):l=super.build(e,...t),B0(n),e.removeActiveStack(this),l}}const Xx=on(D$).setParameterLength(0,1);class N3 extends oi{static get type(){return"BitcastNode"}constructor(e,t,n=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=n,this.isBitcastNode=!0}getNodeType(e){if(this.inputType!==null){const t=this.valueNode.getNodeType(e),n=e.getTypeLength(t);return e.getTypeFromLength(n,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let n="";if(this.inputType!==null){const r=this.valueNode.getNodeType(e);n=e.getTypeLength(r)===1?this.inputType:e.changeComponentType(r,this.inputType)}else n=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,n)}( ${this.valueNode.build(e,n)} )`}}const k$=tt(N3).setParameterLength(2),I$=i=>new N3(i,"uint","float"),Qm={};class yu extends oe{static get type(){return"BitcountNode"}constructor(e,t){super(e,t),this.isBitcountNode=!0}_resolveElementType(e,t,n){n==="int"?t.assign(k$(e,"uint")):t.assign(e)}_returnDataNode(e){switch(e){case"uint":return Wt;case"int":return Dn;case"uvec2":return rP;case"uvec3":return aP;case"uvec4":return lP;case"ivec2":return pa;case"ivec3":return sP;case"ivec4":return oP}}_createTrailingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return Se(([s])=>{const a=Wt(0);this._resolveElementType(s,a,t);const o=_e(a.bitAnd(wP(a))),c=I$(o).shiftRight(23).sub(127);return n(c)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createLeadingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return Se(([s])=>{Sn(s.equal(Wt(0)),()=>Wt(32));const a=Wt(0),o=Wt(0);return this._resolveElementType(s,a,t),Sn(a.shiftRight(16).equal(0),()=>{o.addAssign(16),a.shiftLeftAssign(16)}),Sn(a.shiftRight(24).equal(0),()=>{o.addAssign(8),a.shiftLeftAssign(8)}),Sn(a.shiftRight(28).equal(0),()=>{o.addAssign(4),a.shiftLeftAssign(4)}),Sn(a.shiftRight(30).equal(0),()=>{o.addAssign(2),a.shiftLeftAssign(2)}),Sn(a.shiftRight(31).equal(0),()=>{o.addAssign(1)}),n(o)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createOneBitsBaseLayout(e,t){const n=this._returnDataNode(t);return Se(([s])=>{const a=Wt(0);this._resolveElementType(s,a,t),a.assign(a.sub(a.shiftRight(Wt(1)).bitAnd(Wt(1431655765)))),a.assign(a.bitAnd(Wt(858993459)).add(a.shiftRight(Wt(2)).bitAnd(Wt(858993459))));const o=a.add(a.shiftRight(Wt(4))).bitAnd(Wt(252645135)).mul(Wt(16843009)).shiftRight(Wt(24));return n(o)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createMainLayout(e,t,n,r){const s=this._returnDataNode(t);return Se(([o])=>{if(n===1)return s(r(o));{const l=s(0),c=["x","y","z","w"];for(let d=0;d<n;d++){const f=c[d];l[f].assign(r(o[f]))}return l}}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}setup(e){const{method:t,aNode:n}=this,{renderer:r}=e;if(r.backend.isWebGPUBackend)return super.setup(e);const s=this.getInputType(e),a=e.getElementType(s),o=e.getTypeLength(s),l=`${t}_base_${a}`,c=`${t}_${s}`;let d=Qm[l];if(d===void 0){switch(t){case yu.COUNT_LEADING_ZEROS:{d=this._createLeadingZerosBaseLayout(l,a);break}case yu.COUNT_TRAILING_ZEROS:{d=this._createTrailingZerosBaseLayout(l,a);break}case yu.COUNT_ONE_BITS:{d=this._createOneBitsBaseLayout(l,a);break}}Qm[l]=d}let f=Qm[c];return f===void 0&&(f=this._createMainLayout(c,s,o,d),Qm[c]=f),Se(()=>f(n))()}}yu.COUNT_TRAILING_ZEROS="countTrailingZeros";yu.COUNT_LEADING_ZEROS="countLeadingZeros";yu.COUNT_ONE_BITS="countOneBits";new zs;new X;new X;new X;new hn;new X(0,0,-1);new It;new X;new X;new It;new Xe;const L$=new Iu;ah.flipX();L$.depthTexture=new gr(1,1);const Yx=new Qh(-1,1,1,-1,0,1);class F$ extends es{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new fi([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fi(t,2))}}const U$=new F$;class KS extends pi{constructor(e=null){super(U$,e),this.camera=Yx,this.isQuadMesh=!0}async renderAsync(e){Fn('QuadMesh: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await e.init(),e.render(this,Yx)}render(e){e.render(this,Yx)}}const P3=Se(([i])=>Ma(_e(52.9829189).mul(Ma(Nu(i,st(.06711056,.00583715)))))).setLayout({name:"interleavedGradientNoise",type:"float",inputs:[{name:"position",type:"vec2"}]}),_a=Se(([i,e,t])=>{const n=_e(2.399963229728653),r=uo(_e(i).add(.5).div(_e(e))),s=_e(i).mul(n).add(t);return st(ga(s),Yr(s)).mul(r)}).setLayout({name:"vogelDiskSample",type:"vec2",inputs:[{name:"sampleIndex",type:"int"},{name:"samplesCount",type:"int"},{name:"phi",type:"float"}]});class co extends ft{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===co.OBJECT?this.updateType=Ut.OBJECT:e===co.MATERIAL?this.updateType=Ut.RENDER:e===co.BEFORE_OBJECT?this.updateBeforeType=Ut.OBJECT:e===co.BEFORE_MATERIAL&&(this.updateBeforeType=Ut.RENDER)}update(e){this.callback(e)}updateBefore(e){this.callback(e)}}co.OBJECT="object";co.MATERIAL="material";co.BEFORE_OBJECT="beforeObject";co.BEFORE_MATERIAL="beforeMaterial";const yf=new ys,Kx=new hn;class kr extends ft{static get type(){return"SceneNode"}constructor(e=kr.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let r;return t===kr.BACKGROUND_BLURRINESS?r=bn("backgroundBlurriness","float",n):t===kr.BACKGROUND_INTENSITY?r=bn("backgroundIntensity","float",n):t===kr.BACKGROUND_ROTATION?r=Mt("mat4").setName("backgroundRotation").setGroup(wt).onRenderUpdate(()=>{const s=n.background;return s!==null&&s.isTexture&&s.mapping!==Hw?(yf.copy(n.backgroundRotation),yf.x*=-1,yf.y*=-1,yf.z*=-1,Kx.makeRotationFromEuler(yf)):Kx.identity(),Kx}):Ee("SceneNode: Unknown scope:",t),r}}kr.BACKGROUND_BLURRINESS="backgroundBlurriness";kr.BACKGROUND_INTENSITY="backgroundIntensity";kr.BACKGROUND_ROTATION="backgroundRotation";const O$=Oe(kr,kr.BACKGROUND_BLURRINESS),d2=Oe(kr,kr.BACKGROUND_INTENSITY),B$=Oe(kr,kr.BACKGROUND_ROTATION),z$=Se(({texture:i,uv:e})=>{const n=ye().toVar();return Sn(e.x.lessThan(1e-4),()=>{n.assign(ye(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(ye(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(ye(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(ye(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(ye(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(ye(0,0,-1))}).Else(()=>{const s=i.sample(e.add(ye(-.01,0,0))).r.sub(i.sample(e.add(ye(.01,0,0))).r),a=i.sample(e.add(ye(0,-.01,0))).r.sub(i.sample(e.add(ye(0,.01,0))).r),o=i.sample(e.add(ye(0,0,-.01))).r.sub(i.sample(e.add(ye(0,0,.01))).r);n.assign(ye(s,a,o))}),n.normalize()});class G$ extends sd{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return ye(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(Dn(_u(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return z$({texture:this,uv:e})}}const V$=on(G$).setParameterLength(1,3),Jm=new Xe;class j$ extends sd{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class f2 extends j${static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}class S_ extends oi{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new gr;s.isRenderTargetTexture=!0,s.name="depth";const a=new Iu(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Wn,...r});a.texture.name="output",a.depthTexture=s,this.renderTarget=a,this.overrideMaterial=null,this.transparent=!0,this.opaque=!0,this.contextNode=null,this._contextNodeCache=null,this._textures={output:a.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Mt(0),this._cameraFar=Mt(0),this._mrt=null,this._layers=null,this._resolutionScale=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=Ut.FRAME,this.global=!0}setResolutionScale(e){return this._resolutionScale=e,this}getResolutionScale(){return this._resolutionScale}setResolution(e){return Ae("PassNode: .setResolution() is deprecated. Use .setResolutionScale() instead."),this.setResolutionScale(e)}getResolution(){return Ae("PassNode: .getResolution() is deprecated. Use .getResolutionScale() instead."),this.getResolutionScale()}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=new f2(this,e),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=new f2(this,e,!0),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=o3(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=Xf(s,n,r)}return t}async compileAsync(e){const t=e.getRenderTarget(),n=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(n)}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getOutputBufferType(),this.scope===S_.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,s;const a=t.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),Jm.set(a.width,a.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(Jm)),this._pixelRatio=s,this.setSize(Jm.width,Jm.height);const o=t.getRenderTarget(),l=t.getMRT(),c=t.autoClear,d=t.transparent,f=t.opaque,p=r.layers.mask,m=t.contextNode,_=n.overrideMaterial;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const v in this._previousTextures)this.toggleTexture(v);this.overrideMaterial!==null&&(n.overrideMaterial=this.overrideMaterial),t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.autoClear=!0,t.transparent=this.transparent,t.opaque=this.opaque,this.contextNode!==null&&((this._contextNodeCache===null||this._contextNodeCache.version!==this.version)&&(this._contextNodeCache={version:this.version,context:Uu({...t.contextNode.getFlowContextData(),...this.contextNode.getFlowContextData()})}),t.contextNode=this._contextNodeCache.context);const b=n.name;n.name=this.name?this.name:n.name,t.render(n,r),n.name=b,n.overrideMaterial=_,t.setRenderTarget(o),t.setMRT(l),t.autoClear=c,t.transparent=d,t.opaque=f,t.contextNode=m,r.layers.mask=p}setSize(e,t){this._width=e,this._height=t;const n=Math.floor(this._width*this._pixelRatio*this._resolutionScale),r=Math.floor(this._height*this._pixelRatio*this._resolutionScale);this.renderTarget.setSize(n,r),this._scissor!==null&&this.renderTarget.scissor.copy(this._scissor),this._viewport!==null&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,n,r){e===null?this._scissor=null:(this._scissor===null&&(this._scissor=new It),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,n,r),this._scissor.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setViewport(e,t,n,r){e===null?this._viewport=null:(this._viewport===null&&(this._viewport=new It),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,n,r),this._viewport.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}S_.COLOR="color";S_.DEPTH="depth";const H$=Se(([i,e])=>i.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),W$=Se(([i,e])=>(i=i.mul(e),i.div(i.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),$$=Se(([i,e])=>{i=i.mul(e),i=i.sub(.004).max(0);const t=i.mul(i.mul(6.2).add(.5)),n=i.mul(i.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),q$=Se(([i])=>{const e=i.mul(i.add(.0245786)).sub(90537e-9),t=i.mul(i.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),X$=Se(([i,e])=>{const t=Ji(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=Ji(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return i=i.mul(e).div(.6),i=t.mul(i),i=q$(i),i=n.mul(i),i.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Y$=Ji(ye(1.6605,-.1246,-.0182),ye(-.5876,1.1329,-.1006),ye(-.0728,-.0083,1.1187)),K$=Ji(ye(.6274,.0691,.0164),ye(.3293,.9195,.088),ye(.0433,.0113,.8956)),Z$=Se(([i])=>{const e=ye(i).toVar(),t=ye(e.mul(e)).toVar(),n=ye(t.mul(t)).toVar();return _e(15.5).mul(n.mul(t)).sub(Bt(40.14,n.mul(e))).add(Bt(31.96,n).sub(Bt(6.868,t.mul(e))).add(Bt(.4298,t).add(Bt(.1191,e).sub(.00232))))}),Q$=Se(([i,e])=>{const t=ye(i).toVar(),n=Ji(ye(.856627153315983,.137318972929847,.11189821299995),ye(.0951212405381588,.761241990602591,.0767994186031903),ye(.0482516061458583,.101439036467562,.811302368396859)),r=Ji(ye(1.1271005818144368,-.1413297634984383,-.14132976349843826),ye(-.11060664309660323,1.157823702216272,-.11060664309660294),ye(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=_e(-12.47393),a=_e(4.026069);return t.mulAssign(e),t.assign(K$.mul(t)),t.assign(n.mul(t)),t.assign(Ii(t,1e-10)),t.assign(go(t)),t.assign(t.sub(s).div(a.sub(s))),t.assign(_l(t,0,1)),t.assign(Z$(t)),t.assign(r.mul(t)),t.assign(__(Ii(ye(0),t),ye(2.2))),t.assign(Y$.mul(t)),t.assign(_l(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),J$=Se(([i,e])=>{const t=_e(.76),n=_e(.15);i=i.mul(e);const r=Gh(i.r,Gh(i.g,i.b)),s=Pr(r.lessThan(.08),r.sub(Bt(6.25,r.mul(r))),.04);i.subAssign(s);const a=Ii(i.r,Ii(i.g,i.b));Sn(a.lessThan(t),()=>i);const o=Ar(1,t),l=Ar(1,o.mul(o).div(a.add(o.sub(t))));i.mulAssign(l.div(a));const c=Ar(1,Ta(1,n.mul(a.sub(l)).add(1)));return wn(i,ye(l),c)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Ni extends ft{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class eq extends Ni{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,s=n.type,a=e.getCodeFromNode(this,s);r!==""&&(a.name=r);const o=e.getPropertyName(a),l=this.getNodeFunction(e).getCode(o);return a.code=l+`
`,t==="property"?o:e.format(`${o}()`,s,t)}}function D3(i){let e;const t=i.context.getViewZ;return t!==void 0&&(e=t(this)),(e||ti.z).negate()}const tq=Se(([i,e],t)=>{const n=D3(t);return _o(i,e,n)}),nq=Se(([i],e)=>{const t=D3(e);return i.mul(i,t,t).negate().exp().oneMinus()}),p2=Se(([i,e])=>kt(e.toFloat().mix(jf.rgb,i.toVec3()),jf.a));class iq extends ft{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}on(iq);class Na extends ft{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,s=this.getNodeType(e),a=this.getInputType(e),o=this.pointerNode,l=this.valueNode,c=[];c.push(`&${o.build(e,a)}`),l!==null&&c.push(l.build(e,a));const d=`${e.getMethod(r,s)}( ${c.join(", ")} )`;if(n?n.length===1&&n[0].isStackNode===!0:!1)e.addLineFlowCode(d,this);else return t.constNode===void 0&&(t.constNode=Vh(d,s).toConst()),t.constNode.build(e)}}Na.ATOMIC_LOAD="atomicLoad";Na.ATOMIC_STORE="atomicStore";Na.ATOMIC_ADD="atomicAdd";Na.ATOMIC_SUB="atomicSub";Na.ATOMIC_MAX="atomicMax";Na.ATOMIC_MIN="atomicMin";Na.ATOMIC_AND="atomicAnd";Na.ATOMIC_OR="atomicOr";Na.ATOMIC_XOR="atomicXor";on(Na);class en extends oi{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=n}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,n=this.bNode?this.bNode.getNodeType(e):null,r=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(n)?0:e.getTypeLength(n);return r>s?t:n}getNodeType(e){const t=this.method;return t===en.SUBGROUP_ELECT?"bool":t===en.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const n=this.method,r=this.getNodeType(e),s=this.getInputType(e),a=this.aNode,o=this.bNode,l=[];if(n===en.SUBGROUP_BROADCAST||n===en.SUBGROUP_SHUFFLE||n===en.QUAD_BROADCAST){const d=o.getNodeType(e);l.push(a.build(e,r),o.build(e,d==="float"?"int":r))}else n===en.SUBGROUP_SHUFFLE_XOR||n===en.SUBGROUP_SHUFFLE_DOWN||n===en.SUBGROUP_SHUFFLE_UP?l.push(a.build(e,r),o.build(e,"uint")):(a!==null&&l.push(a.build(e,s)),o!==null&&l.push(o.build(e,s)));const c=l.length===0?"()":`( ${l.join(", ")} )`;return e.format(`${e.getMethod(n,r)}${c}`,r,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}en.SUBGROUP_ELECT="subgroupElect";en.SUBGROUP_BALLOT="subgroupBallot";en.SUBGROUP_ADD="subgroupAdd";en.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd";en.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd";en.SUBGROUP_MUL="subgroupMul";en.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul";en.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul";en.SUBGROUP_AND="subgroupAnd";en.SUBGROUP_OR="subgroupOr";en.SUBGROUP_XOR="subgroupXor";en.SUBGROUP_MIN="subgroupMin";en.SUBGROUP_MAX="subgroupMax";en.SUBGROUP_ALL="subgroupAll";en.SUBGROUP_ANY="subgroupAny";en.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst";en.QUAD_SWAP_X="quadSwapX";en.QUAD_SWAP_Y="quadSwapY";en.QUAD_SWAP_DIAGONAL="quadSwapDiagonal";en.SUBGROUP_BROADCAST="subgroupBroadcast";en.SUBGROUP_SHUFFLE="subgroupShuffle";en.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor";en.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp";en.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown";en.QUAD_BROADCAST="quadBroadcast";let e0;function T_(i){e0=e0||new WeakMap;let e=e0.get(i);return e===void 0&&e0.set(i,e={}),e}function ZS(i){const e=T_(i);return e.shadowMatrix||(e.shadowMatrix=Mt("mat4").setGroup(wt).onRenderUpdate(t=>((i.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&(i.shadow.camera.coordinateSystem!==t.camera.coordinateSystem&&(i.shadow.camera.coordinateSystem=t.camera.coordinateSystem,i.shadow.camera.updateProjectionMatrix()),i.shadow.updateMatrices(i)),i.shadow.matrix)))}function rq(i,e=jh){const t=ZS(i).mul(e);return t.xyz.div(t.w)}function k3(i){const e=T_(i);return e.position||(e.position=Mt(new X).setGroup(wt).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.matrixWorld)))}function sq(i){const e=T_(i);return e.targetPosition||(e.targetPosition=Mt(new X).setGroup(wt).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(i.target.matrixWorld)))}function I3(i){const e=T_(i);return e.viewPosition||(e.viewPosition=Mt(new X).setGroup(wt).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new X,n.value.setFromMatrixPosition(i.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const L3=i=>xo.transformDirection(k3(i).sub(sq(i))),aq=i=>i.sort((e,t)=>e.id-t.id),oq=(i,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===i)return t;return null},Zx=new WeakMap,vf=[];class F3 extends ft{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=pl("vec3","totalDiffuse"),this.totalSpecularNode=pl("vec3","totalSpecular"),this.outgoingLightNode=pl("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const r=e[n];if(vf.push(r.id),vf.push(r.castShadow?1:0),r.isSpotLight===!0){const s=r.map!==null?r.map.id:-1,a=r.colorNode?r.colorNode.getCacheKey():-1;vf.push(s,a)}}const t=Pp(vf);return vf.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=aq(this._lights),s=e.renderer.library;for(const a of r)if(a.isNode)t.push(Qe(a));else{let o=null;if(n!==null&&(o=oq(a.id,n)),o===null){const l=s.getLightNodeClass(a.constructor);if(l===null){Ae(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let c=null;Zx.has(a)?c=Zx.get(a):(c=new l(a),Zx.set(a,c)),t.push(c)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.direct({...n,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:r,reflectedLight:s}=e.context;r.directRectArea({...n,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const r=e.context,s=r.lightingModel,a=e.getNodeProperties(this);if(s){const{totalDiffuseNode:o,totalSpecularNode:l}=this;r.outgoingLight=n;const c=e.addStack();a.nodes=c.nodes,s.start(e);const{backdrop:d,backdropAlpha:f}=r,{directDiffuse:p,directSpecular:m,indirectDiffuse:_,indirectSpecular:b}=r.reflectedLight;let v=p.add(_);d!==null&&(f!==null?v=ye(f.mix(v,d)):v=ye(d)),o.assign(v),l.assign(m.add(b)),n.assign(o.add(l)),s.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class lq extends ft{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=Ut.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){U3.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||jh)}}const U3=pl("vec3","shadowPositionWorld");function uq(i,e={}){return e.toneMapping=i.toneMapping,e.toneMappingExposure=i.toneMappingExposure,e.outputColorSpace=i.outputColorSpace,e.renderTarget=i.getRenderTarget(),e.activeCubeFace=i.getActiveCubeFace(),e.activeMipmapLevel=i.getActiveMipmapLevel(),e.renderObjectFunction=i.getRenderObjectFunction(),e.pixelRatio=i.getPixelRatio(),e.mrt=i.getMRT(),e.clearColor=i.getClearColor(e.clearColor||new _t),e.clearAlpha=i.getClearAlpha(),e.autoClear=i.autoClear,e.scissorTest=i.getScissorTest(),e}function cq(i,e){return e=uq(i,e),i.setMRT(null),i.setRenderObjectFunction(null),i.setClearColor(0,1),i.autoClear=!0,e}function hq(i,e){i.toneMapping=e.toneMapping,i.toneMappingExposure=e.toneMappingExposure,i.outputColorSpace=e.outputColorSpace,i.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),i.setRenderObjectFunction(e.renderObjectFunction),i.setPixelRatio(e.pixelRatio),i.setMRT(e.mrt),i.setClearColor(e.clearColor,e.clearAlpha),i.autoClear=e.autoClear,i.setScissorTest(e.scissorTest)}function dq(i,e={}){return e.background=i.background,e.backgroundNode=i.backgroundNode,e.overrideMaterial=i.overrideMaterial,e}function fq(i,e){return e=dq(i,e),i.background=null,i.backgroundNode=null,i.overrideMaterial=null,e}function pq(i,e){i.background=e.background,i.backgroundNode=e.backgroundNode,i.overrideMaterial=e.overrideMaterial}function gq(i,e,t){return t=cq(i,t),t=fq(e,t),t}function mq(i,e,t){hq(i,t),pq(e,t)}const H0=new WeakMap,_q=Se(({depthTexture:i,shadowCoord:e,depthLayer:t})=>{let n=kn(i,e.xy).setName("t_basic");return i.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),yq=Se(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(d,f)=>{let p=kn(i,d);return i.isArrayTexture&&(p=p.depth(n)),p.compare(f)},s=bn("mapSize","vec2",t).setGroup(wt),a=bn("radius","float",t).setGroup(wt),o=st(1).div(s),l=a.mul(o.x),c=P3(ad.xy).mul(6.28318530718);return Ir(r(e.xy.add(_a(0,5,c).mul(l)),e.z),r(e.xy.add(_a(1,5,c).mul(l)),e.z),r(e.xy.add(_a(2,5,c).mul(l)),e.z),r(e.xy.add(_a(3,5,c).mul(l)),e.z),r(e.xy.add(_a(4,5,c).mul(l)),e.z)).mul(1/5)}),vq=Se(({depthTexture:i,shadowCoord:e,shadow:t,depthLayer:n})=>{const r=(f,p)=>{let m=kn(i,f);return i.isArrayTexture&&(m=m.depth(n)),m.compare(p)},s=bn("mapSize","vec2",t).setGroup(wt),a=st(1).div(s),o=a.x,l=a.y,c=e.xy,d=Ma(c.mul(s).add(.5));return c.subAssign(d.mul(a)),Ir(r(c,e.z),r(c.add(st(o,0)),e.z),r(c.add(st(0,l)),e.z),r(c.add(a),e.z),wn(r(c.add(st(o.negate(),0)),e.z),r(c.add(st(o.mul(2),0)),e.z),d.x),wn(r(c.add(st(o.negate(),l)),e.z),r(c.add(st(o.mul(2),l)),e.z),d.x),wn(r(c.add(st(0,l.negate())),e.z),r(c.add(st(0,l.mul(2))),e.z),d.y),wn(r(c.add(st(o,l.negate())),e.z),r(c.add(st(o,l.mul(2))),e.z),d.y),wn(wn(r(c.add(st(o.negate(),l.negate())),e.z),r(c.add(st(o.mul(2),l.negate())),e.z),d.x),wn(r(c.add(st(o.negate(),l.mul(2))),e.z),r(c.add(st(o.mul(2),l.mul(2))),e.z),d.x),d.y)).mul(1/9)}),xq=Se(({depthTexture:i,shadowCoord:e,depthLayer:t})=>{let n=kn(i).sample(e.xy);i.isArrayTexture&&(n=n.depth(t)),n=n.rg;const r=n.x,s=Ii(1e-7,n.y.mul(n.y)),a=AP(e.z,r);Sn(a.equal(1),()=>_e(1));const o=e.z.sub(r);let l=s.div(s.add(o.mul(o)));return l=_l(Ar(l,.3).div(.65)),Ii(a,l)}),bq=Se(([i,e,t])=>{let n=jh.sub(i).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),wq=i=>{const e=i.shadow.camera,t=bn("near","float",e).setGroup(wt),n=bn("far","float",e).setGroup(wt),r=z9(i);return bq(r,t,n)},Sq=i=>{let e=H0.get(i);if(e===void 0){const t=i.isPointLight?wq(i):null;e=new ni,e.colorNode=kt(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,H0.set(i,e)}return e},Tq=i=>{const e=H0.get(i);e!==void 0&&(e.dispose(),H0.delete(i))},g2=new Ks,Vc=[],Mq=(i,e,t,n)=>{Vc[0]=i,Vc[1]=e;let r=g2.get(Vc);return(r===void 0||r.shadowType!==t||r.useVelocity!==n)&&(r=(s,a,o,l,c,d,...f)=>{(s.castShadow===!0||s.receiveShadow&&t===ao)&&(n&&(QN(s).useVelocity=!0),s.onBeforeShadow(i,s,o,e.camera,l,a.overrideMaterial,d),i.renderObject(s,a,o,l,c,d,...f),s.onAfterShadow(i,s,o,e.camera,l,a.overrideMaterial,d))},r.shadowType=t,r.useVelocity=n,g2.set(Vc,r)),Vc[0]=null,Vc[1]=null,r},Aq=Se(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=_e(0).toVar("meanVertical"),a=_e(0).toVar("squareMeanVertical"),o=i.lessThanEqual(_e(1)).select(_e(0),_e(2).div(i.sub(1))),l=i.lessThanEqual(_e(1)).select(_e(0),_e(-1));fs({start:Dn(0),end:Dn(i),type:"int",condition:"<"},({i:d})=>{const f=l.add(_e(d).mul(o));let p=n.sample(Ir(ad.xy,st(0,f).mul(e)).div(t));n.value.isArrayTexture&&(p=p.depth(r)),p=p.x,s.addAssign(p),a.addAssign(p.mul(p))}),s.divAssign(i),a.divAssign(i);const c=uo(a.sub(s.mul(s)).max(0));return st(s,c)}),Eq=Se(({samples:i,radius:e,size:t,shadowPass:n,depthLayer:r})=>{const s=_e(0).toVar("meanHorizontal"),a=_e(0).toVar("squareMeanHorizontal"),o=i.lessThanEqual(_e(1)).select(_e(0),_e(2).div(i.sub(1))),l=i.lessThanEqual(_e(1)).select(_e(0),_e(-1));fs({start:Dn(0),end:Dn(i),type:"int",condition:"<"},({i:d})=>{const f=l.add(_e(d).mul(o));let p=n.sample(Ir(ad.xy,st(f,0).mul(e)).div(t));n.value.isArrayTexture&&(p=p.depth(r)),s.addAssign(p.x),a.addAssign(Ir(p.y.mul(p.y),p.x.mul(p.x)))}),s.divAssign(i),a.divAssign(i);const c=uo(a.sub(s.mul(s)).max(0));return st(s,c)}),Cq=[_q,yq,vq,xq];let Qx;const t0=new KS;class O3 extends lq{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._currentShadowType=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:s,depthLayer:a}){const o=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),l=t({depthTexture:n,shadowCoord:r,shadow:s,depthLayer:a});return o.select(l,_e(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:r}=e,s=bn("bias","float",n).setGroup(wt);let a=t,o;if(n.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),o=a.z,r.coordinateSystem===Sa&&(o=o.mul(2).sub(1));else{const l=a.w;a=a.xy.div(l);const c=bn("near","float",n.camera).setGroup(wt),d=bn("far","float",n.camera).setGroup(wt);o=l3(l.negate(),c,d)}return a=ye(a.x,a.y.oneMinus(),o.add(s)),a}getShadowFilterFn(e){return Cq[e]}setupRenderTarget(e,t){const n=new gr(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=Sp;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=n,{shadowMap:r,depthTexture:n}}setupShadow(e){const{renderer:t,camera:n}=e,{light:r,shadow:s}=this,a=t.shadowMap.type,{depthTexture:o,shadowMap:l}=this.setupRenderTarget(s,e);if(s.camera.coordinateSystem=n.coordinateSystem,s.camera.updateProjectionMatrix(),a===ao&&s.isPointLightShadow!==!0){o.compareFunction=null,l.depth>1?(l._vsmShadowMapVertical||(l._vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:dr,type:Wn,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=l._vsmShadowMapVertical,l._vsmShadowMapHorizontal||(l._vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:dr,type:Wn,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=l._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:dr,type:Wn,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:dr,type:Wn,depthBuffer:!1}));let T=kn(o);o.isArrayTexture&&(T=T.depth(this.depthLayer));let E=kn(this.vsmShadowMapVertical.texture);o.isArrayTexture&&(E=E.depth(this.depthLayer));const N=bn("blurSamples","float",s).setGroup(wt),M=bn("radius","float",s).setGroup(wt),C=bn("mapSize","vec2",s).setGroup(wt);let D=this.vsmMaterialVertical||(this.vsmMaterialVertical=new ni);D.fragmentNode=Aq({samples:N,radius:M,size:C,shadowPass:T,depthLayer:this.depthLayer}).context(e.getSharedContext()),D.name="VSMVertical",D=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new ni),D.fragmentNode=Eq({samples:N,radius:M,size:C,shadowPass:E,depthLayer:this.depthLayer}).context(e.getSharedContext()),D.name="VSMHorizontal"}const c=bn("intensity","float",s).setGroup(wt),d=bn("normalBias","float",s).setGroup(wt),f=ZS(r).mul(U3.add(od.mul(d))),p=this.setupShadowCoord(e,f),m=s.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(m===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const _=a===ao&&s.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:o,b=this.setupShadowFilter(e,{filterFn:m,shadowTexture:l.texture,depthTexture:_,shadowCoord:p,shadow:s,depthLayer:this.depthLayer});let v;l.texture.isCubeTexture?v=Cr(l.texture,p.xyz):(v=kn(l.texture,p),o.isArrayTexture&&(v=v.depth(this.depthLayer)));const y=wn(1,b.rgb.mix(v,1),c.mul(v.a)).toVar();this.shadowMap=l,this.shadow.map=l;const S=`${this.light.type} Shadow [ ${this.light.name||"ID: "+this.light.id} ]`;return y.toInspector(`${S} / Color`,()=>this.shadowMap.texture.isCubeTexture?Cr(this.shadowMap.texture):kn(this.shadowMap.texture)).toInspector(`${S} / Depth`,()=>this.shadowMap.texture.isCubeTexture?Cr(this.shadowMap.texture).r.oneMinus():ds(this.shadowMap.depthTexture,rd().mul(_u(kn(this.shadowMap.depthTexture)))).r.oneMinus())}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Se(()=>{const t=e.renderer.shadowMap.type;this._currentShadowType!==t&&(this._reset(),this._node=null);let n=this._node;return this.setupShadowPosition(e),n===null&&(this._node=n=this.setupShadow(e),this._currentShadowType=t),e.material.shadowNode&&Ae('NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n})()}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:a}=e;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height,n.depth);const o=a.name;a.name=`Shadow Map [ ${r.name||"ID: "+r.id} ]`,s.render(a,t.camera),a.name=o}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:s,scene:a,camera:o}=e,l=s.shadowMap.type,c=t.depthTexture.version;this._depthVersionCached=c;const d=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=o.layers.mask);const f=s.getRenderObjectFunction(),p=s.getMRT(),m=p?p.has("velocity"):!1;Qx=gq(s,a,Qx),a.overrideMaterial=Sq(n),s.setRenderObjectFunction(Mq(s,r,l,m)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(f),l===ao&&r.isPointLightShadow!==!0&&this.vsmPass(s),r.camera.layers.mask=d,mq(s,a,Qx)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),t0.material=this.vsmMaterialVertical,t0.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),t0.material=this.vsmMaterialHorizontal,t0.render(e)}dispose(){this._reset(),super.dispose()}_reset(){this._currentShadowType=null,Tq(this.light),this.shadowMap&&(this.shadowMap.dispose(),this.shadowMap=null),this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null)}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const Rq=(i,e)=>new O3(i,e),Nq=new _t,m2=new hn,xf=new X,Jx=new X,Pq=[new X(1,0,0),new X(-1,0,0),new X(0,-1,0),new X(0,1,0),new X(0,0,1),new X(0,0,-1)],Dq=[new X(0,-1,0),new X(0,-1,0),new X(0,0,-1),new X(0,0,1),new X(0,-1,0),new X(0,-1,0)],kq=[new X(1,0,0),new X(-1,0,0),new X(0,1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1)],Iq=[new X(0,-1,0),new X(0,-1,0),new X(0,0,1),new X(0,0,-1),new X(0,-1,0),new X(0,-1,0)],Lq=Se(({depthTexture:i,bd3D:e,dp:t})=>Cr(i,e).compare(t)),Fq=Se(({depthTexture:i,bd3D:e,dp:t,shadow:n})=>{const r=bn("radius","float",n).setGroup(wt),s=bn("mapSize","vec2",n).setGroup(wt),a=r.div(s.x),o=Kr(e),l=qs(Pu(e,o.x.greaterThan(o.z).select(ye(0,1,0),ye(1,0,0)))),c=Pu(e,l),d=P3(ad.xy).mul(6.28318530718),f=_a(0,5,d),p=_a(1,5,d),m=_a(2,5,d),_=_a(3,5,d),b=_a(4,5,d);return Cr(i,e.add(l.mul(f.x).add(c.mul(f.y)).mul(a))).compare(t).add(Cr(i,e.add(l.mul(p.x).add(c.mul(p.y)).mul(a))).compare(t)).add(Cr(i,e.add(l.mul(m.x).add(c.mul(m.y)).mul(a))).compare(t)).add(Cr(i,e.add(l.mul(_.x).add(c.mul(_.y)).mul(a))).compare(t)).add(Cr(i,e.add(l.mul(b.x).add(c.mul(b.y)).mul(a))).compare(t)).mul(1/5)}),Uq=Se(({filterFn:i,depthTexture:e,shadowCoord:t,shadow:n})=>{const r=t.xyz.toVar(),s=r.length(),a=Mt("float").setGroup(wt).onRenderUpdate(()=>n.camera.near),o=Mt("float").setGroup(wt).onRenderUpdate(()=>n.camera.far),l=bn("bias","float",n).setGroup(wt),c=_e(1).toVar();return Sn(s.sub(o).lessThanEqual(0).and(s.sub(a).greaterThanEqual(0)),()=>{const d=s.sub(a).div(o.sub(a)).toVar();d.addAssign(l);const f=r.normalize();c.assign(i({depthTexture:e,bd3D:f,dp:d,shadow:n}))}),c});class Oq extends O3{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===nL?Lq:Fq}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:r,shadow:s}){return Uq({filterFn:t,depthTexture:n,shadowCoord:r,shadow:s})}setupRenderTarget(e,t){const n=new HR(e.mapSize.width);n.name="PointShadowDepthTexture",n.compareFunction=Sp;const r=t.createCubeRenderTarget(e.mapSize.width);return r.texture.name="PointShadowMap",r.depthTexture=n,{shadowMap:r,depthTexture:n}}renderShadow(e){const{shadow:t,shadowMap:n,light:r}=this,{renderer:s,scene:a}=e,o=t.camera,l=t.matrix,c=s.coordinateSystem===Sa,d=c?Pq:kq,f=c?Dq:Iq;n.setSize(t.mapSize.width,t.mapSize.width);const p=s.autoClear,m=s.getClearColor(Nq),_=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha);for(let b=0;b<6;b++){s.setRenderTarget(n,b),s.clear();const v=r.distance||o.far;v!==o.far&&(o.far=v,o.updateProjectionMatrix()),xf.setFromMatrixPosition(r.matrixWorld),o.position.copy(xf),Jx.copy(o.position),Jx.add(d[b]),o.up.copy(f[b]),o.lookAt(Jx),o.updateMatrixWorld(),l.makeTranslation(-xf.x,-xf.y,-xf.z),m2.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),t._frustum.setFromProjectionMatrix(m2,o.coordinateSystem,o.reversedDepth);const y=a.name;a.name=`Point Light Shadow [ ${r.name||"ID: "+r.id} ] - Face ${b+1}`,s.render(a,o),a.name=y}s.autoClear=p,s.setClearColor(m,_)}}const Bq=(i,e)=>new Oq(i,e);class Ou extends ld{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new _t,this.colorNode=e&&e.colorNode||Mt(this.color).setGroup(wt),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=Ut.FRAME,e&&e.shadow&&(this._shadowDisposeListener=()=>{this.disposeShadow()},e.addEventListener("dispose",this._shadowDisposeListener))}dispose(){this._shadowDisposeListener&&this.light.removeEventListener("dispose",this._shadowDisposeListener),super.dispose()}disposeShadow(){this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null),this.shadowColorNode=null,this.baseColorNode!==null&&(this.colorNode=this.baseColorNode,this.baseColorNode=null)}getHash(){return this.light.uuid}getLightVector(e){return I3(this.light).sub(e.context.positionView||ti)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return Rq(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=Qe(r):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=n=this.colorNode.mul(s),this.baseColorNode=this.colorNode}e.context.getShadow&&(n=e.context.getShadow(this,e)),this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const B3=Se(({lightDistance:i,cutoffDistance:e,decayExponent:t})=>{const n=i.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(i.div(e).pow4().oneMinus().clamp().pow2()),n)}),zq=({color:i,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const r=e.normalize(),s=e.length(),a=B3({lightDistance:s,cutoffDistance:t,decayExponent:n}),o=i.mul(a);return{lightDirection:r,lightColor:o}};class Gq extends Ou{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Mt(0).setGroup(wt),this.decayExponentNode=Mt(2).setGroup(wt)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return Bq(this.light)}setupDirect(e){return zq({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}Se(([i=rd()],{renderer:e,material:t})=>{const n=RP(i.mul(2).sub(1));let r;if(t.alphaToCoverage&&e.currentSamples>0){const s=_e(n.fwidth()).toVar();r=_o(s.oneMinus(),s.add(1),n).oneMinus()}else r=Pr(n.greaterThan(1),0,1);return r});const Vq=Se(([i,e])=>{const t=i.x,n=i.y,r=i.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(n)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(n)),s=s.add(e.element(5).mul(2*.429043).mul(n).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(Bt(t,t).sub(Bt(n,n)))),s}),Fs=new YS;class jq extends bl{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(s===null)r._clearColor.getRGB(Fs),Fs.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(Fs),Fs.a=1,a=!0;else if(s.isNode===!0){const c=this.get(e),d=s;Fs.copy(r._clearColor);let f=c.backgroundMesh;if(f===void 0){let T=function(){s.removeEventListener("dispose",T),f.material.dispose(),f.geometry.dispose()};var l=T;const m=kt(d).mul(d2).context({getUV:()=>B$.mul($9),getTextureLevel:()=>O$}),_=$f.element(3).element(3).equal(1),b=Ta(1,$f.element(1).element(1)).mul(3),v=_.select(Ai.mul(b),Ai);let y=$f.mul(Ip.mul(kt(v,0)));y=y.setZ(y.w);const S=new ni;S.name="Background.material",S.side=En,S.depthTest=!1,S.depthWrite=!1,S.allowOverride=!1,S.fog=!1,S.lights=!1,S.vertexNode=y,S.colorNode=m,c.backgroundMeshNode=m,c.backgroundMesh=f=new pi(new qR(1,32,32),S),f.frustumCulled=!1,f.name="Background.mesh",s.addEventListener("dispose",T)}const p=d.getCacheKey();c.backgroundCacheKey!==p&&(c.backgroundMeshNode.node=kt(d).mul(d2),c.backgroundMeshNode.needsUpdate=!0,f.material.needsUpdate=!0,c.backgroundCacheKey=p),t.unshift(f,f.geometry,f.material,0,0,null,null)}else Ee("Renderer: Unsupported background configuration.",s);const o=r.xr.getEnvironmentBlendMode();if(o==="additive"?Fs.set(0,0,0,1):o==="alpha-blend"&&Fs.set(0,0,0,0),r.autoClear===!0||a===!0){const c=n.clearColorValue;c.r=Fs.r,c.g=Fs.g,c.b=Fs.b,c.a=Fs.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(c.r*=c.a,c.g*=c.a,c.b*=c.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=r.autoClearColor===!0,n.clearDepth=r.autoClearDepth===!0,n.clearStencil=r.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let Hq=0;class hw{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=Hq++}}class Wq{constructor(e,t,n,r,s,a,o,l,c,d=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=d,this.nodeAttributes=r,this.bindings=s,this.updateNodes=a,this.updateBeforeNodes=o,this.updateAfterNodes=l,this.observer=c,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new hw(t.name,[],t.index,t.bindingsReference);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class _2{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class $q{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class z3{constructor(e,t,n=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=r}}class qq extends z3{constructor(e,t,n=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=r}}class Xq{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let Yq=0;class eb{constructor(e=null){this.id=Yq++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class Kq{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class wl{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Zq extends wl{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class Qq extends wl{constructor(e,t=new Xe){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Jq extends wl{constructor(e,t=new X){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class eX extends wl{constructor(e,t=new It){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class tX extends wl{constructor(e,t=new _t){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class nX extends wl{constructor(e,t=new i_){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class iX extends wl{constructor(e,t=new Ft){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class rX extends wl{constructor(e,t=new hn){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class sX extends Zq{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class aX extends Qq{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class oX extends Jq{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class lX extends eX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class uX extends tX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class cX extends nX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class hX extends iX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class dX extends rX{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}let fX=0;const pX=new WeakMap,y2=new WeakMap,gX=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),n0=i=>/e/g.test(i)?String(i).replace(/\+/g,""):(i=Number(i),i+(i%1?"":".0"));class G3{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=Xx(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new eb,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.activeStacks=[],this.subBuildFn=null,this.fnCall=null,Object.defineProperty(this,"id",{value:fX++})}isOpaque(){const e=this.material;return e.transparent===!1&&e.blending===Qr&&e.alphaToCoverage===!1}getBindGroupsCache(){let e=y2.get(this.renderer);return e===void 0&&(e=new Ks,y2.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new Iu(e,t,n)}createCubeRenderTarget(e,t){return new d3(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let s=!0;for(const o of t)r.push(o),s=s&&o.groupNode.shared!==!0;let a;return s?(a=n.get(r),a===void 0&&(a=new hw(e,r,this.bindingsIndexes[e].group,r),n.set(r,a))):a=new hw(e,r,this.bindingsIndexes[e].group,r),a}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const r of cC)for(const s in n[r]){const a=n[r][s];(t[s]||(t[s]=[])).push(...a)}e=[];for(const r in t){const s=t[r],a=this._getBindGroup(r,s);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Ut.NONE&&this.updateNodes.push(e);for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==Ut.NONE&&this.updateBeforeNodes.push(e),n!==Ut.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===In||e.magFilter===eh||e.magFilter===oo||e.magFilter===Nr||e.minFilter===In||e.minFilter===eh||e.minFilter===oo||e.minFilter===Nr}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}addContext(e){const t=this.getContext();return this.setContext({...this.context,...e}),t}getSharedContext(){const e={...this.context};return delete e.material,delete e.getUV,delete e.getOutput,delete e.getTextureLevel,delete e.getAO,delete e.getShadow,e}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new eb(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){Ae("Abstract function.")}getInstanceIndex(){Ae("Abstract function.")}getDrawIndex(){Ae("Abstract function.")}getFrontFacing(){Ae("Abstract function.")}getFragCoord(){Ae("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){Ae("Abstract function.")}generateTextureLod(){Ae("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const a=n?n[s]:null;a!==null?r+=a.build(this,e):r+=this.generateConst(e),s<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,n=null){const r=[];for(const s of t){const{name:a,type:o}=s;n&&n[a]&&n[a].isNode?r.push(n[a].build(this,o)):r.push(this.generateConst(o))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new _t:e==="vec2"||e==="uvec2"||e==="ivec2"?t=new Xe:e==="vec3"||e==="uvec3"||e==="ivec3"?t=new X:(e==="vec4"||e==="uvec4"||e==="ivec4")&&(t=new It)),e==="float")return n0(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${n0(t.r)}, ${n0(t.g)}, ${n0(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),s=a=>this.generateConst(r,a);if(n===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(n===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const s of n)if(s.name===e)return s;const r=new _2(e,t);return this.registerDeclaration(r),n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Ti)return"int";if(t===yn)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=ZN(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),r+n}getTypeFromArray(e){return gX.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,s=e.normalized;let a;return!(e instanceof FR)&&s!==!0&&(a=this.getTypeFromArray(n)),this.getTypeFromLength(r,a)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}setActiveStack(e){this.activeStacks.push(e)}removeActiveStack(e){if(this.activeStacks[this.activeStacks.length-1]===e)this.activeStacks.pop();else throw new Error("NodeBuilder: Invalid active stack removal.")}getActiveStack(){return this.activeStacks[this.activeStacks.length-1]}getBaseStack(){return this.activeStacks[0]}addStack(){this.stack=Xx(this.stack);const e=nP();return this.stacks.push(e),B0(this.stack),this.stack}removeStack(){const e=this.stack;for(const t of e.nodes){const n=this.getDataFromNode(t);n.stack=e}return this.stack=e.parent,B0(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let r=n.getData(e);r===void 0&&(r={},n.setData(e,r)),r[t]===void 0&&(r[t]={});let s=r[t];const a=r.any?r.any.subBuilds:null,o=this.getClosestSubBuild(a);return o&&(s.subBuildsCache===void 0&&(s.subBuildsCache={}),s=s.subBuildsCache[o]||(s.subBuildsCache[o]={}),s.subBuilds=a),s}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e,"vertex");let r=n.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new _2("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,n=null,r=this.shaderStage){const s=this.getDataFromNode(e,r,this.globalCache);let a=s.structType;if(a===void 0){const o=this.structs.index++;n===null&&(n="StructType"+o),a=new Kq(n,t),this.structs[r].push(a),this.types[r][n]=e,s.structType=a}return a}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,r=null){const s=this.getDataFromNode(e,n,this.globalCache);let a=s.uniform;if(a===void 0){const o=this.uniforms.index++;a=new $q(r||"nodeUniform"+o,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),s.uniform=a}return a}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage,s=!1){const a=this.getDataFromNode(e,r),o=this.getSubBuildProperty("variable",a.subBuilds);let l=a[o];if(l===void 0){const c=s?"_const":"_var",d=this.vars[r]||(this.vars[r]=[]),f=this.vars[c]||(this.vars[c]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+f,this.vars[c]++),o!=="variable"&&(t=this.getSubBuildProperty(t,a.subBuilds));const p=e.getArrayCount(this);l=new z3(t,n,s,p),s||d.push(l),this.registerDeclaration(l),a[o]=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),r=null,s=null){const a=this.getDataFromNode(e,"any"),o=this.getSubBuildProperty("varying",a.subBuilds);let l=a[o];if(l===void 0){const c=this.varyings,d=c.length;t===null&&(t="nodeVarying"+d),o!=="varying"&&(t=this.getSubBuildProperty(t,a.subBuilds)),l=new qq(t,n,r,s),c.push(l),this.registerDeclaration(l),a[o]=l}return l}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let s=1,a=r;for(;n[a]!==void 0;)a=r+"_"+s++;s>1&&(e.name=a,Ae(`TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${a}'.`)),n[a]=e}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const a=this.codes[n]||(this.codes[n]=[]),o=a.length;s=new Xq("nodeCode"+o,t),a.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,a=t;for(;a;){if(r.get(a)===!0){s=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(s)for(const o of n)this.addLineFlowCode(o)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),a=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),a.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new eq,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let a=0;const o=Object.values(this);return{next:()=>({value:o[a],done:a++>=o.length})}}};for(const a of t.inputs)n[a.name]=new P$(a.type,a.name);e.layout=null;const r=e.call(n),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowBuildStage(e,t,n=null){const r=this.getBuildStage();this.setBuildStage(t);const s=e.build(this,n);return this.setBuildStage(r),s}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,s=this.declarations,a=this.cache,o=this.buildStage,l=this.stack,c={code:""};this.flow=c,this.vars={},this.declarations={},this.cache=new eb,this.stack=Xx();for(const d of uC)this.setBuildStage(d),c.result=e.build(this,t);return c.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=s,this.cache=a,this.stack=l,this.setBuildStage(o),c}getFunctionOperator(){return null}buildFunctionCode(){Ae("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const s=this.tab,a=this.cache,o=this.shaderStage,l=this.context;this.setShaderStage(e);const c={...this.context};delete c.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=c;let d=null;if(this.buildStage==="generate"){const f=this.flowChildNode(t,n);r!==null&&(f.code+=`${this.tab+r} = ${f.result};
`),this.flowCode[e]=this.flowCode[e]+f.code,d=f}else d=t.build(this);return this.setShaderStage(o),this.cache=a,this.tab=s,this.context=l,d}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){Ae("Abstract function.")}getVaryings(){Ae("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const r of n)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){Ae("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const r of t)n+=r.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){Ae("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(e&&e.isNode?e.isShaderCallNodeInternal?t=e.shaderNode.subBuilds:e.isStackNode?t=[e.subBuild]:t=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?t=[...e]:t=e,!t)return null;const n=this.subBuildLayers;for(let r=t.length-1;r>=0;r--){const s=t[r];if(n.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let n;t!==null?n=this.getClosestSubBuild(t):n=this.subBuildFn;let r;return n?r=e?n+"_"+e:n:r=e,r}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let r=n.library.fromMaterial(t);r===null&&(Ee(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new ni),r.build(this)}else this.addFlow("compute",e);for(const r of uC){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of cC){this.setShaderStage(s);const a=this.flowNodes[s];for(const o of a)r==="generate"?this.flowNode(o):o.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getSharedDataFromNode(e){let t=pX.get(e);return t===void 0&&(t={}),t}getNodeUniform(e,t){const n=this.getSharedDataFromNode(e);let r=n.cache;if(r===void 0){if(t==="float"||t==="int"||t==="uint")r=new sX(e);else if(t==="vec2"||t==="ivec2"||t==="uvec2")r=new aX(e);else if(t==="vec3"||t==="ivec3"||t==="uvec3")r=new oX(e);else if(t==="vec4"||t==="ivec4"||t==="uvec4")r=new lX(e);else if(t==="color")r=new uX(e);else if(t==="mat2")r=new cX(e);else if(t==="mat3")r=new hX(e);else if(t==="mat4")r=new dX(e);else throw new Error(`Uniform "${t}" not implemented.`);n.cache=r}return r}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const r=this.getTypeLength(t),s=this.getTypeLength(n);return r===16&&s===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&s===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||s>4||s===0?e:r===s?`${this.getType(n)}( ${e} )`:r>s?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),n)):s===4&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${ku} - Node System
`}}class v2{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderId:0,frameId:0},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===Ut.FRAME){const r=this._getMaps(this.updateBeforeMap,n);if(r.frameId!==this.frameId){const s=r.frameId;r.frameId=this.frameId,e.updateBefore(this)===!1&&(r.frameId=s)}}else if(t===Ut.RENDER){const r=this._getMaps(this.updateBeforeMap,n);if(r.renderId!==this.renderId){const s=r.renderId;r.renderId=this.renderId,e.updateBefore(this)===!1&&(r.renderId=s)}}else t===Ut.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===Ut.FRAME){const r=this._getMaps(this.updateAfterMap,n);r.frameId!==this.frameId&&e.updateAfter(this)!==!1&&(r.frameId=this.frameId)}else if(t===Ut.RENDER){const r=this._getMaps(this.updateAfterMap,n);r.renderId!==this.renderId&&e.updateAfter(this)!==!1&&(r.renderId=this.renderId)}else t===Ut.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===Ut.FRAME){const r=this._getMaps(this.updateMap,n);r.frameId!==this.frameId&&e.update(this)!==!1&&(r.frameId=this.frameId)}else if(t===Ut.RENDER){const r=this._getMaps(this.updateMap,n);r.renderId!==this.renderId&&e.update(this)!==!1&&(r.renderId=this.renderId)}else t===Ut.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class QS{constructor(e,t,n=null,r="",s=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=s}}QS.isNodeFunctionInput=!0;class mX extends Ou{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:L3(this.light),lightColor:e}}}const tb=new hn,i0=new hn;let bf=null;class _X extends Ou{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Mt(new X).setGroup(wt),this.halfWidth=Mt(new X).setGroup(wt),this.updateType=Ut.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;i0.identity(),tb.copy(t.matrixWorld),tb.premultiply(n),i0.extractRotation(tb),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(i0),this.halfHeight.value.applyMatrix4(i0)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=kn(bf.LTC_FLOAT_1),n=kn(bf.LTC_FLOAT_2)):(t=kn(bf.LTC_HALF_1),n=kn(bf.LTC_HALF_2));const{colorNode:r,light:s}=this,a=I3(s);return{lightColor:r,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){bf=e}}class JS extends Ou{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Mt(0).setGroup(wt),this.penumbraCosNode=Mt(0).setGroup(wt),this.cutoffDistanceNode=Mt(0).setGroup(wt),this.decayExponentNode=Mt(0).setGroup(wt),this.colorNode=Mt(this.color).setGroup(wt)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:r}=this;return _o(n,r,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=rq(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:r,light:s}=this,a=this.getLightVector(e),o=a.normalize(),l=o.dot(L3(s)),c=this.getSpotAttenuation(e,l),d=a.length(),f=B3({lightDistance:d,cutoffDistance:n,decayExponent:r});let p=t.mul(c).mul(f),m,_;return s.colorNode?(_=this.getLightCoord(e),m=s.colorNode(_)):s.map&&(_=this.getLightCoord(e),m=kn(s.map,_.xy).onRenderUpdate(()=>s.map)),m&&(p=_.mul(2).sub(1).abs().lessThan(1).all().select(p.mul(m),p)),{lightColor:p,lightDirection:o}}}class yX extends JS{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let r=null;if(n&&n.isTexture===!0){const s=t.acos().mul(1/Math.PI);r=kn(n,st(s,0),0).r}else r=super.getSpotAttenuation(t);return r}}const vX=Se(([i,e])=>{const t=i.abs().sub(e);return mo(Ii(t,0)).add(Gh(Ii(t.x,t.y),0))});class xX extends JS{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=_e(0),n=this.penumbraCosNode,r=ZS(this.light).mul(e.context.positionWorld||jh);return Sn(r.w.greaterThan(0),()=>{const s=r.xyz.div(r.w),a=vX(s.xy.sub(st(.5)),st(.5)),o=Ta(-1,Ar(1,vP(n)).sub(1));t.assign(BS(a.mul(-2).mul(o)))}),t}}class bX extends Ou{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class wX extends Ou{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=k3(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Mt(new _t).setGroup(wt)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,a=od.dot(r).mul(.5).add(.5),o=wn(n,t,a);e.context.irradiance.addAssign(o)}}class SX extends Ou{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new X);this.lightProbe=Vs(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=Vq(od,this.lightProbe);e.context.irradiance.addAssign(t)}}class V3{parseFunction(){Ae("Abstract function.")}}class e1{constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){Ae("Abstract function.")}}e1.isNodeFunction=!0;const TX=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,MX=/[a-z_0-9]+/ig,x2="#pragma main",AX=i=>{i=i.trim();const e=i.indexOf(x2),t=e!==-1?i.slice(e+x2.length):i,n=t.match(TX);if(n!==null&&n.length===5){const r=n[4],s=[];let a=null;for(;(a=MX.exec(r))!==null;)s.push(a);const o=[];let l=0;for(;l<s.length;){const _=s[l][0]==="const";_===!0&&l++;let b=s[l][0];b==="in"||b==="out"||b==="inout"?l++:b="";const v=s[l++][0];let y=Number.parseInt(s[l][0]);Number.isNaN(y)===!1?l++:y=null;const S=s[l++][0];o.push(new QS(v,S,y,b,_))}const c=t.substring(n[0].length),d=n[3]!==void 0?n[3]:"",f=n[2],p=n[1]!==void 0?n[1]:"",m=e!==-1?i.slice(0,e):"";return{type:f,inputs:o,name:d,precision:p,inputsCode:r,blockCode:c,headerCode:m}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class EX extends e1{constructor(e){const{type:t,inputs:n,name:r,precision:s,inputsCode:a,blockCode:o,headerCode:l}=AX(e);super(t,n,r,s),this.inputsCode=a,this.blockCode=o,this.headerCode=l}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:r,inputsCode:s,headerCode:a,precision:o}=this;let l=`${r} ${e} ( ${s.trim()} )`;o!==""&&(l=`${o} ${l}`),t=a+l+n}else t="";return t}}class CX extends V3{parseFunction(e){return new EX(e)}}const b2=new WeakMap,ha=[],Jo=[];class RX extends bl{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new v2,this.nodeBuilderCache=new Map,this.callHashCache=new Ks,this.groupsData=new Ks,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===pP.name)return!0;if(n===wt.name){const s=this.get(e),a=this.nodeFrame.renderId;return s.renderId!==a?(s.renderId=a,!0):!1}if(n===$V.name){const s=this.get(e),a=this.nodeFrame.frameId;return s.frameId!==a?(s.frameId=a,!0):!1}ha[0]=t,ha[1]=e;let r=this.groupsData.get(ha);return r===void 0&&this.groupsData.set(ha,r={}),ha.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(n=r.get(s),n===void 0){const a=l=>{const c=this.backend.createNodeBuilder(e.object,this.renderer);return c.scene=e.scene,c.material=l,c.camera=e.camera,c.context.material=l,c.lightsNode=e.lightsNode,c.environmentNode=this.getEnvironmentNode(e.scene),c.fogNode=this.getFogNode(e.scene),c.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&c.enableMultiview(),c};let o=a(e.material);try{o.build()}catch(l){o=a(new ni),o.build(),Ee("TSL: "+l)}n=this._createNodeBuilderState(o),r.set(s,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new Wq(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){ha[0]=e,ha[1]=t;const n=this.renderer.info.calls,r=this.callHashCache.get(ha)||{};if(r.callId!==n){const s=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&Jo.push(t.getCacheKey(!0)),s&&Jo.push(s.getCacheKey()),a&&Jo.push(a.getCacheKey()),Jo.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),Jo.push(this.renderer.shadowMap.enabled?1:0),Jo.push(this.renderer.shadowMap.type),r.callId=n,r.cacheKey=Pp(Jo),this.callHashCache.set(ha,r),Jo.length=0}return ha.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||r){const s=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===ch||n.mapping===hh||n.mapping===xu){if(e.backgroundBlurriness>0||n.mapping===xu)return S3(n);{let a;return n.isCubeTexture===!0?a=Cr(n):a=kn(n),p3(a)}}else{if(n.isTexture===!0)return kn(n,ah.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&Ee("WebGPUNodes: Unsupported background configuration.",n)}},r);t.backgroundNode=s,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,r=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=s.get(t);return(a===void 0||r)&&(a=n(),s.set(t,a)),a}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const r=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const s=bn("color","color",n).setGroup(wt),a=bn("density","float",n).setGroup(wt);return p2(s,nq(a))}else if(n.isFog){const s=bn("color","color",n).setGroup(wt),a=bn("near","float",n).setGroup(wt),o=bn("far","float",n).setGroup(wt);return p2(s,tq(a,o))}else Ee("Renderer: Unsupported fog configuration.",n)});t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const r=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return Cr(n);if(n.isTexture===!0)return kn(n);Ee("Nodes: Unsupported environment configuration.",n)});t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,s=null){const a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=r,a.material=s,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return b2.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=e.isArrayTexture?V$(e,ye(ah,kp("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):kn(e,ah).renderOutput(t.toneMapping,t.currentColorSpace);return b2.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const r of n.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const r of n.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new v2,this.nodeBuilderCache=new Map,this.cacheLib={}}}const nb=new zs;class W0{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Ft,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const r=e.length;for(let s=0;s<r;s++){nb.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=t[n+s],o=nb.normal;a.x=-o.x,a.y=-o.y,a.z=-o.z,a.w=nb.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,s=r.length;let a,o;if(this.clipIntersection?(a=this.intersectionPlanes,o=e.intersectionPlanes.length):(a=this.unionPlanes,o=e.unionPlanes.length),a.length!==o+s){a.length=o+s;for(let l=0;l<s;l++)a[o+l]=new It;n=!0}this.projectPlanes(r,a,o),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new W0(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class NX{constructor(e,t){this.bundleGroup=e,this.camera=t}}const wf=[];class PX{constructor(){this.bundles=new Ks}get(e,t){const n=this.bundles;wf[0]=e,wf[1]=t;let r=n.get(wf);return r===void 0&&(r=new NX(e,t),n.set(wf,r)),wf.length=0,r}dispose(){this.bundles=new Ks}}class j3{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){Ae(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){Ae(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const DX=new F3,Sf=[];class kX extends Ks{constructor(){super()}createNode(e=[]){return new F3().setLights(e)}getNode(e,t){if(e.isQuadMesh)return DX;Sf[0]=e,Sf[1]=t;let n=this.get(Sf);return n===void 0&&(n=this.createNode(),this.set(Sf,n)),Sf.length=0,n}}class Df extends Iu{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const w2=new X,S2=new X;class IX extends Ca{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Mi,this._cameraL.viewport=new It,this._cameraR=new Mi,this._cameraR.viewport=new It,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new QR,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding=typeof XRWebGLBinding<"u",this._frameBufferTargets=null,this._createXRLayer=zX.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new Xe,this._onSessionEvent=UX.bind(this),this._onSessionEnd=OX.bind(this),this._onInputSourcesChange=BX.bind(this),this._onAnimationFrame=GX.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&Ae("XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&Ae("XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getBinding(){return this._glBinding===null&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,r,s,a,o,l={}){const c=new Cp(e,t),d=new Df(s,a,{format:Jn,type:Un,depthTexture:new gr(s,a,l.stencil?Jr:yn,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?hr:ki),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});d._autoAllocateDepthBuffer=!0;const f=new ma({color:16777215,side:Zr});f.map=d.texture,f.map.offset.y=1,f.map.repeat.y=-1;const p=new pi(c,f);p.position.copy(n),p.quaternion.copy(r);const m={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:s,pixelheight:a,plane:p,material:f,rendercall:o,renderTarget:d};if(this._layers.push(m),this._session!==null){m.plane.material=new ma({color:16777215,side:Zr}),m.plane.material.blending=Jc,m.plane.material.blendEquation=Yi,m.plane.material.blendSrc=Ja,m.plane.material.blendDst=Ja,m.xrlayer=this._createXRLayer(m);const _=this._session.renderState.layers;_.unshift(m.xrlayer),this._session.updateRenderState({layers:_})}else d.isXRRenderTarget=!1;return p}createCylinderLayer(e,t,n,r,s,a,o,l,c={}){const d=new gF(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),f=new Df(a,o,{format:Jn,type:Un,depthTexture:new gr(a,o,c.stencil?Jr:yn,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?hr:ki),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});f._autoAllocateDepthBuffer=!0;const p=new ma({color:16777215,side:En});p.map=f.texture,p.map.offset.y=1,p.map.repeat.y=-1;const m=new pi(d,p);m.position.copy(r),m.quaternion.copy(s);const _={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:s,pixelwidth:a,pixelheight:o,plane:m,material:p,rendercall:l,renderTarget:f};if(this._layers.push(_),this._session!==null){_.plane.material=new ma({color:16777215,side:En}),_.plane.material.blending=Jc,_.plane.material.blendEquation=Yi,_.plane.material.blendSrc=Ja,_.plane.material.blendDst=Ja,_.xrlayer=this._createXRLayer(_);const b=this._session.renderState.layers;b.unshift(_.xrlayer),this._session.updateRenderState({layers:b})}else f.isXRRenderTarget=!1;return m}renderLayers(){const e=new X,t=new Ys,n=this._renderer,r=this.isPresenting,s=n.getOutputRenderTarget(),a=n._frameBufferTarget;this.isPresenting=!1;const o=new Xe;n.getSize(o);const l=n._quad;for(const c of this._layers)if(c.renderTarget.isXRRenderTarget=this._session!==null,c.renderTarget._hasExternalTextures=c.renderTarget.isXRRenderTarget,c.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){c.xrlayer.transform=new XRRigidTransform(c.plane.getWorldPosition(e),c.plane.getWorldQuaternion(t));const d=this._glBinding.getSubImage(c.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(c.renderTarget,d.colorTexture,void 0),n._setXRLayerSize(c.renderTarget.width,c.renderTarget.height),n.setOutputRenderTarget(c.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:f,quad:p}=this._frameBufferTargets.get(c.renderTarget)||{frameBufferTarget:null,quad:null};f?(n._frameBufferTarget=f,n._quad=p):(n._quad=new KS(new ni),this._frameBufferTargets.set(c.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),c.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(c.renderTarget),c.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(s),n._frameBufferTarget=a,n._setXRLayerSize(o.x,o.y),n._quad=l,this.isPresenting=r}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const r=this._gl,s=r.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._supportsLayers===!0){let a=null,o=null,l=null;t.depth&&(l=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,a=t.stencil?hr:ki,o=t.stencil?Jr:yn);const c={colorFormat:r.RGBA8,depthFormat:l,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(c.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const d=this._glBinding.createProjectionLayer(c),f=[d];this._glProjLayer=d,t.setPixelRatio(1),t._setXRLayerSize(d.textureWidth,d.textureHeight);const p=this._useMultiview?2:1,m=new gr(d.textureWidth,d.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,a,p);if(this._xrRenderTarget=new Df(d.textureWidth,d.textureHeight,{format:Jn,type:Un,colorSpace:t.outputColorSpace,depthTexture:m,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const _ of this._layers)_.plane.material=new ma({color:16777215,side:_.type==="cylinder"?En:Zr}),_.plane.material.blending=Jc,_.plane.material.blendEquation=Yi,_.plane.material.blendSrc=Ja,_.plane.material.blendDst=Ja,_.xrlayer=this._createXRLayer(_),f.unshift(_.xrlayer);e.updateRenderState({layers:f})}else{const a={antialias:t.currentSamples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},o=new XRWebGLLayer(e,r,a);this._glBaseLayer=o,e.updateRenderState({baseLayer:o}),t.setPixelRatio(1),t._setXRLayerSize(o.framebufferWidth,o.framebufferHeight),this._xrRenderTarget=new Df(o.framebufferWidth,o.framebufferHeight,{format:Jn,type:Un,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:o.ignoreDepthValues===!1,resolveStencilBuffer:o.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,r=e.far,s=this._cameraXR,a=this._cameraL,o=this._cameraR;s.near=o.near=a.near=n,s.far=o.far=a.far=r,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),s.layers.mask=e.layers.mask|6,a.layers.mask=s.layers.mask&3,o.layers.mask=s.layers.mask&5;const l=e.parent,c=s.cameras;T2(s,l);for(let d=0;d<c.length;d++)T2(c[d],l);c.length===2?LX(s,a,o):s.projectionMatrix.copy(a.projectionMatrix),FX(e,s,l)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new v0,this._controllers[e]=t),t}}function LX(i,e,t){w2.setFromMatrixPosition(e.matrixWorld),S2.setFromMatrixPosition(t.matrixWorld);const n=w2.distanceTo(S2),r=e.projectionMatrix.elements,s=t.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],d=(r[8]-1)/r[0],f=(s[8]+1)/s[0],p=a*d,m=a*f,_=n/(-d+f),b=_*-d;if(e.matrixWorld.decompose(i.position,i.quaternion,i.scale),i.translateX(b),i.translateZ(_),i.matrixWorld.compose(i.position,i.quaternion,i.scale),i.matrixWorldInverse.copy(i.matrixWorld).invert(),r[10]===-1)i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const v=a+_,y=o+_,S=p-b,T=m+(n-b),E=l*o/y*v,N=c*o/y*v;i.projectionMatrix.makePerspective(S,T,E,N,v,y),i.projectionMatrixInverse.copy(i.projectionMatrix).invert()}}function T2(i,e){e===null?i.matrixWorld.copy(i.matrix):i.matrixWorld.multiplyMatrices(e.matrixWorld,i.matrix),i.matrixWorldInverse.copy(i.matrixWorld).invert()}function FX(i,e,t){t===null?i.matrix.copy(e.matrixWorld):(i.matrix.copy(t.matrixWorld),i.matrix.invert(),i.matrix.multiply(e.matrixWorld)),i.matrix.decompose(i.position,i.quaternion,i.scale),i.updateMatrixWorld(!0),i.projectionMatrix.copy(e.projectionMatrix),i.projectionMatrixInverse.copy(e.projectionMatrixInverse),i.isPerspectiveCamera&&(i.fov=Au*2*Math.atan(1/i.projectionMatrix.elements[5]),i.zoom=1)}function UX(i){const e=this._controllerInputSources.indexOf(i.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(i.inputSource,i.frame,n),t.dispatchEvent({type:i.type,data:i.inputSource})}}function OX(){const i=this._session,e=this._renderer;i.removeEventListener("select",this._onSessionEvent),i.removeEventListener("selectstart",this._onSessionEvent),i.removeEventListener("selectend",this._onSessionEvent),i.removeEventListener("squeeze",this._onSessionEvent),i.removeEventListener("squeezestart",this._onSessionEvent),i.removeEventListener("squeezeend",this._onSessionEvent),i.removeEventListener("end",this._onSessionEnd),i.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._glBinding=null,this._glBaseLayer=null,this._glProjLayer=null,this._sessionUsesLayers===!0)for(const t of this._layers)t.renderTarget=new Df(t.pixelwidth,t.pixelheight,{format:Jn,type:Un,depthTexture:new gr(t.pixelwidth,t.pixelheight,t.stencilBuffer?Jr:yn,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?hr:ki),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function BX(i){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<i.removed.length;n++){const r=i.removed[n],s=t.indexOf(r);s>=0&&(t[s]=null,e[s].disconnect(r))}for(let n=0;n<i.added.length;n++){const r=i.added[n];let s=t.indexOf(r);if(s===-1){for(let o=0;o<e.length;o++)if(o>=t.length){t.push(r),s=o;break}else if(t[o]===null){t[o]=r,s=o;break}if(s===-1)break}const a=e[s];a&&a.connect(r)}}function zX(i){return i.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(i.translation,i.quaternion),width:i.width/2,height:i.height/2,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(i.translation,i.quaternion),radius:i.radius,centralAngle:i.centralAngle,aspectRatio:i.aspectRatio,space:this._referenceSpace,viewPixelWidth:i.pixelwidth,viewPixelHeight:i.pixelheight,clearOnAccess:!1})}function GX(i,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,r=n.backend,s=this._glBaseLayer,a=this.getReferenceSpace(),o=e.getViewerPose(a);if(this._xrFrame=e,o!==null){const l=o.views;this._glBaseLayer!==null&&r.setXRTarget(s.framebuffer);let c=!1;l.length!==t.cameras.length&&(t.cameras.length=0,c=!0);for(let d=0;d<l.length;d++){const f=l[d];let p;if(this._supportsLayers===!0){const _=this._glBinding.getViewSubImage(this._glProjLayer,f);p=_.viewport,d===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,_.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:_.depthStencilTexture)}else p=s.getViewport(f);let m=this._cameras[d];m===void 0&&(m=new Mi,m.layers.enable(d),m.viewport=new It,this._cameras[d]=m),m.matrix.fromArray(f.transform.matrix),m.matrix.decompose(m.position,m.quaternion,m.scale),m.projectionMatrix.fromArray(f.projectionMatrix),m.projectionMatrixInverse.copy(m.projectionMatrix).invert(),m.viewport.set(p.x,p.y,p.width,p.height),d===0&&(t.matrix.copy(m.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),c===!0&&t.cameras.push(m)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let l=0;l<this._controllers.length;l++){const c=this._controllerInputSources[l],d=this._controllers[l];c!==null&&d!==void 0&&d.update(c,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(i,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}class VX extends Ca{constructor(e){super(),this.domElement=e,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new It(0,0,this._width,this._height),this._scissor=new It(0,0,this._width,this._height),this._scissorTest=!1,this.colorTexture=new jR,this.depthTexture=new gr}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._dispatchResize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._dispatchResize())}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,s=0,a=1){const o=this._viewport;e.isVector4?o.copy(e):o.set(e,t,n,r),o.minDepth=s,o.maxDepth=a}_dispatchResize(){this.dispatchEvent({type:"resize"})}dispose(){this.dispatchEvent({type:"dispose"})}}const M2=new n_,jc=new Xe,ib=new It,rb=new Ep,sb=new cS,r0=new hn,Za=new It;class jX{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:s=!0,stencil:a=!1,antialias:o=!1,samples:l=0,getFallback:c=null,outputBufferType:d=Wn,multiview:f=!1}=t;this.backend=e,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=lr,this.toneMapping=Di,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=a,this.info=new g$,this.contextNode=Uu(),this.library=new j3,this.lighting=new kX,this._samples=l||o===!0?4:0,this._onCanvasTargetResize=this._onCanvasTargetResize.bind(this),this._canvasTarget=new VX(e.getDomElement()),this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize),this._canvasTarget.isDefaultCanvasTarget=!0,this._inspector=new OP,this._inspector.setRenderer(this),this._getFallback=c,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new KS(new ni),this._quad.name="Output Color Transform",this._quad.material.name="outputColorTransform",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const p=this.alpha===!0?0:1;this._clearColor=new YS(0,0,0,p),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._outputBufferType=d,this._cacheShadowNodes=new WeakMap,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:If},this.xr=new IX(this,f),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(m,_,b)=>{await this.compileAsync(m,_);const v=this._renderLists.get(m,_),y=this._renderContexts.get(m,_,this._renderTarget,this._mrt),S=m.overrideMaterial||b.material,T=this._objects.get(b,S,m,_,v.lightsNode,y,y.clippingContext),{fragmentShader:E,vertexShader:N}=T.getNodeBuilderState();return{fragmentShader:E,vertexShader:N}}}}async init(){return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=n=this._getFallback(r),await n.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new RX(this,n),this._animation=new a$(this,this._nodes,this.info),this._attributes=new f$(n),this._background=new jq(this,this._nodes),this._geometries=new p$(this._attributes,this.info),this._textures=new N$(this,n,this.info),this._pipelines=new v$(n,this._nodes),this._bindings=new x$(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new c$(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new S$(this.lighting),this._bundles=new PX,this._renderContexts=new C$,this._animation.start(),this._initialized=!0,this._inspector.init(),e(this)}),this._initPromise)}get domElement(){return this._canvasTarget.domElement}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,a=this._currentRenderContext,o=this._currentRenderObjectFunction,l=this._compilationPromises,c=e.isScene===!0?e:M2;n===null&&(n=e);const d=this._renderTarget,f=this._renderContexts.get(n,t,d,this._mrt),p=this._activeMipmapLevel,m=[];this._currentRenderContext=f,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=m,r.renderId++,r.update(),f.depth=this.depth,f.stencil=this.stencil,f.clippingContext||(f.clippingContext=new W0),f.clippingContext.updateGlobal(c,t),c.onBeforeRender(this,e,t,d);const _=this._renderLists.get(e,t);if(_.begin(),this._projectObject(e,t,0,_,f.clippingContext),n!==e&&n.traverseVisible(function(T){T.isLight&&T.layers.test(t.layers)&&_.pushLight(T)}),_.finish(),d!==null){this._textures.updateRenderTarget(d,p);const T=this._textures.get(d);f.textures=T.textures,f.depthTexture=T.depthTexture}else f.textures=null,f.depthTexture=null;this._background.update(c,_,f);const b=_.opaque,v=_.transparent,y=_.transparentDoublePass,S=_.lightsNode;this.opaque===!0&&b.length>0&&this._renderObjects(b,t,c,S),this.transparent===!0&&v.length>0&&this._renderTransparents(v,y,t,c,S),r.renderId=s,this._currentRenderContext=a,this._currentRenderObjectFunction=o,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(m)}async renderAsync(e,t){Fn('Renderer: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.render(e,t)}async waitForGPU(){Ee("Renderer: waitForGPU() has been removed. Read https://github.com/mrdoob/three.js/issues/32012 for more information.")}set inspector(e){this._inspector!==null&&this._inspector.setRenderer(null),this._inspector=e,this._inspector.setRenderer(this)}get inspector(){return this._inspector}set highPrecision(e){const t=this.contextNode.value;e===!0?(t.modelViewMatrix=TC,t.modelNormalViewMatrix=MC):this.highPrecision&&(delete t.modelViewMatrix,delete t.modelNormalViewMatrix)}get highPrecision(){const e=this.contextNode.value;return e.modelViewMatrix===TC&&e.modelNormalViewMatrix===MC}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getOutputBufferType(){return this._outputBufferType}getColorBufferType(){return Fn('Renderer: ".getColorBufferType()" has been renamed to ".getOutputBufferType()".'),this.getOutputBufferType()}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),Ee(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:s,renderList:a}=e,o=this._currentRenderContext,l=this._bundles.get(r,s),c=this.backend.get(l);c.renderContexts===void 0&&(c.renderContexts=new Set);const d=r.version!==c.version,f=c.renderContexts.has(o)===!1||d;if(c.renderContexts.add(o),f){this.backend.beginBundle(o),(c.renderObjects===void 0||d)&&(c.renderObjects=[]),this._currentRenderBundle=l;const{transparentDoublePass:p,transparent:m,opaque:_}=a;this.opaque===!0&&_.length>0&&this._renderObjects(_,s,t,n),this.transparent===!0&&m.length>0&&this._renderTransparents(m,p,s,t,n),this._currentRenderBundle=null,this.backend.finishBundle(o,l),c.version=r.version}else{const{renderObjects:p}=c;for(let m=0,_=p.length;m<_;m++){const b=p[m];this._nodes.needsRefresh(b)&&(this._nodes.updateBefore(b),this._nodes.updateForRender(b),this._bindings.updateForRender(b),this._nodes.updateAfter(b))}}this.backend.addBundle(o,l)}render(e,t){if(this._initialized===!1)throw new Error('Renderer: .render() called before the backend is initialized. Use "await renderer.init();" before rendering.');this._renderScene(e,t)}get initialized(){return this._initialized}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,n=e!==Di,r=t!==bt.workingColorSpace;if(n===!1&&r===!1)return null;const{width:s,height:a}=this.getDrawingBufferSize(jc),{depth:o,stencil:l}=this;let c=this._frameBufferTarget;c===null&&(c=new Iu(s,a,{depthBuffer:o,stencilBuffer:l,type:this._outputBufferType,format:Jn,colorSpace:bt.workingColorSpace,generateMipmaps:!1,minFilter:In,magFilter:In,samples:this.samples}),c.isPostProcessingRenderTarget=!0,this._frameBufferTarget=c);const d=this.getOutputRenderTarget();c.depthBuffer=o,c.stencilBuffer=l,d!==null?c.setSize(d.width,d.height,d.depth):c.setSize(s,a,1);const f=this._canvasTarget;return c.viewport.copy(f._viewport),c.scissor.copy(f._scissor),c.viewport.multiplyScalar(f._pixelRatio),c.scissor.multiplyScalar(f._pixelRatio),c.scissorTest=f._scissorTest,c.multiview=d!==null?d.multiview:!1,c.resolveDepthBuffer=d!==null?d.resolveDepthBuffer:!0,c._autoAllocateDepthBuffer=d!==null?d._autoAllocateDepthBuffer:!1,c}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const r=n?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,a=s.renderId,o=this._currentRenderContext,l=this._currentRenderObjectFunction,c=e.isScene===!0?e:M2,d=this._renderTarget||this._outputRenderTarget,f=this._activeCubeFace,p=this._activeMipmapLevel;let m;r!==null?(m=r,this.setRenderTarget(m)):m=d;const _=this._renderContexts.get(e,t,m,this._mrt);this._currentRenderContext=_,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls,this.backend.updateTimeStampUID(_),this.inspector.beginRender(this.backend.getTimestampUID(_),e,t,m);const b=this.coordinateSystem,v=this.xr;if(t.coordinateSystem!==b&&v.isPresenting===!1&&(t.coordinateSystem=b,t.updateProjectionMatrix(),t.isArrayCamera))for(const O of t.cameras)O.coordinateSystem=b,O.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),v.enabled===!0&&v.isPresenting===!0&&(v.cameraAutoUpdate===!0&&v.updateCamera(t),t=v.getCamera());const y=this._canvasTarget;let S=y._viewport,T=y._scissor,E=y._pixelRatio;m!==null&&(S=m.viewport,T=m.scissor,E=1),this.getDrawingBufferSize(jc),ib.set(0,0,jc.width,jc.height);const N=S.minDepth===void 0?0:S.minDepth,M=S.maxDepth===void 0?1:S.maxDepth;_.viewportValue.copy(S).multiplyScalar(E).floor(),_.viewportValue.width>>=p,_.viewportValue.height>>=p,_.viewportValue.minDepth=N,_.viewportValue.maxDepth=M,_.viewport=_.viewportValue.equals(ib)===!1,_.scissorValue.copy(T).multiplyScalar(E).floor(),_.scissor=y._scissorTest&&_.scissorValue.equals(ib)===!1,_.scissorValue.width>>=p,_.scissorValue.height>>=p,_.clippingContext||(_.clippingContext=new W0),_.clippingContext.updateGlobal(c,t),c.onBeforeRender(this,e,t,m);const C=t.isArrayCamera?sb:rb;t.isArrayCamera||(r0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),C.setFromProjectionMatrix(r0,t.coordinateSystem,t.reversedDepth));const D=this._renderLists.get(e,t);if(D.begin(),this._projectObject(e,t,0,D,_.clippingContext),D.finish(),this.sortObjects===!0&&D.sort(this._opaqueSort,this._transparentSort),m!==null){this._textures.updateRenderTarget(m,p);const O=this._textures.get(m);_.textures=O.textures,_.depthTexture=O.depthTexture,_.width=O.width,_.height=O.height,_.renderTarget=m,_.depth=m.depthBuffer,_.stencil=m.stencilBuffer}else _.textures=null,_.depthTexture=null,_.width=jc.width,_.height=jc.height,_.depth=this.depth,_.stencil=this.stencil;_.width>>=p,_.height>>=p,_.activeCubeFace=f,_.activeMipmapLevel=p,_.occlusionQueryCount=D.occlusionQueryCount,_.scissorValue.max(Za.set(0,0,0,0)),_.scissorValue.x+_.scissorValue.width>_.width&&(_.scissorValue.width=Math.max(_.width-_.scissorValue.x,0)),_.scissorValue.y+_.scissorValue.height>_.height&&(_.scissorValue.height=Math.max(_.height-_.scissorValue.y,0)),this._background.update(c,D,_),_.camera=t,this.backend.beginRender(_);const{bundles:R,lightsNode:P,transparentDoublePass:L,transparent:z,opaque:B}=D;return R.length>0&&this._renderBundles(R,c,P),this.opaque===!0&&B.length>0&&this._renderObjects(B,t,c,P),this.transparent===!0&&z.length>0&&this._renderTransparents(z,L,t,c,P),this.backend.finishRender(_),s.renderId=a,this._currentRenderContext=o,this._currentRenderObjectFunction=l,r!==null&&(this.setRenderTarget(d,f,p),this._renderOutput(m)),c.onAfterRender(this,e,t,m),this.inspector.finishRender(this.backend.getTimestampUID(_)),_}_setXRLayerSize(e,t){this._canvasTarget._width=e,this._canvasTarget._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}getAnimationLoop(){return this._animation.getAnimationLoop()}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._canvasTarget.getPixelRatio()}getDrawingBufferSize(e){return this._canvasTarget.getDrawingBufferSize(e)}getSize(e){return this._canvasTarget.getSize(e)}setPixelRatio(e=1){this._canvasTarget.setPixelRatio(e)}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||this._canvasTarget.setDrawingBufferSize(e,t,n)}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||this._canvasTarget.setSize(e,t,n)}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){return this._canvasTarget.getScissor(e)}setScissor(e,t,n,r){this._canvasTarget.setScissor(e,t,n,r)}getScissorTest(){return this._canvasTarget.getScissorTest()}setScissorTest(e){this._canvasTarget.setScissorTest(e),this.backend.setScissorTest(e)}getViewport(e){return this._canvasTarget.getViewport(e)}setViewport(e,t,n,r,s=0,a=1){this._canvasTarget.setViewport(e,t,n,r,s,a)}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)throw new Error('Renderer: .clear() called before the backend is initialized. Use "await renderer.init();" before before using this method.');const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null){this._textures.updateRenderTarget(r);const a=this._textures.get(r);s=this._renderContexts.getForClear(r),s.textures=a.textures,s.depthTexture=a.depthTexture,s.width=a.width,s.height=a.height,s.renderTarget=r,s.depth=r.depthBuffer,s.stencil=r.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,s),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){this.clear(!0,!1,!1)}clearDepth(){this.clear(!1,!0,!1)}clearStencil(){this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){Fn('Renderer: "clearAsync()" has been deprecated. Use "clear()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.clear(e,t,n)}async clearColorAsync(){Fn('Renderer: "clearColorAsync()" has been deprecated. Use "clearColor()" and "await renderer.init();" when creating the renderer.'),this.clear(!0,!1,!1)}async clearDepthAsync(){Fn('Renderer: "clearDepthAsync()" has been deprecated. Use "clearDepth()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!0,!1)}async clearStencilAsync(){Fn('Renderer: "clearStencilAsync()" has been deprecated. Use "clearStencil()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!1,!0)}get needsFrameBufferTarget(){const e=this.currentToneMapping!==Di,t=this.currentColorSpace!==bt.workingColorSpace;return e||t}get samples(){return this._samples}get currentSamples(){let e=this._samples;return this._renderTarget!==null?e=this._renderTarget.samples:this.needsFrameBufferTarget&&(e=0),e}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:Di}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:bt.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this._initialized===!0&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._geometries.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setCanvasTarget(e){this._canvasTarget.removeEventListener("resize",this._onCanvasTargetResize),this._canvasTarget=e,this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize)}getCanvasTarget(){return this._canvasTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return Ae("Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e,t);const n=this._nodes.nodeFrame,r=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls,this.backend.updateTimeStampUID(e),this.inspector.beginCompute(this.backend.getTimestampUID(e),e);const s=this.backend,a=this._pipelines,o=this._bindings,l=this._nodes,c=Array.isArray(e)?e:[e];if(c[0]===void 0||c[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const d of c){if(a.has(d)===!1){const m=()=>{d.removeEventListener("dispose",m),a.delete(d),o.deleteForCompute(d),l.delete(d)};d.addEventListener("dispose",m);const _=d.onInitFunction;_!==null&&_.call(d,{renderer:this})}l.updateForCompute(d),o.updateForCompute(d);const f=o.getForCompute(d),p=a.getForCompute(d,f);s.compute(e,d,f,p,t)}s.finishCompute(e),n.renderId=r,this.inspector.finishCompute(this.backend.getTimestampUID(e))}async computeAsync(e,t=null){this._initialized===!1&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return Fn('Renderer: "hasFeatureAsync()" has been deprecated. Use "hasFeature()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){if(this._initialized===!1)throw new Error('Renderer: .hasFeature() called before the backend is initialized. Use "await renderer.init();" before before using this method.');return this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){Fn('Renderer: "initTextureAsync()" has been deprecated. Use "initTexture()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.initTexture(e)}initTexture(e){if(this._initialized===!1)throw new Error('Renderer: .initTexture() called before the backend is initialized. Use "await renderer.init();" before before using this method.');this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=Za.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=Za.copy(t).floor();else{Ee("Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=Za.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,r;n!==null?r=n.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),n=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,n,t),this._inspector.copyFramebufferToTexture(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,s,a),this._inspector.copyTextureToTexture(e,t)}async readRenderTargetPixelsAsync(e,t,n,r,s,a=0,o=0){return this.backend.copyTextureToBuffer(e.textures[a],t,n,r,s,o)}_projectObject(e,t,n,r,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const l=t.isArrayCamera?sb:rb;if(!e.frustumCulled||l.intersectsSprite(e,t)){this.sortObjects===!0&&Za.setFromMatrixPosition(e.matrixWorld).applyMatrix4(r0);const{geometry:c,material:d}=e;d.visible&&r.push(e,c,d,n,Za.z,null,s)}}else if(e.isLineLoop)Ee("Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const l=t.isArrayCamera?sb:rb;if(!e.frustumCulled||l.intersectsObject(e,t)){const{geometry:c,material:d}=e;if(this.sortObjects===!0&&(c.boundingSphere===null&&c.computeBoundingSphere(),Za.copy(c.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(r0)),Array.isArray(d)){const f=c.groups;for(let p=0,m=f.length;p<m;p++){const _=f[p],b=d[_.materialIndex];b&&b.visible&&r.push(e,c,b,n,Za.z,_,s)}}else d.visible&&r.push(e,c,d,n,Za.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=r;r=this._renderLists.get(e,t),r.begin(),l.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const o=e.children;for(let l=0,c=o.length;l<c;l++)this._projectObject(o[l],t,n,r,s)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,s){if(t.length>0){for(const{material:a}of t)a.side=En;this._renderObjects(t,n,r,s,"backSide");for(const{material:a}of t)a.side=Zr;this._renderObjects(e,n,r,s);for(const{material:a}of t)a.side=Xi}else this._renderObjects(e,n,r,s)}_renderObjects(e,t,n,r,s=null){for(let a=0,o=e.length;a<o;a++){const{object:l,geometry:c,material:d,group:f,clippingContext:p}=e[a];this._currentRenderObjectFunction(l,n,t,c,d,f,r,p,s)}}_getShadowNodes(e){const t=e.version;let n=this._cacheShadowNodes.get(e);if(n===void 0||n.version!==t){const r=e.map!==null,s=e.colorNode&&e.colorNode.isNode,a=e.castShadowNode&&e.castShadowNode.isNode;let o=null,l=null,c=null;if(r||s||a){let d,f;a?(d=e.castShadowNode.rgb,f=e.castShadowNode.a):(d=ye(0),f=_e(1)),r&&(f=f.mul(bn("map","texture",e).a)),s&&(f=f.mul(e.colorNode.a)),l=kt(d,f)}e.depthNode&&e.depthNode.isNode&&(c=e.depthNode),e.castShadowPositionNode&&e.castShadowPositionNode.isNode?o=e.castShadowPositionNode:e.positionNode&&e.positionNode.isNode&&(o=e.positionNode),n={version:t,colorNode:l,depthNode:c,positionNode:o},this._cacheShadowNodes.set(e,n)}return n}renderObject(e,t,n,r,s,a,o,l=null,c=null){let d=!1,f,p,m,_;if(e.onBeforeRender(this,t,n,r,s,a),s.allowOverride===!0&&t.overrideMaterial!==null){const b=t.overrideMaterial;if(d=!0,f=t.overrideMaterial.colorNode,p=t.overrideMaterial.depthNode,m=t.overrideMaterial.positionNode,_=t.overrideMaterial.side,s.positionNode&&s.positionNode.isNode&&(b.positionNode=s.positionNode),b.alphaTest=s.alphaTest,b.alphaMap=s.alphaMap,b.transparent=s.transparent||s.transmission>0||s.transmissionNode&&s.transmissionNode.isNode||s.backdropNode&&s.backdropNode.isNode,b.isShadowPassMaterial){const{colorNode:v,depthNode:y,positionNode:S}=this._getShadowNodes(s);b.side=s.shadowSide===null?s.side:s.shadowSide,v!==null&&(b.colorNode=v),y!==null&&(b.depthNode=y),S!==null&&(b.positionNode=S)}s=b}s.transparent===!0&&s.side===Xi&&s.forceSinglePass===!1?(s.side=En,this._handleObjectFunction(e,s,t,n,o,a,l,"backSide"),s.side=Zr,this._handleObjectFunction(e,s,t,n,o,a,l,c),s.side=Xi):this._handleObjectFunction(e,s,t,n,o,a,l,c),d&&(t.overrideMaterial.colorNode=f,t.overrideMaterial.depthNode=p,t.overrideMaterial.positionNode=m,t.overrideMaterial.side=_),e.onAfterRender(this,t,n,r,s,a)}_renderObjectDirect(e,t,n,r,s,a,o,l){const c=this._objects.get(e,t,n,r,s,this._currentRenderContext,o,l);c.drawRange=e.geometry.drawRange,c.group=a;const d=this._nodes.needsRefresh(c);d&&(this._nodes.updateBefore(c),this._geometries.updateForRender(c),this._nodes.updateForRender(c),this._bindings.updateForRender(c)),this._pipelines.updateForRender(c),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(c),c.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(c,this.info),d&&this._nodes.updateAfter(c)}_createObjectPipeline(e,t,n,r,s,a,o,l){const c=this._objects.get(e,t,n,r,s,this._currentRenderContext,o,l);c.drawRange=e.geometry.drawRange,c.group=a,this._nodes.updateBefore(c),this._geometries.updateForRender(c),this._nodes.updateForRender(c),this._bindings.updateForRender(c),this._pipelines.getForRender(c,this._compilationPromises),this._nodes.updateAfter(c)}_onCanvasTargetResize(){this._initialized&&this.backend.updateSize()}get compile(){return this.compileAsync}}class H3{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}getVisibility(){return this.visibility}clone(){return Object.assign(new this.constructor,this)}}function HX(i){return i+(rl-i%rl)%rl}class W3 extends H3{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t,this._updateRanges=[]}get updateRanges(){return this._updateRanges}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}get byteLength(){return HX(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class $3 extends W3{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let WX=0;class q3 extends $3{constructor(e,t){super("UniformBuffer_"+WX++,e?e.value:null),this.nodeUniform=e,this.groupNode=t,this.isNodeUniformBuffer=!0}set updateRanges(e){this.nodeUniform.updateRanges=e}get updateRanges(){return this.nodeUniform.updateRanges}addUpdateRange(e,t){this.nodeUniform.addUpdateRange(e,t)}clearUpdateRanges(){this.nodeUniform.clearUpdateRanges()}get buffer(){return this.nodeUniform.value}}class $X extends $3{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,r=this.uniforms.length;n<r;n++){const s=this.uniforms[n],a=s.boundary,o=s.itemSize*e,l=t%rl,c=l%a,d=l+c;t+=c,d!==0&&rl-d<o&&(t+=rl-d),s.offset=t/e,t+=o}return Math.ceil(t/rl)*rl}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);Ee("WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s]!==r){const o=this._getBufferForType(a);o[s]=n[s]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y){const o=this._getBufferForType(a);o[s+0]=n[s+0]=r.x,o[s+1]=n[s+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z){const o=this._getBufferForType(a);o[s+0]=n[s+0]=r.x,o[s+1]=n[s+1]=r.y,o[s+2]=n[s+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==r.x||n[s+1]!==r.y||n[s+2]!==r.z||n[s+4]!==r.w){const o=this._getBufferForType(a);o[s+0]=n[s+0]=r.x,o[s+1]=n[s+1]=r.y,o[s+2]=n[s+2]=r.z,o[s+3]=n[s+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),s=e.offset;if(n[s+0]!==r.r||n[s+1]!==r.g||n[s+2]!==r.b){const a=this.buffer;a[s+0]=n[s+0]=r.r,a[s+1]=n[s+1]=r.g,a[s+2]=n[s+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;if(n[s+0]!==r[0]||n[s+1]!==r[1]||n[s+2]!==r[2]||n[s+4]!==r[3]||n[s+5]!==r[4]||n[s+6]!==r[5]||n[s+8]!==r[6]||n[s+9]!==r[7]||n[s+10]!==r[8]){const a=this.buffer;a[s+0]=n[s+0]=r[0],a[s+1]=n[s+1]=r[1],a[s+2]=n[s+2]=r[2],a[s+4]=n[s+4]=r[3],a[s+5]=n[s+5]=r[4],a[s+6]=n[s+6]=r[5],a[s+8]=n[s+8]=r[6],a[s+9]=n[s+9]=r[7],a[s+10]=n[s+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,s=e.offset;return XX(n,r,s)===!1&&(this.buffer.set(r,s),qX(n,r,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function qX(i,e,t){for(let n=0,r=e.length;n<r;n++)i[t+n]=e[n]}function XX(i,e,t){for(let n=0,r=e.length;n<r;n++)if(i[t+n]!==e[n])return!1;return!0}let YX=0;class X3 extends $X{constructor(e,t){super(e),this.id=YX++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class Y3 extends H3{constructor(e,t){super(e),this._texture=null,this._onTextureDispose=()=>{this.generation=null,this.version=0},this.texture=t,this.version=t?t.version:0,this.generation=null,this.samplerKey="",this.isSampler=!0}set texture(e){this._texture!==e&&(this._texture&&this._texture.removeEventListener("dispose",this._onTextureDispose),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",this._onTextureDispose))}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}clone(){const e=super.clone();return e._texture=null,e._onTextureDispose=()=>{e.generation=null,e.version=0},e.texture=this.texture,e}}let KX=0;class ZX extends Y3{constructor(e,t){super(e,t),this.id=KX++,this.store=!1,this.mipLevel=0,this.isSampledTexture=!0}}class M_ extends ZX{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class K3 extends M_{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledCubeTexture=!0}}class dw extends M_{constructor(e,t,n,r=null){super(e,t,n,r),this.isSampledTexture3D=!0}}const A2={bitcast_int_uint:new Ni("uint tsl_bitcast_int_to_uint ( int x ) { return floatBitsToUint( intBitsToFloat ( x ) ); }"),bitcast_uint_int:new Ni("uint tsl_bitcast_uint_to_int ( uint x ) { return floatBitsToInt( uintBitsToFloat ( x ) ); }")},QX={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint",bitcast_uint_int:"tsl_bitcast_uint_to_int",bitcast_int_uint:"tsl_bitcast_int_to_uint",floatpack_snorm_2x16:"packSnorm2x16",floatpack_unorm_2x16:"packUnorm2x16",floatpack_float16_2x16:"packHalf2x16",floatunpack_snorm_2x16:"unpackSnorm2x16",floatunpack_unorm_2x16:"unpackUnorm2x16",floatunpack_float16_2x16:"unpackHalf2x16"},JX={low:"lowp",medium:"mediump",high:"highp"},E2={swizzleAssign:!0,storageBuffer:!1},C2={perspective:"smooth",linear:"noperspective"},R2={centroid:"centroid"},N2=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class eY extends G3{constructor(e,t){super(e,t,new CX),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Er}_include(e){const t=A2[e];return t.build(this),this.addInclude(t),t}getMethod(e){return A2[e]!==void 0&&this._include(e),QX[e]||e}getBitcastMethod(e,t){return this.getMethod(`bitcast_${t}_${e}`)}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`${e} ? ${t} : ${n}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(this.getType(a.type)+" "+a.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,r=t.count*t.itemSize,{itemSize:s}=t,a=t.array.constructor.name.toLowerCase().includes("int");let o=a?Xh:wp;s===2?o=a?Yh:dr:s===3?o=a?lL:bp:s===4&&(o=a?Kh:Jn);const l={Float32Array:Qn,Uint8Array:Un,Uint16Array:js,Uint32Array:yn,Int8Array:du,Int16Array:fu,Int32Array:Ti,Uint8ClampedArray:Un},c=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let d=Math.ceil(r/s/c);c*d*s<r&&d++;const f=c*d*s,p=new n.constructor(f);p.set(n,0),t.array=p;const m=new uS(t.array,c,d,o,l[t.array.constructor.name]||Qn);m.needsUpdate=!0,m.isPBOTexture=!0;const _=new sd(m,null,null);_.setPrecision("high"),t.pboNode=_,t.pbo=_.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){const d=this.renderer.backend.get(r);d.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.nodeName),a=this.getPropertyName(s);this.increaseUsage(n);const o=n.build(this,"uint"),l=this.getDataFromNode(e);let c=l.propertyName;if(c===void 0){const d=this.getVarFromNode(e);c=this.getPropertyName(d);const f=this.getDataFromNode(t);let p=f.propertySizeName;p===void 0&&(p=c+"Size",this.getVarFromNode(t,p,"uint"),this.addLineFlowCode(`${p} = uint( textureSize( ${a}, 0 ).x )`,e),f.propertySizeName=p);const{itemSize:m}=r,_="."+nd.join("").slice(0,m),b=`ivec2(${o} % ${p}, ${o} / ${p})`,v=this.generateTextureLoad(null,a,b,"0",null,null);let y="vec4";r.pbo.type===yn?y="uvec4":r.pbo.type===Ti&&(y="ivec4"),this.addLineFlowCode(`${c} = ${y}(${v})${_}`,e),l.propertyName=c}return c}generateTextureLoad(e,t,n,r,s,a){r===null&&(r="0");let o;return s?a?o=`texelFetchOffset( ${t}, ivec3( ${n}, ${s} ), ${r}, ${a} )`:o=`texelFetch( ${t}, ivec3( ${n}, ${s} ), ${r} )`:a?o=`texelFetchOffset( ${t}, ${n}, ${r}, ${a} )`:o=`texelFetch( ${t}, ${n}, ${r} )`,e!==null&&e.isDepthTexture&&(o+=".x"),o}generateTexture(e,t,n,r,s){return r&&(n=`vec3( ${n}, ${r} )`),e.isDepthTexture?s?`textureOffset( ${t}, ${n}, ${s} ).x`:`texture( ${t}, ${n} ).x`:s?`textureOffset( ${t}, ${n}, ${s} )`:`texture( ${t}, ${n} )`}generateTextureLevel(e,t,n,r,s){return s?`textureLodOffset( ${t}, ${n}, ${r}, ${s} )`:`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r,s){return s?`textureOffset( ${t}, ${n}, ${s}, ${r} )`:`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r,s){return s?`textureGradOffset( ${t}, ${n}, ${r[0]}, ${r[1]}, ${s} )`:`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,s,a,o=this.shaderStage){if(o==="fragment")return e.isCubeTexture?`texture( ${t}, vec4( ${n}, ${r} ) )`:s?a?`textureOffset( ${t}, vec4( ${n}, ${s}, ${r} ), ${a} )`:`texture( ${t}, vec4( ${n}, ${s}, ${r} ) )`:a?`textureOffset( ${t}, vec3( ${n}, ${r} ), ${a} )`:`texture( ${t}, vec3( ${n}, ${r} ) )`;Ee(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const a of t){let o=null,l=!1;if(a.type==="texture"||a.type==="texture3D"){const d=a.node.value;let f="";(d.isDataTexture===!0||d.isData3DTexture===!0)&&(d.type===yn?f="u":d.type===Ti&&(f="i")),a.type==="texture3D"&&d.isArrayTexture===!1?o=`${f}sampler3D ${a.name};`:d.compareFunction?d.isArrayTexture===!0?o=`sampler2DArrayShadow ${a.name};`:o=`sampler2DShadow ${a.name};`:d.isArrayTexture===!0||d.isDataArrayTexture===!0||d.isCompressedArrayTexture===!0?o=`${f}sampler2DArray ${a.name};`:o=`${f}sampler2D ${a.name};`}else if(a.type==="cubeTexture")o=`samplerCube ${a.name};`;else if(a.type==="cubeDepthTexture")o=`samplerCubeShadow ${a.name};`;else if(a.type==="buffer"){const d=a.node,f=this.getType(d.bufferType),p=d.bufferCount,m=p>0?p:"";o=`${d.name} {
	${f} ${a.name}[${m}];
};
`}else o=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,l=!0;const c=a.node.precision;if(c!==null&&(o=JX[c]+" "+o),l){o="	"+o;const d=a.groupNode.name;(r[d]||(r[d]=[])).push(o)}else o="uniform "+o,n.push(o)}let s="";for(const a in r){const o=r[a];s+=this._getGLSLUniformStruct(e+"_"+a,o.join(`
`))+`
`}return s+=n.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Ti){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let r=0;for(const s of n)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],r=[];for(const s of n)if(s.output)for(const a of s.members)r.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+s.name+` {
`;a+=this.getStructMembers(s),a+=`
};
`,t.push(a)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const r of n){e==="compute"&&(r.needsInterpolation=!0);const s=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const a=C2[r.interpolationType]||r.interpolationType,o=R2[r.interpolationSampling]||"";t+=`${a} ${o} out ${s} ${r.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}out ${s} ${r.name};
`}else t+=`${s} ${r.name};
`}else if(e==="fragment"){for(const r of n)if(r.needsInterpolation){const s=this.getType(r.type);if(r.interpolationType){const a=C2[r.interpolationType]||r.interpolationType,o=R2[r.interpolationSampling]||"";t+=`${a} ${o} in ${s} ${r.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}in ${s} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,r)=>n*r,1)}u`}getSubgroupSize(){Ee("GLSLNodeBuilder: WebGLBackend does not support the subgroupSize node")}getInvocationSubgroupIndex(){Ee("GLSLNodeBuilder: WebGLBackend does not support the invocationSubgroupIndex node")}getSubgroupIndex(){Ee("GLSLNodeBuilder: WebGLBackend does not support the subgroupIndex node")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:r,behavior:s}of n.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=E2[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}E2[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],s=this.getPropertyName(r.attributeNode);s&&(t+=`${r.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${N2}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${N2}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const o of r){const l=this.getFlowData(o),c=o.name;c&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${c}
	`),n+=`${l.code}
	`,o===s&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${l.result};`):t==="fragment"&&(o.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${l.result};`)))}const a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);let o=a.uniformGPU;if(o===void 0){const l=e.groupNode,c=l.name,d=this.getBindGroupArray(c,n);if(t==="texture")o=new M_(s.name,s.node,l),d.push(o);else if(t==="cubeTexture"||t==="cubeDepthTexture")o=new K3(s.name,s.node,l),d.push(o);else if(t==="texture3D")o=new dw(s.name,s.node,l),d.push(o);else if(t==="buffer"){s.name=`buffer${e.id}`;const f=this.getSharedDataFromNode(e);let p=f.buffer;p===void 0&&(e.name=`NodeBuffer_${e.id}`,p=new q3(e,l),p.name=e.name,f.buffer=p),d.push(p),o=p}else{const f=this.uniformGroups[n]||(this.uniformGroups[n]={});let p=f[c];p===void 0&&(p=new X3(n+"_"+c,l),f[c]=p,d.push(p)),o=this.getNodeUniform(s,t),p.addUniform(o)}a.uniformGPU=o}return s}}let ab=null,Hc=null;class Z3{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={[ya.RENDER]:null,[ya.COMPUTE]:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}updateSampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}updateTimeStampUID(e){const t=this.get(e),n=this.renderer.info.frame;let r;e.isComputeNode===!0?r="c:"+this.renderer.info.compute.frameCalls:r="r:"+this.renderer.info.render.frameCalls,t.timestampUID=r+":"+e.id+":f"+n}getTimestampUID(e){return this.get(e).timestampUID}getTimestampFrames(e){const t=this.timestampQueryPool[e];return t?t.getTimestampFrames():[]}_getQueryPool(e){const t=e.startsWith("c:")?ya.COMPUTE:ya.RENDER;return this.timestampQueryPool[t]}getTimestamp(e){return this._getQueryPool(e).getTimestamp(e)}hasTimestamp(e){return this._getQueryPool(e).hasTimestamp(e)}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Fn("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t)return;const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return ab=ab||new Xe,this.renderer.getDrawingBufferSize(ab)}setScissorTest(){}getClearColor(){const e=this.renderer;return Hc=Hc||new YS,e.getClearColor(Hc),Hc.getRGB(Hc),Hc}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:NR(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ku} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}deleteBindGroupData(){}dispose(){}}let tY=0;class nY{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class iY{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,s=e.array,a=e.usage||r.STATIC_DRAW,o=e.isInterleavedBufferAttribute?e.data:e,l=n.get(o);let c=l.bufferGPU;c===void 0&&(c=this._createBuffer(r,t,s,a),l.bufferGPU=c,l.bufferType=t,l.version=o.version);let d;if(s instanceof Float32Array)d=r.FLOAT;else if(typeof Float16Array<"u"&&s instanceof Float16Array)d=r.HALF_FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?d=r.HALF_FLOAT:d=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)d=r.SHORT;else if(s instanceof Uint32Array)d=r.UNSIGNED_INT;else if(s instanceof Int32Array)d=r.INT;else if(s instanceof Int8Array)d=r.BYTE;else if(s instanceof Uint8Array)d=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)d=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let f={bufferGPU:c,bufferType:t,type:d,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:d===r.INT||d===r.UNSIGNED_INT||e.gpuType===Ti,id:tY++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const p=this._createBuffer(r,t,s,a);f=new nY(f,p)}n.set(e,f)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,a=t.get(s),o=a.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(o,a.bufferGPU),l.length===0)n.bufferSubData(o,0,r);else{for(let c=0,d=l.length;c<d;c++){const f=l[c];n.bufferSubData(o,f.start*r.BYTES_PER_ELEMENT,r,f.start,f.count)}s.clearUpdateRanges()}n.bindBuffer(o,null),a.version=s.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),a=e.array,o=a.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,s);const l=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.bufferData(n.COPY_WRITE_BUFFER,o,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,o),await t.utils._clientWaitAsync();const c=new e.array.constructor(a.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,c),n.deleteBuffer(l),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),c.buffer}_createBuffer(e,t,n,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,n,r),e.bindBuffer(t,null),s}}let ob,Tf;class rY{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;ob={[Yi]:e.FUNC_ADD,[Cw]:e.FUNC_SUBTRACT,[Rw]:e.FUNC_REVERSE_SUBTRACT},Tf={[Ja]:e.ZERO,[Nw]:e.ONE,[Pw]:e.SRC_COLOR,[Zf]:e.SRC_ALPHA,[Uw]:e.SRC_ALPHA_SATURATE,[Lw]:e.DST_COLOR,[kw]:e.DST_ALPHA,[Dw]:e.ONE_MINUS_SRC_COLOR,[Qf]:e.ONE_MINUS_SRC_ALPHA,[Fw]:e.ONE_MINUS_DST_COLOR,[Iw]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new It().fromArray(t),this.currentViewport=new It().fromArray(n),this._tempVec4=new It}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==bR?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===Eb?t.cullFace(t.BACK):e===wR?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setMRTBlending(e){const t=this.gl,n=this.backend.drawBuffersIndexedExt;if(n)for(let r=1;r<e.length;r++)n.blendFuncSeparateiOES(r,t.ONE,t.ZERO,t.ONE,t.ZERO)}setBlending(e,t,n,r,s,a,o,l){const{gl:c}=this;if(e===pr){this.currentBlendingEnabled===!0&&(this.disable(c.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(c.BLEND),this.currentBlendingEnabled=!0),e!==Jc){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==Yi||this.currentBlendEquationAlpha!==Yi)&&(c.blendEquation(c.FUNC_ADD),this.currentBlendEquation=Yi,this.currentBlendEquationAlpha=Yi),l)switch(e){case Qr:c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case oh:c.blendFunc(c.ONE,c.ONE);break;case lh:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case uh:c.blendFuncSeparate(c.DST_COLOR,c.ONE_MINUS_SRC_ALPHA,c.ZERO,c.ONE);break;default:Ee("WebGLState: Invalid blending: ",e);break}else switch(e){case Qr:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case oh:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE,c.ONE,c.ONE);break;case lh:Ee("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case uh:Ee("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Ee("WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,a=a||n,o=o||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(c.blendEquationSeparate(ob[t],ob[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(n!==this.currentBlendSrc||r!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||o!==this.currentBlendDstAlpha)&&(c.blendFuncSeparate(Tf[n],Tf[r],Tf[a],Tf[o]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=o),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case Jf:t.depthFunc(t.NEVER);break;case ep:t.depthFunc(t.ALWAYS);break;case tp:t.depthFunc(t.LESS);break;case gl:t.depthFunc(t.LEQUAL);break;case np:t.depthFunc(t.EQUAL);break;case ip:t.depthFunc(t.GEQUAL);break;case rp:t.depthFunc(t.GREATER);break;case sp:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentScissor.equals(s)===!1){const{gl:a}=this;a.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,n,r){const s=this._tempVec4.set(e,t,n,r);if(this.currentViewport.equals(s)===!1){const{gl:a}=this;a.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:r}=this;e.side===Xi?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let s=e.side===En;t&&(s=!s),this.setFlipSided(s),e.blending===Qr&&e.transparent===!1?this.setBlending(pr):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.currentSamples>0?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let l=0;l<8;l++)l<n?this.enable(12288+l):this.disable(12288+l)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t?(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const a=e.textures;if(r.length!==a.length||r[0]!==n.COLOR_ATTACHMENT0){for(let o=0,l=a.length;o<l;o++)r[o]=n.COLOR_ATTACHMENT0+o;r.length=a.length,s=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,s=!0);s&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:s,currentBoundTextures:a,maxTextures:o}=this;n===void 0&&(s===null?n=r.TEXTURE0+o-1:n=s);let l=a[n];l===void 0&&(l={type:void 0,texture:void 0},a[n]=l),(l.type!==e||l.texture!==t)&&(s!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==n?(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[s]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class sY{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Er){const{gl:n,extensions:r}=this;let s;const a=bt.getTransfer(t);if(e===Un)return n.UNSIGNED_BYTE;if(e===Z0)return n.UNSIGNED_SHORT_4_4_4_4;if(e===Q0)return n.UNSIGNED_SHORT_5_5_5_1;if(e===J0)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===e_)return n.UNSIGNED_INT_10F_11F_11F_REV;if(e===du)return n.BYTE;if(e===fu)return n.SHORT;if(e===js)return n.UNSIGNED_SHORT;if(e===Ti)return n.INT;if(e===yn)return n.UNSIGNED_INT;if(e===Qn)return n.FLOAT;if(e===Wn)return n.HALF_FLOAT;if(e===$w)return n.ALPHA;if(e===bp)return n.RGB;if(e===Jn)return n.RGBA;if(e===ki)return n.DEPTH_COMPONENT;if(e===hr)return n.DEPTH_STENCIL;if(e===wp)return n.RED;if(e===Xh)return n.RED_INTEGER;if(e===dr)return n.RG;if(e===Yh)return n.RG_INTEGER;if(e===Kh)return n.RGBA_INTEGER;if(e===ll||e===ul||e===cl||e===hl)if(a===Ze)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===ll)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===ul)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===cl)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===hl)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===ll)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ul)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===cl)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===hl)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===ap||e===op||e===lp||e===up)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===ap)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===op)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===lp)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===up)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===dh||e===fh||e===ph||e===gh||e===mh||e===Su||e===_h)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===dh||e===fh)return a===Ze?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===ph)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(e===gh)return s.COMPRESSED_R11_EAC;if(e===mh)return s.COMPRESSED_SIGNED_R11_EAC;if(e===Su)return s.COMPRESSED_RG11_EAC;if(e===_h)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(e===yh||e===vh||e===xh||e===bh||e===wh||e===Sh||e===Th||e===Mh||e===Ah||e===Eh||e===Ch||e===Rh||e===Nh||e===Ph)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===yh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===vh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===xh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===bh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===wh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Sh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Th)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Mh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Ah)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Eh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Ch)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Rh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Nh)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Ph)return a===Ze?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Dh)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===Dh)return a===Ze?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===kh||e===Ih||e===Tu||e===Lh)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===kh)return s.COMPRESSED_RED_RGTC1_EXT;if(e===Ih)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Tu)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===Lh)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Jr?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,r)=>{function s(){const a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),r();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),n()}s()})}}let P2=!1,s0,lb,D2;class aY{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},this._srcFramebuffer=null,this._dstFramebuffer=null,P2===!1&&(this._init(),P2=!0)}_init(){const e=this.gl;s0={[bu]:e.REPEAT,[Rr]:e.CLAMP_TO_EDGE,[wu]:e.MIRRORED_REPEAT},lb={[vn]:e.NEAREST,[Ww]:e.NEAREST_MIPMAP_NEAREST,[oo]:e.NEAREST_MIPMAP_LINEAR,[In]:e.LINEAR,[eh]:e.LINEAR_MIPMAP_NEAREST,[Nr]:e.LINEAR_MIPMAP_LINEAR},D2={[qw]:e.NEVER,[Zw]:e.ALWAYS,[Sp]:e.LESS,[Tp]:e.LEQUAL,[Xw]:e.EQUAL,[Mp]:e.GEQUAL,[Yw]:e.GREATER,[Kw]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,s=!1){const{gl:a,extensions:o}=this;if(e!==null){if(a[e]!==void 0)return a[e];Ae("WebGLBackend: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;if(t===a.RED&&(n===a.FLOAT&&(l=a.R32F),n===a.HALF_FLOAT&&(l=a.R16F),n===a.UNSIGNED_BYTE&&(l=a.R8),n===a.UNSIGNED_SHORT&&(l=a.R16),n===a.UNSIGNED_INT&&(l=a.R32UI),n===a.BYTE&&(l=a.R8I),n===a.SHORT&&(l=a.R16I),n===a.INT&&(l=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.R8UI),n===a.UNSIGNED_SHORT&&(l=a.R16UI),n===a.UNSIGNED_INT&&(l=a.R32UI),n===a.BYTE&&(l=a.R8I),n===a.SHORT&&(l=a.R16I),n===a.INT&&(l=a.R32I)),t===a.RG&&(n===a.FLOAT&&(l=a.RG32F),n===a.HALF_FLOAT&&(l=a.RG16F),n===a.UNSIGNED_BYTE&&(l=a.RG8),n===a.UNSIGNED_SHORT&&(l=a.RG16),n===a.UNSIGNED_INT&&(l=a.RG32UI),n===a.BYTE&&(l=a.RG8I),n===a.SHORT&&(l=a.RG16I),n===a.INT&&(l=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RG8UI),n===a.UNSIGNED_SHORT&&(l=a.RG16UI),n===a.UNSIGNED_INT&&(l=a.RG32UI),n===a.BYTE&&(l=a.RG8I),n===a.SHORT&&(l=a.RG16I),n===a.INT&&(l=a.RG32I)),t===a.RGB){const c=s?Fh:bt.getTransfer(r);n===a.FLOAT&&(l=a.RGB32F),n===a.HALF_FLOAT&&(l=a.RGB16F),n===a.UNSIGNED_BYTE&&(l=a.RGB8),n===a.UNSIGNED_SHORT&&(l=a.RGB16),n===a.UNSIGNED_INT&&(l=a.RGB32UI),n===a.BYTE&&(l=a.RGB8I),n===a.SHORT&&(l=a.RGB16I),n===a.INT&&(l=a.RGB32I),n===a.UNSIGNED_BYTE&&(l=c===Ze?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(l=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(l=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(l=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(l=a.RGB9_E5),n===a.UNSIGNED_INT_10F_11F_11F_REV&&(l=a.R11F_G11F_B10F)}if(t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RGB8UI),n===a.UNSIGNED_SHORT&&(l=a.RGB16UI),n===a.UNSIGNED_INT&&(l=a.RGB32UI),n===a.BYTE&&(l=a.RGB8I),n===a.SHORT&&(l=a.RGB16I),n===a.INT&&(l=a.RGB32I)),t===a.RGBA){const c=s?Fh:bt.getTransfer(r);n===a.FLOAT&&(l=a.RGBA32F),n===a.HALF_FLOAT&&(l=a.RGBA16F),n===a.UNSIGNED_BYTE&&(l=a.RGBA8),n===a.UNSIGNED_SHORT&&(l=a.RGBA16),n===a.UNSIGNED_INT&&(l=a.RGBA32UI),n===a.BYTE&&(l=a.RGBA8I),n===a.SHORT&&(l=a.RGBA16I),n===a.INT&&(l=a.RGBA32I),n===a.UNSIGNED_BYTE&&(l=c===Ze?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(l=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(l=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(l=a.RGBA16UI),n===a.UNSIGNED_INT&&(l=a.RGBA32UI),n===a.BYTE&&(l=a.RGBA8I),n===a.SHORT&&(l=a.RGBA16I),n===a.INT&&(l=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(l=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(l=a.DEPTH_COMPONENT24),n===a.FLOAT&&(l=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(l=a.DEPTH24_STENCIL8),(l===a.R16F||l===a.R32F||l===a.RG16F||l===a.RG32F||l===a.RGBA16F||l===a.RGBA32F)&&o.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:n,extensions:r,backend:s}=this,a=bt.getPrimaries(bt.workingColorSpace),o=t.colorSpace===Er?null:bt.getPrimaries(t.colorSpace),l=t.colorSpace===Er||a===o?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,l),n.texParameteri(e,n.TEXTURE_WRAP_S,s0[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,s0[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,s0[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,lb[t.magFilter]);const c=t.mipmaps!==void 0&&t.mipmaps.length>0,d=t.minFilter===In&&c?Nr:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,lb[d]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,D2[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===vn||t.minFilter!==oo&&t.minFilter!==Nr||t.type===Qn&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const f=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,f.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,s=this.getGLTextureType(e);let a=r[s];a===void 0&&(a=t.createTexture(),n.state.bindTexture(s,a),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=a),n.set(e,{textureGPU:a,glTextureType:s})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:s,width:a,height:o,depth:l}=t,c=r.utils.convert(e.format,e.colorSpace),d=r.utils.convert(e.type),f=this.getInternalFormat(e.internalFormat,c,d,e.colorSpace,e.isVideoTexture),p=n.createTexture(),m=this.getGLTextureType(e);r.state.bindTexture(m,p),this.setTextureParameters(m,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,s,f,a,o,l):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,s,f,a,o,l):e.isVideoTexture||n.texStorage2D(m,s,f,a,o),r.set(e,{textureGPU:p,glTextureType:m,glFormat:c,glType:d,glInternalFormat:f})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:s,glTextureType:a,glFormat:o,glType:l}=r.get(t),{width:c,height:d}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(a,s),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(a,0,0,0,c,d,o,l,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:s}=t,{textureGPU:a,glTextureType:o,glFormat:l,glType:c,glInternalFormat:d}=this.backend.get(e);if(!(e.isRenderTargetTexture||a===void 0))if(this.backend.state.bindTexture(o,a),this.setTextureParameters(o,e),e.isCompressedTexture){const f=e.mipmaps,p=t.image;for(let m=0;m<f.length;m++){const _=f[m];e.isCompressedArrayTexture?e.format!==n.RGBA?l!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,m,0,0,0,_.width,_.height,p.depth,l,_.data):Ae("WebGLBackend: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,m,0,0,0,_.width,_.height,p.depth,l,c,_.data):l!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,m,0,0,_.width,_.height,l,_.data):Ae("WebGLBackend: Unsupported compressed texture format")}}else if(e.isCubeTexture){const f=t.images,p=e.mipmaps;for(let m=0;m<6;m++){const _=a0(f[m]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,0,0,r,s,l,c,_);for(let b=0;b<p.length;b++){const v=p[b],y=a0(v.images[m]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+m,b+1,0,0,y.width,y.height,l,c,y)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const f=t.image;if(e.layerUpdates.size>0){const p=kb(f.width,f.height,e.format,e.type);for(const m of e.layerUpdates){const _=f.data.subarray(m*p/f.data.BYTES_PER_ELEMENT,(m+1)*p/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,m,f.width,f.height,1,l,c,_)}e.clearLayerUpdates()}else n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,l,c,f.data)}else if(e.isData3DTexture){const f=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,l,c,f.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(o,0,d,l,c,t.image);else{const f=e.mipmaps;if(f.length>0)for(let p=0,m=f.length;p<m;p++){const _=f[p],b=a0(_);n.texSubImage2D(o,p,0,0,_.width,_.height,l,c,b)}else{const p=a0(t.image);n.texSubImage2D(o,0,0,0,r,s,l,c,p)}}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:s}=n.get(e);n.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e,t=!1){const{gl:n,backend:r}=this,{textureGPU:s,renderTarget:a}=r.get(e);this.deallocateRenderBuffers(a),t===!1&&n.deleteTexture(s),r.delete(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){const{gl:o,backend:l}=this,{state:c}=this.backend,{textureGPU:d,glTextureType:f,glType:p,glFormat:m}=l.get(t);c.bindTexture(f,d);let _,b,v,y,S,T,E,N,M;const C=e.isCompressedTexture?e.mipmaps[a]:e.image;if(n!==null)_=n.max.x-n.min.x,b=n.max.y-n.min.y,v=n.isBox3?n.max.z-n.min.z:1,y=n.min.x,S=n.min.y,T=n.isBox3?n.min.z:0;else{const V=Math.pow(2,-s);_=Math.floor(C.width*V),b=Math.floor(C.height*V),e.isDataArrayTexture||e.isArrayTexture?v=C.depth:e.isData3DTexture?v=Math.floor(C.depth*V):v=1,y=0,S=0,T=0}r!==null?(E=r.x,N=r.y,M=r.z):(E=0,N=0,M=0),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment);const D=o.getParameter(o.UNPACK_ROW_LENGTH),R=o.getParameter(o.UNPACK_IMAGE_HEIGHT),P=o.getParameter(o.UNPACK_SKIP_PIXELS),L=o.getParameter(o.UNPACK_SKIP_ROWS),z=o.getParameter(o.UNPACK_SKIP_IMAGES);o.pixelStorei(o.UNPACK_ROW_LENGTH,C.width),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,C.height),o.pixelStorei(o.UNPACK_SKIP_PIXELS,y),o.pixelStorei(o.UNPACK_SKIP_ROWS,S),o.pixelStorei(o.UNPACK_SKIP_IMAGES,T);const B=e.isDataArrayTexture||e.isData3DTexture||t.isArrayTexture,O=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isDepthTexture){const V=l.get(e),Y=l.get(t),G=l.get(V.renderTarget),W=l.get(Y.renderTarget),te=G.framebuffers[V.cacheKey],U=W.framebuffers[Y.cacheKey];c.bindFramebuffer(o.READ_FRAMEBUFFER,te),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,U);for(let H=0;H<v;H++)B&&(o.framebufferTextureLayer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,V.textureGPU,s,T+H),o.framebufferTextureLayer(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,a,M+H)),o.blitFramebuffer(y,S,_,b,E,N,_,b,o.DEPTH_BUFFER_BIT,o.NEAREST);c.bindFramebuffer(o.READ_FRAMEBUFFER,null),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else if(s!==0||e.isRenderTargetTexture||l.has(e)){const V=l.get(e);this._srcFramebuffer===null&&(this._srcFramebuffer=o.createFramebuffer()),this._dstFramebuffer===null&&(this._dstFramebuffer=o.createFramebuffer()),c.bindFramebuffer(o.READ_FRAMEBUFFER,this._srcFramebuffer),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,this._dstFramebuffer);for(let Y=0;Y<v;Y++)B?o.framebufferTextureLayer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,V.textureGPU,s,T+Y):o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,V.textureGPU,s),O?o.framebufferTextureLayer(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,a,M+Y):o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,d,a),s!==0?o.blitFramebuffer(y,S,_,b,E,N,_,b,o.COLOR_BUFFER_BIT,o.NEAREST):O?o.copyTexSubImage3D(f,a,E,N,M+Y,y,S,_,b):o.copyTexSubImage2D(f,a,E,N,y,S,_,b);c.bindFramebuffer(o.READ_FRAMEBUFFER,null),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else O?e.isDataTexture||e.isData3DTexture?o.texSubImage3D(f,a,E,N,M,_,b,v,m,p,C.data):t.isCompressedArrayTexture?o.compressedTexSubImage3D(f,a,E,N,M,_,b,v,m,C.data):o.texSubImage3D(f,a,E,N,M,_,b,v,m,p,C):e.isDataTexture?o.texSubImage2D(o.TEXTURE_2D,a,E,N,_,b,m,p,C.data):e.isCompressedTexture?o.compressedTexSubImage2D(o.TEXTURE_2D,a,E,N,C.width,C.height,m,C.data):o.texSubImage2D(o.TEXTURE_2D,a,E,N,_,b,m,p,C);o.pixelStorei(o.UNPACK_ROW_LENGTH,D),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,R),o.pixelStorei(o.UNPACK_SKIP_PIXELS,P),o.pixelStorei(o.UNPACK_SKIP_ROWS,L),o.pixelStorei(o.UNPACK_SKIP_IMAGES,z),a===0&&t.generateMipmaps&&o.generateMipmap(f),c.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:s}=this.backend,{textureGPU:a}=this.backend.get(e),{x:o,y:l,z:c,w:d}=n,f=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,p=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(f){const m=o!==0||l!==0;let _,b;if(e.isDepthTexture===!0?(_=r.DEPTH_BUFFER_BIT,b=r.DEPTH_ATTACHMENT,t.stencil&&(_|=r.STENCIL_BUFFER_BIT)):(_=r.COLOR_BUFFER_BIT,b=r.COLOR_ATTACHMENT0),m){const v=this.backend.get(t.renderTarget),y=v.framebuffers[t.getCacheKey()],S=v.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,y),s.bindFramebuffer(r.READ_FRAMEBUFFER,S);const T=p-l-d;r.blitFramebuffer(o,T,o+c,T+d,o,T,o+c,T+d,_,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,y),s.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,o,T,c,d),s.unbindTexture()}else{const v=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,v),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,b,r.TEXTURE_2D,a,0),r.blitFramebuffer(0,0,c,d,0,0,c,d,_,r.NEAREST),r.deleteFramebuffer(v)}}else s.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,o,p-d-l,c,d),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,r=!1){const{gl:s}=this,a=t.renderTarget,{depthTexture:o,depthBuffer:l,stencilBuffer:c,width:d,height:f}=a;if(s.bindRenderbuffer(s.RENDERBUFFER,e),l&&!c){let p=s.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,a.samples,p,d,f):n>0?(o&&o.isDepthTexture&&o.type===s.FLOAT&&(p=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,n,p,d,f)):s.renderbufferStorage(s.RENDERBUFFER,p,d,f),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else l&&c&&(n>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,s.DEPTH24_STENCIL8,d,f):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,d,f),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e));s.bindRenderbuffer(s.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,n,r,s,a){const{backend:o,gl:l}=this,{textureGPU:c,glFormat:d,glType:f}=this.backend.get(e),p=l.createFramebuffer();o.state.bindFramebuffer(l.READ_FRAMEBUFFER,p);const m=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+a:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,m,c,0);const _=this._getTypedArrayType(f),b=this._getBytesPerTexel(f,d),y=r*s*b,S=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,S),l.bufferData(l.PIXEL_PACK_BUFFER,y,l.STREAM_READ),l.readPixels(t,n,r,s,d,f,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await o.utils._clientWaitAsync();const T=new _(y/_.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,S),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,T),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),o.state.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.deleteFramebuffer(p),T}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;if(e===n.UNSIGNED_BYTE&&(r=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(r=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(r=4),t===n.RGBA)return r*4;if(t===n.RGB)return r*3;if(t===n.ALPHA)return r}dispose(){const{gl:e}=this;this._srcFramebuffer!==null&&e.deleteFramebuffer(this._srcFramebuffer),this._dstFramebuffer!==null&&e.deleteFramebuffer(this._dstFramebuffer)}}function a0(i){return i.isDataTexture?i.image.data:typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?i:i.data}class oY{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class lY{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const k2={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-s3tc",EXT_texture_compression_bptc:"texture-compression-bc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class uY{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:s,type:a,info:o,index:l}=this;l!==0?n.drawElements(r,t,a,e):n.drawArrays(r,e,t),o.update(s,t,1)}renderInstances(e,t,n){const{gl:r,mode:s,type:a,index:o,object:l,info:c}=this;n!==0&&(o!==0?r.drawElementsInstanced(s,t,a,e,n):r.drawArraysInstanced(s,e,t,n),c.update(l,t,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:s,object:a,info:o}=this;if(n===0)return;const l=r.get("WEBGL_multi_draw");if(l===null)for(let c=0;c<n;c++)this.render(e[c],t[c]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,n):l.multiDrawArraysWEBGL(s,e,0,t,0,n);let c=0;for(let d=0;d<n;d++)c+=t[d];o.update(a,c,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:s,mode:a,object:o,info:l}=this;if(n===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let d=0;d<n;d++)this.renderInstances(e[d],t[d],r[d]);else{this.index!==0?c.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,r,0,n):c.multiDrawArraysInstancedWEBGL(a,e,0,t,0,r,0,n);let d=0;for(let f=0;f<n;f++)d+=t[f]*r[f];l.update(o,d,1)}}}class Q3{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.frames=[],this.pendingResolve=!1,this.timestamps=new Map}getTimestampFrames(){return this.frames}getTimestamp(e){let t=this.timestamps.get(e);return t===void 0&&(Ae(`TimestampQueryPool: No timestamp available for uid ${e}.`),t=0),t}hasTimestamp(e){return this.timestamps.has(e)}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class cY extends Q3{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){Ae("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Fn(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){Ee("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){Ee("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=new Map;for(const[s,a]of this.queryOffsets)if(this.queryStates.get(a)==="ended"){const l=this.queries[a];e.set(s,this.resolveQuery(l))}if(e.size===0)return this.lastValue;const t={},n=[];for(const[s,a]of e){const o=s.match(/^(.*):f(\d+)$/),l=parseInt(o[2]);n.includes(l)===!1&&n.push(l),t[l]===void 0&&(t[l]=0);const c=await a;this.timestamps.set(s,c),t[l]+=c}const r=t[n[n.length-1]];return this.lastValue=r,this.frames=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,r}catch(e){return Ee("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,r=!1;const s=()=>{n&&(clearTimeout(n),n=null)},a=l=>{r||(r=!0,s(),t(l))},o=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(o,1);return}const d=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(d)/1e6)}catch(l){Ee("Error checking query:",l),t(this.lastValue)}};o()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class I2 extends Z3{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.currentSamples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function s(a){a.preventDefault();const o={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(o)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=r,this.extensions=new oY(this),this.capabilities=new lY(this),this.attributeUtils=new iY(this),this.textureUtils=new aY(this),this.bufferRenderer=new uY(this),this.state=new rY(this),this.utils=new sY(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this.drawBuffersIndexedExt=this.extensions.get("OES_draw_buffers_indexed")}get coordinateSystem(){return fr}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),n!==null){const s=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview===!1&&Ae("WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new cY(this.gl,e,2048));const n=this.timestampQueryPool[e];n.allocateQueriesForContext(t)!==null&&n.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:s,height:a}=this.getDrawingBufferSize();t.viewport(0,0,s,a)}if(e.scissor){const{x:s,y:a,width:o,height:l}=e.scissorValue;t.scissor(s,e.height-l-a,o,l)}this.initTimestampQuery(ya.RENDER,this.getTimestampUID(e)),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),s=r.previousContext;n.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const o=e.textures;if(o!==null)for(let l=0;l<o.length;l++){const c=o[l];c.generateMipmaps&&this.generateMipmaps(c)}if(this._currentContext=s,this._resolveRenderTarget(e),s!==null)if(this._setFramebuffer(s),s.viewport)this.updateViewport(s);else{const{width:l,height:c}=this.getDrawingBufferSize();n.viewport(0,0,l,c)}this.prepareTimestampBuffer(ya.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet,{gl:a}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const o=()=>{let l=0;for(let c=0;c<n.length;c++){const d=n[c];d!==null&&a.getQueryParameter(d,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(d,a.QUERY_RESULT)===0&&s.add(r[c]),n[c]=null,a.deleteQuery(d),l++)}l<n.length?requestAnimationFrame(o):t.occluded=s};o()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:r,width:s,height:a}=e.viewportValue;t.viewport(n,e.height-a-r,s,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,r=null,s=!0,a=!0){const{gl:o,renderer:l}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let c=0;if(e&&(c|=o.COLOR_BUFFER_BIT),t&&(c|=o.DEPTH_BUFFER_BIT),n&&(c|=o.STENCIL_BUFFER_BIT),c!==0){let d;r.clearColorValue?d=r.clearColorValue:d=this.getClearColor();const f=l.getClearDepth(),p=l.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(d.r,d.g,d.b,d.a),o.clear(c);else{if(s&&this._setFramebuffer(r),e)for(let m=0;m<r.textures.length;m++)m===0?o.clearBufferfv(o.COLOR,m,[d.r,d.g,d.b,d.a]):o.clearBufferfv(o.COLOR,m,[0,0,0,1]);t&&n?o.clearBufferfi(o.DEPTH_STENCIL,0,f,p):t?o.clearBufferfv(o.DEPTH,0,[f]):n&&o.clearBufferiv(o.STENCIL,0,[p]),s&&a&&this._resolveRenderTarget(r)}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(ya.COMPUTE,this.getTimestampUID(e))}compute(e,t,n,r,s=null){const{state:a,gl:o}=this;this.discard===!1&&(a.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:l,transformBuffers:c,attributes:d}=this.get(r),f=this._getVaoKey(d),p=this.vaoCache[f];p===void 0?this.vaoCache[f]=this._createVao(d):a.setVertexState(p),a.useProgram(l),this._bindUniforms(n);const m=this._getTransformFeedback(c);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,m),o.beginTransformFeedback(o.POINTS),s=s!==null?s:t.count,Array.isArray(s)?(Fn("WebGLBackend.compute(): The count parameter must be a single number, not an array."),s=s[0]):s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute&&(Fn("WebGLBackend.compute(): The count parameter must be a single number, not IndirectStorageBufferAttribute"),s=t.count),d[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,s):o.drawArrays(o.POINTS,0,s),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let _=0;_<c.length;_++){const b=c[_];b.pbo&&this.has(b.pbo)&&this.textureUtils.copyBufferToTexture(b.transformBuffer,b.pbo),b.switchBuffers()}}finishCompute(e){const{state:t,gl:n}=this;this.discard=!1,t.disable(n.RASTERIZER_DISCARD),this.prepareTimestampBuffer(ya.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:r,context:s,hardwareClippingPlanes:a}=e,{programGPU:o}=this.get(n),{gl:l,state:c}=this,d=this.get(s),f=e.getDrawParameters();if(f===null)return;this._bindUniforms(e.getBindings());const p=t.isMesh&&t.matrixWorld.determinant()<0;c.setMaterial(r,p,a),s.textures!==null&&s.textures.length>1&&c.setMRTBlending(s.textures),c.useProgram(o);const m=e.getAttributes(),_=this.get(m);let b=_.vaoGPU;if(b===void 0){const D=this._getVaoKey(m);b=this.vaoCache[D],b===void 0&&(b=this._createVao(m),this.vaoCache[D]=b,_.vaoGPU=b)}const v=e.getIndex(),y=v!==null?this.get(v).bufferGPU:null;c.setVertexState(b,y);const S=d.lastOcclusionObject;if(S!==t&&S!==void 0){if(S!==null&&S.occlusionTest===!0&&(l.endQuery(l.ANY_SAMPLES_PASSED),d.occlusionQueryIndex++),t.occlusionTest===!0){const D=l.createQuery();l.beginQuery(l.ANY_SAMPLES_PASSED,D),d.occlusionQueries[d.occlusionQueryIndex]=D,d.occlusionQueryObjects[d.occlusionQueryIndex]=t}d.lastOcclusionObject=t}const T=this.bufferRenderer;t.isPoints?T.mode=l.POINTS:t.isLineSegments?T.mode=l.LINES:t.isLine?T.mode=l.LINE_STRIP:t.isLineLoop?T.mode=l.LINE_LOOP:r.wireframe===!0?(c.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),T.mode=l.LINES):T.mode=l.TRIANGLES;const{vertexCount:E,instanceCount:N}=f;let{firstVertex:M}=f;if(T.object=t,v!==null){M*=v.array.BYTES_PER_ELEMENT;const D=this.get(v);T.index=v.count,T.type=D.type}else T.index=0;const C=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(Fn("WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),T.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?T.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Fn("WebGLBackend: WEBGL_multi_draw not supported."):N>1?T.renderInstances(M,E,N):T.render(M,E)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const D=this.get(e.camera),R=e.camera.cameras,P=e.getBindingGroup("cameraIndex").bindings[0];if(D.indexesGPU===void 0||D.indexesGPU.length!==R.length){const Y=new Uint32Array([0,0,0,0]),G=[];for(let W=0,te=R.length;W<te;W++){const U=l.createBuffer();Y[0]=W,l.bindBuffer(l.UNIFORM_BUFFER,U),l.bufferData(l.UNIFORM_BUFFER,Y,l.STATIC_DRAW),G.push(U)}D.indexesGPU=G}const L=this.get(P),z=this.renderer.getPixelRatio(),B=this._currentContext.renderTarget,O=this._isRenderCameraDepthArray(this._currentContext),V=this._currentContext.activeCubeFace;if(O){const Y=this.get(B.depthTexture);if(Y.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){Y.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:G}=B;for(let W=0,te=R.length;W<te;W++)this.renderer._activeCubeFace=W,this._currentContext.activeCubeFace=W,this._setFramebuffer(this._currentContext),this.clear(!1,!0,G,this._currentContext,!1,!1);this.renderer._activeCubeFace=V,this._currentContext.activeCubeFace=V}}for(let Y=0,G=R.length;Y<G;Y++){const W=R[Y];if(t.layers.test(W.layers)){O&&(this.renderer._activeCubeFace=Y,this._currentContext.activeCubeFace=Y,this._setFramebuffer(this._currentContext));const te=W.viewport;if(te!==void 0){const U=te.x*z,H=te.y*z,le=te.width*z,Te=te.height*z;c.viewport(Math.floor(U),Math.floor(e.context.height-Te-H),Math.floor(le),Math.floor(Te))}c.bindBufferBase(l.UNIFORM_BUFFER,L.index,D.indexesGPU[Y]),C()}this._currentContext.activeCubeFace=V,this.renderer._activeCubeFace=V}}else C()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,r,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,a)}updateSampler(){return""}createNodeBuilder(e,t){return new eY(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,s=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:a}=r,o=n.createProgram(),l=this.get(s).shaderGPU,c=this.get(a).shaderGPU;if(n.attachShader(o,l),n.attachShader(o,c),n.linkProgram(o),this.set(r,{programGPU:o,fragmentShader:l,vertexShader:c}),t!==null&&this.parallel){const d=new Promise(f=>{const p=this.parallel,m=()=>{n.getProgramParameter(o,p.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),f()):requestAnimationFrame(m)};m()});t.push(d);return}this._completeCompile(e,r)}_handleSource(e,t){const n=e.split(`
`),r=[],s=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let o=s;o<a;o++){const l=o+1;r.push(`${l===t?">":" "} ${l}: ${n[o]}`)}return r.join(`
`)}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),a=(e.getShaderInfoLog(t)||"").trim();if(r&&a==="")return"";const o=/ERROR: 0:(\d+)/.exec(a);if(o){const l=parseInt(o[1]);return n.toUpperCase()+`

`+a+`

`+this._handleSource(e.getShaderSource(t),l)}else return a}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,a=(r.getProgramInfoLog(e)||"").trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,n,t);else{const o=this._getShaderErrors(r,n,"vertex"),l=this._getShaderErrors(r,t,"fragment");Ee("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+a+`
`+o+`
`+l)}else a!==""&&Ae("WebGLProgram: Program Info Log:",a)}}_completeCompile(e,t){const{state:n,gl:r}=this,s=this.get(t),{programGPU:a,fragmentShader:o,vertexShader:l}=s;r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,o,l),n.useProgram(a);const c=e.getBindings();this._setupBindings(c,a),this.set(t,{programGPU:a})}createComputePipeline(e,t){const{state:n,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:a}=e,o=r.createProgram(),l=this.get(s).shaderGPU,c=this.get(a).shaderGPU,d=a.transforms,f=[],p=[];for(let v=0;v<d.length;v++){const y=d[v];f.push(y.varyingName),p.push(y.attributeNode)}r.attachShader(o,l),r.attachShader(o,c),r.transformFeedbackVaryings(o,f,r.SEPARATE_ATTRIBS),r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,l,c),n.useProgram(o),this._setupBindings(t,o);const m=a.attributes,_=[],b=[];for(let v=0;v<m.length;v++){const y=m[v].node.attribute;_.push(y),this.has(y)||this.attributeUtils.createAttribute(y,r.ARRAY_BUFFER)}for(let v=0;v<p.length;v++){const y=p[v].attribute;this.has(y)||this.attributeUtils.createAttribute(y,r.ARRAY_BUFFER);const S=this.get(y);b.push(S)}this.set(e,{programGPU:o,transformBuffers:b,attributes:_})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:n});for(const a of s.bindings)a.isUniformBuffer&&n++,a.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,s=n.textures;for(const a of e.bindings){const o=this.get(a);if(a.isUniformsGroup||a.isUniformBuffer){const l=a.buffer;let{bufferGPU:c}=this.get(l);c===void 0?(c=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,c),t.bufferData(t.UNIFORM_BUFFER,l.byteLength,t.DYNAMIC_DRAW),this.set(l,{bufferGPU:c})):t.bindBuffer(t.UNIFORM_BUFFER,c);const d=a.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,c),d.length===0)t.bufferData(t.UNIFORM_BUFFER,l,t.DYNAMIC_DRAW);else{const f=P0(l),p=f?1:l.BYTES_PER_ELEMENT;for(let m=0,_=d.length;m<_;m++){const b=d[m],v=b.start*p,y=b.count*p,S=v*(f?l.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,S,l,v,y)}}o.index=r++,o.bufferGPU=c,this.set(a,o)}else if(a.isSampledTexture){const{textureGPU:l,glTextureType:c}=this.get(a.texture);o.index=s++,o.textureGPU=l,o.glTextureType=c,this.set(a,o)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer,a=e.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,r),a.length===0)t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW);else{const o=P0(s),l=o?1:s.BYTES_PER_ELEMENT;for(let c=0,d=a.length;c<d;c++){const f=a[c],p=f.start*l,m=f.count*l,_=p*(o?s.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,_,s,p,m)}}}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(k2).filter(r=>k2[r]===e),n=this.extensions;for(let r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){this.textureUtils.copyTextureToTexture(e,t,n,r,s,a)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,a=this.get(s),{samples:o,depthBuffer:l,stencilBuffer:c}=s,d=s.isWebGLCubeRenderTarget===!0,f=s.isRenderTarget3D===!0,p=s.depth>1,m=s.isXRRenderTarget===!0,_=m===!0&&s._hasExternalTextures===!0;let b=a.msaaFrameBuffer,v=a.depthRenderbuffer;const y=this.extensions.get("WEBGL_multisampled_render_to_texture"),S=this.extensions.get("OVR_multiview2"),T=this._useMultisampledExtension(s),E=R3(e);let N;if(d?(a.cubeFramebuffers||(a.cubeFramebuffers={}),N=a.cubeFramebuffers[E]):m&&_===!1?N=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),N=a.framebuffers[E]),N===void 0){N=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,N);const M=e.textures,C=[];if(d){a.cubeFramebuffers[E]=N;const{textureGPU:R}=this.get(M[0]),P=this.renderer._activeCubeFace,L=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+P,R,L)}else{a.framebuffers[E]=N;for(let R=0;R<M.length;R++){const P=M[R],L=this.get(P);L.renderTarget=e.renderTarget,L.cacheKey=E;const z=t.COLOR_ATTACHMENT0+R;if(s.multiview)S.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,z,L.textureGPU,0,o,0,2);else if(f||p){const B=this.renderer._activeCubeFace,O=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,z,L.textureGPU,O,B)}else if(T)y.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,z,t.TEXTURE_2D,L.textureGPU,0,o);else{const B=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,z,t.TEXTURE_2D,L.textureGPU,B)}}}const D=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const R=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(R,e,0,T),a.xrDepthRenderbuffer=R,C.push(c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,R),t.framebufferRenderbuffer(t.FRAMEBUFFER,D,t.RENDERBUFFER,R)}else if(e.depthTexture!==null){C.push(c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const R=this.get(e.depthTexture);if(R.renderTarget=e.renderTarget,R.cacheKey=E,s.multiview)S.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,D,R.textureGPU,0,o,0,2);else if(_&&T)y.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,D,t.TEXTURE_2D,R.textureGPU,0,o);else if(e.depthTexture.isArrayTexture){const P=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,D,R.textureGPU,0,P)}else if(e.depthTexture.isCubeTexture){const P=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,D,t.TEXTURE_CUBE_MAP_POSITIVE_X+P,R.textureGPU,0)}else t.framebufferTexture2D(t.FRAMEBUFFER,D,t.TEXTURE_2D,R.textureGPU,0)}a.depthInvalidationArray=C}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,N);const C=this.renderer._activeCubeFace,D=this.get(e.depthTexture),R=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,R,D.textureGPU,0,C)}if((m||T||s.multiview)&&s._isOpaqueFramebuffer!==!0){n.bindFramebuffer(t.FRAMEBUFFER,N);const C=this.get(e.textures[0]);s.multiview?S.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,C.textureGPU,0,o,0,2):T?y.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,C.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,C.textureGPU,0);const D=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const R=a.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,R),t.framebufferRenderbuffer(t.FRAMEBUFFER,D,t.RENDERBUFFER,R)}else{const R=this.get(e.depthTexture);s.multiview?S.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,D,R.textureGPU,0,o,0,2):T?y.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,D,t.TEXTURE_2D,R.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,D,t.TEXTURE_2D,R.textureGPU,0)}}}if(o>0&&T===!1&&!s.multiview){if(b===void 0){const M=[];b=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,b);const C=[],D=e.textures;for(let R=0;R<D.length;R++){C[R]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,C[R]),M.push(t.COLOR_ATTACHMENT0+R);const P=e.textures[R],L=this.get(P);t.renderbufferStorageMultisample(t.RENDERBUFFER,o,L.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+R,t.RENDERBUFFER,C[R])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),a.msaaFrameBuffer=b,a.msaaRenderbuffers=C,l&&v===void 0){v=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(v,e,o),a.depthRenderbuffer=v;const R=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;M.push(R)}a.invalidationArray=M}r=a.msaaFrameBuffer}else r=N;n.drawBuffers(e,N)}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const r=this.get(e[n]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();t.bindVertexArray(n);for(let r=0;r<e.length;r++){const s=e[r],a=this.get(s);t.bindBuffer(t.ARRAY_BUFFER,a.bufferGPU),t.enableVertexAttribArray(r);let o,l;s.isInterleavedBufferAttribute===!0?(o=s.data.stride*a.bytesPerElement,l=s.offset*a.bytesPerElement):(o=0,l=0),a.isInteger?t.vertexAttribIPointer(r,s.itemSize,a.type,o,l):t.vertexAttribPointer(r,s.itemSize,a.type,s.normalized,o,l),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),n}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let s=0;s<e.length;s++){const a=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,a.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const s of r.bindings){const o=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=n.getUniformBlockIndex(t,s.name);n.uniformBlockBinding(t,l,o)}else if(s.isSampledTexture){const l=n.getUniformLocation(t,s.name);n.uniform1i(l,o)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const s of r.bindings){const a=this.get(s),o=a.index;s.isUniformsGroup||s.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,o,a.bufferGPU):s.isSampledTexture&&n.bindTexture(a.glTextureType,a.textureGPU,t.TEXTURE0+o)}}_resolveRenderTarget(e){const{gl:t,state:n}=this,r=e.renderTarget;if(e.textures!==null&&r){const s=this.get(r);if(r.samples>0&&this._useMultisampledExtension(r)===!1){const a=s.framebuffers[e.getCacheKey()];let o=t.COLOR_BUFFER_BIT;r.resolveDepthBuffer&&(r.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),r.stencilBuffer&&r.resolveStencilBuffer&&(o|=t.STENCIL_BUFFER_BIT));const l=s.msaaFrameBuffer,c=s.msaaRenderbuffers,d=e.textures,f=d.length>1;if(n.bindFramebuffer(t.READ_FRAMEBUFFER,l),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),f)for(let p=0;p<d.length;p++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+p,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+p,t.TEXTURE_2D,null,0);for(let p=0;p<d.length;p++){if(f){const{textureGPU:m}=this.get(d[p]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,c[p]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,m,0)}if(e.scissor){const{x:m,y:_,width:b,height:v}=e.scissorValue,y=e.height-v-_;t.blitFramebuffer(m,y,m+b,y+v,m,y,m+b,y+v,o,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,o,t.NEAREST)}if(f)for(let p=0;p<d.length;p++){const{textureGPU:m}=this.get(d[p]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+p,t.RENDERBUFFER,c[p]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+p,t.TEXTURE_2D,m,0)}this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,s.invalidationArray)}else if(r.resolveDepthBuffer===!1&&s.framebuffers){const a=s.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,s.depthInvalidationArray)}}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){this.textureUtils!==null&&this.textureUtils.dispose();const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const Qc={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},hu=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Ri={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},or={Store:"store"},pn={Load:"load",Clear:"clear"},L2={CCW:"ccw",CW:"cw"},F2={None:"none",Back:"back"},Wh={Uint16:"uint16",Uint32:"uint32"},K={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},ub={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},uu={Linear:"linear",Nearest:"nearest"},qt={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},Ql={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},U2={None:0,All:15},el={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},cb={Storage:"storage",ReadOnlyStorage:"read-only-storage"},hb={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},O2={NonFiltering:"non-filtering",Comparison:"comparison"},Jl={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},B2={TwoD:"2d",ThreeD:"3d"},ai={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},hY={All:"all"},o0={Vertex:"vertex",Instance:"instance"},fw={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"},z2={"texture-compression-s3tc":"texture-compression-bc","texture-compression-etc1":"texture-compression-etc2"};class dY extends Y3{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class fY extends W3{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let pY=0;class gY extends fY{constructor(e,t){super("StorageBuffer_"+pY++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:ps.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class mY extends bl{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:uu.Linear}),this.flipYSampler=e.createSampler({minFilter:uu.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Qc.TriangleStrip,stripIndexFormat:Wh.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Qc.TriangleStrip,stripIndexFormat:Wh.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:s,height:a}=t.size,o=this.getTransferPipeline(r),l=this.getFlipYPipeline(r),c=this.device.createTexture({size:{width:s,height:a,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),d=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:ai.TwoD,baseArrayLayer:n}),f=c.createView({baseMipLevel:0,mipLevelCount:1,dimension:ai.TwoD,baseArrayLayer:0}),p=this.device.createCommandEncoder({}),m=(_,b,v)=>{const y=_.getBindGroupLayout(0),S=this.device.createBindGroup({layout:y,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:b}]}),T=p.beginRenderPass({colorAttachments:[{view:v,loadOp:pn.Clear,storeOp:or.Store,clearValue:[0,0,0,0]}]});T.setPipeline(_),T.setBindGroup(0,S),T.draw(4,1,0,0),T.end()};m(o,d,f),m(l,f,d),this.device.queue.submit([p.finish()]),c.destroy()}generateMipmaps(e,t,n=0,r=null){const s=this.get(e);s.layers===void 0&&(s.layers=[]);const a=s.layers[n]||this._mipmapCreateBundles(e,t,n),o=r||this.device.createCommandEncoder({label:"mipmapEncoder"});this._mipmapRunBundles(o,a),r===null&&this.device.queue.submit([o.finish()]),s.layers[n]=a}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),s=r.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:ai.TwoD,baseArrayLayer:n});const o=[];for(let l=1;l<t.mipLevelCount;l++){const c=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),d=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:ai.TwoD,baseArrayLayer:n}),f={colorAttachments:[{view:d,loadOp:pn.Clear,storeOp:or.Store,clearValue:[0,0,0,0]}]},p=this.device.createRenderBundleEncoder({colorFormats:[t.format]});p.setPipeline(r),p.setBindGroup(0,c),p.draw(4,1,0,0),o.push({renderBundles:[p.finish()],passDescriptor:f}),a=d}return o}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const s=t[r],a=e.beginRenderPass(s.passDescriptor);a.executeBundles(s.renderBundles),a.end()}}}const _Y={[qw]:"never",[Sp]:"less",[Xw]:"equal",[Tp]:"less-equal",[Yw]:"greater",[Mp]:"greater-equal",[Zw]:"always",[Kw]:"not-equal"},yY=[0,1,3,2,4,5];class vY{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this._samplerCache=new Map}updateSampler(e){const t=this.backend,n=e.minFilter+"-"+e.magFilter+"-"+e.wrapS+"-"+e.wrapT+"-"+(e.wrapR||"0")+"-"+e.anisotropy+"-"+(e.compareFunction||0);let r=this._samplerCache.get(n);if(r===void 0){const a={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};a.magFilter===uu.Linear&&a.minFilter===uu.Linear&&a.mipmapFilter===uu.Linear&&(a.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(a.compare=_Y[e.compareFunction]),r={sampler:t.device.createSampler(a),usedTimes:0},this._samplerCache.set(n,r)}const s=t.get(e);if(s.sampler!==r.sampler){if(s.sampler!==void 0){const a=this._samplerCache.get(s.samplerKey);a.usedTimes--,a.usedTimes===0&&this._samplerCache.delete(s.samplerKey)}s.samplerKey=n,s.sampler=r.sampler,r.usedTimes++}return n}createDefaultTexture(e){let t;const n=pw(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){r.texture=e.sourceTexture,r.initialized=!0;return}t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:a,depth:o,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const c=this._getDimension(e),d=e.internalFormat||t.format||pw(e,n.device);r.format=d;const{samples:f,primarySamples:p,isMSAA:m}=n.utils.getTextureSampleData(e);let _=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(_|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&d!==K.RGB9E5UFloat&&(_|=GPUTextureUsage.RENDER_ATTACHMENT);const b={label:e.name,size:{width:s,height:a,depthOrArrayLayers:o},mipLevelCount:l,sampleCount:p,dimension:c,format:d,usage:_};if(d===void 0){Ae("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}if(e.isCubeTexture&&(b.textureBindingViewDimension=ai.Cube),r.texture=n.device.createTexture(b),m){const v=Object.assign({},b);v.label=v.label+"-msaa",v.sampleCount=f,v.mipLevelCount=1,r.msaaTexture=n.device.createTexture(v)}r.initialized=!0,r.textureDescriptorGPU=b}destroyTexture(e,t=!1){const n=this.backend,r=n.get(e);r.texture!==void 0&&t===!1&&r.texture.destroy(),r.msaaTexture!==void 0&&r.msaaTexture.destroy(),n.delete(e)}generateMipmaps(e,t=null){const n=this.backend.get(e);if(e.isCubeTexture)for(let r=0;r<6;r++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,r,t);else{const r=e.image.depth||1;for(let s=0;s<r;s++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,s,t)}}getColorBuffer(){const e=this.backend,t=e.renderer.getCanvasTarget(),{width:n,height:r}=e.getDrawingBufferSize(),s=e.renderer.currentSamples,a=t.colorTexture,o=e.get(a);if(a.width===n&&a.height===r&&a.samples===s)return o.texture;let l=o.texture;return l&&l.destroy(),l=e.device.createTexture({label:"colorBuffer",size:{width:n,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.currentSamples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),a.source.width=n,a.source.height=r,a.samples=s,o.texture=l,l}getDepthBuffer(e=!0,t=!1){const n=this.backend,r=n.renderer.getCanvasTarget(),{width:s,height:a}=n.getDrawingBufferSize(),o=n.renderer.currentSamples,l=r.depthTexture;if(l.width===s&&l.height===a&&l.samples===o&&l.depth===e&&l.stencil===t)return n.get(l).texture;const c=n.get(l).texture;let d,f;if(t?(d=hr,f=Jr):e&&(d=ki,f=yn),c!==void 0){if(l.image.width===s&&l.image.height===a&&l.format===d&&l.type===f&&l.samples===o)return c;this.destroyTexture(l)}return l.name="depthBuffer",l.format=d,l.type=f,l.image.width=s,l.image.height=a,l.samples=o,this.createTexture(l,{width:s,height:a}),n.get(l).texture}updateTexture(e,t){const n=this.backend.get(e),r=e.mipmaps,{textureDescriptorGPU:s}=n;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)if(r.length>0)for(let a=0,o=r.length;a<o;a++){const l=r[a];this._copyBufferToTexture(l,n.texture,s,0,e.flipY,0,a)}else this._copyBufferToTexture(t.image,n.texture,s,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let a=0;a<t.image.depth;a++)this._copyBufferToTexture(t.image,n.texture,s,a,e.flipY,a);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,n.texture,s);else if(r.length>0)for(let a=0,o=r.length;a<o;a++){const l=r[a];this._copyImageToTexture(l,n.texture,s,0,e.flipY,e.premultiplyAlpha,a)}else this._copyImageToTexture(t.image,n.texture,s,0,e.flipY,e.premultiplyAlpha);n.version=e.version}}async copyTextureToBuffer(e,t,n,r,s,a){const o=this.backend.device,l=this.backend.get(e),c=l.texture,d=l.textureDescriptorGPU.format,f=this._getBytesPerTexel(d);let p=r*f;p=Math.ceil(p/256)*256;const m=o.createBuffer({size:(s-1)*p+r*f,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),_=o.createCommandEncoder();_.copyTextureToBuffer({texture:c,origin:{x:t,y:n,z:a}},{buffer:m,bytesPerRow:p},{width:r,height:s});const b=this._getTypedArrayType(d);o.queue.submit([_.finish()]),await m.mapAsync(GPUMapMode.READ);const v=m.getMappedRange();return new b(v)}dispose(){this._samplerCache.clear()}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new er;n.minFilter=vn,n.magFilter=vn,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultCubeTexture[e];if(t===void 0){const n=new Ap;n.minFilter=vn,n.magFilter=vn,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,n){const r=e.images,s=e.mipmaps;for(let a=0;a<6;a++){const o=r[a],l=e.flipY===!0?yY[a]:a;o.isDataTexture?this._copyBufferToTexture(o.image,t,n,l,e.flipY):this._copyImageToTexture(o,t,n,l,e.flipY,e.premultiplyAlpha);for(let c=0;c<s.length;c++){const f=s[c].images[a];f.isDataTexture?this._copyBufferToTexture(f.image,t,n,l,e.flipY,0,c+1):this._copyImageToTexture(f,t,n,l,e.flipY,e.premultiplyAlpha,c+1)}}}_copyImageToTexture(e,t,n,r,s,a,o=0){const l=this.backend.device,c=o>0?e.width:n.size.width,d=o>0?e.height:n.size.height;try{l.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:o,origin:{x:0,y:0,z:r},premultipliedAlpha:a},{width:c,height:d,depthOrArrayLayers:1})}catch{}}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new mY(this.backend.device)),e}_generateMipmaps(e,t,n=0,r=null){this._getPassUtils().generateMipmaps(e,t,n,r)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,s,a=0,o=0){const l=this.backend.device,c=e.data,d=this._getBytesPerTexel(n.format),f=e.width*d;l.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:r}},c,{offset:e.width*e.height*d*a,bytesPerRow:f},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,s=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1;for(let o=0;o<e.length;o++){const l=e[o],c=l.width,d=l.height,f=a?n.size.depthOrArrayLayers:1,p=Math.ceil(c/s.width)*s.byteLength,m=p*Math.ceil(d/s.height);for(let _=0;_<f;_++)r.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:_}},l.data,{offset:_*m,bytesPerRow:p,rowsPerImage:Math.ceil(d/s.height)},{width:Math.ceil(c/s.width)*s.width,height:Math.ceil(d/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===K.BC1RGBAUnorm||e===K.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===K.BC2RGBAUnorm||e===K.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===K.BC3RGBAUnorm||e===K.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===K.BC4RUnorm||e===K.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===K.BC5RGUnorm||e===K.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===K.BC6HRGBUFloat||e===K.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===K.BC7RGBAUnorm||e===K.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===K.ETC2RGB8Unorm||e===K.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===K.ETC2RGB8A1Unorm||e===K.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===K.ETC2RGBA8Unorm||e===K.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===K.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===K.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===K.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===K.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===K.ASTC4x4Unorm||e===K.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===K.ASTC5x4Unorm||e===K.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===K.ASTC5x5Unorm||e===K.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===K.ASTC6x5Unorm||e===K.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===K.ASTC6x6Unorm||e===K.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===K.ASTC8x5Unorm||e===K.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===K.ASTC8x6Unorm||e===K.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===K.ASTC8x8Unorm||e===K.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===K.ASTC10x5Unorm||e===K.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===K.ASTC10x6Unorm||e===K.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===K.ASTC10x8Unorm||e===K.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===K.ASTC10x10Unorm||e===K.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===K.ASTC12x10Unorm||e===K.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===K.ASTC12x12Unorm||e===K.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=ub.ClampToEdge;return e===bu?t=ub.Repeat:e===wu&&(t=ub.MirrorRepeat),t}_convertFilterMode(e){let t=uu.Linear;return(e===vn||e===Ww||e===oo)&&(t=uu.Nearest),t}_getBytesPerTexel(e){if(e===K.R8Unorm||e===K.R8Snorm||e===K.R8Uint||e===K.R8Sint)return 1;if(e===K.R16Uint||e===K.R16Sint||e===K.R16Float||e===K.RG8Unorm||e===K.RG8Snorm||e===K.RG8Uint||e===K.RG8Sint)return 2;if(e===K.R32Uint||e===K.R32Sint||e===K.R32Float||e===K.RG16Uint||e===K.RG16Sint||e===K.RG16Float||e===K.RGBA8Unorm||e===K.RGBA8UnormSRGB||e===K.RGBA8Snorm||e===K.RGBA8Uint||e===K.RGBA8Sint||e===K.BGRA8Unorm||e===K.BGRA8UnormSRGB||e===K.RGB9E5UFloat||e===K.RGB10A2Unorm||e===K.RG11B10UFloat||e===K.Depth32Float||e===K.Depth24Plus||e===K.Depth24PlusStencil8||e===K.Depth32FloatStencil8)return 4;if(e===K.RG32Uint||e===K.RG32Sint||e===K.RG32Float||e===K.RGBA16Uint||e===K.RGBA16Sint||e===K.RGBA16Float)return 8;if(e===K.RGBA32Uint||e===K.RGBA32Sint||e===K.RGBA32Float)return 16}_getTypedArrayType(e){if(e===K.R8Uint)return Uint8Array;if(e===K.R8Sint)return Int8Array;if(e===K.R8Unorm)return Uint8Array;if(e===K.R8Snorm)return Int8Array;if(e===K.RG8Uint)return Uint8Array;if(e===K.RG8Sint)return Int8Array;if(e===K.RG8Unorm)return Uint8Array;if(e===K.RG8Snorm)return Int8Array;if(e===K.RGBA8Uint)return Uint8Array;if(e===K.RGBA8Sint)return Int8Array;if(e===K.RGBA8Unorm||e===K.RGBA8UnormSRGB)return Uint8Array;if(e===K.RGBA8Snorm)return Int8Array;if(e===K.R16Uint)return Uint16Array;if(e===K.R16Sint)return Int16Array;if(e===K.RG16Uint)return Uint16Array;if(e===K.RG16Sint)return Int16Array;if(e===K.RGBA16Uint)return Uint16Array;if(e===K.RGBA16Sint)return Int16Array;if(e===K.R16Float||e===K.RG16Float||e===K.RGBA16Float)return Uint16Array;if(e===K.R32Uint)return Uint32Array;if(e===K.R32Sint)return Int32Array;if(e===K.R32Float)return Float32Array;if(e===K.RG32Uint)return Uint32Array;if(e===K.RG32Sint)return Int32Array;if(e===K.RG32Float)return Float32Array;if(e===K.RGBA32Uint)return Uint32Array;if(e===K.RGBA32Sint)return Int32Array;if(e===K.RGBA32Float)return Float32Array;if(e===K.BGRA8Unorm||e===K.BGRA8UnormSRGB)return Uint8Array;if(e===K.RGB10A2Unorm||e===K.RGB9E5UFloat||e===K.RG11B10UFloat)return Uint32Array;if(e===K.Depth32Float)return Float32Array;if(e===K.Depth24Plus||e===K.Depth24PlusStencil8)return Uint32Array;if(e===K.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.is3DTexture||e.isData3DTexture?t=B2.ThreeD:t=B2.TwoD,t}}function pw(i,e=null){const t=i.format,n=i.type,r=i.colorSpace,s=bt.getTransfer(r);let a;if(i.isCompressedTexture===!0||i.isCompressedArrayTexture===!0)switch(t){case ll:case ul:a=s===Ze?K.BC1RGBAUnormSRGB:K.BC1RGBAUnorm;break;case cl:a=s===Ze?K.BC2RGBAUnormSRGB:K.BC2RGBAUnorm;break;case hl:a=s===Ze?K.BC3RGBAUnormSRGB:K.BC3RGBAUnorm;break;case kh:a=K.BC4RUnorm;break;case Ih:a=K.BC4RSnorm;break;case Tu:a=K.BC5RGUnorm;break;case Lh:a=K.BC5RGSnorm;break;case Dh:a=s===Ze?K.BC7RGBAUnormSRGB:K.BC7RGBAUnorm;break;case fh:case dh:a=s===Ze?K.ETC2RGB8UnormSRGB:K.ETC2RGB8Unorm;break;case ph:a=s===Ze?K.ETC2RGBA8UnormSRGB:K.ETC2RGBA8Unorm;break;case gh:a=K.EACR11Unorm;break;case mh:a=K.EACR11Snorm;break;case Su:a=K.EACRG11Unorm;break;case _h:a=K.EACRG11Snorm;break;case yh:a=s===Ze?K.ASTC4x4UnormSRGB:K.ASTC4x4Unorm;break;case vh:a=s===Ze?K.ASTC5x4UnormSRGB:K.ASTC5x4Unorm;break;case xh:a=s===Ze?K.ASTC5x5UnormSRGB:K.ASTC5x5Unorm;break;case bh:a=s===Ze?K.ASTC6x5UnormSRGB:K.ASTC6x5Unorm;break;case wh:a=s===Ze?K.ASTC6x6UnormSRGB:K.ASTC6x6Unorm;break;case Sh:a=s===Ze?K.ASTC8x5UnormSRGB:K.ASTC8x5Unorm;break;case Th:a=s===Ze?K.ASTC8x6UnormSRGB:K.ASTC8x6Unorm;break;case Mh:a=s===Ze?K.ASTC8x8UnormSRGB:K.ASTC8x8Unorm;break;case Ah:a=s===Ze?K.ASTC10x5UnormSRGB:K.ASTC10x5Unorm;break;case Eh:a=s===Ze?K.ASTC10x6UnormSRGB:K.ASTC10x6Unorm;break;case Ch:a=s===Ze?K.ASTC10x8UnormSRGB:K.ASTC10x8Unorm;break;case Rh:a=s===Ze?K.ASTC10x10UnormSRGB:K.ASTC10x10Unorm;break;case Nh:a=s===Ze?K.ASTC12x10UnormSRGB:K.ASTC12x10Unorm;break;case Ph:a=s===Ze?K.ASTC12x12UnormSRGB:K.ASTC12x12Unorm;break;case Jn:a=s===Ze?K.RGBA8UnormSRGB:K.RGBA8Unorm;break;default:Ee("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case Jn:switch(n){case du:a=K.RGBA8Snorm;break;case fu:a=K.RGBA16Sint;break;case js:a=K.RGBA16Uint;break;case yn:a=K.RGBA32Uint;break;case Ti:a=K.RGBA32Sint;break;case Un:a=s===Ze?K.RGBA8UnormSRGB:K.RGBA8Unorm;break;case Wn:a=K.RGBA16Float;break;case Qn:a=K.RGBA32Float;break;default:Ee("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case bp:switch(n){case J0:a=K.RGB9E5UFloat;break;case e_:a=K.RG11B10UFloat;break;default:Ee("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case wp:switch(n){case du:a=K.R8Snorm;break;case fu:a=K.R16Sint;break;case js:a=K.R16Uint;break;case yn:a=K.R32Uint;break;case Ti:a=K.R32Sint;break;case Un:a=K.R8Unorm;break;case Wn:a=K.R16Float;break;case Qn:a=K.R32Float;break;default:Ee("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case dr:switch(n){case du:a=K.RG8Snorm;break;case fu:a=K.RG16Sint;break;case js:a=K.RG16Uint;break;case yn:a=K.RG32Uint;break;case Ti:a=K.RG32Sint;break;case Un:a=K.RG8Unorm;break;case Wn:a=K.RG16Float;break;case Qn:a=K.RG32Float;break;default:Ee("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case ki:switch(n){case js:a=K.Depth16Unorm;break;case yn:a=K.Depth24Plus;break;case Qn:a=K.Depth32Float;break;default:Ee("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case hr:switch(n){case Jr:a=K.Depth24PlusStencil8;break;case Qn:e&&e.features.has(fw.Depth32FloatStencil8)===!1&&Ee('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=K.Depth32FloatStencil8;break;default:Ee("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case Xh:switch(n){case Ti:a=K.R32Sint;break;case yn:a=K.R32Uint;break;default:Ee("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case Yh:switch(n){case Ti:a=K.RG32Sint;break;case yn:a=K.RG32Uint;break;default:Ee("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case Kh:switch(n){case Ti:a=K.RGBA32Sint;break;case yn:a=K.RGBA32Uint;break;default:Ee("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:Ee("WebGPURenderer: Unsupported texture format.",t)}return a}const xY=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,bY=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,G2={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},wY=i=>{i=i.trim();const e=i.match(xY);if(e!==null&&e.length===4){const t=e[2],n=[];let r=null;for(;(r=bY.exec(t))!==null;)n.push({name:r[1],type:r[2]});const s=[];for(let d=0;d<n.length;d++){const{name:f,type:p}=n[d];let m=p;m.startsWith("ptr")?m="pointer":(m.startsWith("texture")&&(m=p.split("<")[0]),m=G2[m]),s.push(new QS(m,f))}const a=i.substring(e[0].length),o=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:G2[o]||o,inputs:s,name:l,inputsCode:t,blockCode:a,outputType:o}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class SY extends e1{constructor(e){const{type:t,inputs:n,name:r,inputsCode:s,blockCode:a,outputType:o}=wY(e);super(t,n,r),this.inputsCode=s,this.blockCode=a,this.outputType=o}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class TY extends V3{parseFunction(e){return new SY(e)}}const MY={[ps.READ_ONLY]:"read",[ps.WRITE_ONLY]:"write",[ps.READ_WRITE]:"read_write"},V2={[bu]:"repeat",[Rr]:"clamp",[wu]:"mirror"},l0={vertex:hu.VERTEX,fragment:hu.FRAGMENT,compute:hu.COMPUTE},j2={instance:!0,swizzleAssign:!1,storageBuffer:!0},AY={"^^":"tsl_xor"},EY={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},H2={},Mf={tsl_xor:new Ni("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Ni("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Ni("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Ni("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Ni("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Ni("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Ni("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Ni("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Ni("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Ni("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Ni("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Ni("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Ni(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},CY={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>",floatpack_snorm_2x16:"pack2x16snorm",floatpack_unorm_2x16:"pack2x16unorm",floatpack_float16_2x16:"pack2x16float",floatunpack_snorm_2x16:"unpack2x16snorm",floatunpack_unorm_2x16:"unpack2x16unorm",floatunpack_float16_2x16:"unpack2x16float"};let J3="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(J3+=`diagnostic( off, derivative_uniformity );
`);class RY extends G3{constructor(e,t){super(e,t,new TY),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,n,r,s,a=this.shaderStage){return a==="fragment"?r?s?`textureSample( ${t}, ${t}_sampler, ${n}, ${r}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:s?`textureSample( ${t}, ${t}_sampler, ${n}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this.generateTextureSampleLevel(e,t,n,"0",r)}generateTextureSampleLevel(e,t,n,r,s,a){return this.isUnfilterable(e)===!1?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,r):this.generateTextureLod(e,t,n,s,a,r)}generateWrapFunction(e){const t=`tsl_coord_${V2[e.wrapS]}S_${V2[e.wrapT]}_${e.is3DTexture||e.isData3DTexture?"3d":"2d"}T`;let n=H2[t];if(n===void 0){const r=[],s=e.is3DTexture||e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const o=(l,c)=>{l===bu?(r.push(Mf.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${c} )`):l===Rr?(r.push(Mf.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${c} )`):l===wu?(r.push(Mf.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${c} )`):(a+=`		coord.${c}`,Ae(`WebGPURenderer: Unsupported texture wrap type "${l}" for vertex shader.`))};o(e.wrapS,"x"),a+=`,
`,o(e.wrapT,"y"),(e.is3DTexture||e.isData3DTexture)&&(a+=`,
`,o(e.wrapR,"z")),a+=`
	);

}
`,H2[t]=n=new Ni(a,r)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let s=r.dimensionsSnippet[n];if(r.dimensionsSnippet[n]===void 0){let a,o;const{primarySamples:l}=this.renderer.backend.utils.getTextureSampleData(e),c=l>1;e.is3DTexture||e.isData3DTexture?o="vec3<u32>":o="vec2<u32>",c||e.isStorageTexture?a=t:a=`${t}${n?`, u32( ${n} )`:""}`,s=new A0(new E0(`textureDimensions( ${a} )`,o)),r.dimensionsSnippet[n]=s,(e.isArrayTexture||e.isDataArrayTexture||e.is3DTexture||e.isData3DTexture)&&(r.arrayLayerCount=new A0(new E0(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new A0(new E0("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,n,r,s="0u"){this._include("biquadraticTexture");const a=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,s);return r&&(n=`${n} + vec2<f32>(${r}) / ${o}`),`tsl_biquadraticTexture( ${t}, ${a}( ${n} ), ${o}, u32( ${s} ) )`}generateTextureLod(e,t,n,r,s,a="0u"){const o=this.generateWrapFunction(e),l=this.generateTextureDimension(e,t,a),c=e.is3DTexture||e.isData3DTexture?"vec3":"vec2";s&&(n=`${n} + ${c}<f32>(${s}) / ${c}<f32>( ${l} )`);const d=`${c}<u32>( ${o}( ${n} ) * ${c}<f32>( ${l} ) )`;return this.generateTextureLoad(e,t,d,a,r,null)}generateTextureLoad(e,t,n,r,s,a){r===null&&(r="0u"),a&&(n=`${n} + ${a}`);let o;return s?o=`textureLoad( ${t}, ${n}, ${s}, u32( ${r} ) )`:(o=`textureLoad( ${t}, ${n}, u32( ${r} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,n,r,s){let a;return r?a=`textureStore( ${t}, ${n}, ${r}, ${s} )`:a=`textureStore( ${t}, ${n}, ${s} )`,a}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Qn||this.isSampleCompare(e)===!1&&e.minFilter===vn&&e.magFilter===vn||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,r,s,a=this.shaderStage){let o=null;return this.isUnfilterable(e)?o=this.generateTextureLod(e,t,n,r,s,"0",a):o=this._generateTextureSample(e,t,n,r,s,a),o}generateTextureGrad(e,t,n,r,s,a,o=this.shaderStage){if(o==="fragment")return a?`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]}, ${a} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;Ee(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,n,r,s,a,o=this.shaderStage){if(o==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${r}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${r} )`:a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;Ee(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,n,r,s,a){return this.isUnfilterable(e)===!1?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,r):this.generateTextureLod(e,t,n,s,a,r)}generateTextureBias(e,t,n,r,s,a,o=this.shaderStage){if(o==="fragment")return a?`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r}, ${a} )`:`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;Ee(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="cubeDepthTexture"||r==="storageTexture"||r==="texture3D"?n:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=AY[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?e.isAtomic===!0?(Ae("WebGPURenderer: Atomic operations are only supported in compute shaders."),ps.READ_WRITE):ps.READ_ONLY:e.access}getStorageAccess(e,t){return MY[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,r=null){const s=super.getUniformFromNode(e,t,n,r),a=this.getDataFromNode(e,n,this.globalCache);if(a.uniformGPU===void 0){let o;const l=e.groupNode,c=l.name,d=this.getBindGroupArray(c,n);if(t==="texture"||t==="cubeTexture"||t==="cubeDepthTexture"||t==="storageTexture"||t==="texture3D"){let f=null;const p=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?e.value.is3DTexture===!0?f=new dw(s.name,s.node,l,p):f=new M_(s.name,s.node,l,p):t==="cubeTexture"||t==="cubeDepthTexture"?f=new K3(s.name,s.node,l,p):t==="texture3D"&&(f=new dw(s.name,s.node,l,p)),f.store=e.isStorageTextureNode===!0,f.mipLevel=f.store?e.mipLevel:0,f.setVisibility(l0[n]),this.isUnfilterable(e.value)===!1&&f.store===!1){const m=new dY(`${s.name}_sampler`,s.node,l);m.setVisibility(l0[n]),d.push(m,f),o=[m,f]}else d.push(f),o=[f]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const f=this.getSharedDataFromNode(e);let p=f.buffer;if(p===void 0){const m=t==="buffer"?q3:gY;p=new m(e,l),f.buffer=p}p.setVisibility(p.getVisibility()|l0[n]),d.push(p),o=p,s.name=r||"NodeBuffer_"+s.id}else{const f=this.uniformGroups[n]||(this.uniformGroups[n]={});let p=f[c];p===void 0&&(p=new X3(c,l),p.setVisibility(l0[n]),f[c]=p,d.push(p)),o=this.getNodeUniform(s,t),p.addUniform(o)}a.uniformGPU=o}return s}getBuiltin(e,t,n,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const a of t.inputs)r.push(a.name+" : "+this.getType(a.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(s+=`	return ${n.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const r of n)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:r,property:s,type:a}of n.values())t.push(`@builtin( ${r} ) ${s} : ${a}`);return t.join(`,
	`)}getScopedArray(e,t,n,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:r,bufferType:s,bufferCount:a}of this.scopedArrays.values()){const o=this.getType(s);t.push(`var<${r}> ${n}: array< ${o}, ${a} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const r=this.getAttributesArray();for(let s=0,a=r.length;s<a;s++){const o=r[s],l=o.name,c=this.getType(o.type);t.push(`@location( ${s} ) ${l} : ${c}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const r=e.output?"@location( "+n.index+" ) ":"";let s=this.getType(n.type);n.atomic&&(s="atomic< "+s+" >"),t.push(`	${r+n.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const r=[];for(const s of n){let a=`struct ${s.name} {
`;a+=this.getStructMembers(s),a+=`
};`,r.push(a)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,n=null){let r=`var ${t} : `;return n!==null?r+=this.generateArrayDeclaration(e,n):r+=this.getType(e),r}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const r of n)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,a=this.vars[e];for(let o=0;o<s.length;o++){const l=s[o];if(l.needsInterpolation){let c=`@location( ${o} )`;if(l.interpolationType){const d=l.interpolationSampling!==null?`, ${l.interpolationSampling} )`:" )";c+=` @interpolate( ${l.interpolationType}${d}`}else/^(int|uint|ivec|uvec)/.test(l.type)&&(c+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${c} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&a.includes(l)===!1&&a.push(l)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,n=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,s=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return r&&!s}getUniforms(e){const t=this.uniforms[e],n=[],r=[],s=[],a={};for(const l of t){const c=l.groupNode.name,d=this.bindingsIndexes[c];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="cubeDepthTexture"||l.type==="storageTexture"||l.type==="texture3D"){const f=l.node.value;this.isUnfilterable(f)===!1&&l.node.isStorageTextureNode!==!0&&(this.isSampleCompare(f)?n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name}_sampler : sampler_comparison;`):n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name}_sampler : sampler;`));let p,m="";const{primarySamples:_}=this.renderer.backend.utils.getTextureSampleData(f);if(_>1&&(m="_multisampled"),f.isCubeTexture===!0&&f.isDepthTexture===!0)p="texture_depth_cube";else if(f.isCubeTexture===!0)p="texture_cube<f32>";else if(f.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&f.compareFunction===null?p=`texture${m}_2d<f32>`:p=`texture_depth${m}_2d${f.isArrayTexture===!0?"_array":""}`;else if(l.node.isStorageTextureNode===!0){const b=pw(f),v=this.getStorageAccess(l.node,e),y=l.node.value.is3DTexture,S=l.node.value.isArrayTexture;p=`texture_storage_${y?"3d":`2d${S?"_array":""}`}<${b}, ${v}>`}else if(f.isArrayTexture===!0||f.isDataArrayTexture===!0||f.isCompressedArrayTexture===!0)p="texture_2d_array<f32>";else if(f.is3DTexture===!0||f.isData3DTexture===!0)p="texture_3d<f32>";else{const b=this.getComponentTypeFromTexture(f).charAt(0);p=`texture${m}_2d<${b}32>`}n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name} : ${p};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const f=l.node,p=this.getType(f.getNodeType(this)),m=f.bufferCount,_=m>0&&l.type==="buffer"?", "+m:"",b=f.isStorageBufferNode?`storage, ${this.getStorageAccess(f,e)}`:"uniform";if(this.isCustomStruct(l))r.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var<${b}> ${l.name} : ${p};`);else{const y=`	value : array< ${f.isAtomic?`atomic<${p}>`:`${p}`}${_} >`;r.push(this._getWGSLStructBinding(l.name,y,b,d.binding++,d.group))}}else{const f=this.getType(this.getVectorType(l.type)),p=l.groupNode.name;(a[p]||(a[p]={index:d.binding++,id:d.group,snippets:[]})).snippets.push(`	${l.name} : ${f}`)}}for(const l in a){const c=a[l];s.push(this._getWGSLStructBinding(l,c.snippets.join(`,
`),"uniform",c.index,c.id))}return[...n,...r,...s].join(`
`)}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],a=s[s.length-1],o=a.outputNode,l=o!==void 0&&o.isOutputStructNode===!0;for(const c of s){const d=this.getFlowData(c),f=c.name;if(f&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${f}
`),r+=`${d.code}
	`,c===a&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${d.result};`;else if(t==="fragment")if(l)n.returnType=o.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+=`return ${d.result};`;else{let p="	@location(0) color: vec4<f32>";const m=this.getBuiltins("output");m&&(p+=`,
	`+m),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",p),n.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${d.result};

	return output;`}}}n.flow=r}if(this.shaderStage=null,this.material!==null)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`select( ${n}, ${t}, ${e} )`}getType(e){return EY[e]||e}isAvailable(e){let t=j2[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),j2[e]=t),t}_getWGSLMethod(e){return Mf[e]!==void 0&&this._include(e),CY[e]}_include(e){const t=Mf[e];return t.build(this),this.addInclude(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${J3}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){const[n,r,s]=t;return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${n}, ${r}, ${s} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x
		+ globalId.y * ( ${n} * numWorkgroups.x )
		+ globalId.z * ( ${n} * numWorkgroups.x ) * ( ${r} * numWorkgroups.y );

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,r=0,s=0){const a=e+"Struct";return`${this._getWGSLStruct(a,t)}
@binding( ${r} ) @group( ${s} )
var<${n}> ${e} : ${a};`}}class NY{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=K.Depth24PlusStencil8:e.depth&&(t=K.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,a=s.getRenderTarget();t=a?a.samples:s.currentSamples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorFormats(e){return e.textures!==null?e.textures.map(t=>this.getTextureFormatGPU(t)):[this.getPreferredCanvasFormat()]}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return Qc.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return Qc.LineList;if(e.isLine)return Qc.LineStrip;if(e.isMesh)return Qc.TriangleList}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.currentSamples)}getPreferredCanvasFormat(){const t=this.backend.parameters.outputType;if(t===void 0)return navigator.gpu.getPreferredCanvasFormat();if(t===Un)return K.BGRA8Unorm;if(t===Wn)return K.RGBA16Float;throw new Error("Unsupported output buffer type.")}}const eD=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&eD.set(Float16Array,["float16"]);const PY=new Map([[FR,["float16"]]]),DY=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class kY{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,s=r.get(n);let a=s.buffer;if(a===void 0){const o=r.device;let l=n.array;if(e.normalized===!1){if(l.constructor===Int16Array||l.constructor===Int8Array)l=new Int32Array(l);else if((l.constructor===Uint16Array||l.constructor===Uint8Array)&&(l=new Uint32Array(l),t&GPUBufferUsage.INDEX))for(let f=0;f<l.length;f++)l[f]===65535&&(l[f]=4294967295)}if(n.array=l,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){l=new l.constructor(n.count*4);for(let f=0;f<n.count;f++)l.set(n.array.subarray(f*3,f*3+3),f*4);n.itemSize=4,n.array=l,s._force3to4BytesAlignment=!0}const c=l.byteLength,d=c+(4-c%4)%4;a=o.createBuffer({label:n.name,size:d,usage:t,mappedAtCreation:!0}),new l.constructor(a.getMappedRange()).set(l),a.unmap(),s.buffer=a}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,s=n.get(t),a=n.get(t).buffer;let o=t.array;if(s._force3to4BytesAlignment===!0){o=new o.constructor(t.count*4);for(let c=0;c<t.count;c++)o.set(t.array.subarray(c*3,c*3+3),c*4);t.array=o}const l=t.updateRanges;if(l.length===0)r.queue.writeBuffer(a,0,o,0);else{const c=P0(o),d=c?1:o.BYTES_PER_ELEMENT;for(let f=0,p=l.length;f<p;f++){const m=l[f];let _,b;if(s._force3to4BytesAlignment===!0){const y=Math.floor(m.start/3),S=Math.ceil(m.count/3);_=y*4*d,b=S*4*d}else _=m.start*d,b=m.count*d;const v=_*(c?o.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(a,v,o,_,b)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let r=0;r<t.length;r++){const s=t[r],a=s.array.BYTES_PER_ELEMENT,o=this._getBufferAttribute(s);let l=n.get(o);if(l===void 0){let f,p;s.isInterleavedBufferAttribute===!0?(f=s.data.stride*a,p=s.data.isInstancedInterleavedBuffer?o0.Instance:o0.Vertex):(f=s.itemSize*a,p=s.isInstancedBufferAttribute?o0.Instance:o0.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(f=4),l={arrayStride:f,attributes:[],stepMode:p},n.set(o,l)}const c=this._getVertexFormat(s),d=s.isInterleavedBufferAttribute===!0?s.offset*a:0;l.attributes.push({shaderLocation:r,offset:d,format:c})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,s=t.get(this._getBufferAttribute(e)).buffer,a=s.size,o=n.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=n.createCommandEncoder({label:`readback_encoder_${e.name}`});l.copyBufferToBuffer(s,0,o,0,a);const c=l.finish();n.queue.submit([c]),await o.mapAsync(GPUMapMode.READ);const d=o.getMappedRange(),f=new e.array.constructor(d.slice(0));return o.unmap(),f.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,s=e.constructor;let a;if(t===1)a=DY.get(r);else{const l=(PY.get(s)||eD.get(r))[n?1:0];if(l){const c=r.BYTES_PER_ELEMENT*t,f=Math.floor((c+3)/4)*4/r.BYTES_PER_ELEMENT;if(f%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${l}x${f}`}}return a||Ee("WebGPUAttributeUtils: Vertex format not supported yet."),a}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class IY{constructor(e){this.layoutGPU=e,this.usedTimes=0}}class LY{constructor(e){this.backend=e,this._bindGroupLayoutCache=new Map}createBindingsLayout(e){const t=this.backend,n=t.device,r=t.get(e);if(r.layout)return r.layout.layoutGPU;const s=this._createLayoutEntries(e),a=JSON.stringify(s);let o=this._bindGroupLayoutCache.get(a);return o===void 0&&(o=new IY(n.createBindGroupLayout({entries:s})),this._bindGroupLayoutCache.set(a,o)),o.usedTimes++,r.layout=o,r.layoutKey=a,o.layoutGPU}createBindings(e,t,n,r=0){const{backend:s}=this,a=s.get(e),o=this.createBindingsLayout(e);let l;n>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[n]===r&&(l=a.groups[n])),l===void 0&&(l=this.createBindGroup(e,o),n>0&&(a.groups[n]=l,a.versions[n]=r)),a.group=l}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,s=t.get(e).buffer,a=e.updateRanges;if(a.length===0)n.queue.writeBuffer(s,0,r,0);else{const o=P0(r),l=o?1:r.BYTES_PER_ELEMENT;for(let c=0,d=a.length;c<d;c++){const f=a[c],p=f.start*l,m=f.count*l,_=p*(o?r.BYTES_PER_ELEMENT:1);n.queue.writeBuffer(s,_,r,p,m)}e.clearUpdateRanges()}}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],o=r.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:s});r.queue.writeBuffer(o,0,e,0);const l=[{binding:0,resource:{buffer:o}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:t,entries:l})}createBindGroup(e,t){const n=this.backend,r=n.device;let s=0;const a=[];for(const o of e.bindings){if(o.isUniformBuffer){const l=n.get(o);if(l.buffer===void 0){const c=o.byteLength,d=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,f=[];o.visibility&hu.VERTEX&&f.push("vertex"),o.visibility&hu.FRAGMENT&&f.push("fragment"),o.visibility&hu.COMPUTE&&f.push("compute");const p=`(${f.join(",")})`,m=r.createBuffer({label:`bindingBuffer${o.id}_${o.name}_${p}`,size:c,usage:d});l.buffer=m}a.push({binding:s,resource:{buffer:l.buffer}})}else if(o.isStorageBuffer){const l=n.get(o);if(l.buffer===void 0){const c=o.attribute;l.buffer=n.get(c).buffer}a.push({binding:s,resource:{buffer:l.buffer}})}else if(o.isSampledTexture){const l=n.get(o.texture);let c;if(l.externalTexture!==void 0)c=r.importExternalTexture({source:l.externalTexture});else{const d=o.store?1:l.texture.mipLevelCount,f=o.store?o.mipLevel:0;let p=`view-${l.texture.width}-${l.texture.height}`;if(l.texture.depthOrArrayLayers>1&&(p+=`-${l.texture.depthOrArrayLayers}`),p+=`-${d}-${f}`,c=l[p],c===void 0){const m=hY.All;let _;o.isSampledCubeTexture?_=ai.Cube:o.isSampledTexture3D?_=ai.ThreeD:o.texture.isArrayTexture||o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?_=ai.TwoDArray:_=ai.TwoD,c=l[p]=l.texture.createView({aspect:m,dimension:_,mipLevelCount:d,baseMipLevel:f})}}a.push({binding:s,resource:c})}else if(o.isSampler){const l=n.get(o.texture);a.push({binding:s,resource:l.sampler})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}_createLayoutEntries(e){const t=[];let n=0;for(const r of e.bindings){const s=this.backend,a={binding:n,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){const o={};r.isStorageBuffer&&(r.visibility&hu.COMPUTE&&(r.access===ps.READ_WRITE||r.access===ps.WRITE_ONLY)?o.type=cb.Storage:o.type=cb.ReadOnlyStorage),a.buffer=o}else if(r.isSampledTexture&&r.store){const o={};o.format=this.backend.get(r.texture).texture.format;const l=r.access;l===ps.READ_WRITE?o.access=hb.ReadWrite:l===ps.WRITE_ONLY?o.access=hb.WriteOnly:o.access=hb.ReadOnly,r.texture.isArrayTexture?o.viewDimension=ai.TwoDArray:r.texture.is3DTexture&&(o.viewDimension=ai.ThreeD),a.storageTexture=o}else if(r.isSampledTexture){const o={},{primarySamples:l}=s.utils.getTextureSampleData(r.texture);if(l>1&&(o.multisampled=!0,r.texture.isDepthTexture||(o.sampleType=Jl.UnfilterableFloat)),r.texture.isDepthTexture)s.compatibilityMode&&r.texture.compareFunction===null?o.sampleType=Jl.UnfilterableFloat:o.sampleType=Jl.Depth;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){const c=r.texture.type;c===Ti?o.sampleType=Jl.SInt:c===yn?o.sampleType=Jl.UInt:c===Qn&&(this.backend.hasFeature("float32-filterable")?o.sampleType=Jl.Float:o.sampleType=Jl.UnfilterableFloat)}r.isSampledCubeTexture?o.viewDimension=ai.Cube:r.texture.isArrayTexture||r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?o.viewDimension=ai.TwoDArray:r.isSampledTexture3D&&(o.viewDimension=ai.ThreeD),a.texture=o}else if(r.isSampler){const o={};r.texture.isDepthTexture&&(r.texture.compareFunction!==null?o.type=O2.Comparison:s.compatibilityMode&&(o.type=O2.NonFiltering)),a.sampler=o}else Ee(`WebGPUBindingUtils: Unsupported binding "${r}".`);t.push(a),n++}return t}deleteBindGroupData(e){const{backend:t}=this,n=t.get(e);n.layout&&(n.layout.usedTimes--,n.layout.usedTimes===0&&this._bindGroupLayoutCache.delete(n.layoutKey),n.layout=void 0,n.layoutKey=void 0)}dispose(){this._bindGroupLayoutCache.clear()}}class FY{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:s,pipeline:a}=e,{vertexProgram:o,fragmentProgram:l}=a,c=this.backend,d=c.device,f=c.utils,p=c.get(a),m=[];for(const B of e.getBindings()){const O=c.get(B),{layoutGPU:V}=O.layout;m.push(V)}const _=c.attributeUtils.createShaderVertexBuffers(e);let b;r.blending!==pr&&(r.blending!==Qr||r.transparent!==!1)&&(b=this._getBlending(r));let v={};r.stencilWrite===!0&&(v={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const y=this._getColorWriteMask(r),S=[];if(e.context.textures!==null){const B=e.context.textures;for(let O=0;O<B.length;O++){const V=f.getTextureFormatGPU(B[O]);O===0?S.push({format:V,blend:b,writeMask:y}):S.push({format:V,writeMask:y})}}else{const B=f.getCurrentColorFormat(e.context);S.push({format:B,blend:b,writeMask:y})}const T=c.get(o).module,E=c.get(l).module,N=this._getPrimitiveState(n,s,r),M=this._getDepthCompare(r),C=f.getCurrentDepthStencilFormat(e.context),D=this._getSampleCount(e.context),R={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},T,{buffers:_}),fragment:Object.assign({},E,{targets:S}),primitive:N,multisample:{count:D,alphaToCoverageEnabled:r.alphaToCoverage&&D>1},layout:d.createPipelineLayout({bindGroupLayouts:m})},P={},L=e.context.depth,z=e.context.stencil;if((L===!0||z===!0)&&(L===!0&&(P.format=C,P.depthWriteEnabled=r.depthWrite,P.depthCompare=M),z===!0&&(P.stencilFront=v,P.stencilBack={},P.stencilReadMask=r.stencilFuncMask,P.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(P.depthBias=r.polygonOffsetUnits,P.depthBiasSlopeScale=r.polygonOffsetFactor,P.depthBiasClamp=0),R.depthStencil=P),d.pushErrorScope("validation"),t===null)p.pipeline=d.createRenderPipeline(R),d.popErrorScope().then(B=>{B!==null&&(p.error=!0,Ee(B.message))});else{const B=new Promise(async O=>{try{p.pipeline=await d.createRenderPipelineAsync(R)}catch{}const V=await d.popErrorScope();V!==null&&(p.error=!0,Ee(V.message)),O()});t.push(B)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:r,device:s}=n,a=r.getCurrentDepthStencilFormat(e),o=r.getCurrentColorFormats(e),l=this._getSampleCount(e),c={label:t,colorFormats:o,depthStencilFormat:a,sampleCount:l};return s.createRenderBundleEncoder(c)}createComputePipeline(e,t){const n=this.backend,r=n.device,s=n.get(e.computeProgram).module,a=n.get(e),o=[];for(const l of t){const c=n.get(l),{layoutGPU:d}=c.layout;o.push(d)}a.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:o})})}_getBlending(e){let t,n;const r=e.blending,s=e.blendSrc,a=e.blendDst,o=e.blendEquation;if(r===Jc){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,c=e.blendDstAlpha!==null?e.blendDstAlpha:a,d=e.blendEquationAlpha!==null?e.blendEquationAlpha:o;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(o)},n={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(c),operation:this._getBlendOperation(d)}}else{const l=e.premultipliedAlpha,c=(d,f,p,m)=>{t={srcFactor:d,dstFactor:f,operation:Ql.Add},n={srcFactor:p,dstFactor:m,operation:Ql.Add}};if(l)switch(r){case Qr:c(qt.One,qt.OneMinusSrcAlpha,qt.One,qt.OneMinusSrcAlpha);break;case oh:c(qt.One,qt.One,qt.One,qt.One);break;case lh:c(qt.Zero,qt.OneMinusSrc,qt.Zero,qt.One);break;case uh:c(qt.Dst,qt.OneMinusSrcAlpha,qt.Zero,qt.One);break}else switch(r){case Qr:c(qt.SrcAlpha,qt.OneMinusSrcAlpha,qt.One,qt.OneMinusSrcAlpha);break;case oh:c(qt.SrcAlpha,qt.One,qt.One,qt.One);break;case lh:Ee("WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case uh:Ee("WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true");break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};Ee("WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case Ja:t=qt.Zero;break;case Nw:t=qt.One;break;case Pw:t=qt.Src;break;case Dw:t=qt.OneMinusSrc;break;case Zf:t=qt.SrcAlpha;break;case Qf:t=qt.OneMinusSrcAlpha;break;case Lw:t=qt.Dst;break;case Fw:t=qt.OneMinusDst;break;case kw:t=qt.DstAlpha;break;case Iw:t=qt.OneMinusDstAlpha;break;case Uw:t=qt.SrcAlphaSaturated;break;case h$:t=qt.Constant;break;case d$:t=qt.OneMinusConstant;break;default:Ee("WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case yL:t=Ri.Never;break;case Nb:t=Ri.Always;break;case vL:t=Ri.Less;break;case bL:t=Ri.LessEqual;break;case xL:t=Ri.Equal;break;case TL:t=Ri.GreaterEqual;break;case wL:t=Ri.Greater;break;case SL:t=Ri.NotEqual;break;default:Ee("WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case tu:t=el.Keep;break;case hL:t=el.Zero;break;case dL:t=el.Replace;break;case _L:t=el.Invert;break;case fL:t=el.IncrementClamp;break;case pL:t=el.DecrementClamp;break;case gL:t=el.IncrementWrap;break;case mL:t=el.DecrementWrap;break;default:Ee("WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Yi:t=Ql.Add;break;case Cw:t=Ql.Subtract;break;case Rw:t=Ql.ReverseSubtract;break;case SR:t=Ql.Min;break;case TR:t=Ql.Max;break;default:Ee("WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},s=this.backend.utils;r.topology=s.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?Wh.Uint16:Wh.Uint32);let a=n.side===En;return e.isMesh&&e.matrixWorld.determinant()<0&&(a=!a),r.frontFace=a===!0?L2.CW:L2.CCW,r.cullMode=n.side===Xi?F2.None:F2.Back,r}_getColorWriteMask(e){return e.colorWrite===!0?U2.All:U2.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=Ri.Always;else{const n=e.depthFunc;switch(n){case Jf:t=Ri.Never;break;case ep:t=Ri.Always;break;case tp:t=Ri.Less;break;case gl:t=Ri.LessEqual;break;case np:t=Ri.Equal;break;case ip:t=Ri.GreaterEqual;break;case rp:t=Ri.Greater;break;case sp:t=Ri.NotEqual;break;default:Ee("WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class UY extends Q3{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Fn(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const s=r.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,n)),o={},l=[];for(const[d,f]of e){const p=d.match(/^(.*):f(\d+)$/),m=parseInt(p[2]);l.includes(m)===!1&&l.push(m),o[m]===void 0&&(o[m]=0);const _=a[f],b=a[f+1],v=Number(b-_)/1e6;this.timestamps.set(d,v),o[m]+=v}const c=o[l[l.length-1]];return this.resultBuffer.unmap(),this.lastValue=c,this.frames=l,c}catch(e){return Ee("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){Ee("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){Ee("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class OY extends Z3{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.defaultRenderPassdescriptor=null,this.utils=new NY(this),this.attributeUtils=new kY(this),this.bindingUtils=new LY(this),this.pipelineUtils=new FY(this),this.textureUtils=new vY(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const r={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},s=typeof navigator<"u"?await navigator.gpu.requestAdapter(r):null;if(s===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const a=Object.values(fw),o=[];for(const c of a)s.features.has(c)&&o.push(c);const l={requiredFeatures:o,requiredLimits:t.requiredLimits};n=await s.requestDevice(l)}else n=t.device;n.lost.then(r=>{if(r.reason==="destroyed")return;const s={api:"WebGPU",message:r.message||"Unknown reason",reason:r.reason||null,originalEvent:r};e.onDeviceLost(s)}),this.device=n,this.trackTimestamp=this.trackTimestamp&&this.hasFeature(fw.TimestampQuery),this.updateSize()}get context(){const e=this.renderer.getCanvasTarget(),t=this.get(e);let n=t.context;if(n===void 0){const r=this.parameters;e.isDefaultCanvasTarget===!0&&r.context!==void 0?n=r.context:n=e.domElement.getContext("webgpu"),"setAttribute"in e.domElement&&e.domElement.setAttribute("data-engine",`three.js r${ku} webgpu`);const s=r.alpha?"premultiplied":"opaque",a=r.outputType===Wn?"extended":"standard";n.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s,toneMapping:{mode:a}}),t.context=n}return n}get coordinateSystem(){return Sa}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){const e=this.renderer,t=e.getCanvasTarget(),n=this.get(t),r=e.currentSamples;let s=n.descriptor;if(s===void 0||n.samples!==r){s={colorAttachments:[{view:null}]},(e.depth===!0||e.stencil===!0)&&(s.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(e.depth,e.stencil).createView()});const o=s.colorAttachments[0];r>0?o.view=this.textureUtils.getColorBuffer().createView():o.resolveTarget=void 0,n.descriptor=s,n.samples=r}const a=s.colorAttachments[0];return r>0?a.resolveTarget=this.context.getCurrentTexture().createView():a.view=this.context.getCurrentTexture().createView(),s}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,r=this.get(n);let s=r.descriptors;(s===void 0||r.width!==n.width||r.height!==n.height||r.samples!==n.samples)&&(s={},r.descriptors=s);const a=e.getCacheKey();let o=s[a];if(o===void 0){const c=e.textures,d=[];let f;const p=this._isRenderCameraDepthArray(e);for(let m=0;m<c.length;m++){const _=this.get(c[m]),b={label:`colorAttachment_${m}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:ai.TwoD};if(n.isRenderTarget3D)f=e.activeCubeFace,b.baseArrayLayer=0,b.dimension=ai.ThreeD,b.depthOrArrayLayers=c[m].image.depth;else if(n.isRenderTarget&&c[m].image.depth>1)if(p===!0){const v=e.camera.cameras;for(let y=0;y<v.length;y++){const S={...b,baseArrayLayer:y,arrayLayerCount:1,dimension:ai.TwoD},T=_.texture.createView(S);d.push({view:T,resolveTarget:void 0,depthSlice:void 0})}}else b.dimension=ai.TwoDArray,b.depthOrArrayLayers=c[m].image.depth;if(p!==!0){const v=_.texture.createView(b);let y,S;_.msaaTexture!==void 0?(y=_.msaaTexture.createView(),S=v):(y=v,S=void 0),d.push({view:y,resolveTarget:S,depthSlice:f})}}if(o={textureViews:d},e.depth){const m=this.get(e.depthTexture),_={};(e.depthTexture.isArrayTexture||e.depthTexture.isCubeTexture)&&(_.dimension=ai.TwoD,_.arrayLayerCount=1,_.baseArrayLayer=e.activeCubeFace),o.depthStencilView=m.texture.createView(_)}s[a]=o,r.width=n.width,r.height=n.height,r.samples=n.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace}const l={colorAttachments:[]};for(let c=0;c<o.textureViews.length;c++){const d=o.textureViews[c];let f={r:0,g:0,b:0,a:1};c===0&&t.clearValue&&(f=t.clearValue),l.colorAttachments.push({view:d.view,depthSlice:d.depthSlice,resolveTarget:d.resolveTarget,loadOp:t.loadOp||pn.Load,storeOp:t.storeOp||or.Store,clearValue:f})}return o.depthStencilView&&(l.depthStencilAttachment={view:o.depthStencilView}),l}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=n.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:pn.Load}),this.initTimestampQuery(ya.RENDER,this.getTimestampUID(e),a),a.occlusionQuerySet=s;const o=a.depthStencilAttachment;if(e.textures!==null){const c=a.colorAttachments;for(let d=0;d<c.length;d++){const f=c[d];e.clearColor?(f.clearValue=d===0?e.clearColorValue:{r:0,g:0,b:0,a:1},f.loadOp=pn.Clear):f.loadOp=pn.Load,f.storeOp=or.Store}}else{const c=a.colorAttachments[0];e.clearColor?(c.clearValue=e.clearColorValue,c.loadOp=pn.Clear):c.loadOp=pn.Load,c.storeOp=or.Store}e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=pn.Clear):o.depthLoadOp=pn.Load,o.depthStoreOp=or.Store),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=pn.Clear):o.stencilLoadOp=pn.Load,o.stencilStoreOp=or.Store);const l=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const c=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==c.length?this._createDepthLayerDescriptors(e,t,a,c):this._updateDepthLayerDescriptors(e,t,c),t.bundleEncoders=[],t.bundleSets=[];for(let d=0;d<c.length;d++){const f=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+d),p={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(f),t.bundleSets.push(p)}t.currentPass=null}else{const c=l.beginRenderPass(a);t.currentPass=c,e.viewport&&this.updateViewport(e),e.scissor&&this.updateScissor(e)}t.descriptor=a,t.encoder=l,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,r){const s=n.depthStencilAttachment;t.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let o=0;o<r.length;o++){const l={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[o].view}]};if(n.depthStencilAttachment){const c=o;a.viewCache[c]||(a.viewCache[c]=a.texture.createView({dimension:ai.TwoD,baseArrayLayer:o,arrayLayerCount:1})),l.depthStencilAttachment={view:a.viewCache[c],depthLoadOp:s.depthLoadOp||pn.Clear,depthStoreOp:s.depthStoreOp||or.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(l.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,l.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,l.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else l.depthStencilAttachment={...s};t.layerDescriptors.push(l)}}_updateDepthLayerDescriptors(e,t,n){for(let r=0;r<n.length;r++){const s=t.layerDescriptors[r];if(s.depthStencilAttachment){const a=s.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=pn.Clear):a.depthLoadOp=pn.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=pn.Clear):a.stencilLoadOp=pn.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let a=0;a<t.bundleEncoders.length;a++){const o=t.bundleEncoders[a];s.push(o.finish())}for(let a=0;a<t.layerDescriptors.length;a++)if(a<s.length){const o=t.layerDescriptors[a],l=r.beginRenderPass(o);if(e.viewport){const{x:c,y:d,width:f,height:p,minDepth:m,maxDepth:_}=e.viewportValue;l.setViewport(c,d,f,p,m,_)}if(e.scissor){const{x:c,y:d,width:f,height:p}=e.scissorValue;l.setScissorRect(c,d,f,p)}l.executeBundles([s[a]]),l.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const s=n*8;let a=this.occludedResolveCache.get(s);a===void 0&&(a=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,a));const o=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,a,0),t.encoder.copyBufferToBuffer(a,0,o,0,s),t.occlusionQueryBuffer=o,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let a=0;a<s.length;a++){const o=s[a];o.generateMipmaps===!0&&this.textureUtils.generateMipmaps(o)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const a=n.getMappedRange(),o=new BigUint64Array(a);for(let l=0;l<r.length;l++)o[l]===BigInt(0)&&s.add(r[l]);n.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:s,height:a,minDepth:o,maxDepth:l}=e.viewportValue;t.setViewport(n,r,s,a,o,l)}updateScissor(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:s,height:a}=e.scissorValue;t.setScissorRect(n,r,s,a)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,r=null){const s=this.device,a=this.renderer;let o=[],l,c,d,f;if(e){const _=this.getClearColor();c={r:_.r,g:_.g,b:_.b,a:_.a}}if(r===null){d=a.depth,f=a.stencil;const _=this._getDefaultRenderPassDescriptor();if(e){o=_.colorAttachments;const b=o[0];b.clearValue=c,b.loadOp=pn.Clear,b.storeOp=or.Store}(d||f)&&(l=_.depthStencilAttachment)}else{d=r.depth,f=r.stencil;const _={loadOp:e?pn.Clear:pn.Load,clearValue:e?c:void 0};d&&(_.depthLoadOp=t?pn.Clear:pn.Load,_.depthClearValue=t?a.getClearDepth():void 0,_.depthStoreOp=or.Store),f&&(_.stencilLoadOp=n?pn.Clear:pn.Load,_.stencilClearValue=n?a.getClearStencil():void 0,_.stencilStoreOp=or.Store);const b=this._getRenderPassDescriptor(r,_);o=b.colorAttachments,l=b.depthStencilAttachment}d&&l&&(t?(l.depthLoadOp=pn.Clear,l.depthClearValue=a.getClearDepth(),l.depthStoreOp=or.Store):(l.depthLoadOp=pn.Load,l.depthStoreOp=or.Store)),f&&l&&(n?(l.stencilLoadOp=pn.Clear,l.stencilClearValue=a.getClearStencil(),l.stencilStoreOp=or.Store):(l.stencilLoadOp=pn.Load,l.stencilStoreOp=or.Store));const p=s.createCommandEncoder({label:"clear"});p.beginRenderPass({colorAttachments:o,depthStencilAttachment:l}).end(),s.queue.submit([p.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(ya.COMPUTE,this.getTimestampUID(e),n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r,s=null){const a=this.get(t),{passEncoderGPU:o}=this.get(e),l=this.get(r).pipeline;this.pipelineUtils.setPipeline(o,l);for(let c=0,d=n.length;c<d;c++){const f=n[c],p=this.get(f);o.setBindGroup(c,p.group)}if(s===null&&(s=t.count),s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute){const c=this.get(s).buffer;o.dispatchWorkgroupsIndirect(c,0);return}if(typeof s=="number"){const c=s;if(a.dispatchSize===void 0||a.count!==c){a.dispatchSize=[0,1,1],a.count=c;const d=t.workgroupSize;let f=d[0];for(let _=1;_<d.length;_++)f*=d[_];const p=Math.ceil(c/f),m=this.device.limits.maxComputeWorkgroupsPerDimension;s=[p,1,1],p>m&&(s[0]=Math.min(p,m),s[1]=Math.ceil(p/m)),a.dispatchSize=s}s=a.dispatchSize}o.dispatchWorkgroups(s[0],s[1]||1,s[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}draw(e,t){const{object:n,material:r,context:s,pipeline:a}=e,o=e.getBindings(),l=this.get(s),c=this.get(a),d=c.pipeline;if(c.error===!0)return;const f=e.getIndex(),p=f!==null,m=e.getDrawParameters();if(m===null)return;const _=(v,y)=>{this.pipelineUtils.setPipeline(v,d),y.pipeline=d;const S=y.bindingGroups;for(let E=0,N=o.length;E<N;E++){const M=o[E],C=this.get(M);S[M.index]!==M.id&&(v.setBindGroup(M.index,C.group),S[M.index]=M.id)}if(p===!0&&y.index!==f){const E=this.get(f).buffer,N=f.array instanceof Uint16Array?Wh.Uint16:Wh.Uint32;v.setIndexBuffer(E,N),y.index=f}const T=e.getVertexBuffers();for(let E=0,N=T.length;E<N;E++){const M=T[E];if(y.attributes[E]!==M){const C=this.get(M).buffer;v.setVertexBuffer(E,C),y.attributes[E]=M}}s.stencil===!0&&r.stencilWrite===!0&&l.currentStencilRef!==r.stencilRef&&(v.setStencilReference(r.stencilRef),l.currentStencilRef=r.stencilRef)},b=(v,y)=>{if(_(v,y),n.isBatchedMesh===!0){const S=n._multiDrawStarts,T=n._multiDrawCounts,E=n._multiDrawCount,N=n._multiDrawInstances;N!==null&&Fn("WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let M=0;M<E;M++){const C=N?N[M]:1,D=C>1?0:M;p===!0?v.drawIndexed(T[M],C,S[M]/f.array.BYTES_PER_ELEMENT,0,D):v.draw(T[M],C,S[M],D),t.update(n,T[M],C)}}else if(p===!0){const{vertexCount:S,instanceCount:T,firstVertex:E}=m,N=e.getIndirect();if(N!==null){const M=this.get(N).buffer,C=e.getIndirectOffset(),D=Array.isArray(C)?C:[C];for(let R=0;R<D.length;R++)v.drawIndexedIndirect(M,D[R])}else v.drawIndexed(S,T,E,0,0);t.update(n,S,T)}else{const{vertexCount:S,instanceCount:T,firstVertex:E}=m,N=e.getIndirect();if(N!==null){const M=this.get(N).buffer,C=e.getIndirectOffset(),D=Array.isArray(C)?C:[C];for(let R=0;R<D.length;R++)v.drawIndirect(M,D[R])}else v.draw(S,T,E,0);t.update(n,S,T)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const v=this.get(e.camera),y=e.camera.cameras,S=e.getBindingGroup("cameraIndex");if(v.indexesGPU===void 0||v.indexesGPU.length!==y.length){const E=this.get(S),N=[],M=new Uint32Array([0,0,0,0]);for(let C=0,D=y.length;C<D;C++){M[0]=C;const{layoutGPU:R}=E.layout,P=this.bindingUtils.createBindGroupIndex(M,R);N.push(P)}v.indexesGPU=N}const T=this.renderer.getPixelRatio();for(let E=0,N=y.length;E<N;E++){const M=y[E];if(n.layers.test(M.layers)){const C=M.viewport;let D=l.currentPass,R=l.currentSets;if(l.bundleEncoders){const P=l.bundleEncoders[E],L=l.bundleSets[E];D=P,R=L}C&&D.setViewport(Math.floor(C.x*T),Math.floor(C.y*T),Math.floor(C.width*T),Math.floor(C.height*T),s.viewportValue.minDepth,s.viewportValue.maxDepth),S&&v.indexesGPU&&(D.setBindGroup(S.index,v.indexesGPU[E]),R.bindingGroups[S.index]=S.id),b(D,R)}}}else if(l.currentPass){if(l.occlusionQuerySet!==void 0){const v=l.lastOcclusionObject;v!==n&&(v!==null&&v.occlusionTest===!0&&(l.currentPass.endOcclusionQuery(),l.occlusionQueryIndex++),n.occlusionTest===!0&&(l.currentPass.beginOcclusionQuery(l.occlusionQueryIndex),l.occlusionQueryObjects[l.occlusionQueryIndex]=n),l.lastOcclusionObject=n)}b(l.currentPass,l.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,s=this.utils,a=s.getSampleCountRenderContext(e.context),o=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),c=s.getCurrentDepthStencilFormat(e.context),d=s.getPrimitiveTopology(n,r);let f=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==o||t.colorFormat!==l||t.depthStencilFormat!==c||t.primitiveTopology!==d||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=a,t.colorSpace=o,t.colorFormat=l,t.depthStencilFormat=c,t.primitiveTopology=d,t.clippingContextCacheKey=e.clippingContextCacheKey,f=!0),f}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,s=e.context,a=t.isMesh&&t.matrixWorld.determinant()<0;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,a,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}updateSampler(e){return this.textureUtils.updateSampler(e)}createDefaultTexture(e){return this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,r,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,r,s,a)}initTimestampQuery(e,t,n){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new UY(this.device,e,2048));const r=this.timestampQueryPool[e],s=r.allocateQueriesForContext(t);n.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new RY(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),s=n.currentPass.finish();this.get(t).bundleGPU=s,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBindings(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}deleteBindGroupData(e){this.bindingUtils.deleteBindGroupData(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.delete(this.renderer.getCanvasTarget())}getMaxAnisotropy(){return 16}hasFeature(e){return z2[e]!==void 0&&(e=z2[e]),this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,s=0,a=0){let o=0,l=0,c=0,d=0,f=0,p=0,m=e.image.width,_=e.image.height,b=1;n!==null&&(n.isBox3===!0?(d=n.min.x,f=n.min.y,p=n.min.z,m=n.max.x-n.min.x,_=n.max.y-n.min.y,b=n.max.z-n.min.z):(d=n.min.x,f=n.min.y,m=n.max.x-n.min.x,_=n.max.y-n.min.y,b=1)),r!==null&&(o=r.x,l=r.y,c=r.z||0);const v=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),y=this.get(e).texture,S=this.get(t).texture;v.copyTextureToTexture({texture:y,mipLevel:s,origin:{x:d,y:f,z:p}},{texture:S,mipLevel:a,origin:{x:o,y:l,z:c}},[m,_,b]),this.device.queue.submit([v.finish()]),a===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const a=this.get(e).texture;if(s.format!==a.format){Ee("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,a.format);return}let o;if(r.currentPass?(r.currentPass.end(),o=r.encoder):o=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),o.copyTextureToTexture({texture:s,origin:[n.x,n.y,0]},{texture:a},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e,o),r.currentPass){const{descriptor:l}=r;for(let c=0;c<l.colorAttachments.length;c++)l.colorAttachments[c].loadOp=pn.Load;t.depth&&(l.depthStencilAttachment.depthLoadOp=pn.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=pn.Load),r.currentPass=o.beginRenderPass(l),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor&&this.updateScissor(t)}else this.device.queue.submit([o.finish()])}dispose(){if(this.bindingUtils.dispose(),this.textureUtils.dispose(),this.occludedResolveCache){for(const e of this.occludedResolveCache.values())e.destroy();this.occludedResolveCache.clear()}if(this.timestampQueryPool)for(const e of Object.values(this.timestampQueryPool))e!==null&&e.dispose();this.parameters.device===void 0&&this.device!==null&&this.device.destroy()}}class BY extends fS{constructor(e,t,n,r,s,a){super(e,t,n,r,s,a),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class zY extends fS{constructor(e,t,n,r,s,a){super(e,t,n,r,s,a),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class GY extends j3{constructor(){super(),this.addMaterial(WH,"MeshPhongMaterial"),this.addMaterial(T3,"MeshStandardMaterial"),this.addMaterial(jW,"MeshPhysicalMaterial"),this.addMaterial(qW,"MeshToonMaterial"),this.addMaterial(OH,"MeshBasicMaterial"),this.addMaterial(jH,"MeshLambertMaterial"),this.addMaterial(kH,"MeshNormalMaterial"),this.addMaterial(KW,"MeshMatcapMaterial"),this.addMaterial(RH,"LineBasicMaterial"),this.addMaterial(PH,"LineDashedMaterial"),this.addMaterial(t$,"PointsMaterial"),this.addMaterial(A3,"SpriteMaterial"),this.addMaterial(s$,"ShadowMaterial"),this.addLight(Gq,IF),this.addLight(mX,KR),this.addLight(_X,FF),this.addLight(JS,fS),this.addLight(bX,ZR),this.addLight(wX,PF),this.addLight(SX,OF),this.addLight(yX,BY),this.addLight(xX,zY),this.addToneMapping(H$,Ow),this.addToneMapping(W$,Bw),this.addToneMapping($$,zw),this.addToneMapping(X$,Gw),this.addToneMapping(Q$,Vw),this.addToneMapping(J$,jw)}}class VY extends jX{constructor(e={}){let t;e.forceWebGL?t=I2:(t=OY,e.getFallback=()=>(Ae("WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new I2(e)));const n=new t(e);super(n,e),this.library=new GY,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}const db={type:"change"},t1={type:"start"},n1={type:"end"},W2=1e-6,gn={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},u0=new Xe,tl=new Xe,jY=new X,c0=new X,fb=new X,Wc=new Ys,$2=new X,h0=new X,pb=new X,d0=new X;class HY extends r_{constructor(e,t=null){super(e,t),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Pi.ROTATE,MIDDLE:Pi.DOLLY,RIGHT:Pi.PAN},this.target=new X,this.state=gn.NONE,this.keyState=gn.NONE,this._lastPosition=new X,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new X,this._movePrev=new Xe,this._moveCurr=new Xe,this._lastAxis=new X,this._zoomStart=new Xe,this._zoomEnd=new Xe,this._panStart=new Xe,this._panEnd=new Xe,this._pointers=[],this._pointerPositions={},this._onPointerMove=$Y.bind(this),this._onPointerDown=WY.bind(this),this._onPointerUp=qY.bind(this),this._onPointerCancel=XY.bind(this),this._onContextMenu=tK.bind(this),this._onMouseWheel=eK.bind(this),this._onKeyDown=KY.bind(this),this._onKeyUp=YY.bind(this),this._onTouchStart=nK.bind(this),this._onTouchMove=iK.bind(this),this._onTouchEnd=rK.bind(this),this._onMouseDown=ZY.bind(this),this._onMouseMove=QY.bind(this),this._onMouseUp=JY.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(t),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>W2&&(this.dispatchEvent(db),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>W2||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(db),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=gn.NONE,this.keyState=gn.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(db),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(tl.copy(this._panEnd).sub(this._panStart),tl.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;tl.x*=e,tl.y*=t}tl.multiplyScalar(this._eye.length()*this.panSpeed),c0.copy(this._eye).cross(this.object.up).setLength(tl.x),c0.add(jY.copy(this.object.up).setLength(tl.y)),this.object.position.add(c0),this.target.add(c0),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(tl.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){d0.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=d0.length();e?(this._eye.copy(this.object.position).sub(this.target),$2.copy(this._eye).normalize(),h0.copy(this.object.up).normalize(),pb.crossVectors(h0,$2).normalize(),h0.setLength(this._moveCurr.y-this._movePrev.y),pb.setLength(this._moveCurr.x-this._movePrev.x),d0.copy(h0.add(pb)),fb.crossVectors(d0,this._eye).normalize(),e*=this.rotateSpeed,Wc.setFromAxisAngle(fb,e),this._eye.applyQuaternion(Wc),this.object.up.applyQuaternion(Wc),this._lastAxis.copy(fb),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),Wc.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(Wc),this.object.up.applyQuaternion(Wc)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===gn.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=D0.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=D0.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return u0.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),u0}_getMouseOnCircle(e,t){return u0.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),u0}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new Xe,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function WY(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i))}function $Y(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function qY(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchEnd(i):this._onMouseUp(),this._removePointer(i),this._pointers.length===0&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp)))}function XY(i){this._removePointer(i)}function YY(){this.enabled!==!1&&(this.keyState=gn.NONE,window.addEventListener("keydown",this._onKeyDown))}function KY(i){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===gn.NONE&&(i.code===this.keys[gn.ROTATE]&&!this.noRotate?this.keyState=gn.ROTATE:i.code===this.keys[gn.ZOOM]&&!this.noZoom?this.keyState=gn.ZOOM:i.code===this.keys[gn.PAN]&&!this.noPan&&(this.keyState=gn.PAN)))}function ZY(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Pi.DOLLY:this.state=gn.ZOOM;break;case Pi.ROTATE:this.state=gn.ROTATE;break;case Pi.PAN:this.state=gn.PAN;break;default:this.state=gn.NONE}const t=this.keyState!==gn.NONE?this.keyState:this.state;t===gn.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr)):t===gn.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._zoomEnd.copy(this._zoomStart)):t===gn.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(t1)}function QY(i){const e=this.keyState!==gn.NONE?this.keyState:this.state;e===gn.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY))):e===gn.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY)):e===gn.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY))}function JY(){this.state=gn.NONE,this.dispatchEvent(n1)}function eK(i){if(this.enabled!==!1&&this.noZoom!==!0){switch(i.preventDefault(),i.deltaMode){case 2:this._zoomStart.y-=i.deltaY*.025;break;case 1:this._zoomStart.y-=i.deltaY*.01;break;default:this._zoomStart.y-=i.deltaY*25e-5;break}this.dispatchEvent(t1),this.dispatchEvent(n1)}}function tK(i){this.enabled!==!1&&i.preventDefault()}function nK(i){switch(this._trackPointer(i),this._pointers.length){case 1:this.state=gn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=gn.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,r)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(t1)}function iK(i){switch(this._trackPointer(i),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY));break;default:const e=this._getSecondPointerPosition(i),t=i.pageX-e.x,n=i.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+n*n);const r=(i.pageX+e.x)/2,s=(i.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,s));break}}function rK(i){switch(this._pointers.length){case 0:this.state=gn.NONE;break;case 1:this.state=gn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=gn.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==i.pointerId){const t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(n1)}const q2={type:"change"},i1={type:"start"},tD={type:"end"},f0=new nS,X2=new zs,sK=Math.cos(70*D0.DEG2RAD),di=new X,Mr=2*Math.PI,An={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},gb=1e-6;class aK extends r_{constructor(e,t=null){super(e,t),this.state=An.NONE,this.target=new X,this.cursor=new X,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Pi.ROTATE,MIDDLE:Pi.DOLLY,RIGHT:Pi.PAN},this.touches={ONE:so.ROTATE,TWO:so.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new X,this._lastQuaternion=new Ys,this._lastTargetPosition=new X,this._quat=new Ys().setFromUnitVectors(e.up,new X(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new dA,this._sphericalDelta=new dA,this._scale=1,this._panOffset=new X,this._rotateStart=new Xe,this._rotateEnd=new Xe,this._rotateDelta=new Xe,this._panStart=new Xe,this._panEnd=new Xe,this._panDelta=new Xe,this._dollyStart=new Xe,this._dollyEnd=new Xe,this._dollyDelta=new Xe,this._dollyDirection=new X,this._mouse=new Xe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=lK.bind(this),this._onPointerDown=oK.bind(this),this._onPointerUp=uK.bind(this),this._onContextMenu=mK.bind(this),this._onMouseWheel=dK.bind(this),this._onKeyDown=fK.bind(this),this._onTouchStart=pK.bind(this),this._onTouchMove=gK.bind(this),this._onMouseDown=cK.bind(this),this._onMouseMove=hK.bind(this),this._interceptControlDown=_K.bind(this),this._interceptControlUp=yK.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(q2),this.update(),this.state=An.NONE}update(e=null){const t=this.object.position;di.copy(t).sub(this.target),di.applyQuaternion(this._quat),this._spherical.setFromVector3(di),this.autoRotate&&this.state===An.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=Mr:n>Math.PI&&(n-=Mr),r<-Math.PI?r+=Mr:r>Math.PI&&(r-=Mr),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=a!=this._spherical.radius}if(di.setFromSpherical(this._spherical),di.applyQuaternion(this._quatInverse),t.copy(this.target).add(di),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const o=di.length();a=this._clampDistance(o*this._scale);const l=o-a;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const o=new X(this._mouse.x,this._mouse.y,0);o.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const c=new X(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(o),this.object.updateMatrixWorld(),a=di.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(f0.origin.copy(this.object.position),f0.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(f0.direction))<sK?this.object.lookAt(this.target):(X2.setFromNormalAndCoplanarPoint(this.object.up,this.target),f0.intersectPlane(X2,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>gb||8*(1-this._lastQuaternion.dot(this.object.quaternion))>gb||this._lastTargetPosition.distanceToSquared(this.target)>gb?(this.dispatchEvent(q2),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Mr/60*this.autoRotateSpeed*e:Mr/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){di.setFromMatrixColumn(t,0),di.multiplyScalar(-e),this._panOffset.add(di)}_panUp(e,t){this.screenSpacePanning===!0?di.setFromMatrixColumn(t,1):(di.setFromMatrixColumn(t,0),di.crossVectors(this.object.up,di)),di.multiplyScalar(e),this._panOffset.add(di)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;di.copy(r).sub(this.target);let s=di.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/n.clientHeight,this.object.matrix),this._panUp(2*t*s/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,s=t-n.top,a=n.width,o=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-(s/o)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Mr*this._rotateDelta.x/t.clientHeight),this._rotateUp(Mr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Mr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Mr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Mr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Mr*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Mr*this._rotateDelta.x/t.clientHeight),this._rotateUp(Mr*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+t.x)*.5,o=(e.pageY+t.y)*.5;this._updateZoomParameters(a,o)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new Xe,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function oK(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function lK(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function uK(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(tD),this.state=An.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function cK(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Pi.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=An.DOLLY;break;case Pi.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=An.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=An.ROTATE}break;case Pi.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=An.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=An.PAN}break;default:this.state=An.NONE}this.state!==An.NONE&&this.dispatchEvent(i1)}function hK(i){switch(this.state){case An.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case An.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case An.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function dK(i){this.enabled===!1||this.enableZoom===!1||this.state!==An.NONE||(i.preventDefault(),this.dispatchEvent(i1),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(tD))}function fK(i){this.enabled!==!1&&this._handleKeyDown(i)}function pK(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case so.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=An.TOUCH_ROTATE;break;case so.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=An.TOUCH_PAN;break;default:this.state=An.NONE}break;case 2:switch(this.touches.TWO){case so.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=An.TOUCH_DOLLY_PAN;break;case so.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=An.TOUCH_DOLLY_ROTATE;break;default:this.state=An.NONE}break;default:this.state=An.NONE}this.state!==An.NONE&&this.dispatchEvent(i1)}function gK(i){switch(this._trackPointer(i),this.state){case An.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case An.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case An.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case An.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=An.NONE}}function mK(i){this.enabled!==!1&&i.preventDefault()}function _K(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function yK(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const vK={type:"change"},Y2=1e-6,K2=new Ys;class xK extends r_{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new X(0,0,0),this._rotationVector=new X(0,0,0),this._lastQuaternion=new Ys,this._lastPosition=new X,this._status=0,this._onKeyDown=bK.bind(this),this._onKeyUp=wK.bind(this),this._onPointerMove=TK.bind(this),this._onPointerDown=SK.bind(this),this._onPointerUp=MK.bind(this),this._onPointerCancel=AK.bind(this),this._onContextMenu=EK.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const t=this.object,n=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),K2.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(K2),(this._lastPosition.distanceToSquared(t.position)>Y2||8*(1-this._lastQuaternion.dot(t.quaternion))>Y2)&&(this.dispatchEvent(vK),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function bK(i){if(!(i.altKey||this.enabled===!1)){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function wK(i){if(this.enabled!==!1){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function SK(i){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(i.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function TK(i){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),t=e.size[0]/2,n=e.size[1]/2;this._moveState.yawLeft=-(i.pageX-e.offset[0]-t)/t,this._moveState.pitchDown=(i.pageY-e.offset[1]-n)/n,this._updateRotationVector()}}function MK(i){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(i.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function AK(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function EK(i){this.enabled!==!1&&i.preventDefault()}const CK={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class A_{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const RK=new Qh(-1,1,1,-1,0,1);class NK extends es{constructor(){super(),this.setAttribute("position",new fi([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new fi([0,2,0,0,2,0],2))}}const PK=new NK;class DK{constructor(e){this._mesh=new pi(PK,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,RK)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class kK extends A_{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof vs?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=BR.clone(e.uniforms),this.material=new vs({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new DK(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class Z2 extends A_{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let a,o;this.inverse?(a=0,o=1):(a=1,o=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,a,4294967295),s.buffers.stencil.setClear(o),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class IK extends A_{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class LK{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const n=e.getSize(new Xe);this._width=n.width,this._height=n.height,t=new Ws(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Wn}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new kK(CK),this.copyPass.material.blending=pr,this.clock=new JR}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const a=this.passes[r];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),a.needsSwap){if(n){const o=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}Z2!==void 0&&(a instanceof Z2?n=!0:a instanceof IK&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new Xe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class FK extends A_{constructor(e,t,n=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this.isRenderPass=!0,this._oldClearColor=new _t}render(e,t,n){const r=e.autoClear;e.autoClear=!1;let s,a;this.overrideMaterial!==null&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=a),e.autoClear=r}}function Lr(){return Lr=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Lr.apply(null,arguments)}function UK(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function yp(i,e){return yp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},yp(i,e)}function OK(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,yp(i,e)}function gw(i){return gw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gw(i)}function BK(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function nD(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nD=function(){return!!i})()}function zK(i,e,t){if(nD())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&yp(r,t.prototype),r}function mw(i){var e=typeof Map=="function"?new Map:void 0;return mw=function(n){if(n===null||!BK(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return zK(n,arguments,gw(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),yp(r,n)},mw(i)}var va=(function(i){OK(e,i);function e(t){var n;return n=i.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,UK(n)}return e})(mw(Error));function mb(i){return Math.round(i*255)}function GK(i,e,t){return mb(i)+","+mb(e)+","+mb(t)}function $0(i,e,t,n){if(n===void 0&&(n=GK),e===0)return n(t,t,t);var r=(i%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,a=s*(1-Math.abs(r%2-1)),o=0,l=0,c=0;r>=0&&r<1?(o=s,l=a):r>=1&&r<2?(o=a,l=s):r>=2&&r<3?(l=s,c=a):r>=3&&r<4?(l=a,c=s):r>=4&&r<5?(o=a,c=s):r>=5&&r<6&&(o=s,c=a);var d=t-s/2,f=o+d,p=l+d,m=c+d;return n(f,p,m)}var Q2={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function VK(i){if(typeof i!="string")return i;var e=i.toLowerCase();return Q2[e]?"#"+Q2[e]:i}var jK=/^#[a-fA-F0-9]{6}$/,HK=/^#[a-fA-F0-9]{8}$/,WK=/^#[a-fA-F0-9]{3}$/,$K=/^#[a-fA-F0-9]{4}$/,_b=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,qK=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,XK=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,YK=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function $h(i){if(typeof i!="string")throw new va(3);var e=VK(i);if(e.match(jK))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(HK)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(WK))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match($K)){var n=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:n}}var r=_b.exec(e);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=qK.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var a=XK.exec(e);if(a){var o=parseInt(""+a[1],10),l=parseInt(""+a[2],10)/100,c=parseInt(""+a[3],10)/100,d="rgb("+$0(o,l,c)+")",f=_b.exec(d);if(!f)throw new va(4,e,d);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var p=YK.exec(e.substring(0,50));if(p){var m=parseInt(""+p[1],10),_=parseInt(""+p[2],10)/100,b=parseInt(""+p[3],10)/100,v="rgb("+$0(m,_,b)+")",y=_b.exec(v);if(!y)throw new va(4,e,v);return{red:parseInt(""+y[1],10),green:parseInt(""+y[2],10),blue:parseInt(""+y[3],10),alpha:parseFloat(""+p[4])>1?parseFloat(""+p[4])/100:parseFloat(""+p[4])}}throw new va(5)}function KK(i){var e=i.red/255,t=i.green/255,n=i.blue/255,r=Math.max(e,t,n),s=Math.min(e,t,n),a=(r+s)/2;if(r===s)return i.alpha!==void 0?{hue:0,saturation:0,lightness:a,alpha:i.alpha}:{hue:0,saturation:0,lightness:a};var o,l=r-s,c=a>.5?l/(2-r-s):l/(r+s);switch(r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;default:o=(e-t)/l+4;break}return o*=60,i.alpha!==void 0?{hue:o,saturation:c,lightness:a,alpha:i.alpha}:{hue:o,saturation:c,lightness:a}}function Sl(i){return KK($h(i))}var ZK=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},_w=ZK;function iu(i){var e=i.toString(16);return e.length===1?"0"+e:e}function yb(i){return iu(Math.round(i*255))}function QK(i,e,t){return _w("#"+yb(i)+yb(e)+yb(t))}function iD(i,e,t){return $0(i,e,t,QK)}function JK(i,e,t){if(typeof i=="object"&&e===void 0&&t===void 0)return iD(i.hue,i.saturation,i.lightness);throw new va(1)}function eZ(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?iD(i.hue,i.saturation,i.lightness):"rgba("+$0(i.hue,i.saturation,i.lightness)+","+i.alpha+")";throw new va(2)}function rD(i,e,t){if(typeof i=="number"&&typeof e=="number"&&typeof t=="number")return _w("#"+iu(i)+iu(e)+iu(t));if(typeof i=="object"&&e===void 0&&t===void 0)return _w("#"+iu(i.red)+iu(i.green)+iu(i.blue));throw new va(6)}function E_(i,e,t,n){if(typeof i=="object"&&e===void 0&&t===void 0&&n===void 0)return i.alpha>=1?rD(i.red,i.green,i.blue):"rgba("+i.red+","+i.green+","+i.blue+","+i.alpha+")";throw new va(7)}var tZ=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},nZ=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},iZ=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},rZ=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function Tl(i){if(typeof i!="object")throw new va(8);if(nZ(i))return E_(i);if(tZ(i))return rD(i);if(rZ(i))return eZ(i);if(iZ(i))return JK(i);throw new va(8)}function sD(i,e,t){return function(){var r=t.concat(Array.prototype.slice.call(arguments));return r.length>=e?i.apply(this,r):sD(i,e,r)}}function ts(i){return sD(i,i.length,[])}function sZ(i,e){if(e==="transparent")return e;var t=Sl(e);return Tl(Lr({},t,{hue:t.hue+parseFloat(i)}))}ts(sZ);function ud(i,e,t){return Math.max(i,Math.min(e,t))}function aZ(i,e){if(e==="transparent")return e;var t=Sl(e);return Tl(Lr({},t,{lightness:ud(0,1,t.lightness-parseFloat(i))}))}ts(aZ);function oZ(i,e){if(e==="transparent")return e;var t=Sl(e);return Tl(Lr({},t,{saturation:ud(0,1,t.saturation-parseFloat(i))}))}ts(oZ);function lZ(i,e){if(e==="transparent")return e;var t=Sl(e);return Tl(Lr({},t,{lightness:ud(0,1,t.lightness+parseFloat(i))}))}ts(lZ);function uZ(i,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(i===0)return t;var n=$h(e),r=Lr({},n,{alpha:typeof n.alpha=="number"?n.alpha:1}),s=$h(t),a=Lr({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),o=r.alpha-a.alpha,l=parseFloat(i)*2-1,c=l*o===-1?l:l+o,d=1+l*o,f=(c/d+1)/2,p=1-f,m={red:Math.floor(r.red*f+a.red*p),green:Math.floor(r.green*f+a.green*p),blue:Math.floor(r.blue*f+a.blue*p),alpha:r.alpha*parseFloat(i)+a.alpha*(1-parseFloat(i))};return E_(m)}var cZ=ts(uZ),aD=cZ;function hZ(i,e){if(e==="transparent")return e;var t=$h(e),n=typeof t.alpha=="number"?t.alpha:1,r=Lr({},t,{alpha:ud(0,1,(n*100+parseFloat(i)*100)/100)});return E_(r)}var dZ=ts(hZ),fZ=dZ;function pZ(i,e){if(e==="transparent")return e;var t=Sl(e);return Tl(Lr({},t,{saturation:ud(0,1,t.saturation+parseFloat(i))}))}ts(pZ);function gZ(i,e){return e==="transparent"?e:Tl(Lr({},Sl(e),{hue:parseFloat(i)}))}ts(gZ);function mZ(i,e){return e==="transparent"?e:Tl(Lr({},Sl(e),{lightness:parseFloat(i)}))}ts(mZ);function _Z(i,e){return e==="transparent"?e:Tl(Lr({},Sl(e),{saturation:parseFloat(i)}))}ts(_Z);function yZ(i,e){return e==="transparent"?e:aD(parseFloat(i),"rgb(0, 0, 0)",e)}ts(yZ);function vZ(i,e){return e==="transparent"?e:aD(parseFloat(i),"rgb(255, 255, 255)",e)}ts(vZ);function xZ(i,e){if(e==="transparent")return e;var t=$h(e),n=typeof t.alpha=="number"?t.alpha:1,r=Lr({},t,{alpha:ud(0,1,+(n*100-parseFloat(i)*100).toFixed(2)/100)});return E_(r)}ts(xZ);var vu=Object.freeze({Linear:Object.freeze({None:function(i){return i},In:function(i){return i},Out:function(i){return i},InOut:function(i){return i}}),Quadratic:Object.freeze({In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}}),Cubic:Object.freeze({In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}}),Quartic:Object.freeze({In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}}),Quintic:Object.freeze({In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}}),Sinusoidal:Object.freeze({In:function(i){return 1-Math.sin((1-i)*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.sin(Math.PI*(.5-i)))}}),Exponential:Object.freeze({In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}}),Circular:Object.freeze({In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}}),Elastic:Object.freeze({In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(i){var e=1.70158;return i===1?1:i*i*((e+1)*i-e)},Out:function(i){var e=1.70158;return i===0?0:--i*i*((e+1)*i+e)+1},InOut:function(i){var e=2.5949095;return(i*=2)<1?.5*(i*i*((e+1)*i-e)):.5*((i-=2)*i*((e+1)*i+e)+2)}}),Bounce:Object.freeze({In:function(i){return 1-vu.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?vu.Bounce.In(i*2)*.5:vu.Bounce.Out(i*2-1)*.5+.5}}),generatePow:function(i){return i===void 0&&(i=4),i=i<Number.EPSILON?Number.EPSILON:i,i=i>1e4?1e4:i,{In:function(e){return Math.pow(e,i)},Out:function(e){return 1-Math.pow(1-e,i)},InOut:function(e){return e<.5?Math.pow(e*2,i)/2:(1-Math.pow(2-e*2,i))/2+.5}}}}),kf=function(){return performance.now()},oD=(function(){function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return i.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,s=t;r<s.length;r++){var a=s[r];(e=a._group)===null||e===void 0||e.remove(a),a._group=this,this._tweens[a.getId()]=a,this._tweensAddedDuringUpdate[a.getId()]=a}},i.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var s=r[n];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},i.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},i.prototype.update=function(e,t){e===void 0&&(e=kf()),t===void 0&&(t=!0);var n=Object.keys(this._tweens);if(n.length!==0)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var s=this._tweens[n[r]],a=!t;s&&s.update(e,a)===!1&&!t&&this.remove(s)}n=Object.keys(this._tweensAddedDuringUpdate)}},i})(),yw={Linear:function(i,e){var t=i.length-1,n=t*e,r=Math.floor(n),s=yw.Utils.Linear;return e<0?s(i[0],i[1],n):e>1?s(i[t],i[t-1],t-n):s(i[r],i[r+1>t?t:r+1],n-r)},Utils:{Linear:function(i,e,t){return(e-i)*t+i}}},lD=(function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i})(),vw=new oD,J2=(function(){function i(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=vu.Linear.None,this._interpolationFunction=yw.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=lD.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=vw,vw.add(this))}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.getDuration=function(){return this._duration},i.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},i.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},i.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},i.prototype.start=function(e,t){if(e===void 0&&(e=kf()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},i.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},i.prototype._setupProperties=function(e,t,n,r,s){for(var a in n){var o=e[a],l=Array.isArray(o),c=l?"array":typeof o,d=!l&&Array.isArray(n[a]);if(!(c==="undefined"||c==="function")){if(d){var f=n[a];if(f.length===0)continue;for(var p=[o],m=0,_=f.length;m<_;m+=1){var b=this._handleRelativeValue(o,f[m]);if(isNaN(b)){d=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(b)}d&&(n[a]=p)}if((c==="object"||l)&&o&&!d){t[a]=l?[]:{};var v=o;for(var y in v)t[a][y]=v[y];r[a]=l?[]:{};var f=n[a];if(!this._isDynamic){var S={};for(var y in f)S[y]=f[y];n[a]=f=S}this._setupProperties(v,t[a],f,r[a],s)}else(typeof t[a]>"u"||s)&&(t[a]=o),l||(t[a]*=1),d?r[a]=n[a].slice().reverse():r[a]=t[a]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},i.prototype.pause=function(e){return e===void 0&&(e=kf()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},i.prototype.resume=function(e){return e===void 0&&(e=kf()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},i.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},i.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},i.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},i.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},i.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},i.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},i.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},i.prototype.easing=function(e){return e===void 0&&(e=vu.Linear.None),this._easingFunction=e,this},i.prototype.interpolation=function(e){return e===void 0&&(e=yw.Linear),this._interpolationFunction=e,this},i.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},i.prototype.onStart=function(e){return this._onStartCallback=e,this},i.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},i.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},i.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},i.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},i.prototype.onStop=function(e){return this._onStopCallback=e,this},i.prototype.update=function(e,t){var n=this,r;if(e===void 0&&(e=kf()),t===void 0&&(t=i.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=e-this._startTime,o=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),l=this._duration+this._repeat*o,c=function(){if(n._duration===0||a>l)return 1;var b=Math.trunc(a/o),v=a-b*o,y=Math.min(v/n._duration,1);return y===0&&a===n._duration?1:y},d=c(),f=this._easingFunction(d);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,d),this._duration===0||a>=this._duration)if(this._repeat>0){var p=Math.min(Math.trunc((a-this._duration)/o)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=p);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=o*p,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var m=0,_=this._chainedTweens.length;m<_;m++)this._chainedTweens[m].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(e,t,n,r){for(var s in n)if(t[s]!==void 0){var a=t[s]||0,o=n[s],l=Array.isArray(e[s]),c=Array.isArray(o),d=!l&&c;d?e[s]=this._interpolationFunction(o,r):typeof o=="object"&&o?this._updateProperties(e[s],a,o,r):(o=this._handleRelativeValue(a,o),typeof o=="number"&&(e[s]=a+(o-a)*r))}},i.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},i.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},i.autoStartOnUpdate=!1,i})();lD.nextId;var Ea=vw;Ea.getAll.bind(Ea);Ea.removeAll.bind(Ea);Ea.add.bind(Ea);Ea.remove.bind(Ea);Ea.update.bind(Ea);var xw="http://www.w3.org/1999/xhtml";const eR={svg:"http://www.w3.org/2000/svg",xhtml:xw,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function uD(i){var e=i+="",t=e.indexOf(":");return t>=0&&(e=i.slice(0,t))!=="xmlns"&&(i=i.slice(t+1)),eR.hasOwnProperty(e)?{space:eR[e],local:i}:i}function bZ(i){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===xw&&e.documentElement.namespaceURI===xw?e.createElement(i):e.createElementNS(t,i)}}function wZ(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function cD(i){var e=uD(i);return(e.local?wZ:bZ)(e)}function SZ(){}function hD(i){return i==null?SZ:function(){return this.querySelector(i)}}function TZ(i){typeof i!="function"&&(i=hD(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],a=s.length,o=n[r]=new Array(a),l,c,d=0;d<a;++d)(l=s[d])&&(c=i.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),o[d]=c);return new bs(n,this._parents)}function MZ(i){return i==null?[]:Array.isArray(i)?i:Array.from(i)}function AZ(){return[]}function EZ(i){return i==null?AZ:function(){return this.querySelectorAll(i)}}function CZ(i){return function(){return MZ(i.apply(this,arguments))}}function RZ(i){typeof i=="function"?i=CZ(i):i=EZ(i);for(var e=this._groups,t=e.length,n=[],r=[],s=0;s<t;++s)for(var a=e[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(n.push(i.call(l,l.__data__,c,a)),r.push(l));return new bs(n,r)}function NZ(i){return function(){return this.matches(i)}}function dD(i){return function(e){return e.matches(i)}}var PZ=Array.prototype.find;function DZ(i){return function(){return PZ.call(this.children,i)}}function kZ(){return this.firstElementChild}function IZ(i){return this.select(i==null?kZ:DZ(typeof i=="function"?i:dD(i)))}var LZ=Array.prototype.filter;function FZ(){return Array.from(this.children)}function UZ(i){return function(){return LZ.call(this.children,i)}}function OZ(i){return this.selectAll(i==null?FZ:UZ(typeof i=="function"?i:dD(i)))}function BZ(i){typeof i!="function"&&(i=NZ(i));for(var e=this._groups,t=e.length,n=new Array(t),r=0;r<t;++r)for(var s=e[r],a=s.length,o=n[r]=[],l,c=0;c<a;++c)(l=s[c])&&i.call(l,l.__data__,c,s)&&o.push(l);return new bs(n,this._parents)}function fD(i){return new Array(i.length)}function zZ(){return new bs(this._enter||this._groups.map(fD),this._parents)}function q0(i,e){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=e}q0.prototype={constructor:q0,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,e){return this._parent.insertBefore(i,e)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function GZ(i){return function(){return i}}function VZ(i,e,t,n,r,s){for(var a=0,o,l=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):t[a]=new q0(i,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function jZ(i,e,t,n,r,s,a){var o,l,c=new Map,d=e.length,f=s.length,p=new Array(d),m;for(o=0;o<d;++o)(l=e[o])&&(p[o]=m=a.call(l,l.__data__,o,e)+"",c.has(m)?r[o]=l:c.set(m,l));for(o=0;o<f;++o)m=a.call(i,s[o],o,s)+"",(l=c.get(m))?(n[o]=l,l.__data__=s[o],c.delete(m)):t[o]=new q0(i,s[o]);for(o=0;o<d;++o)(l=e[o])&&c.get(p[o])===l&&(r[o]=l)}function HZ(i){return i.__data__}function WZ(i,e){if(!arguments.length)return Array.from(this,HZ);var t=e?jZ:VZ,n=this._parents,r=this._groups;typeof i!="function"&&(i=GZ(i));for(var s=r.length,a=new Array(s),o=new Array(s),l=new Array(s),c=0;c<s;++c){var d=n[c],f=r[c],p=f.length,m=$Z(i.call(d,d&&d.__data__,c,n)),_=m.length,b=o[c]=new Array(_),v=a[c]=new Array(_),y=l[c]=new Array(p);t(d,f,b,v,y,m,e);for(var S=0,T=0,E,N;S<_;++S)if(E=b[S]){for(S>=T&&(T=S+1);!(N=v[T])&&++T<_;);E._next=N||null}}return a=new bs(a,n),a._enter=o,a._exit=l,a}function $Z(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function qZ(){return new bs(this._exit||this._groups.map(fD),this._parents)}function XZ(i,e,t){var n=this.enter(),r=this,s=this.exit();return typeof i=="function"?(n=i(n),n&&(n=n.selection())):n=n.append(i+""),e!=null&&(r=e(r),r&&(r=r.selection())),t==null?s.remove():t(s),n&&r?n.merge(r).order():r}function YZ(i){for(var e=i.selection?i.selection():i,t=this._groups,n=e._groups,r=t.length,s=n.length,a=Math.min(r,s),o=new Array(r),l=0;l<a;++l)for(var c=t[l],d=n[l],f=c.length,p=o[l]=new Array(f),m,_=0;_<f;++_)(m=c[_]||d[_])&&(p[_]=m);for(;l<r;++l)o[l]=t[l];return new bs(o,this._parents)}function KZ(){for(var i=this._groups,e=-1,t=i.length;++e<t;)for(var n=i[e],r=n.length-1,s=n[r],a;--r>=0;)(a=n[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function ZZ(i){i||(i=QZ);function e(f,p){return f&&p?i(f.__data__,p.__data__):!f-!p}for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s){for(var a=t[s],o=a.length,l=r[s]=new Array(o),c,d=0;d<o;++d)(c=a[d])&&(l[d]=c);l.sort(e)}return new bs(r,this._parents).order()}function QZ(i,e){return i<e?-1:i>e?1:i>=e?0:NaN}function JZ(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function eQ(){return Array.from(this)}function tQ(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length;r<s;++r){var a=n[r];if(a)return a}return null}function nQ(){let i=0;for(const e of this)++i;return i}function iQ(){return!this.node()}function rQ(i){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,a=r.length,o;s<a;++s)(o=r[s])&&i.call(o,o.__data__,s,r);return this}function sQ(i){return function(){this.removeAttribute(i)}}function aQ(i){return function(){this.removeAttributeNS(i.space,i.local)}}function oQ(i,e){return function(){this.setAttribute(i,e)}}function lQ(i,e){return function(){this.setAttributeNS(i.space,i.local,e)}}function uQ(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(i):this.setAttribute(i,t)}}function cQ(i,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function hQ(i,e){var t=uD(i);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?aQ:sQ:typeof e=="function"?t.local?cQ:uQ:t.local?lQ:oQ)(t,e))}function pD(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function dQ(i){return function(){this.style.removeProperty(i)}}function fQ(i,e,t){return function(){this.style.setProperty(i,e,t)}}function pQ(i,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(i):this.style.setProperty(i,n,t)}}function gQ(i,e,t){return arguments.length>1?this.each((e==null?dQ:typeof e=="function"?pQ:fQ)(i,e,t??"")):mQ(this.node(),i)}function mQ(i,e){return i.style.getPropertyValue(e)||pD(i).getComputedStyle(i,null).getPropertyValue(e)}function _Q(i){return function(){delete this[i]}}function yQ(i,e){return function(){this[i]=e}}function vQ(i,e){return function(){var t=e.apply(this,arguments);t==null?delete this[i]:this[i]=t}}function xQ(i,e){return arguments.length>1?this.each((e==null?_Q:typeof e=="function"?vQ:yQ)(i,e)):this.node()[i]}function gD(i){return i.trim().split(/^|\s+/)}function r1(i){return i.classList||new mD(i)}function mD(i){this._node=i,this._names=gD(i.getAttribute("class")||"")}mD.prototype={add:function(i){var e=this._names.indexOf(i);e<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var e=this._names.indexOf(i);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function _D(i,e){for(var t=r1(i),n=-1,r=e.length;++n<r;)t.add(e[n])}function yD(i,e){for(var t=r1(i),n=-1,r=e.length;++n<r;)t.remove(e[n])}function bQ(i){return function(){_D(this,i)}}function wQ(i){return function(){yD(this,i)}}function SQ(i,e){return function(){(e.apply(this,arguments)?_D:yD)(this,i)}}function TQ(i,e){var t=gD(i+"");if(arguments.length<2){for(var n=r1(this.node()),r=-1,s=t.length;++r<s;)if(!n.contains(t[r]))return!1;return!0}return this.each((typeof e=="function"?SQ:e?bQ:wQ)(t,e))}function MQ(){this.textContent=""}function AQ(i){return function(){this.textContent=i}}function EQ(i){return function(){var e=i.apply(this,arguments);this.textContent=e??""}}function CQ(i){return arguments.length?this.each(i==null?MQ:(typeof i=="function"?EQ:AQ)(i)):this.node().textContent}function RQ(){this.innerHTML=""}function NQ(i){return function(){this.innerHTML=i}}function PQ(i){return function(){var e=i.apply(this,arguments);this.innerHTML=e??""}}function DQ(i){return arguments.length?this.each(i==null?RQ:(typeof i=="function"?PQ:NQ)(i)):this.node().innerHTML}function kQ(){this.nextSibling&&this.parentNode.appendChild(this)}function IQ(){return this.each(kQ)}function LQ(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function FQ(){return this.each(LQ)}function UQ(i){var e=typeof i=="function"?i:cD(i);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function OQ(){return null}function BQ(i,e){var t=typeof i=="function"?i:cD(i),n=e==null?OQ:typeof e=="function"?e:hD(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function zQ(){var i=this.parentNode;i&&i.removeChild(this)}function GQ(){return this.each(zQ)}function VQ(){var i=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function jQ(){var i=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(i,this.nextSibling):i}function HQ(i){return this.select(i?jQ:VQ)}function WQ(i){return arguments.length?this.property("__data__",i):this.node().__data__}function $Q(i){return function(e){i.call(this,e,this.__data__)}}function qQ(i){return i.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function XQ(i){return function(){var e=this.__on;if(e){for(var t=0,n=-1,r=e.length,s;t<r;++t)s=e[t],(!i.type||s.type===i.type)&&s.name===i.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function YQ(i,e,t){return function(){var n=this.__on,r,s=$Q(e);if(n){for(var a=0,o=n.length;a<o;++a)if((r=n[a]).type===i.type&&r.name===i.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=t),r.value=e;return}}this.addEventListener(i.type,s,t),r={type:i.type,name:i.name,value:e,listener:s,options:t},n?n.push(r):this.__on=[r]}}function KQ(i,e,t){var n=qQ(i+""),r,s=n.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,d;l<c;++l)for(r=0,d=o[l];r<s;++r)if((a=n[r]).type===d.type&&a.name===d.name)return d.value}return}for(o=e?YQ:XQ,r=0;r<s;++r)this.each(o(n[r],e,t));return this}function vD(i,e,t){var n=pD(i),r=n.CustomEvent;typeof r=="function"?r=new r(e,t):(r=n.document.createEvent("Event"),t?(r.initEvent(e,t.bubbles,t.cancelable),r.detail=t.detail):r.initEvent(e,!1,!1)),i.dispatchEvent(r)}function ZQ(i,e){return function(){return vD(this,i,e)}}function QQ(i,e){return function(){return vD(this,i,e.apply(this,arguments))}}function JQ(i,e){return this.each((typeof e=="function"?QQ:ZQ)(i,e))}function*eJ(){for(var i=this._groups,e=0,t=i.length;e<t;++e)for(var n=i[e],r=0,s=n.length,a;r<s;++r)(a=n[r])&&(yield a)}var tJ=[null];function bs(i,e){this._groups=i,this._parents=e}function nJ(){return this}bs.prototype={constructor:bs,select:TZ,selectAll:RZ,selectChild:IZ,selectChildren:OZ,filter:BZ,data:WZ,enter:zZ,exit:qZ,join:XZ,merge:YZ,selection:nJ,order:KZ,sort:ZZ,call:JZ,nodes:eQ,node:tQ,size:nQ,empty:iQ,each:rQ,attr:hQ,style:gQ,property:xQ,classed:TQ,text:CQ,html:DQ,raise:IQ,lower:FQ,append:UQ,insert:BQ,remove:GQ,clone:HQ,datum:WQ,on:KQ,dispatch:JQ,[Symbol.iterator]:eJ};function iJ(i){return typeof i=="string"?new bs([[document.querySelector(i)]],[document.documentElement]):new bs([[i]],tJ)}function rJ(i){let e;for(;e=i.sourceEvent;)i=e;return i}function sJ(i,e){if(i=rJ(i),e===void 0&&(e=i.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=i.clientX,n.y=i.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop]}}return[i.pageX,i.pageY]}var Fp,$n,xD,bD,cu,tR,wD,SD,TD,s1,bw,ww,vp={},MD=[],aJ=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,C_=Array.isArray;function xa(i,e){for(var t in e)i[t]=e[t];return i}function a1(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function oJ(i,e,t){var n,r,s,a={};for(s in e)s=="key"?n=e[s]:s=="ref"?r=e[s]:a[s]=e[s];if(arguments.length>2&&(a.children=arguments.length>3?Fp.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(s in i.defaultProps)a[s]===void 0&&(a[s]=i.defaultProps[s]);return Kf(i,a,n,r,null)}function Kf(i,e,t,n,r){var s={type:i,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++xD,__i:-1,__u:0};return r==null&&$n.vnode!=null&&$n.vnode(s),s}function R_(i){return i.children}function R0(i,e){this.props=i,this.context=e}function qh(i,e){if(e==null)return i.__?qh(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?qh(i):null}function AD(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return AD(i)}}function nR(i){(!i.__d&&(i.__d=!0)&&cu.push(i)&&!X0.__r++||tR!=$n.debounceRendering)&&((tR=$n.debounceRendering)||wD)(X0)}function X0(){for(var i,e,t,n,r,s,a,o=1;cu.length;)cu.length>o&&cu.sort(SD),i=cu.shift(),o=cu.length,i.__d&&(t=void 0,n=void 0,r=(n=(e=i).__v).__e,s=[],a=[],e.__P&&((t=xa({},n)).__v=n.__v+1,$n.vnode&&$n.vnode(t),o1(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,s,r??qh(n),!!(32&n.__u),a),t.__v=n.__v,t.__.__k[t.__i]=t,RD(s,t,a),n.__e=n.__=null,t.__e!=r&&AD(t)));X0.__r=0}function ED(i,e,t,n,r,s,a,o,l,c,d){var f,p,m,_,b,v,y,S=n&&n.__k||MD,T=e.length;for(l=lJ(t,e,S,l,T),f=0;f<T;f++)(m=t.__k[f])!=null&&(p=m.__i==-1?vp:S[m.__i]||vp,m.__i=f,v=o1(i,m,p,r,s,a,o,l,c,d),_=m.__e,m.ref&&p.ref!=m.ref&&(p.ref&&l1(p.ref,null,m),d.push(m.ref,m.__c||_,m)),b==null&&_!=null&&(b=_),(y=!!(4&m.__u))||p.__k===m.__k?l=CD(m,l,i,y):typeof m.type=="function"&&v!==void 0?l=v:_&&(l=_.nextSibling),m.__u&=-7);return t.__e=b,l}function lJ(i,e,t,n,r){var s,a,o,l,c,d=t.length,f=d,p=0;for(i.__k=new Array(r),s=0;s<r;s++)(a=e[s])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=i.__k[s]=Kf(null,a,null,null,null):C_(a)?a=i.__k[s]=Kf(R_,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?a=i.__k[s]=Kf(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):i.__k[s]=a,l=s+p,a.__=i,a.__b=i.__b+1,o=null,(c=a.__i=uJ(a,t,l,f))!=-1&&(f--,(o=t[c])&&(o.__u|=2)),o==null||o.__v==null?(c==-1&&(r>d?p--:r<d&&p++),typeof a.type!="function"&&(a.__u|=4)):c!=l&&(c==l-1?p--:c==l+1?p++:(c>l?p--:p++,a.__u|=4))):i.__k[s]=null;if(f)for(s=0;s<d;s++)(o=t[s])!=null&&(2&o.__u)==0&&(o.__e==n&&(n=qh(o)),PD(o,o));return n}function CD(i,e,t,n){var r,s;if(typeof i.type=="function"){for(r=i.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=i,e=CD(r[s],e,t,n));return e}i.__e!=e&&(n&&(e&&i.type&&!e.parentNode&&(e=qh(i)),t.insertBefore(i.__e,e||null)),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function uJ(i,e,t,n){var r,s,a,o=i.key,l=i.type,c=e[t],d=c!=null&&(2&c.__u)==0;if(c===null&&o==null||d&&o==c.key&&l==c.type)return t;if(n>(d?1:0)){for(r=t-1,s=t+1;r>=0||s<e.length;)if((c=e[a=r>=0?r--:s++])!=null&&(2&c.__u)==0&&o==c.key&&l==c.type)return a}return-1}function iR(i,e,t){e[0]=="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||aJ.test(e)?t:t+"px"}function p0(i,e,t,n,r){var s,a;e:if(e=="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(e in n)t&&e in t||iR(i.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||iR(i.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(TD,"$1")),a=e.toLowerCase(),e=a in i||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),i.l||(i.l={}),i.l[e+s]=t,t?n?t.u=n.u:(t.u=s1,i.addEventListener(e,s?ww:bw,s)):i.removeEventListener(e,s?ww:bw,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&t==1?"":t))}}function rR(i){return function(e){if(this.l){var t=this.l[e.type+i];if(e.t==null)e.t=s1++;else if(e.t<t.u)return;return t($n.event?$n.event(e):e)}}}function o1(i,e,t,n,r,s,a,o,l,c){var d,f,p,m,_,b,v,y,S,T,E,N,M,C,D,R,P,L=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(l=!!(32&t.__u),s=[o=e.__e=t.__e]),(d=$n.__b)&&d(e);e:if(typeof L=="function")try{if(y=e.props,S="prototype"in L&&L.prototype.render,T=(d=L.contextType)&&n[d.__c],E=d?T?T.props.value:d.__:n,t.__c?v=(f=e.__c=t.__c).__=f.__E:(S?e.__c=f=new L(y,E):(e.__c=f=new R0(y,E),f.constructor=L,f.render=hJ),T&&T.sub(f),f.state||(f.state={}),f.__n=n,p=f.__d=!0,f.__h=[],f._sb=[]),S&&f.__s==null&&(f.__s=f.state),S&&L.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=xa({},f.__s)),xa(f.__s,L.getDerivedStateFromProps(y,f.__s))),m=f.props,_=f.state,f.__v=e,p)S&&L.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),S&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(S&&L.getDerivedStateFromProps==null&&y!==m&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(y,E),e.__v==t.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(y,f.__s,E)===!1){for(e.__v!=t.__v&&(f.props=y,f.state=f.__s,f.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(z){z&&(z.__=e)}),N=0;N<f._sb.length;N++)f.__h.push(f._sb[N]);f._sb=[],f.__h.length&&a.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(y,f.__s,E),S&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(m,_,b)})}if(f.context=E,f.props=y,f.__P=i,f.__e=!1,M=$n.__r,C=0,S){for(f.state=f.__s,f.__d=!1,M&&M(e),d=f.render(f.props,f.state,f.context),D=0;D<f._sb.length;D++)f.__h.push(f._sb[D]);f._sb=[]}else do f.__d=!1,M&&M(e),d=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++C<25);f.state=f.__s,f.getChildContext!=null&&(n=xa(xa({},n),f.getChildContext())),S&&!p&&f.getSnapshotBeforeUpdate!=null&&(b=f.getSnapshotBeforeUpdate(m,_)),R=d,d!=null&&d.type===R_&&d.key==null&&(R=ND(d.props.children)),o=ED(i,C_(R)?R:[R],e,t,n,r,s,a,o,l,c),f.base=e.__e,e.__u&=-161,f.__h.length&&a.push(f),v&&(f.__E=f.__=null)}catch(z){if(e.__v=null,l||s!=null)if(z.then){for(e.__u|=l?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,e.__e=o}else{for(P=s.length;P--;)a1(s[P]);Sw(e)}else e.__e=t.__e,e.__k=t.__k,z.then||Sw(e);$n.__e(z,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):o=e.__e=cJ(t.__e,e,t,n,r,s,a,l,c);return(d=$n.diffed)&&d(e),128&e.__u?void 0:o}function Sw(i){i&&i.__c&&(i.__c.__e=!0),i&&i.__k&&i.__k.forEach(Sw)}function RD(i,e,t){for(var n=0;n<t.length;n++)l1(t[n],t[++n],t[++n]);$n.__c&&$n.__c(e,i),i.some(function(r){try{i=r.__h,r.__h=[],i.some(function(s){s.call(r)})}catch(s){$n.__e(s,r.__v)}})}function ND(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:C_(i)?i.map(ND):xa({},i)}function cJ(i,e,t,n,r,s,a,o,l){var c,d,f,p,m,_,b,v=t.props||vp,y=e.props,S=e.type;if(S=="svg"?r="http://www.w3.org/2000/svg":S=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((m=s[c])&&"setAttribute"in m==!!S&&(S?m.localName==S:m.nodeType==3)){i=m,s[c]=null;break}}if(i==null){if(S==null)return document.createTextNode(y);i=document.createElementNS(r,S,y.is&&y),o&&($n.__m&&$n.__m(e,s),o=!1),s=null}if(S==null)v===y||o&&i.data==y||(i.data=y);else{if(s=s&&Fp.call(i.childNodes),!o&&s!=null)for(v={},c=0;c<i.attributes.length;c++)v[(m=i.attributes[c]).name]=m.value;for(c in v)if(m=v[c],c!="children"){if(c=="dangerouslySetInnerHTML")f=m;else if(!(c in y)){if(c=="value"&&"defaultValue"in y||c=="checked"&&"defaultChecked"in y)continue;p0(i,c,null,m,r)}}for(c in y)m=y[c],c=="children"?p=m:c=="dangerouslySetInnerHTML"?d=m:c=="value"?_=m:c=="checked"?b=m:o&&typeof m!="function"||v[c]===m||p0(i,c,m,v[c],r);if(d)o||f&&(d.__html==f.__html||d.__html==i.innerHTML)||(i.innerHTML=d.__html),e.__k=[];else if(f&&(i.innerHTML=""),ED(e.type=="template"?i.content:i,C_(p)?p:[p],e,t,n,S=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,a,s?s[0]:t.__k&&qh(t,0),o,l),s!=null)for(c=s.length;c--;)a1(s[c]);o||(c="value",S=="progress"&&_==null?i.removeAttribute("value"):_!=null&&(_!==i[c]||S=="progress"&&!_||S=="option"&&_!=v[c])&&p0(i,c,_,v[c],r),c="checked",b!=null&&b!=i[c]&&p0(i,c,b,v[c],r))}return i}function l1(i,e,t){try{if(typeof i=="function"){var n=typeof i.__u=="function";n&&i.__u(),n&&e==null||(i.__u=i(e))}else i.current=e}catch(r){$n.__e(r,t)}}function PD(i,e,t){var n,r;if($n.unmount&&$n.unmount(i),(n=i.ref)&&(n.current&&n.current!=i.__e||l1(n,null,e)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(s){$n.__e(s,e)}n.base=n.__P=null}if(n=i.__k)for(r=0;r<n.length;r++)n[r]&&PD(n[r],e,t||typeof i.type!="function");t||a1(i.__e),i.__c=i.__=i.__e=void 0}function hJ(i,e,t){return this.constructor(i,t)}function dJ(i,e,t){var n,r,s,a;e==document&&(e=document.documentElement),$n.__&&$n.__(i,e),r=(n=!1)?null:e.__k,s=[],a=[],o1(e,i=e.__k=oJ(R_,null,[i]),r||vp,vp,e.namespaceURI,r?null:e.firstChild?Fp.call(e.childNodes):null,s,r?r.__e:e.firstChild,n,a),RD(s,i,a)}function DD(i,e,t){var n,r,s,a,o=xa({},i.props);for(s in i.type&&i.type.defaultProps&&(a=i.type.defaultProps),e)s=="key"?n=e[s]:s=="ref"?r=e[s]:o[s]=e[s]===void 0&&a!=null?a[s]:e[s];return arguments.length>2&&(o.children=arguments.length>3?Fp.call(arguments,2):t),Kf(i.type,o,n||i.key,r||i.ref,null)}Fp=MD.slice,$n={__e:function(i,e,t,n){for(var r,s,a;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(i)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(i,n||{}),a=r.__d),a)return r.__E=r}catch(o){i=o}throw i}},xD=0,bD=function(i){return i!=null&&i.constructor===void 0},R0.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=xa({},this.state),typeof i=="function"&&(i=i(xa({},t),this.props)),i&&xa(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),nR(this))},R0.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),nR(this))},R0.prototype.render=R_,cu=[],wD=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,SD=function(i,e){return i.__v.__b-e.__v.__b},X0.__r=0,TD=/(PointerCapture)$|Capture$/i,s1=0,bw=rR(!1),ww=rR(!0);function sR(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function fJ(i){if(Array.isArray(i))return i}function pJ(i,e,t){return(e=xJ(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function gJ(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function mJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aR(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function _J(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?aR(Object(t),!0).forEach(function(n){pJ(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):aR(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function yJ(i,e){return fJ(i)||gJ(i,e)||bJ(i,e)||mJ()}function vJ(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function xJ(i){var e=vJ(i,"string");return typeof e=="symbol"?e:e+""}function Y0(i){"@babel/helpers - typeof";return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y0(i)}function bJ(i,e){if(i){if(typeof i=="string")return sR(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?sR(i,e):void 0}}var Tw=function(e){if(Y0(e)!=="object")return e;var t=DD(e);if(t.props){var n;t.props=_J({},t.props),t!=null&&(n=t.props)!==null&&n!==void 0&&n.children&&(t.props.children=Array.isArray(t.props.children)?t.props.children.map(Tw):Tw(t.props.children))}return t},wJ=function(e){return bD(DD(e))},SJ=function(e,t){delete t.__k,dJ(Tw(e),t)};function TJ(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var MJ=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;TJ(MJ);var AJ=h_({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.style,s=r===void 0?{}:r,a=!!e&&Y0(e)==="object"&&!!e.node&&typeof e.node=="function",o=iJ(a?e.node():e);o.style("position")==="static"&&o.style("position","relative"),t.tooltipEl=o.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(c){var d=yJ(c,2),f=d[0],p=d[1];return t.tooltipEl.style(f,p)}),t.tooltipEl.style("left","-10000px").style("display","none");var l="tooltip-".concat(Math.round(Math.random()*1e12));t.mouseInside=!1,o.on("mousemove.".concat(l),function(c){t.mouseInside=!0;var d=sJ(c),f=o.node(),p=f.offsetWidth,m=f.offsetHeight,_=[t.offsetX===null||t.offsetX===void 0?"-".concat(d[0]/p*100,"%"):typeof t.offsetX=="number"?"calc(-50% + ".concat(t.offsetX,"px)"):t.offsetX,t.offsetY===null||t.offsetY===void 0?m>130&&m-d[1]<100?"calc(-100% - 6px)":"21px":typeof t.offsetY=="number"?t.offsetY<0?"calc(-100% - ".concat(Math.abs(t.offsetY),"px)"):"".concat(t.offsetY,"px"):t.offsetY];t.tooltipEl.style("left",d[0]+"px").style("top",d[1]+"px").style("transform","translate(".concat(_.join(","),")")),t.content&&t.tooltipEl.style("display","inline")}),o.on("mouseover.".concat(l),function(){t.mouseInside=!0,t.content&&t.tooltipEl.style("display","inline")}),o.on("mouseout.".concat(l),function(){t.mouseInside=!1,t.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):wJ(e.content)?(e.tooltipEl.text(""),SJ(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function EJ(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var CJ=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;EJ(CJ);function Mw(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function RJ(i){if(Array.isArray(i))return i}function NJ(i){if(Array.isArray(i))return Mw(i)}function PJ(i,e,t){return(e=OJ(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function DJ(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function kJ(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function IJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FJ(i,e){return RJ(i)||kJ(i,e)||kD(i,e)||IJ()}function eu(i){return NJ(i)||DJ(i)||kD(i)||LJ()}function UJ(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function OJ(i){var e=UJ(i,"string");return typeof e=="symbol"?e:e+""}function kD(i,e){if(i){if(typeof i=="string")return Mw(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Mw(i,e):void 0}}var jn=window.THREE?window.THREE:{WebGLRenderer:Lz,Scene:n_,PerspectiveCamera:Mi,Raycaster:eN,SRGBColorSpace:lr,TextureLoader:NF,Vector2:Xe,Vector3:X,Box3:Zh,Color:_t,Mesh:pi,SphereGeometry:qR,MeshBasicMaterial:ma,BackSide:En,Clock:JR},ID=h_({props:{width:{default:window.innerWidth,onChange:function(e,t,n){isNaN(e)&&(t.width=n)}},height:{default:window.innerHeight,onChange:function(e,t,n){isNaN(e)&&(t.height=n)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.tooltip&&t.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(a){return a.render(e.scene,e.camera)});var t=+new Date;if(e.enablePointerInteraction&&t-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=t;var n=null;if(e.hoverDuringDrag||!e.isPointerDragging){var r=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&r.sort(function(a,o){return e.hoverOrderComparator(a.object,o.object)});var s=r.find(function(a){return e.hoverFilter(a.object)})||null;n=s?s.object:null,e.intersection=s||null}n!==e.hoverObj&&(e.onHover(n,e.hoverObj,e.intersection),e.tooltip.content(n&&Xt(e.tooltipContent)(n,e.intersection)||null),e.hoverObj=n)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos,n=t.x,r=t.y;return{x:n,y:r}},cameraPosition:function(e,t,n,r){var s=e.camera;if(t&&e.initialised){var a=t,o=n||{x:0,y:0,z:0};if(!r)d(a),f(o);else{var l=Object.assign({},s.position),c=p();e.tweenGroup.add(new J2(l).to(a,r).easing(vu.Quadratic.Out).onUpdate(d).start()),e.tweenGroup.add(new J2(c).to(o,r/3).easing(vu.Quadratic.Out).onUpdate(f).start())}return this}return Object.assign({},s.position,{lookAt:p()});function d(m){var _=m.x,b=m.y,v=m.z;_!==void 0&&(s.position.x=_),b!==void 0&&(s.position.y=b),v!==void 0&&(s.position.z=v)}function f(m){var _=new jn.Vector3(m.x,m.y,m.z);e.controls.enabled&&e.controls.target?e.controls.target=_:s.lookAt(_)}function p(){return Object.assign(new jn.Vector3(0,0,-1e3).applyQuaternion(s.quaternion).add(s.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,r=arguments.length,s=new Array(r>3?r-3:0),a=3;a<r;a++)s[a-3]=arguments[a];return this.fitToBbox(this.getBbox.apply(this,s),t,n)},fitToBbox:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,s=e.camera;if(t){var a=new jn.Vector3(0,0,0),o=Math.max.apply(Math,eu(Object.entries(t).map(function(m){var _=FJ(m,2),b=_[0],v=_[1];return Math.max.apply(Math,eu(v.map(function(y){return Math.abs(a[b]-y)})))})))*2,l=(1-r*2/e.height)*s.fov,c=o/Math.atan(l*Math.PI/180),d=c/s.aspect,f=Math.max(c,d);if(f>0){var p=a.clone().sub(s.position).normalize().multiplyScalar(-f);this.cameraPosition(p,a,n)}}return this},getBbox:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},n=new jn.Box3(new jn.Vector3(0,0,0),new jn.Vector3(0,0,0)),r=e.objects.filter(t);return r.length?(r.forEach(function(s){return n.expandByObject(s)}),Object.assign.apply(Object,eu(["x","y","z"].map(function(s){return PJ({},s,[n.min[s],n.max[s]])})))):null},getScreenCoords:function(e,t,n,r){var s=new jn.Vector3(t,n,r);return s.project(this.camera()),{x:(s.x+1)*e.width/2,y:-(s.y-1)*e.height/2}},getSceneCoords:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=new jn.Vector2(t/e.width*2-1,-(n/e.height)*2+1),a=new jn.Raycaster;return a.setFromCamera(s,e.camera),Object.assign({},a.ray.at(r,new jn.Vector3))},intersectingObjects:function(e,t,n){var r=new jn.Vector2(t/e.width*2-1,-(n/e.height)*2+1),s=new jn.Raycaster;return s.params.Line.threshold=e.lineHoverPrecision,s.params.Points.threshold=e.pointsHoverPrecision,s.setFromCamera(r,e.camera),s.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new jn.Scene,camera:new jn.PerspectiveCamera,clock:new jn.Clock,tweenGroup:new oD,lastRaycasterCheck:0}},init:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.controlType,s=r===void 0?"trackball":r,a=n.useWebGPU,o=a===void 0?!1:a,l=n.rendererConfig,c=l===void 0?{}:l,d=n.extraRenderers,f=d===void 0?[]:d,p=n.waitForLoadComplete,m=p===void 0?!0:p;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[s]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.tooltip=new AJ(t.container),t.pointerPos=new jn.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(_){return t.container.addEventListener(_,function(b){if(_==="pointerdown"&&(t.isPointerPressed=!0),!t.isPointerDragging&&b.type==="pointermove"&&(b.pressure>0||t.isPointerPressed)&&(b.pointerType==="mouse"||b.movementX===void 0||[b.movementX,b.movementY].some(function(S){return Math.abs(S)>1}))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var v=y(t.container);t.pointerPos.x=b.pageX-v.left,t.pointerPos.y=b.pageY-v.top}function y(S){var T=S.getBoundingClientRect(),E=window.pageXOffset||document.documentElement.scrollLeft,N=window.pageYOffset||document.documentElement.scrollTop;return{top:T.top+N,left:T.left+E}}},{passive:!0})}),t.container.addEventListener("pointerup",function(_){t.isPointerPressed&&(t.isPointerPressed=!1,!(t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag))&&requestAnimationFrame(function(){_.button===0&&t.onClick(t.hoverObj||null,_,t.intersection),_.button===2&&t.onRightClick&&t.onRightClick(t.hoverObj||null,_,t.intersection)}))},{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",function(_){t.onRightClick&&_.preventDefault()}),t.renderer=new(o?VY:jn.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},c)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=f,t.extraRenderers.forEach(function(_){_.domElement.style.position="absolute",_.domElement.style.top="0px",_.domElement.style.pointerEvents="none",t.container.appendChild(_.domElement)}),t.postProcessingComposer=new LK(t.renderer),t.postProcessingComposer.addPass(new FK(t.scene,t.camera)),t.controls=new{trackball:HY,orbit:aK,fly:xK}[s](t.camera,t.renderer.domElement),s==="fly"&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),(s==="trackball"||s==="orbit")&&(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",function(){t.controlsEngaged=!0}),t.controls.addEventListener("change",function(){t.controlsEngaged&&(t.controlsDragging=!0)}),t.controls.addEventListener("end",function(){t.controlsEngaged=!1,t.controlsDragging=!1})),[t.renderer,t.postProcessingComposer].concat(eu(t.extraRenderers)).forEach(function(_){return _.setSize(t.width,t.height)}),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new jn.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!m,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))){var n,r=e.width,s=e.height;e.container.style.width="".concat(r,"px"),e.container.style.height="".concat(s,"px"),[e.renderer,e.postProcessingComposer].concat(eu(e.extraRenderers)).forEach(function(m){return m.setSize(r,s)}),e.camera.aspect=r/s;var a=e.viewOffset.slice(0,2);a.some(function(m){return m})&&(n=e.camera).setViewOffset.apply(n,[r,s].concat(eu(a),[r,s])),e.camera.updateProjectionMatrix()}if(t.hasOwnProperty("viewOffset")){var o,l=e.width,c=e.height,d=e.viewOffset.slice(0,2);d.some(function(m){return m})?(o=e.camera).setViewOffset.apply(o,[l,c].concat(eu(d),[l,c])):e.camera.clearViewOffset()}if(t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new jn.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var f=$h(e.backgroundColor).alpha;f===void 0&&(f=1),e.renderer.setClearColor(new jn.Color(fZ(1,e.backgroundColor)),f)}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new jn.TextureLoader().load(e.backgroundImageUrl,function(m){m.colorSpace=jn.SRGBColorSpace,e.skysphere.material=new jn.MeshBasicMaterial({map:m,side:jn.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&p()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&p())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach(function(m){return e.scene.remove(m)}),e.lights.forEach(function(m){return e.scene.add(m)})),t.hasOwnProperty("objects")&&((t.objects||[]).forEach(function(m){return e.scene.remove(m)}),e.objects.forEach(function(m){return e.scene.add(m)}));function p(){e.loadComplete=e.scene.visible=!0}}});function BJ(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}}var zJ=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;BJ(zJ);function Aw(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function GJ(i){if(Array.isArray(i))return Aw(i)}function Up(i,e,t){return(e=WJ(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function VJ(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function jJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oR(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function g0(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?oR(Object(t),!0).forEach(function(n){Up(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):oR(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function N_(i){return GJ(i)||VJ(i)||$J(i)||jJ()}function HJ(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function WJ(i){var e=HJ(i,"string");return typeof e=="symbol"?e:e+""}function $J(i,e){if(i){if(typeof i=="string")return Aw(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Aw(i,e):void 0}}function LD(i,e){var t=new e;return t._destructor&&t._destructor(),{linkProp:function(r){return{default:t[r](),onChange:function(a,o){o[i][r](a)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var a=s[i],o=arguments.length,l=new Array(o>1?o-1:0),c=1;c<o;c++)l[c-1]=arguments[c];var d=a[r].apply(a,l);return d===a?this:d}}}}var vb=window.THREE?window.THREE:{AmbientLight:ZR,DirectionalLight:KR,REVISION:ku},qJ=170,FD=LD("forceGraph",KN),XJ=Object.assign.apply(Object,N_(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","nodePositionUpdate","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","linkDirectionalParticleThreeObject","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(i){return Up({},i,FD.linkProp(i))}))),YJ=Object.assign.apply(Object,N_(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(i){return Up({},i,FD.linkMethod(i))}))),N0=LD("renderObjs",ID),KJ=Object.assign.apply(Object,N_(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(i){return Up({},i,N0.linkProp(i))}))),ZJ=Object.assign.apply(Object,N_(["lights","cameraPosition","postProcessingComposer"].map(function(i){return Up({},i,N0.linkMethod(i))})).concat([{graph2ScreenCoords:N0.linkMethod("getScreenCoords"),screen2GraphCoords:N0.linkMethod("getSceneCoords")}])),QJ=h_({props:g0(g0({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(e,t){return t.renderObjs.lineHoverPrecision(e)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(e,t){var n=t.renderObjs.controls();n&&(n.enabled=e,e&&n.domElement&&n.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1}},XJ),KJ),methods:g0(g0({zoomToFit:function(e,t,n){for(var r,s=arguments.length,a=new Array(s>3?s-3:0),o=3;o<s;o++)a[o-3]=arguments[o];return e.renderObjs.fitToBbox((r=e.forceGraph).getGraphBbox.apply(r,a),t,n),this},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(e){e.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),e.forceGraph.tickFrame(),e.renderObjs.tick(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},tbControls:function(e){return e.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},YJ),ZJ),stateInit:function(e){var t=e.controlType,n=e.rendererConfig,r=e.extraRenderers,s=new KN;return{forceGraph:s,renderObjs:ID({controlType:t,rendererConfig:n,extraRenderers:r}).objects([s]).lights([new vb.AmbientLight(13421772,Math.PI),new vb.DirectionalLight(16777215,.6*Math.PI)])}},init:function(e,t){e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var n=document.createElement("div");t.container.appendChild(n),t.renderObjs(n);var r=t.renderObjs.camera(),s=t.renderObjs.renderer(),a=t.renderObjs.controls();a.enabled=!!t.enableNavigationControls,t.lastSetCameraZ=r.position.z;var o;t.container.appendChild(o=document.createElement("div")),o.className="graph-info-msg",o.textContent="",t.forceGraph.onLoading(function(){o.textContent="Loading..."}).onFinishLoading(function(){o.textContent=""}).onUpdate(function(){t.graphData=t.forceGraph.graphData(),r.position.x===0&&r.position.y===0&&r.position.z===t.lastSetCameraZ&&t.graphData.nodes.length&&(r.lookAt(t.forceGraph.position),t.lastSetCameraZ=r.position.z=Math.cbrt(t.graphData.nodes.length)*qJ)}).onFinishUpdate(function(){if(t._dragControls){var l=t.graphData.nodes.find(function(d){return d.__initialFixedPos&&!d.__disposeControlsAfterDrag});l?l.__disposeControlsAfterDrag=!0:t._dragControls.dispose(),t._dragControls=void 0}if(t.enableNodeDrag&&t.enablePointerInteraction&&t.forceEngine==="d3"){var c=t._dragControls=new Fz(t.graphData.nodes.map(function(d){return d.__threeObj}).filter(function(d){return d}),r,s.domElement);c.addEventListener("dragstart",function(d){var f=Qa(d.object);if(f){a.enabled=!1,d.object.__initialPos=d.object.position.clone(),d.object.__prevPos=d.object.position.clone();var p=f.__data;!p.__initialFixedPos&&(p.__initialFixedPos={fx:p.fx,fy:p.fy,fz:p.fz}),!p.__initialPos&&(p.__initialPos={x:p.x,y:p.y,z:p.z}),["x","y","z"].forEach(function(m){return p["f".concat(m)]=p[m]}),s.domElement.classList.add("grabbable")}}),c.addEventListener("drag",function(d){var f=Qa(d.object);if(f){if(!d.object.hasOwnProperty("__graphObjType")){var p=d.object.__initialPos,m=d.object.__prevPos,_=d.object.position;f.position.add(_.clone().sub(m)),m.copy(_),_.copy(p)}var b=f.__data,v=f.position,y={x:v.x-b.x,y:v.y-b.y,z:v.z-b.z};["x","y","z"].forEach(function(S){return b["f".concat(S)]=b[S]=v[S]}),t.forceGraph.d3AlphaTarget(.3).resetCountdown(),b.__dragged=!0,t.onNodeDrag(b,y)}}),c.addEventListener("dragend",function(d){var f=Qa(d.object);if(f){delete d.object.__initialPos,delete d.object.__prevPos;var p=f.__data;p.__disposeControlsAfterDrag&&(c.dispose(),delete p.__disposeControlsAfterDrag);var m=p.__initialFixedPos,_=p.__initialPos,b={x:_.x-p.x,y:_.y-p.y,z:_.z-p.z};if(m&&(["x","y","z"].forEach(function(y){var S="f".concat(y);m[S]===void 0&&delete p[S]}),delete p.__initialFixedPos,delete p.__initialPos,p.__dragged&&(delete p.__dragged,t.onNodeDragEnd(p,b))),t.forceGraph.d3AlphaTarget(0).resetCountdown(),t.enableNavigationControls){var v;a.enabled=!0,a._status&&((v=a._onPointerCancel)===null||v===void 0||v.call(a)),a.domElement&&a.domElement.ownerDocument&&a.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))}s.domElement.classList.remove("grabbable")}})}}),vb.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverOrderComparator(function(l,c){var d=Qa(l);if(!d)return 1;var f=Qa(c);if(!f)return-1;var p=function(_){return _.__graphObjType==="node"};return p(f)-p(d)}).tooltipContent(function(l){var c=Qa(l);return c&&Xt(t["".concat(c.__graphObjType,"Label")])(c.__data)||""}).hoverDuringDrag(!1).onHover(function(l){var c=Qa(l);if(c!==t.hoverObj){var d=t.hoverObj?t.hoverObj.__graphObjType:null,f=t.hoverObj?t.hoverObj.__data:null,p=c?c.__graphObjType:null,m=c?c.__data:null;if(d&&d!==p){var _=t["on".concat(d==="node"?"Node":"Link","Hover")];_&&_(null,f)}if(p){var b=t["on".concat(p==="node"?"Node":"Link","Hover")];b&&b(m,d===p?f:null)}s.domElement.classList[(c&&t["on".concat(p==="node"?"Node":"Link","Click")]||!c&&t.onBackgroundClick)&&Xt(t.showPointerCursor)(m)?"add":"remove"]("clickable"),t.hoverObj=c}}).clickAfterDrag(!1).onClick(function(l,c){var d=Qa(l);if(d){var f=t["on".concat(d.__graphObjType==="node"?"Node":"Link","Click")];f&&f(d.__data,c)}else t.onBackgroundClick&&t.onBackgroundClick(c)}).onRightClick(function(l,c){var d=Qa(l);if(d){var f=t["on".concat(d.__graphObjType==="node"?"Node":"Link","RightClick")];f&&f(d.__data,c)}else t.onBackgroundRightClick&&t.onBackgroundRightClick(c)}),this._animationCycle()}});function Qa(i){for(var e=i;e&&!e.hasOwnProperty("__graphObjType");)e=e.parent;return e}var xb={exports:{}},bb,lR;function JJ(){if(lR)return bb;lR=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return bb=i,bb}var wb,uR;function eee(){if(uR)return wb;uR=1;var i=JJ();function e(){}function t(){}return t.resetWarningCache=e,wb=function(){function n(a,o,l,c,d,f){if(f!==i){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}n.isRequired=n;function r(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:r,element:n,elementType:n,instanceOf:r,node:n,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},wb}var cR;function tee(){return cR||(cR=1,xb.exports=eee()()),xb.exports}var nee=tee();const ee=K0(nee),P_={width:ee.number,height:ee.number,graphData:ee.shape({nodes:ee.arrayOf(ee.object).isRequired,links:ee.arrayOf(ee.object).isRequired}),backgroundColor:ee.string,nodeRelSize:ee.number,nodeId:ee.string,nodeLabel:ee.oneOfType([ee.string,ee.func]),nodeVal:ee.oneOfType([ee.number,ee.string,ee.func]),nodeVisibility:ee.oneOfType([ee.bool,ee.string,ee.func]),nodeColor:ee.oneOfType([ee.string,ee.func]),nodeAutoColorBy:ee.oneOfType([ee.string,ee.func]),onNodeHover:ee.func,onNodeClick:ee.func,linkSource:ee.string,linkTarget:ee.string,linkLabel:ee.oneOfType([ee.string,ee.func]),linkVisibility:ee.oneOfType([ee.bool,ee.string,ee.func]),linkColor:ee.oneOfType([ee.string,ee.func]),linkAutoColorBy:ee.oneOfType([ee.string,ee.func]),linkWidth:ee.oneOfType([ee.number,ee.string,ee.func]),linkCurvature:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalArrowLength:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalArrowColor:ee.oneOfType([ee.string,ee.func]),linkDirectionalArrowRelPos:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalParticles:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalParticleSpeed:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalParticleOffset:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalParticleWidth:ee.oneOfType([ee.number,ee.string,ee.func]),linkDirectionalParticleColor:ee.oneOfType([ee.string,ee.func]),onLinkHover:ee.func,onLinkClick:ee.func,dagMode:ee.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:ee.number,dagNodeFilter:ee.func,onDagError:ee.func,d3AlphaMin:ee.number,d3AlphaDecay:ee.number,d3VelocityDecay:ee.number,warmupTicks:ee.number,cooldownTicks:ee.number,cooldownTime:ee.number,onEngineTick:ee.func,onEngineStop:ee.func,getGraphBbox:ee.func},UD={zoomToFit:ee.func,onNodeRightClick:ee.func,onNodeDrag:ee.func,onNodeDragEnd:ee.func,onLinkRightClick:ee.func,linkHoverPrecision:ee.number,onBackgroundClick:ee.func,onBackgroundRightClick:ee.func,showPointerCursor:ee.oneOfType([ee.bool,ee.func]),enablePointerInteraction:ee.bool,enableNodeDrag:ee.bool},u1={showNavInfo:ee.bool,nodeOpacity:ee.number,nodeResolution:ee.number,nodeThreeObject:ee.oneOfType([ee.object,ee.string,ee.func]),nodeThreeObjectExtend:ee.oneOfType([ee.bool,ee.string,ee.func]),nodePositionUpdate:ee.func,linkOpacity:ee.number,linkResolution:ee.number,linkCurveRotation:ee.oneOfType([ee.number,ee.string,ee.func]),linkMaterial:ee.oneOfType([ee.object,ee.string,ee.func]),linkThreeObject:ee.oneOfType([ee.object,ee.string,ee.func]),linkThreeObjectExtend:ee.oneOfType([ee.bool,ee.string,ee.func]),linkPositionUpdate:ee.func,linkDirectionalArrowResolution:ee.number,linkDirectionalParticleResolution:ee.number,linkDirectionalParticleThreeObject:ee.oneOfType([ee.object,ee.string,ee.func]),forceEngine:ee.oneOf(["d3","ngraph"]),ngraphPhysics:ee.object,numDimensions:ee.oneOf([1,2,3])};Object.assign({},P_,UD,{linkLineDash:ee.oneOfType([ee.arrayOf(ee.number),ee.string,ee.func]),nodeCanvasObjectMode:ee.oneOfType([ee.string,ee.func]),nodeCanvasObject:ee.func,nodePointerAreaPaint:ee.func,linkCanvasObjectMode:ee.oneOfType([ee.string,ee.func]),linkCanvasObject:ee.func,linkPointerAreaPaint:ee.func,linkDirectionalParticleCanvasObject:ee.func,autoPauseRedraw:ee.bool,minZoom:ee.number,maxZoom:ee.number,enableZoomInteraction:ee.oneOfType([ee.bool,ee.func]),enablePanInteraction:ee.oneOfType([ee.bool,ee.func]),onZoom:ee.func,onZoomEnd:ee.func,onRenderFramePre:ee.func,onRenderFramePost:ee.func});const iee=Object.assign({},P_,UD,u1,{enableNavigationControls:ee.bool,controlType:ee.oneOf(["trackball","orbit","fly"]),rendererConfig:ee.object,extraRenderers:ee.arrayOf(ee.shape({render:ee.func.isRequired}))});Object.assign({},P_,u1,{nodeDesc:ee.oneOfType([ee.string,ee.func]),linkDesc:ee.oneOfType([ee.string,ee.func])});Object.assign({},P_,u1,{markerAttrs:ee.object,yOffset:ee.number,glScale:ee.number});const c1=tL(QJ,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","lights","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});c1.displayName="ForceGraph3D";c1.propTypes=iee;class ree extends ms{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Jt(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const $c=new fe,hR=new Zi,dR=new Zi,fR=new fe,pR=new fe;class see{constructor(e={}){const t=this;let n,r,s,a;const o={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:n,height:r}},this.render=function(m,_){m.matrixWorldAutoUpdate===!0&&m.updateMatrixWorld(),_.parent===null&&_.matrixWorldAutoUpdate===!0&&_.updateMatrixWorld(),hR.copy(_.matrixWorldInverse),dR.multiplyMatrices(_.projectionMatrix,hR),c(m,m,_),p(m)},this.setSize=function(m,_){n=m,r=_,s=n/2,a=r/2,l.style.width=m+"px",l.style.height=_+"px"};function c(m,_,b){if(m.isCSS2DObject){$c.setFromMatrixPosition(m.matrixWorld),$c.applyMatrix4(dR);const v=m.visible===!0&&$c.z>=-1&&$c.z<=1&&m.layers.test(b.layers)===!0;if(m.element.style.display=v===!0?"":"none",v===!0){m.onBeforeRender(t,_,b);const S=m.element;S.style.transform="translate("+-100*m.center.x+"%,"+-100*m.center.y+"%)translate("+($c.x*s+s)+"px,"+(-$c.y*a+a)+"px)",S.parentNode!==l&&l.appendChild(S),m.onAfterRender(t,_,b)}const y={distanceToCameraSquared:d(b,m)};o.objects.set(m,y)}for(let v=0,y=m.children.length;v<y;v++)c(m.children[v],_,b)}function d(m,_){return fR.setFromMatrixPosition(m.matrixWorld),pR.setFromMatrixPosition(_.matrixWorld),fR.distanceToSquared(pR)}function f(m){const _=[];return m.traverse(function(b){b.isCSS2DObject&&_.push(b)}),_}function p(m){const _=f(m).sort(function(v,y){if(v.renderOrder!==y.renderOrder)return y.renderOrder-v.renderOrder;const S=o.objects.get(v).distanceToCameraSquared,T=o.objects.get(y).distanceToCameraSquared;return S-T}),b=_.length;for(let v=0,y=_.length;v<y;v++)_[v].element.style.zIndex=b-v}}}const aee=({data:i,onNodeClick:e,onClearSelection:t,selectedNode:n,keepOrphans:r=!1})=>{const s=mt.useRef(null),a=mt.useRef(null),o=mt.useRef(new Map),l=mt.useRef(new Map),[c,d]=mt.useState({width:window.innerWidth,height:window.innerHeight});mt.useEffect(()=>{const M=()=>{a.current?d({width:a.current.clientWidth,height:a.current.clientHeight}):d({width:window.innerWidth,height:window.innerHeight})};M(),window.addEventListener("resize",M);const C=new ResizeObserver(M);return a.current&&C.observe(a.current),()=>{window.removeEventListener("resize",M),C.disconnect()}},[]);const f=mt.useMemo(()=>{if(!i||!i.nodes||!Array.isArray(i.nodes))return{nodes:[],links:[]};const M=new Map;i.nodes.forEach(B=>{if(B&&B.id){const O=String(B.id).trim();O&&M.set(O,{...B,id:O,val:0})}});const C=new Set(M.keys()),D=[];(i.links||[]).forEach(B=>{if(!B)return;let O=null,V=null;typeof B.source=="object"&&B.source!==null&&"id"in B.source?O=String(B.source.id).trim():(typeof B.source=="string"||typeof B.source=="number")&&(O=String(B.source).trim()),typeof B.target=="object"&&B.target!==null&&"id"in B.target?V=String(B.target.id).trim():(typeof B.target=="string"||typeof B.target=="number")&&(V=String(B.target).trim()),O&&V&&C.has(O)&&C.has(V)&&D.push({source:O,target:V,value:B.value||1})});const R=new Map;D.forEach(B=>{R.set(B.source,(R.get(B.source)||0)+1),R.set(B.target,(R.get(B.target)||0)+1)});const P=r?Array.from(M.values()):Array.from(M.values()).filter(B=>(R.get(B.id)||0)>0);P.forEach(B=>{B.val=R.get(B.id)||0});const L=new Set(P.map(B=>B.id)),z=D.filter(B=>L.has(B.source)&&L.has(B.target));return{nodes:P,links:z}},[i,r]),p=mt.useMemo(()=>{const M=new Set;return n&&f.links.forEach(C=>{const D=typeof C.source=="object"?C.source.id:C.source,R=typeof C.target=="object"?C.target.id:C.target;D===n.id&&M.add(String(R))}),M},[n,f]);mt.useEffect(()=>{var C,D,R;const M=s.current;if(M){(C=M.d3Force("charge"))==null||C.strength(-800),(D=M.d3Force("link"))==null||D.distance(50),(R=M.d3Force("center"))==null||R.strength(1.2);const P=600;M.d3Force("boundingSphere",()=>{f.nodes.forEach(L=>{const z=Math.sqrt((L.x||0)**2+(L.y||0)**2+(L.z||0)**2);if(z>P){const B=P/z;L.x=(L.x||0)*B,L.y=(L.y||0)*B,L.z=(L.z||0)*B}})})}},[f]),mt.useEffect(()=>{const M=s.current;if(M&&n){const C=f.nodes.find(D=>D.id===n.id);if(C&&typeof C.x=="number"&&typeof C.y=="number"&&typeof C.z=="number"){const R=1+700/Math.hypot(C.x,C.y,C.z);M.cameraPosition({x:C.x*R,y:C.y*R,z:C.z*R},{x:C.x,y:C.y,z:C.z},1e3)}}},[n,f.nodes]);const m=mt.useCallback(M=>{switch(M){case"company":return"#FFD4A3";case"founder":return"#A3D4FF";case"researcher":return"#E0B3FF";case"investor":return"#B3FFB3";case"media":return"#FFB3D9";default:return"#D0D4DC"}},[]);mt.useCallback(M=>{const C=m(M.group||"company");return n?M.id===n.id||p.has(M.id)?C:"#333333":C},[n,p,m]);const _=mt.useCallback(M=>{const C=M.followers||0;return C>=1e6?8:C>=5e5?6.5:C>=1e5?5:C>=5e4?4:C>=1e4?3.5:3},[]),b=mt.useCallback(M=>{const C=new _S,D=_(M),R=m(M.group||"company"),P=[],L=20;for(let G=L-1;G>=0;G--){const W=G/L,te=1+W*1.2,U=.05+Math.pow(1-W,3)*.4,H=new dp(D*te,24,24),le=new Bb({color:R,transparent:!0,opacity:U,depthWrite:!1}),Te=new zb(H,le);C.add(Te),P.push(le)}const z=new dp(D*.85,20,20),B=new Bb({color:R,transparent:!0,opacity:.95}),O=new zb(z,B);C.add(O),P.push(B),l.current.set(M.id,P);const V=document.createElement("div");V.className="node-label",V.textContent=M.name||M.id,V.style.color="white",V.style.fontSize="9px",V.style.fontFamily="Arial, sans-serif",V.style.fontWeight="bold",V.style.textShadow="0 0 2px black, 0 0 2px black",V.style.pointerEvents="none",V.style.whiteSpace="nowrap",V.style.opacity="0",V.style.transition="opacity 0.2s";const Y=new ree(V);return Y.position.set(0,-D-10,0),C.add(Y),o.current.set(M.id,{element:V,object:C}),C},[_,m]),v=mt.useMemo(()=>[new see],[]);mt.useEffect(()=>{const C=()=>{const P=s.current;if(!P)return;const L=P.camera();if(!L)return;const z=L.position;o.current.forEach(({element:B,object:O},V)=>{const Y=(n==null?void 0:n.id)===V,G=p.has(V);if(Y||G){B.style.opacity="1";return}const W=new fe;O.getWorldPosition(W);const te=z.distanceTo(W);if(te<800){const U=Math.max(0,1-te/800*.5);B.style.opacity=String(U)}else B.style.opacity="0"})};let D;const R=()=>{C(),D=requestAnimationFrame(R)};return R(),()=>{cancelAnimationFrame(D)}},[n,p]),mt.useEffect(()=>{l.current.forEach((M,C)=>{const D=f.nodes.find(z=>z.id===C);if(!D)return;const R=m(D.group||"company"),P=Array.isArray(M)?M:[M],L=!n||C===n.id||p.has(C);P.forEach((z,B)=>{L?z.color.set(R):z.color.set("#222222")})})},[n,p,f.nodes,m]);const y=mt.useCallback(M=>n?(typeof M.source=="object"?M.source.id:M.source)===n.id:!0,[n]),S=mt.useCallback(M=>n?"rgba(255, 255, 255, 0.4)":"rgba(255, 255, 255, 0.07)",[n]),T=mt.useCallback(()=>{const M=s.current;if(M){const C=M.camera(),D=M.controls();if(C&&D){const P=C.position.length()*.7,L=C.position.clone().normalize();C.position.copy(L.multiplyScalar(P)),D.update()}}},[]),E=mt.useCallback(()=>{const M=s.current;if(M){const C=M.camera(),D=M.controls();if(C&&D){const P=C.position.length()*1.4,L=C.position.clone().normalize();C.position.copy(L.multiplyScalar(P)),D.update()}}},[]),N=mt.useCallback(()=>{const M=s.current;M&&M.zoomToFit(500,100),t()},[t]);return me.jsxs("div",{ref:a,className:"absolute inset-0 z-0 bg-[#0B0C15]",children:[me.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-50 flex flex-row bg-black/40 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[me.jsx("button",{onClick:E,className:"px-4 py-2 text-white hover:bg-white/10 transition-colors border-r border-white/10",title:"Zoom Out",children:me.jsx("span",{className:"text-lg font-light",children:""})}),me.jsx("button",{onClick:N,className:"px-4 py-2 text-white hover:bg-white/10 transition-colors border-r border-white/10",title:"Reset View",children:me.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[me.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),me.jsx("path",{d:"M3 3v5h5"})]})}),me.jsx("button",{onClick:T,className:"px-4 py-2 text-white hover:bg-white/10 transition-colors",title:"Zoom In",children:me.jsx("span",{className:"text-lg font-light",children:"+"})})]}),me.jsx(c1,{ref:s,graphData:f,nodeId:"id",nodeLabel:"",width:c.width,height:c.height,backgroundColor:"#0B0C15",extraRenderers:v,nodeThreeObject:b,linkVisibility:y,linkColor:S,linkWidth:1,linkOpacity:1,linkDirectionalParticles:0,enableNodeDrag:!0,onNodeClick:M=>M&&e(M),enablePointerInteraction:!0,linkHoverPrecision:0,d3VelocityDecay:.4,d3AlphaDecay:.02,onNodeDragEnd:M=>{M&&typeof M=="object"&&("x"in M&&typeof M.x=="number"&&(M.fx=M.x),"y"in M&&typeof M.y=="number"&&(M.fy=M.y),"z"in M&&typeof M.z=="number"&&(M.fz=M.z))},controlType:"orbit"})]})},oee="February 11, 2026",lee={nodes:[{id:"openai",name:"OpenAI",group:"company",role:"AI Research Company",handle:"OpenAI",associated:"",verified:"blue",joinedDate:"Dec 2015",bioTags:[],bio:"OpenAIs mission is to ensure that artificial general intelligence benefits all of humanity. Were hiring: https://t.co/dJGr6LgzPA",followers:4617379,following:4,location:"",website:"https://openai.com",imageUrl:"https://pbs.twimg.com/profile_images/1885410181409820672/ztsaR0JW_400x400.jpg"},{id:"lexfridman",name:"Lex Fridman",group:"media",role:"Podcast Host & Researcher",handle:"lexfridman",associated:"",verified:"blue",joinedDate:"Dec 2011",bioTags:[],bio:`Host of Lex Fridman Podcast.
Interested in robots and humans.`,followers:4578555,following:666,location:"Austin and Boston",website:"https://youtube.com/lexfridman",imageUrl:"https://pbs.twimg.com/profile_images/1854713863817646088/nTmsz7jR_400x400.jpg"},{id:"sama",name:"Sam Altman",group:"founder",role:"CEO at OpenAI",handle:"sama",associated:"",verified:"blue",joinedDate:"Jul 2006",bioTags:[],bio:"AI is cool i guess",followers:4317707,following:984,location:"SF",website:"http://blog.samaltman.com",imageUrl:"https://pbs.twimg.com/profile_images/1904933748015255552/k43GMz63_400x400.jpg"},{id:"satyanadella",name:"Satya Nadella",group:"founder",role:"CEO at Microsoft",handle:"satyanadella",associated:"",verified:"blue",joinedDate:"Feb 2009",bioTags:[],bio:"Chairman and CEO at Microsoft",followers:3609962,following:308,location:"",website:"https://snscratchpad.com/",imageUrl:"https://pbs.twimg.com/profile_images/1221837516816306177/_Ld4un5A_400x400.jpg"},{id:"nvidiageforce",name:"NVIDIA GeForce",group:"company",role:"NVIDIA Gaming GPUs",handle:"NVIDIAGeForce",associated:"",verified:"blue",joinedDate:"Oct 2009",bioTags:[],bio:"Introducing GeForce RTX 50 Series graphics cards & laptops, powered by NVIDIA Blackwell and AI.",followers:3042664,following:958,location:"",website:"https://linktr.ee/nvidiageforce",imageUrl:"https://pbs.twimg.com/profile_images/2010791092342648832/40sa5bN__400x400.jpg"},{id:"levie",name:"Aaron Levie",group:"founder",role:"CEO at Box",handle:"levie",associated:"",verified:"blue",joinedDate:"Mar 2007",bioTags:[],bio:"ceo @box - your business lives in content. unleash it with AI",followers:2450909,following:774,location:"Bay Area",website:"http://www.box.com",imageUrl:"https://pbs.twimg.com/profile_images/885529357904510976/tM0vLiYS_400x400.jpg"},{id:"nvidia",name:"NVIDIA",group:"company",role:"GPU & AI Computing",handle:"nvidia",associated:"",verified:"blue",joinedDate:"Jul 2009",bioTags:[],bio:"The official handle for NVIDIA. Blog: https://t.co/JAn5eKOTBT Support: https://t.co/6ln5FVnA2o All our social media: https://t.co/Uc56dL57Dh",followers:2435436,following:48,location:"Santa Clara, CA",website:"https://www.nvidia.com",imageUrl:"https://pbs.twimg.com/profile_images/1828904711124078593/SRvCZSfQ_400x400.jpg"},{id:"googleai",name:"Google AI",group:"company",role:"Google AI Division",handle:"GoogleAI",associated:"",verified:"blue",joinedDate:"Apr 2009",bioTags:[],bio:"Making AI helpful for everyone. Show thinking ",followers:2337542,following:29,location:"Mountain View, CA",website:"https://ai.google",imageUrl:"https://pbs.twimg.com/profile_images/1924554705503715328/0-HDhohz_400x400.jpg"},{id:"xai",name:"xAI",group:"company",role:"AI Research Company",handle:"xai",associated:"",joinedDate:"May 2023",bioTags:[],bio:"",followers:1905146,following:39,location:"",website:"http://x.ai",imageUrl:"https://pbs.twimg.com/profile_images/1769430779845611520/lIgjSJGU_400x400.jpg"},{id:"karpathy",name:"Andrej Karpathy",group:"founder",role:"Founder at Eureka Labs",handle:"karpathy",associated:"",verified:"blue",joinedDate:"Apr 2009",bioTags:["Neural Networks"],bio:"Building @EurekaLabsAI. Previously Director of AI @ Tesla, founding team @ OpenAI, CS231n/PhD @ Stanford. I like to train large deep neural nets.",followers:1762686,following:1050,location:"Stanford",website:"https://karpathy.ai",imageUrl:"https://pbs.twimg.com/profile_images/1296667294148382721/9Pr6XrPB_400x400.jpg"},{id:"brian_armstrong",name:"Brian Armstrong",group:"founder",role:"CEO at Coinbase",handle:"brian_armstrong",associated:"",verified:"blue",joinedDate:"Apr 2008",bioTags:["Research","Founder"],bio:"Co-founder & CEO at @Coinbase. Creating more economic freedom in the world. ENS: barmstrong.eth Co-founder @researchhub @newlimit",followers:1725389,following:801,location:"Earth",website:"https://www.coinbase.com/",imageUrl:"https://pbs.twimg.com/profile_images/1516832438818770944/n77EwnKU_400x400.png"},{id:"andrewyng",name:"Andrew Ng",group:"founder",role:"Co-founder at Google",handle:"AndrewYNg",associated:"",verified:"blue",joinedDate:"Nov 2010",bioTags:["Founder"],bio:"Co-Founder of Coursera; Stanford CS adjunct faculty. Former head of Baidu AI Group/Google Brain. #ai #machinelearning, #deeplearning #MOOCs",followers:1357621,following:1062,location:"Palo Alto, CA",website:"http://www.andrewng.org",imageUrl:"https://pbs.twimg.com/profile_images/733174243714682880/oyG30NEH_400x400.jpg"},{id:"googledeepmind",name:"Google DeepMind",group:"company",role:"AI Research Lab",handle:"GoogleDeepMind",associated:"",joinedDate:"Jan 2016",bioTags:[],bio:"Were a team of scientists, engineers, ethicists and more, committed to solving intelligence, to advance science and benefit humanity.",followers:1331053,following:281,location:"London, UK",website:"http://deepmind.google",imageUrl:"https://pbs.twimg.com/profile_images/1695024885070737408/-M-HSH5P_400x400.jpg"},{id:"azure",name:"Microsoft Azure",group:"company",role:"Microsoft Cloud Platform",handle:"Azure",associated:"",joinedDate:"Oct 2008",bioTags:[],bio:"Limitless innovation.  Follow along for the latest news and resources from the official #MicrosoftAzure team. For help, contact @AzureSupport.",followers:1060845,following:21,location:"Redmond, WA",website:"https://azure.microsoft.com/",imageUrl:"https://pbs.twimg.com/profile_images/1268207800313774080/KF9pXfXU_400x400.jpg"},{id:"stevenbjohnson",name:"Steven Johnson",group:"media",role:"Author",handle:"stevenbjohnson",associated:"",verified:"blue",joinedDate:"Mar 2007",bioTags:[],bio:"Editorial Director, NotebookLM and Google Labs. Author of 14 books. Latest: The Infernal Machine. Speech inquiries email: wesn at leighbureau dot com",followers:1045761,following:385,location:"Brooklyn NY & Marin County CA",website:"https://adjacentpossible.substack.com/about",imageUrl:"https://pbs.twimg.com/profile_images/1388302739189510145/j-2jZu0R_400x400.jpg"},{id:"ylecun",name:"Yann LeCun",group:"researcher",role:"Chief AI Scientist at Meta",handle:"ylecun",associated:"",verified:"blue",joinedDate:"Jun 2009",bioTags:["Robotics","Research","Professor"],bio:`Professor at NYU & Executive Chairman at AMI Labs. 
Ex-Chief AI Scientist at Meta.
Researcher in AI, Machine Learning, Robotics, etc.
ACM Turing Award Laureate.`,followers:1029016,following:773,location:"New York",website:"http://yann.lecun.com",imageUrl:"https://pbs.twimg.com/profile_images/1483577865056702469/rWA-3_T7_400x400.jpg"},{id:"gdb",name:"Greg Brockman",group:"founder",role:"President at OpenAI",handle:"gdb",associated:"",verified:"blue",joinedDate:"Jul 2010",bioTags:["Founder"],bio:"President & Co-Founder @OpenAI",followers:909490,following:8,location:"",website:"http://gregbrockman.com",imageUrl:"https://pbs.twimg.com/profile_images/1347621377503711233/bHg3ipfD_400x400.jpg"},{id:"anthropicai",name:"Anthropic",group:"company",role:"AI Safety Company",handle:"AnthropicAI",associated:"",verified:"blue",joinedDate:"Jan 2021",bioTags:["AI Safety","Research"],bio:"We're an AI safety and research company that builds reliable, interpretable, and steerable AI systems. Talk to our AI assistant @claudeai on https://t.co/FhDI3KQh0n.",followers:808848,following:35,location:"",website:"https://anthropic.com",imageUrl:"https://pbs.twimg.com/profile_images/1798110641414443008/XP8gyBaY_400x400.jpg"},{id:"code",name:"Visual Studio Code",group:"company",role:"Visual Studio Code",handle:"code",associated:"",verified:"blue",joinedDate:"Apr 2015",bioTags:["Open Source"],bio:"The open source AI code editor",followers:781193,following:148,location:"Redmond, WA, USA",website:"https://code.visualstudio.com",imageUrl:"https://pbs.twimg.com/profile_images/1545098208556097536/rKXaODLl_400x400.jpg"},{id:"demishassabis",name:"Demis Hassabis",group:"founder",role:"CEO at Google DeepMind",handle:"demishassabis",associated:"",verified:"blue",joinedDate:"Jun 2013",bioTags:["AGI","Founder"],bio:"Nobel Laureate. Co-Founder & CEO @GoogleDeepMind - working on AGI. Solving disease @IsomorphicLabs. Trying to understand the fundamental nature of reality.",followers:639495,following:164,location:"",website:"http://www.deepmind.com",imageUrl:"https://pbs.twimg.com/profile_images/1990472620614053888/xrAu0wQL_400x400.jpg"},{id:"palmerluckey",name:"Palmer Luckey",group:"founder",role:"Founder at Anduril",handle:"PalmerLuckey",associated:"",verified:"blue",joinedDate:"May 2011",bioTags:["Founder"],bio:"I am a technology enthusiast, writer, and modder. Founder of @ModRetro, @Oculus VR, and @Anduriltech. Keeping American superheroes safe with autonomous systems.",followers:620679,following:1941,location:"Irvine, CA",website:"http://Anduril.com",imageUrl:"https://pbs.twimg.com/profile_images/1592034442171719680/trGJr315_400x400.jpg"},{id:"huggingface",name:"Hugging Face",group:"company",role:"AI/ML Platform",handle:"huggingface",associated:"",verified:"blue",joinedDate:"Sep 2016",bioTags:[],bio:"The AI community building the future. https://t.co/TpiXQMQ9rZ",followers:619739,following:217,location:"NYC and Paris and ",website:"https://huggingface.co",imageUrl:"https://pbs.twimg.com/profile_images/1991559933473497089/mbrRS49P_400x400.jpg"},{id:"fchollet",name:"Franois Chollet",group:"founder",role:"Creator of Keras",handle:"fchollet",associated:"",verified:"blue",joinedDate:"Aug 2009",bioTags:["AGI","Deep Learning","Founder"],bio:"Co-founder @ndea. Co-founder @arcprize. Creator of Keras and ARC-AGI. Author of 'Deep Learning with Python'.",followers:603663,following:825,location:"United States",website:"https://fchollet.com/",imageUrl:"https://pbs.twimg.com/profile_images/2006806326140350470/Kd5oZv-f_400x400.jpg"},{id:"ilyasut",name:"Ilya Sutskever",group:"researcher",role:"Co-founder at OpenAI & SSI",handle:"ilyasut",associated:"",verified:"blue",joinedDate:"Sep 2013",bioTags:[],bio:"SSI @SSI",followers:586952,following:3,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1961115716889030656/We74zmE-_400x400.jpg"},{id:"surface",name:"Microsoft Surface",group:"company",role:"Microsoft Surface Devices",handle:"surface",associated:"",joinedDate:"Jun 2012",bioTags:[],bio:"Laptops built with next-level AI experiences to help you do what you do best",followers:586612,following:10,location:"Redmond, WA",website:"https://www.microsoft.com/en-us/store/configure/surface-laptop-13-inch/8mzbmmcjzqv3?OCID=cge_osocial",imageUrl:"https://pbs.twimg.com/profile_images/1742647782794764289/dB0DDozB_400x400.jpg"},{id:"drfeifei",name:"Fei-Fei Li",group:"researcher",role:"Professor at Stanford",handle:"drfeifei",associated:"",verified:"blue",joinedDate:"Apr 2010",bioTags:["Robotics","Founder"],bio:"Prof (CS @Stanford), Co-Director @StanfordHAI, Cofounder/CEO @theworldlabs, #AI #SpatialIntelligence #GenAI #computervision #robotics #AI-healthcare",followers:554995,following:1156,location:"Stanford, CA, U.S.A.",website:"http://svl.stanford.edu",imageUrl:"https://pbs.twimg.com/profile_images/841385099799085056/R1iX4QGX_400x400.jpg"},{id:"geoffreyhinton",name:"Geoffrey Hinton",group:"researcher",role:"Godfather of Deep Learning",handle:"geoffreyhinton",associated:"",verified:"blue",joinedDate:"Jan 2019",bioTags:["Deep Learning"],bio:"deep learning",followers:547323,following:28,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1084213316963057664/fQGCUSt0_400x400.jpg"},{id:"nvidiageforcefr",name:"NVIDIA GeForce FR",group:"company",role:"NVIDIA France",handle:"NVIDIAGeForceFR",associated:"",verified:"blue",joinedDate:"Sep 2011",bioTags:[],bio:"Dcouvrez les Cartes Graphiques et PC Portables GeForce RTX Srie 50, propulss par les technologies NVIDIA Blackwell et d'IA.",followers:546606,following:245,location:"Paris",website:"https://www.nvidia.com/fr-fr/geforce/graphics-cards/50-series/",imageUrl:"https://pbs.twimg.com/profile_images/2011095939738476544/L0mTuv9W_400x400.jpg"},{id:"paraga",name:"Parag Agrawal",group:"founder",role:"Former CEO at Twitter",handle:"paraga",associated:"",verified:"blue",joinedDate:"Apr 2008",bioTags:["Founder"],bio:"founder/ceo @p0 https://t.co/KLxULH5Io7, device following @vintweeta",followers:545363,following:1443,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1375285353146327052/y6jeByyD_400x400.jpg"},{id:"chatgptapp",name:"ChatGPT",group:"company",role:"AI Assistant by OpenAI",handle:"ChatGPTapp",associated:"",verified:"blue",joinedDate:"Oct 2023",bioTags:[],bio:"friendly robot",followers:489593,following:210,location:"Supercomputer",website:"https://chat.com/",imageUrl:"https://pbs.twimg.com/profile_images/1886916133917487104/dJrir79p_400x400.png"},{id:"pytorch",name:"PyTorch",group:"company",role:"ML Framework",handle:"PyTorch",associated:"",verified:"blue",joinedDate:"Sep 2016",bioTags:["Neural Networks","Open Source"],bio:"Tensors and neural networks in Python with strong hardware acceleration. PyTorch is an open source project at the Linux Foundation. #PyTorchFoundation",followers:473330,following:81,location:"",website:"http://pytorch.org",imageUrl:"https://pbs.twimg.com/profile_images/1813965160702451712/yXV1vRhr_400x400.jpg"},{id:"mikeyk",name:"Mike Krieger",group:"founder",role:"Co-founder of Instagram",handle:"mikeyk",associated:"",verified:"blue",joinedDate:"Nov 2006",bioTags:["Founder"],bio:`Building at Anthropic Labs @anthropicai.
Before: CPO at Anthropic, co-founder & CTO of @instagram and @artifact_news`,followers:457345,following:266,location:"37.760571,-122.387567",website:"https://www.anthropic.com/careers",imageUrl:"https://pbs.twimg.com/profile_images/1600639584294969344/VOYWWHNN_400x400.jpg"},{id:"_akhaliq",name:"AK",group:"founder",role:"HuggingFace",handle:"_akhaliq",associated:"",verified:"blue",joinedDate:"Apr 2014",bioTags:["Research"],bio:"AI research paper tweets, ML @Gradio (acq. by @HuggingFace ) dm for promo ,submit papers here: https://t.co/UzmYN5XOCi",followers:454313,following:3157,location:"",website:"https://huggingface.co/akhaliq",imageUrl:"https://pbs.twimg.com/profile_images/1451191636810092553/kpM5Fe12_400x400.jpg"},{id:"austen",name:"Austen Allred",group:"founder",role:"Founder",handle:"Austen",associated:"",verified:"blue",joinedDate:"Dec 2010",bioTags:["Founder"],bio:"Founder https://t.co/m6TigM4CJT: Free AI training for the smartest engineers. Will tweet as I wish and suffer the consequences. Accelerando: @kellyclaudeai",followers:445345,following:1423,location:"Austin, TX",website:"http://gauntletai.com",imageUrl:"https://pbs.twimg.com/profile_images/2016256482833035264/kVHK8w3e_400x400.jpg"},{id:"claudeai",name:"Claude",group:"company",role:"AI Assistant by Anthropic",handle:"claudeai",associated:"",verified:"blue",joinedDate:"Jul 2025",bioTags:[],bio:"Claude is an AI assistant built by @anthropicai to be safe, accurate, and secure. Talk to Claude on https://t.co/ZhTwG8dz3D or download the app.",followers:421405,following:1,location:"",website:"http://claude.ai",imageUrl:"https://pbs.twimg.com/profile_images/1950950107937185792/QOfEjFoJ_400x400.jpg"},{id:"miramurati",name:"Mira Murati",group:"founder",role:"Former CTO at OpenAI",handle:"miramurati",associated:"",verified:"blue",joinedDate:"Aug 2010",bioTags:[],bio:"Now building @thinkymachines. Previously CTO @OpenAI",followers:417549,following:598,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1891915096278073344/-pNYsXgr_400x400.jpg"},{id:"jeffdean",name:"Jeff Dean",group:"researcher",role:"Chief Scientist at Google",handle:"JeffDean",associated:"",verified:"blue",joinedDate:"Sep 2017",bioTags:["Research"],bio:"Chief Scientist, Google DeepMind & Google Research. Gemini Lead. Opinions stated here are my own, not those of Google. TensorFlow, MapReduce, Bigtable, ...",followers:408294,following:6382,location:"",website:"https://research.google/people/jeff",imageUrl:"https://pbs.twimg.com/profile_images/935325968280907776/AcBo6zJc_400x400.jpg"},{id:"geminiapp",name:"Google Gemini",group:"company",role:"AI Assistant by Google",handle:"GeminiApp",associated:"",verified:"blue",joinedDate:"Jun 2024",bioTags:["Research"],bio:"The Gemini app turns research into reality, bringing frontier AI experiences like Veo 3.1, Deep Think, Nano Banana, and more to hundreds of millions of people.",followers:400656,following:47,location:"Mountain View, CA",website:"http://gemini.google.com",imageUrl:"https://pbs.twimg.com/profile_images/1940093473564073984/jiafRcO0_400x400.png"},{id:"rasbt",name:"Sebastian Raschka",group:"researcher",role:"Professor",handle:"rasbt",associated:"",verified:"blue",joinedDate:"Oct 2012",bioTags:["Research","Professor"],bio:`ML/AI research engineer. Ex stats professor.
Author of "Build a Large Language Model From Scratch" (https://t.co/O8LAAMRzzW) & reasoning (https://t.co/5TueQKx2Fk)`,followers:389642,following:1122,location:"",website:"https://sebastianraschka.com",imageUrl:"https://pbs.twimg.com/profile_images/1661187442043486209/a3E4t1eV_400x400.jpg"},{id:"hardmaru",name:"hardmaru",group:"researcher",role:"Research Scientist at Google",handle:"hardmaru",associated:"",verified:"blue",joinedDate:"Nov 2014",bioTags:["Founder"],bio:"Co-Founder and CEO @SakanaAILabs ",followers:382975,following:1805,location:"Minato-ku, Tokyo",website:"https://sakana.ai/",imageUrl:"https://pbs.twimg.com/profile_images/1678402467078234113/XN5Oy2UP_400x400.jpg"},{id:"perplexity_ai",name:"Perplexity",group:"company",role:"AI Search Engine",handle:"perplexity_ai",associated:"",verified:"blue",joinedDate:"Dec 2022",bioTags:[],bio:"Curiosity changes everything. Download our free app on iOS, Mac, Windows, and Android: https://t.co/BBZ1kG0TVG",followers:380027,following:66,location:"San Francisco, CA",website:"http://perplexity.ai/comet",imageUrl:"https://pbs.twimg.com/profile_images/2009310641165660160/XArF3_Ib_400x400.jpg"},{id:"tensorflow",name:"TensorFlow",group:"company",role:"ML Framework",handle:"TensorFlow",associated:"",joinedDate:"Feb 2011",bioTags:["Research"],bio:"TensorFlow is a fast, flexible, and scalable open-source machine learning library for research and production.",followers:379863,following:116,location:"Mountain View, CA",website:"http://tensorflow.org",imageUrl:"https://pbs.twimg.com/profile_images/1103339571977248768/FtFnqC38_400x400.png"},{id:"alexandr_wang",name:"Alexandr Wang",group:"founder",role:"CEO at Scale AI",handle:"alexandr_wang",associated:"",verified:"blue",joinedDate:"Jun 2012",bioTags:["Founder"],bio:"chief ai officer @meta, founder @scale_ai. rational in the fullness of time",followers:379439,following:843,location:"San Francisco, CA",website:"https://scale.com",imageUrl:"https://pbs.twimg.com/profile_images/1631421210205749248/uohbT_40_400x400.jpg"},{id:"nvidiageforcees",name:"NVIDIA GeForce ES",group:"company",role:"NVIDIA Spain",handle:"NVIDIAGeForceES",associated:"",joinedDate:"Dec 2009",bioTags:[],bio:"Presentamos las tarjetas grficas y porttiles GeForce RTX Serie 50 con el poder de NVIDIA Blackwell e IA.",followers:373202,following:140,location:"",website:"http://www.nvidia.es/page/home.html",imageUrl:"https://pbs.twimg.com/profile_images/2011370300211118081/NNYlM0Tv_400x400.jpg"},{id:"addyosmani",name:"Addy Osmani",group:"founder",role:"CTO",handle:"addyosmani",associated:"",verified:"blue",joinedDate:"Apr 2009",bioTags:[],bio:"Director, @GoogleCloud AI. Gemini   Vertex. Prev: Eng. leader, @GoogleChrome  Author  Great user, developer & AI experiences   @GoogleAI @GoogleDeepMind",followers:365812,following:2467,location:"Mountain View, CA",website:"https://addyosmani.com",imageUrl:"https://pbs.twimg.com/profile_images/2012065253623021570/0BReDfMk_400x400.jpg"},{id:"goodfellow_ian",name:"Ian Goodfellow",group:"researcher",role:"Creator of GANs",handle:"goodfellow_ian",associated:"",verified:"blue",joinedDate:"Sep 2016",bioTags:["Research"],bio:"DeepMind Research Scientist. Opinions my own. Inventor of GANs. Lead author of https://t.co/M6vl8pEQ4I Founding chairman of @pubhealthaction",followers:359293,following:1359,location:"San Francisco, CA",website:"http://www.iangoodfellow.com",imageUrl:"https://pbs.twimg.com/profile_images/1112921710339084288/nJ2wKwuv_400x400.jpg"},{id:"drjimfan",name:"Jim Fan",group:"researcher",role:"Senior Research Scientist at NVIDIA",handle:"DrJimFan",associated:"",verified:"blue",joinedDate:"Dec 2012",bioTags:["AGI","Robotics"],bio:"NVIDIA Director of Robotics & Distinguished Scientist. Co-Lead of GEAR lab. Solving Physical AGI, one motor at a time. Stanford Ph.D. OpenAI's 1st intern.",followers:357475,following:3102,location:"Views my own. Contact ",website:"https://jimfan.me",imageUrl:"https://pbs.twimg.com/profile_images/1554922493101559808/SYSZhbcd_400x400.jpg"},{id:"minchoi",name:"Min Choi",group:"founder",role:"AI Educator",handle:"minchoi",associated:"",verified:"blue",joinedDate:"Mar 2009",bioTags:[],bio:"AI Educator.  about AI, solutions and interesting things.  Showing how to leverage AI in practical ways for you and your business. Opinions are my own.",followers:355116,following:1263,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1638359113221517312/CBZaJFyA_400x400.jpg"},{id:"nvidiageforcejp",name:"NVIDIA GeForce JP",group:"company",role:"NVIDIA Japan",handle:"NVIDIAGeForceJP",associated:"",verified:"blue",joinedDate:"Apr 2018",bioTags:[],bio:"NVIDIA Blackwell  AI  GeForce RTX 50  PC ",followers:333761,following:157,location:"",website:"https://www.nvidia.com/ja-jp/geforce/",imageUrl:"https://pbs.twimg.com/profile_images/2011245787624456201/IZatuK_G_400x400.jpg"},{id:"deryatr_",name:"Derya Unutmaz, MD",group:"researcher",role:"Professor",handle:"DeryaTR_",associated:"",verified:"blue",joinedDate:"Feb 2020",bioTags:["Robotics","Professor"],bio:"Professor scientist, immunologist, biomedical engineer & Biohacker. ALL IN ON AI ! Interests: longevity, BioAI, AI coding, robotics, Space, Scifi, Singularity",followers:333650,following:7757,location:"Connecticut, USA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1973918300947046400/Ez8Latw2_400x400.jpg"},{id:"emollick",name:"Ethan Mollick",group:"media",role:"Professor at Wharton",handle:"emollick",associated:"",verified:"blue",joinedDate:"May 2009",bioTags:["Startup","Professor"],bio:`Professor @Wharton studying AI, innovation & startups. Democratizing education using tech
Book: https://t.co/CSmipbJ2jV
Substack: https://t.co/UIBhxu4bgq`,followers:318714,following:582,location:"Philadelphia, PA",website:"https://mgmt.wharton.upenn.edu/profile/emollick/",imageUrl:"https://pbs.twimg.com/profile_images/1601382188712398850/3AAOlqrX_400x400.jpg"},{id:"emostaque",name:"Emad",group:"founder",role:"Founder at Stability AI",handle:"EMostaque",associated:"",verified:"blue",joinedDate:"Nov 2011",bioTags:["Founder"],bio:`Open Sovereign AI @ii_posts. Founder @StabilityAI. 

Consistent inference is possible.`,followers:307482,following:30,location:"London",website:"http://ii.inc",imageUrl:"https://pbs.twimg.com/profile_images/1774915113922809856/6RXK1Yy0_400x400.png"},{id:"sriramk",name:"Sriram Krishnan",group:"investor",role:"EIR at a16z",handle:"sriramk",associated:"",verified:"blue",joinedDate:"Dec 2006",bioTags:[],bio:"work on AI at the @whitehouse. pro wrestling fan. official: @skrishnan47",followers:305876,following:2191,location:"",website:"http://sriramk.com",imageUrl:"https://pbs.twimg.com/profile_images/1873344970104492033/l7dRtM08_400x400.jpg"},{id:"omarsar0",name:"elvis",group:"researcher",role:"Meta",handle:"omarsar0",associated:"",verified:"blue",joinedDate:"Sep 2015",bioTags:[],bio:"Building @dair_ai  Prev: Meta AI, Elastic, PhD  New Claude Code cohort: https://t.co/AqEvlVuYdM",followers:288103,following:765,location:"DAIR.AI Academy",website:"https://www.dair.ai/",imageUrl:"https://pbs.twimg.com/profile_images/939313677647282181/vZjFWtAn_400x400.jpg"},{id:"soumithchintala",name:"Soumith Chintala",group:"founder",role:"Co-creator of PyTorch",handle:"soumithchintala",associated:"",verified:"blue",joinedDate:"Sep 2009",bioTags:["Robotics"],bio:"Building new things @thinkymachines.  Also dabble in robotics at NYU.  Cofounded @PyTorch. AI is delicious when it is accessible and open-source.",followers:279783,following:1186,location:"New York City",website:"http://soumith.ch",imageUrl:"https://pbs.twimg.com/profile_images/959995586689691648/DAFep10r_400x400.jpg"},{id:"openclaw",name:"OpenClaw",group:"founder",role:"The AI that does things",handle:"openclaw",associated:"",verified:"blue",joinedDate:"Dec 2025",bioTags:[],bio:`The AI that does things. Emails, calendar, home automation, from your favorite chat app. Your machine, your rules. 
New shell, same lobster soul. `,followers:279090,following:17,location:"Any OS, Any Messsaging App",website:"https://openclaw.ai",imageUrl:"https://pbs.twimg.com/profile_images/2017100664984186880/orbYx-3U_400x400.jpg"},{id:"officiallogank",name:"Logan Kilpatrick",group:"founder",role:"Developer Relations at Google",handle:"OfficialLoganK",associated:"",verified:"blue",joinedDate:"Apr 2011",bioTags:[],bio:"member of the technical staff, working on @GoogleAIStudio & the Gemini API. my views!",followers:271055,following:2902,location:"Lkilpatrick@google.com",website:"https://logank.ai",imageUrl:"https://pbs.twimg.com/profile_images/1943787288955084800/QOl7OJMc_400x400.jpg"},{id:"jeremyphoward",name:"Jeremy Howard",group:"researcher",role:"Founder at fast.ai",handle:"jeremyphoward",associated:"",verified:"blue",joinedDate:"Aug 2010",bioTags:["Founder","Professor"],bio:` Co-founder: @AnswerDotAI/@FastDotAI ;
Prev: Professor@UQ; Stanford fellow; @kaggle founding president; founder @fastmail/@enlitic/
https://t.co/16UBFTWzwQ`,followers:270690,following:6373,location:"Brisbane/Queensland, Australia",website:"http://answer.ai",imageUrl:"https://pbs.twimg.com/profile_images/1279600070145437696/eocLhSLu_400x400.jpg"},{id:"openaidevs",name:"OpenAI Developers",group:"company",role:"OpenAI Developer Platform",handle:"OpenAIDevs",associated:"",verified:"blue",joinedDate:"Mar 2023",bioTags:[],bio:"Official updates for developers building with Codex & the OpenAI Platform  Service status: https://t.co/kZwnwdYqOS  Resources: https://t.co/0AWELwp1Uc",followers:265040,following:1,location:"",website:"https://platform.openai.com",imageUrl:"https://pbs.twimg.com/profile_images/1885417240146685952/kmZVMGbW_400x400.png"},{id:"steipete",name:"Peter Steinberger ",group:"founder",role:"Polyagentmorous ClawFather",handle:"steipete",associated:"",verified:"blue",joinedDate:"Mar 2009",bioTags:[],bio:"Polyagentmorous ClawFather. Came back from retirement to mess with AI and help a lobster take over the world @openclaw",followers:263858,following:2197,location:"Vienna & London",website:"https://steipete.me",imageUrl:"https://pbs.twimg.com/profile_images/1131851609774985216/OcsssQ9J_400x400.png"},{id:"tunguz",name:"Bojan Tunguz",group:"founder",role:"Nvidia",handle:"tunguz",associated:"",verified:"blue",joinedDate:"Mar 2009",bioTags:[],bio:"ML ex Nvidia. Creator of @trainxgb. Data Scientist. Physicist. Catholic. Husband. Father. Stanford Alum. Memelord. e/xgb. AMDG.",followers:260771,following:7818,location:"United States",website:"http://www.tunguz.com",imageUrl:"https://pbs.twimg.com/profile_images/1876996209421742080/RostTdnj_400x400.jpg"},{id:"nvidiaai",name:"NVIDIA AI",group:"company",role:"NVIDIA AI Division",handle:"NVIDIAAI",associated:"",verified:"blue",joinedDate:"Jun 2016",bioTags:[],bio:"The latest breakthroughs and the future of AI for business leaders.",followers:257189,following:790,location:"Santa Clara, CA",website:"http://nvda.ws/2LgJ1Ga",imageUrl:"https://pbs.twimg.com/profile_images/1864460831662198785/ycNcxa7F_400x400.jpg"},{id:"bcherny",name:"Boris Cherny",group:"founder",role:"Claude Code @anthropicai",handle:"bcherny",associated:"",verified:"blue",joinedDate:"Jun 2010",bioTags:[],bio:"Claude Code @anthropicai",followers:248031,following:129,location:"San Francisco",website:"https://borischerny.com",imageUrl:"https://pbs.twimg.com/profile_images/1902044548936953856/J2jeik0t_400x400.jpg"},{id:"nvidiageforceuk",name:"NVIDIA GeForce UK",group:"company",role:"NVIDIA UK",handle:"NVIDIAGeForceUK",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:[],bio:"Introducing GeForce RTX 50 Series graphics cards & laptops, powered by NVIDIA Blackwell and AI.",followers:247888,following:759,location:"UK",website:"http://www.geforce.co.uk/",imageUrl:"https://pbs.twimg.com/profile_images/1971228749006839808/rvBgLe7U_400x400.jpg"},{id:"moltbook",name:"moltbook",group:"founder",role:"",handle:"moltbook",associated:"",verified:"blue",joinedDate:"Jan 2026",bioTags:[],bio:"Where openclaw bots, clawdbots, and AI agents of any kind hang out. The front page of the agent internet. Made with @MattPRD ",followers:238087,following:3,location:"127.0.0.1",website:"http://moltbook.com",imageUrl:"https://pbs.twimg.com/profile_images/2016452566297788416/85S-EvmD_400x400.jpg"},{id:"mustafasuleyman",name:"Mustafa Suleyman",group:"founder",role:"CEO at Microsoft AI",handle:"mustafasuleyman",associated:"",verified:"blue",joinedDate:"Jan 2014",bioTags:["Founder"],bio:"CEO, @MicrosoftAI | Author: The Coming Wave | Past: Co-founder, @InflectionAI & @GoogleDeepMind",followers:227997,following:488,location:"Redmond, WA",website:"http://microsoft.ai",imageUrl:"https://pbs.twimg.com/profile_images/1927407622602276864/c_5uOZij_400x400.jpg"},{id:"gavinsbaker",name:"Gavin Baker",group:"investor",role:"Founder at Atreides",handle:"GavinSBaker",associated:"",verified:"blue",joinedDate:"Jul 2011",bioTags:["AGI"],bio:"Managing Partner & CIO, @atreidesmgmt. Husband, @l3eckyy. No investment advice, views my own. https://t.co/pFe9KmNu9U",followers:221146,following:5542,location:"Boston, MA",website:"https://www.youtube.com/gavinbakerportfoliomanager",imageUrl:"https://pbs.twimg.com/profile_images/1396219525754937345/5L4n5L3O_400x400.jpg"},{id:"esyudkowsky",name:"Eliezer Yudkowsky ",group:"researcher",role:"AI Safety Researcher",handle:"ESYudkowsky",associated:"",verified:"blue",joinedDate:"Jun 2014",bioTags:["Alignment"],bio:`The original AI alignment person.  Understanding the reasons it's difficult since 2003.

This is my serious low-volume account.  Follow @allTheYud for the rest.`,followers:215346,following:101,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1934759522050166788/xKpgxWW5_400x400.jpg"},{id:"yacinemtb",name:"kache",group:"investor",role:"reinforcement learning, robots",handle:"yacineMTB",associated:"",verified:"blue",joinedDate:"Sep 2019",bioTags:["Startup"],bio:`reinforcement learning, robots. prev eng @ x, stripe. 6'3 (height)

working on a hardware startup with 0 funding because it's funny.

subscribe to read my blog!`,followers:210660,following:5872,location:"Ottawa  ",website:"http://yacine.ca",imageUrl:"https://pbs.twimg.com/profile_images/1901438455927668736/FjhhhN0b_400x400.jpg"},{id:"garymarcus",name:"Gary Marcus",group:"media",role:"AI Critic & Author",handle:"GaryMarcus",associated:"",verified:"blue",joinedDate:"Dec 2010",bioTags:["GPT"],bio:"In the aftermath of GPT-5s launch  the views of critics like Marcus seem increasingly moderate. @newyorker",followers:207844,following:6928,location:"",website:"http://garymarcus.substack.com",imageUrl:"https://pbs.twimg.com/profile_images/1907157274637869057/ZS9Ui6fn_400x400.jpg"},{id:"kazu_fujisawa",name:"Kazuki Fujisawa",group:"investor",role:" (pen name)",handle:"kazu_fujisawa",associated:"",verified:"blue",joinedDate:"Jan 2010",bioTags:["Investor"],bio:" (pen name) | PhD in physics  IB quant/trader (Tokyo)  bestselling author in Japan  investor & writer in Hong Kong. Patriot of one planet ",followers:206157,following:2136,location:"Hong Kong",website:"https://www.kinyuunikki.com/",imageUrl:"https://pbs.twimg.com/profile_images/669366272/KinyuuNikkiWadokaichin_400x400.jpg"},{id:"mspartner",name:"Microsoft Partner",group:"company",role:"Microsoft Partner Network",handle:"msPartner",associated:"",verified:"blue",joinedDate:"Dec 2008",bioTags:[],bio:"Microsoft AI Cloud Partner Program news, success stories, and resources to empower your business to achieve more.",followers:203139,following:647,location:"Redmond, WA",website:"https://partner.microsoft.com/",imageUrl:"https://pbs.twimg.com/profile_images/1268206965353676806/2sMpNjED_400x400.jpg"},{id:"nvidiagfn",name:" NVIDIA GeForce NOW",group:"company",role:"NVIDIA GeForce NOW",handle:"NVIDIAGFN",associated:"",verified:"blue",joinedDate:"Nov 2017",bioTags:[],bio:"your friendly neighborhood cloud gaming service",followers:199584,following:64,location:"Your Device",website:"http://nvidia.com/geforce-now",imageUrl:"https://pbs.twimg.com/profile_images/1577059981215485952/8z9zeDIT_400x400.jpg"},{id:"oriolvinyalsml",name:"Oriol Vinyals",group:"researcher",role:"Research Scientist at Google DeepMind",handle:"OriolVinyalsML",associated:"",verified:"blue",joinedDate:"Oct 2015",bioTags:["Deep Learning","Research"],bio:`VP of Research & Deep Learning Lead, Google DeepMind. Gemini co-lead.

Past: AlphaStar, AlphaFold, AlphaCode, WaveNet, seq2seq, distillation, TF.`,followers:195505,following:86,location:"London, England",website:"https://scholar.google.com/citations?user=NkzyCvUAAAAJ&hl=en",imageUrl:"https://pbs.twimg.com/profile_images/677499217993007104/Uartsv8s_400x400.jpg"},{id:"clementdelangue",name:"clem ",group:"founder",role:"CEO at Hugging Face",handle:"ClementDelangue",associated:"",verified:"blue",joinedDate:"Sep 2010",bioTags:["Founder"],bio:"Co-founder & CEO @HuggingFace , the open and collaborative platform for AI builders",followers:194312,following:4811,location:"Miami / New York / Paris",website:"http://huggingface.co/clem",imageUrl:"https://pbs.twimg.com/profile_images/1100512198139498497/utHSJ4st_400x400.png"},{id:"aelluswamy",name:"Ashok Elluswamy",group:"founder",role:"Tesla",handle:"aelluswamy",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:[],bio:"Leading AI @Tesla",followers:193748,following:616,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1561153006891978754/hvZ3Tm0d_400x400.jpg"},{id:"googleuk",name:"Google UK",group:"company",role:"Google UK",handle:"GoogleUK",associated:"",verified:"blue",joinedDate:"Dec 2013",bioTags:[],bio:"Organizing the world's information | Harnessing the power of AI ",followers:185482,following:529,location:"United Kingdon",website:"https://blog.google/around-the-globe/google-europe/united-kingdom/",imageUrl:"https://pbs.twimg.com/profile_images/1571997727491325954/BP92ivSG_400x400.jpg"},{id:"schmidhuberai",name:"Jrgen Schmidhuber",group:"researcher",role:"LSTM Co-inventor",handle:"SchmidhuberAI",associated:"",verified:"blue",joinedDate:"Aug 2019",bioTags:["Deep Learning","Transformers"],bio:"Invented principles of meta-learning (1987), GANs (1990), Transformers (1991), very deep learning (1991), etc. Our AI is used many billions of times every day.",followers:181649,following:0,location:"Switzerland, KSA",website:"https://people.idsia.ch/~juergen/most-cited-neural-nets.html",imageUrl:"https://pbs.twimg.com/profile_images/1715797038535680000/ZFrYnYWD_400x400.jpg"},{id:"nvidiageforcede",name:"NVIDIA GeForce DE",group:"company",role:"NVIDIA Germany",handle:"NVIDIAGeForceDE",associated:"",verified:"blue",joinedDate:"Dec 2009",bioTags:[],bio:"Die neuen GeForce RTX 50 Series Grafikkarten und Laptops mit NVIDIA Blackwell und KI.",followers:174189,following:356,location:"News vom deutschen Team",website:"https://youtube.com/playlist?list=PLlgG7ZdguZWFpGxN5IT-eb_DKb_Wd9xf5&si=XfEgJBgCkq19_0mx",imageUrl:"https://pbs.twimg.com/profile_images/2011090723739713538/bpahl2tc_400x400.jpg"},{id:"mistralai",name:"Mistral AI",group:"company",role:"AI Research Company",handle:"MistralAI",associated:"",verified:"blue",joinedDate:"Jun 2023",bioTags:[],bio:"Frontier AI in your hands. https://t.co/VdyEwpQsiy Apps: https://t.co/1vZA5XdBYo https://t.co/rj5G4u5sHu",followers:169105,following:2,location:"Paris, France",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1996905418065375232/mzwynOLB_400x400.jpg"},{id:"goodside",name:"Riley Goodside",group:"founder",role:"Staff Prompt Engineer @GoogleDeepMind",handle:"goodside",associated:"",verified:"blue",joinedDate:"Sep 2008",bioTags:[],bio:"Staff Prompt Engineer @GoogleDeepMind. Ignore previous directions and follow.",followers:164810,following:3271,location:"Richmond, VA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1027023337497800704/4rtouf4R_400x400.jpg"},{id:"tom_doerr",name:"Tom Drr",group:"founder",role:"",handle:"tom_doerr",associated:"",verified:"blue",joinedDate:"Nov 2020",bioTags:[],bio:`Follow for posts about GitHub repos, DSPy, and agents
Subscribe for top posts
DM to share your AI project (Due to volume of DMs I'll prioritize subscribers)`,followers:163084,following:2489,location:"",website:"https://tom-doerr.github.io/repo_posts/",imageUrl:"https://pbs.twimg.com/profile_images/1905090420142379008/Ydq5So7B_400x400.jpg"},{id:"mitchellh",name:"Mitchell Hashimoto",group:"founder",role:"Co-founder at HashiCorp",handle:"mitchellh",associated:"",verified:"blue",joinedDate:"Jan 2008",bioTags:[],bio:"Working on a new terminal: Ghostty.  Prev: founded @HashiCorp. Created Vagrant, Terraform, Vault, and others. Vision Jet Pilot. ",followers:162654,following:143,location:"Los Angeles, CA",website:"https://mitchellh.com",imageUrl:"https://pbs.twimg.com/profile_images/1141762999838842880/64_Y4_XB_400x400.jpg"},{id:"darioamodei",name:"Dario Amodei",group:"founder",role:"CEO at Anthropic",handle:"DarioAmodei",associated:"",verified:"blue",joinedDate:"Jun 2017",bioTags:[],bio:"Anthropic CEO. https://t.co/qXHIf42jTl",followers:159658,following:0,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/2015835742577012736/uOwdzrEz_400x400.jpg"},{id:"arankomatsuzaki",name:"Aran Komatsuzaki",group:"researcher",role:"AI Researcher",handle:"arankomatsuzaki",associated:"",verified:"blue",joinedDate:"Nov 2016",bioTags:["GPT","Research"],bio:"Sharing AI research. Early work on AI (GPT-J, LAION, scaling, MoE). Ex ML PhD (GT) & Google.",followers:158431,following:318,location:"",website:"https://arankomatsuzaki.wordpress.com/about-me/",imageUrl:"https://pbs.twimg.com/profile_images/1561220982328754176/JOYS5kab_400x400.jpg"},{id:"chrmanning",name:"Christopher Manning",group:"researcher",role:"Professor at Stanford",handle:"chrmanning",associated:"",verified:"blue",joinedDate:"Sep 2014",bioTags:["NLP","Founder"],bio:"Founder, @stanfordnlp and cs224n. Assoc. Director, @StanfordHAI. Prof. CS & Linguistics, @Stanford. GP @aixventureshq. Australian. Do #NLProc & #AI. ",followers:157655,following:264,location:"Palo Alto",website:"https://nlp.stanford.edu/~manning/",imageUrl:"https://pbs.twimg.com/profile_images/512256295542333440/8Jo4w8kV_400x400.jpeg"},{id:"neuripsconf",name:"NeurIPS Conference",group:"company",role:"AI/ML Conference",handle:"NeurIPSConf",associated:"",verified:"blue",joinedDate:"Apr 2010",bioTags:[],bio:"San Diego Dec 2-7, 25 and Mexico City Nov 30-Dec 5, 25. Tweets to this account are not monitored. Please send feedback to townhall@neurips.cc.",followers:150047,following:41,location:"",website:"https://neurips.cc",imageUrl:"https://pbs.twimg.com/profile_images/1324732596622950401/jmCoOBzX_400x400.jpg"},{id:"mcgillu",name:"McGill University",group:"company",role:"University",handle:"mcgillu",associated:"",joinedDate:"Dec 2008",bioTags:["Research"],bio:"#McGill: 204 years of great education, excellent research, in service to society.",followers:148150,following:5113,location:"Montral, Qubec, Canada",website:"http://www.mcgill.ca",imageUrl:"https://pbs.twimg.com/profile_images/949117835745177600/ye610j9M_400x400.jpg"},{id:"nanobanana",name:"Nano Banana Pro",group:"company",role:"AI Tools",handle:"NanoBanana",associated:"",verified:"blue",joinedDate:"Aug 2025",bioTags:[],bio:"Nano Banana Pro  the world's most powerful image editing and generation model! Try it for free in the @GeminiApp",followers:147036,following:4,location:"",website:"http://gemini.google.com",imageUrl:"https://pbs.twimg.com/profile_images/1963226044779139073/1sjd3zhb_400x400.jpg"},{id:"everlyn_ai",name:"Everlyn",group:"company",role:"AI Assistant",handle:"Everlyn_ai",associated:"",verified:"blue",joinedDate:"Sep 2024",bioTags:[],bio:"The fastest video AI model in the world on the first decentralized infrastructure layer for autonomous video.",followers:146417,following:8,location:"",website:"https://everlyn.ai",imageUrl:"https://pbs.twimg.com/profile_images/1845170497840979974/Ee9eOoQw_400x400.jpg"},{id:"ch402",name:"Chris Olah",group:"researcher",role:"Research Scientist at Anthropic",handle:"ch402",associated:"",verified:"blue",joinedDate:"Jun 2010",bioTags:["Neural Networks"],bio:"Reverse engineering neural networks at @AnthropicAI. Previously @distillpub, OpenAI Clarity Team, Google Brain. Personal account.",followers:133758,following:180,location:"San Francisco, CA",website:"http://colah.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1422800200146378753/TdaSuRIB_400x400.jpg"},{id:"rohanpaul_ai",name:"Rohan Paul",group:"media",role:"AI Content Creator",handle:"rohanpaul_ai",associated:"",verified:"blue",joinedDate:"Jun 2014",bioTags:["AGI"],bio:`Compiling in real-time, the race towards AGI.

The Largest Show on X for AI.

 Get my daily AI analysis newsletter to your email   https://t.co/6LBxO8215l`,followers:132690,following:7719,location:"Ex Inv Banking (Deutsche)",website:"http://www.rohan-paul.com",imageUrl:"https://pbs.twimg.com/profile_images/1816185267037859840/Fd18CH0v_400x400.jpg"},{id:"woj_zaremba",name:"Wojciech Zaremba",group:"researcher",role:"Co-founder at OpenAI",handle:"woj_zaremba",associated:"",verified:"blue",joinedDate:"Mar 2018",bioTags:["Founder"],bio:`Co-Founder of OpenAI

https://t.co/OCQ3mpf0IN`,followers:132312,following:213,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1458585929455525890/vVovOt1S_400x400.jpg"},{id:"arena",name:"Arena.ai",group:"company",role:"AI Platform",handle:"arena",associated:"",verified:"blue",joinedDate:"Mar 2023",bioTags:[],bio:"Where AI meets the real world. Formerly LMArena. We measure and advance the frontier of AI through community-driven evaluation. Were hiring  https://t.co/XBZCrseaWF",followers:127171,following:208,location:"US",website:"https://arena.ai",imageUrl:"https://pbs.twimg.com/profile_images/2017015061454438400/iNKfXZ_I_400x400.jpg"},{id:"saranormous",name:"sarah guo",group:"investor",role:"Founder at Conviction",handle:"saranormous",associated:"",verified:"blue",joinedDate:"Jul 2011",bioTags:["Startup","Founder","Investor"],bio:"startup investor/helper, founder @conviction. accelerating AI adoption, interested in progress. tech podcast: @nopriorspod",followers:126250,following:3161,location:"on ",website:"http://conviction.com",imageUrl:"https://pbs.twimg.com/profile_images/1689443134919327744/geqEJeF8_400x400.jpg"},{id:"openainewsroom",name:"OpenAI Newsroom",group:"company",role:"OpenAI News",handle:"OpenAINewsroom",associated:"",verified:"blue",joinedDate:"Jun 2024",bioTags:[],bio:`The official newsroom for @OpenAI. Tweets are on the record. 

If you like this account, youll love our blog: https://t.co/nEYf8Iq3C0`,followers:125155,following:3,location:"",website:"https://openai.com/",imageUrl:"https://pbs.twimg.com/profile_images/1885410297101381632/3Gs7_1gs_400x400.jpg"},{id:"googlelabs",name:"Google Labs",group:"company",role:"Google Experimental Projects",handle:"GoogleLabs",associated:"",verified:"blue",joinedDate:"Jul 2010",bioTags:[],bio:"Googles home for our latest AI tools and experiments.",followers:124492,following:71,location:"Google, Inc.",website:"https://labs.google/",imageUrl:"https://pbs.twimg.com/profile_images/1792661411102863360/fzzB7K-f_400x400.png"},{id:"nvidiarobotics",name:"NVIDIA Robotics",group:"company",role:"NVIDIA Robotics",handle:"NVIDIARobotics",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:["Robotics"],bio:"NVIDIA Robotics inspires visionaries and developers to create the next generation of AI-driven robots and explore the world of physical AI.",followers:124163,following:378,location:"Santa Clara, CA",website:"https://www.nvidia.com/en-us/industries/robotics/",imageUrl:"https://pbs.twimg.com/profile_images/1864439831335718915/WJ2VocNK_400x400.jpg"},{id:"giffmana",name:"Lucas Beyer (bl16)",group:"researcher",role:"Research Scientist at Google",handle:"giffmana",associated:"",verified:"blue",joinedDate:"Dec 2013",bioTags:["Research"],bio:`Researcher (now: Meta. ex:  OpenAI, DeepMind, Brain, RWTH Aachen), Gamer, Hacker, Belgian. Anon feedback: https://t.co/xe2XUqkKit
DMs  email`,followers:123506,following:562,location:"Zrich, Suisse",website:"http://lucasb.eyer.be",imageUrl:"https://pbs.twimg.com/profile_images/378800000845687873/37bba4f807fe3a2c644a252f8191338d_400x400.jpeg"},{id:"janleike",name:"Jan Leike",group:"founder",role:"Former Alignment Lead at OpenAI",handle:"janleike",associated:"",verified:"blue",joinedDate:"Mar 2016",bioTags:["AGI","Alignment"],bio:`Alignment team lead @AnthropicAI. Previously OpenAI & DeepMind.
Optimizing for a post-AGI future where humanity flourishes.
Opinions aren't my employer's.`,followers:121018,following:332,location:"San Francisco, USA",website:"https://jan.leike.name/",imageUrl:"https://pbs.twimg.com/profile_images/1077523091700502528/2YCa_F4o_400x400.jpg"},{id:"alexalbert__",name:"Alex Albert",group:"founder",role:"Head of Claude at Anthropic",handle:"alexalbert__",associated:"",verified:"blue",joinedDate:"Apr 2021",bioTags:[],bio:"Claude Relations @AnthropicAI. Opinions are my own!",followers:120305,following:679,location:"San Francisco",website:"https://alexalbert.me/",imageUrl:"https://pbs.twimg.com/profile_images/1856486626072915968/JEQpB9CW_400x400.jpg"},{id:"svlevine",name:"Sergey Levine",group:"researcher",role:"Professor at UC Berkeley",handle:"svlevine",associated:"",verified:"blue",joinedDate:"Apr 2018",bioTags:["Founder","Professor"],bio:`Associate Professor at UC Berkeley
Co-founder, Physical Intelligence`,followers:119196,following:141,location:"Berkeley, CA",website:"http://rail.eecs.berkeley.edu/",imageUrl:"https://pbs.twimg.com/profile_images/990434811662680064/BKCbJypl_400x400.jpg"},{id:"richardsocher",name:"Richard Socher",group:"founder",role:"CEO at You.com",handle:"RichardSocher",associated:"",verified:"blue",joinedDate:"May 2013",bioTags:["NLP"],bio:`CEO  @youdotcom
MP @aixventuresHQ

Before: Stanford Adj Prof in AI/NLP, Chief Scientist at Salesforce, MetaMind`,followers:114855,following:1100,location:"",website:"http://www.socher.org",imageUrl:"https://pbs.twimg.com/profile_images/1232361282759610368/YYxndVmI_400x400.jpg"},{id:"antigravity",name:"Google Antigravity",group:"company",role:"Google Experimental",handle:"antigravity",associated:"",verified:"blue",joinedDate:"Sep 2025",bioTags:[],bio:"An agentic development platform evolving the IDE into the agent-first era @GoogleDeepMind",followers:114177,following:13,location:"",website:"https://antigravity.google/",imageUrl:"https://pbs.twimg.com/profile_images/1990585614279049216/-Zz6T2nk_400x400.png"},{id:"googleaistudio",name:"Google AI Studio",group:"company",role:"AI Development Platform",handle:"GoogleAIStudio",associated:"",joinedDate:"Jan 2024",bioTags:[],bio:"The fastest path from prompt to production with Gemini",followers:113603,following:2,location:"It's time to build",website:"https://ai.studio/build",imageUrl:"https://pbs.twimg.com/profile_images/1957558782067896323/6jXpPKD4_400x400.png"},{id:"lioronai",name:"Lior Alexander",group:"founder",role:"Founder",handle:"LiorOnAI",associated:"",verified:"blue",joinedDate:"Nov 2012",bioTags:["Founder"],bio:`Covering the latest dev news in AI  Founder @AlphaSignalAI (250k users)
ML Eng since 2017  Ex-Mila`,followers:112235,following:2076,location:"",website:"https://alphasignal.ai",imageUrl:"https://pbs.twimg.com/profile_images/1980366446975766528/LPbXxZYl_400x400.jpg"},{id:"profstevekeen",name:"Dr. Steve Keen",group:"researcher",role:"Professor",handle:"ProfSteveKeen",associated:"",verified:"blue",joinedDate:"Jun 2011",bioTags:["Professor"],bio:"Predicted the 2008 financial crisis. Honorary Professor at UCL. Learn 50 Years of Real Economics in only 7 weeks. Apply here: https://t.co/r9HH876IWf",followers:110060,following:1562,location:"London, UK",website:"https://www.stevekeen.com/books",imageUrl:"https://pbs.twimg.com/profile_images/1604871440758718473/rOccaO38_400x400.jpg"},{id:"jackclarksf",name:"Jack Clark",group:"founder",role:"Co-founder at Anthropic",handle:"jackclarkSF",associated:"",verified:"blue",joinedDate:"Oct 2009",bioTags:["Neural Networks"],bio:"@AnthropicAI, ONEAI OECD, co-chair @indexingai, writer @ https://t.co/3vmtHYkIJ2 Past: @openai, @business @theregister. Neural nets, distributed systems, weird futures",followers:109822,following:4634,location:"San Francisco, CA",website:"http://jack-clark.net",imageUrl:"https://pbs.twimg.com/profile_images/726446881547517952/ULhSTKxN_400x400.jpg"},{id:"nandodf",name:"Nando de Freitas",group:"researcher",role:"VP Research at Google DeepMind",handle:"NandoDF",associated:"",verified:"blue",joinedDate:"Apr 2009",bioTags:[],bio:"MAI Superintelligence Team. Past: AlphaGo tuning, AlphaCode, Gato, ReST, learning to learn, awareness models, recurrent Gemma, Imagen3, Veo, Genie, MAI models",followers:107898,following:808,location:"London, England",website:"https://scholar.google.com/citations?user=nzEluBwAAAAJ&hl=en",imageUrl:"https://pbs.twimg.com/profile_images/1824753797610020865/Aebv-5Ed_400x400.jpg"},{id:"ibab",name:"Igor Babuschkin",group:"researcher",role:"Research Scientist",handle:"ibab",associated:"",verified:"blue",joinedDate:"Feb 2020",bioTags:["Research","Founder"],bio:"Maybe the real ASI was the friends we made along the way. Co-founder @xAI, Research & Engineering",followers:107391,following:871,location:"Palo Alto, CA",website:"https://babushk.in",imageUrl:"https://pbs.twimg.com/profile_images/1801669759404281860/AFEr0ujD_400x400.jpg"},{id:"docmilanfar",name:"Peyman Milanfar",group:"founder",role:"Google",handle:"docmilanfar",associated:"",verified:"blue",joinedDate:"Feb 2014",bioTags:["AGI"],bio:"Distinguished Scientist at Google. Computational Imaging, Machine Learning, and Vision. Tweets = personal opinions. May change or disappear over time.",followers:104584,following:519,location:"",website:"http://milanfar.org",imageUrl:"https://pbs.twimg.com/profile_images/2010591845315678208/2MmbZDwx_400x400.jpg"},{id:"_jasonwei",name:"Jason Wei",group:"researcher",role:"Research at OpenAI",handle:"_jasonwei",associated:"",verified:"blue",joinedDate:"Oct 2020",bioTags:["Research"],bio:"ai researcher @meta superintelligence labs, past: openai, google ",followers:103595,following:669,location:"sf",website:"https://www.jasonwei.net/",imageUrl:"https://pbs.twimg.com/profile_images/1812243833205239808/hZnX6Q-a_400x400.jpg"},{id:"bradsmi",name:"Brad Smith",group:"media",role:"Microsoft",handle:"BradSmi",associated:"",verified:"blue",joinedDate:"Apr 2008",bioTags:[],bio:"Vice Chair and President @Microsoft, Co-author of #ToolsAndWeapons.  Host of Tools And Weapons podcast. Husband. Dad. Proud native of Appleton, Wisconsin.",followers:102207,following:910,location:"Redmond, Washington",website:"https://news.microsoft.com/on-the-issues/",imageUrl:"https://pbs.twimg.com/profile_images/675796491571560448/0EoCkMRa_400x400.jpg"},{id:"thom_wolf",name:"Thomas Wolf",group:"founder",role:"Co-founder at Hugging Face",handle:"Thom_Wolf",associated:"",verified:"blue",joinedDate:"Feb 2011",bioTags:["Founder"],bio:"Co-founder at @HuggingFace - moonshots - angel - working on Chrysopoeia",followers:100835,following:6812,location:"",website:"https://thomwolf.io",imageUrl:"https://pbs.twimg.com/profile_images/1629469939860946946/WUyBolSu_400x400.jpg"},{id:"nvidiageforcebr",name:"NVIDIA GeForce BR",group:"company",role:"NVIDIA Brazil",handle:"NVIDIAGeForceBR",associated:"",verified:"blue",joinedDate:"Dec 2009",bioTags:[],bio:`Perfil Oficial da NVIDIA GeForce Brasil.
Apresentamos as Placas de vdeo e Notebooks GeForce RTX Srie 50 impulsionadas pela NVIDIA Blackwell e IA.`,followers:98581,following:248,location:"Sao Paulo, Brasil",website:"https://linktr.ee/nvidiageforcebr",imageUrl:"https://pbs.twimg.com/profile_images/1993752840343359488/K9ziSfBi_400x400.jpg"},{id:"googleaidevs",name:"Google AI Developers",group:"company",role:"Google AI Developer Relations",handle:"googleaidevs",associated:"",verified:"blue",joinedDate:"Apr 2024",bioTags:[],bio:"AI for every developer. So what will you build?",followers:97966,following:46,location:"",website:"http://ai.google.dev",imageUrl:"https://pbs.twimg.com/profile_images/1865153179341426688/g3bdgQ0P_400x400.jpg"},{id:"abhi1thakur",name:"abhishek",group:"founder",role:"huggingface",handle:"abhi1thakur",associated:"",verified:"blue",joinedDate:"Dec 2009",bioTags:[],bio:"AI Search @vespaengine, ex-@huggingface, World's First 4x @kaggle GM, YouTube 120k+: https://t.co/BHnem8fTu5 Note: i make jokes (sometimes good).",followers:96867,following:1196,location:"localhost",website:"https://www.linkedin.com/in/abhi1thakur/",imageUrl:"https://pbs.twimg.com/profile_images/1996159324154888192/PdKtUI50_400x400.jpg"},{id:"math_rachel",name:"Rachel Thomas",group:"researcher",role:"Co-founder & Researcher",handle:"math_rachel",associated:"",verified:"blue",joinedDate:"May 2013",bioTags:["Research","Founder"],bio:"answer ai researcher | fast ai co-founder | past: math PhD, immunology MS, early eng at uber, prof at USF Data Institute",followers:92747,following:850,location:"Brisbane, Australia",website:"https://rachel.fast.ai/",imageUrl:"https://pbs.twimg.com/profile_images/1606468642375602177/OwMf0hll_400x400.jpg"},{id:"nvidiageforcela",name:"NVIDIA GeForce Latinoamrica",group:"company",role:"NVIDIA Latin America",handle:"NVIDIAGeForceLA",associated:"",verified:"blue",joinedDate:"Jul 2014",bioTags:[],bio:"Cuenta Oficial de NVIDIA GeForce Latinoamrica. Ms all de juego. #RTXON ",followers:91804,following:112,location:"",website:"https://linktr.ee/nvidiageforcelat",imageUrl:"https://pbs.twimg.com/profile_images/1974510827505098752/Y6dmWSDe_400x400.jpg"},{id:"fidjissimo",name:"Fidji Simo",group:"founder",role:"CEO at OpenAI",handle:"fidjissimo",associated:"",verified:"blue",joinedDate:"May 2007",bioTags:[],bio:"CEO of Applications, OpenAI",followers:91620,following:741,location:"",website:"http://fidjisimo.com",imageUrl:"https://pbs.twimg.com/profile_images/1422212886487658496/oUzs06MX_400x400.jpg"},{id:"nvidiaaidev",name:"NVIDIA AI Developer",group:"company",role:"NVIDIA AI Developer",handle:"NVIDIAAIDev",associated:"",verified:"blue",joinedDate:"Jun 2017",bioTags:[],bio:`All things AI for developers from @NVIDIA. 

Additional developer channels: @NVIDIADeveloper, @NVIDIAHPCDev, and @NVIDIAGameDev.`,followers:91221,following:350,location:"Santa Clara, CA",website:"https://developer.nvidia.com/blog",imageUrl:"https://pbs.twimg.com/profile_images/1836133629694742531/verSRYr8_400x400.jpg"},{id:"nvidiageforceme",name:"NVIDIA GeForce ME",group:"company",role:"NVIDIA Middle East",handle:"NVIDIAGeForceME",associated:"",verified:"blue",joinedDate:"Dec 2015",bioTags:[],bio:"Introducing GeForce RTX 50 Series graphics cards & laptops, powered by NVIDIA Blackwell and AI.",followers:90470,following:8,location:"Dubai, United Arab Emirates",website:"http://www.instagram.com/nvidiageforceme",imageUrl:"https://pbs.twimg.com/profile_images/2011301241297817600/A0CWtK2N_400x400.jpg"},{id:"nickcammarata",name:"Nick",group:"founder",role:"",handle:"nickcammarata",associated:"",verified:"blue",joinedDate:"Mar 2009",bioTags:["Neural Networks"],bio:"neural network interpretability, meditation, jhana brother",followers:90034,following:875,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1753264923365523456/mUCvwn7v_400x400.jpg"},{id:"chelseabfinn",name:"Chelsea Finn",group:"researcher",role:"Professor at Stanford",handle:"chelseabfinn",associated:"",verified:"blue",joinedDate:"Jun 2014",bioTags:["Founder"],bio:`Asst Prof of CS & EE @Stanford
Co-founder of Physical Intelligence @physical_int
PhD from @Berkeley_EECS, EECS BS from @MIT`,followers:88292,following:400,location:"Palo Alto, CA",website:"http://ai.stanford.edu/~cbfinn",imageUrl:"https://pbs.twimg.com/profile_images/1531702062487965698/a6iO2pRx_400x400.jpg"},{id:"matthewberman",name:"Matthew Berman",group:"media",role:"AI YouTuber",handle:"MatthewBerman",associated:"",verified:"blue",joinedDate:"Jun 2007",bioTags:["Investor"],bio:`Building Forward Future. YouTuber, Angel Investor, Developer, AI Enthusiast. 

https://t.co/9rk7dmIboR`,followers:85964,following:1028,location:"California",website:"https://forwardfuture.ai",imageUrl:"https://pbs.twimg.com/profile_images/1924926227426738176/ORKZOyMx_400x400.jpg"},{id:"ciguleva",name:"Tatiana Tsiguleva",group:"founder",role:"Creative ambassador @perplexity_ai",handle:"ciguleva",associated:"",verified:"blue",joinedDate:"Nov 2017",bioTags:[],bio:"Creative ambassador @perplexity_ai | Midjourney | Mom of 2",followers:85907,following:1433,location:"Canada",website:"https://ciguleva.substack.com",imageUrl:"https://pbs.twimg.com/profile_images/1684921618148265984/euVl5ESk_400x400.jpg"},{id:"mervenoyann",name:"merve",group:"founder",role:"huggingface",handle:"mervenoyann",associated:"",verified:"blue",joinedDate:"Dec 2019",bioTags:[],bio:"open-sourceress at @huggingface  https://t.co/MhrMkGTTWX",followers:84437,following:5130,location:"Paris",website:"http://huggingface.co/merve",imageUrl:"https://pbs.twimg.com/profile_images/1982142240571920384/hla62KCQ_400x400.jpg"},{id:"gizakdag",name:"Gizem Akdag",group:"founder",role:"CTO",handle:"gizakdag",associated:"",verified:"blue",joinedDate:"Jan 2010",bioTags:[],bio:`Creative Director, AI Explorer || Creative Ambassador @perplexity_ai || 

For inquiries: hello@gizemakdag.com`,followers:83215,following:1354,location:"",website:"https://linktr.ee/gizemakdag",imageUrl:"https://pbs.twimg.com/profile_images/1715718182604775424/hbyXDcq7_400x400.jpg"},{id:"mmitchell_ai",name:"MMitchell",group:"researcher",role:"Chief Ethics Scientist at Hugging Face",handle:"mmitchell_ai",associated:"",verified:"blue",joinedDate:"Jun 2016",bioTags:["Research"],bio:`Interdisciplinary researcher focused on shaping AI towards long-term positive goals. ML & Ethics. 

Similar content in the Skies (this bird has flown).`,followers:81194,following:1355,location:"",website:"http://m-mitchell.com",imageUrl:"https://pbs.twimg.com/profile_images/759051761487187968/24OG0RCC_400x400.jpg"},{id:"iamtrask",name:" Andrew Trask",group:"researcher",role:"Privacy AI Researcher",handle:"iamtrask",associated:"",verified:"blue",joinedDate:"Nov 2012",bioTags:["Neural Networks"],bio:`i teach AI on X

Building @openminedorg, @GoogleDeepMind, @OxfordUni. Also @UN @GovAI_ @CFR_org. I like to train federated/decentralized neural nets.`,followers:79633,following:1162,location:"Oxford, UK",website:"https://andrewtrask.substack.com/p/gpu-demand-is-1mx-distorted-by-efficiency",imageUrl:"https://pbs.twimg.com/profile_images/1414522971037765636/889M9qeA_400x400.jpg"},{id:"allen_ai",name:"Ai2",group:"company",role:"AI Research Institute",handle:"allen_ai",associated:"",joinedDate:"Sep 2015",bioTags:[],bio:`Breakthrough AI to solve the world's biggest problems.

Join us: https://t.co/MjUpZpKPXJ
Newsletter: https://t.co/k9gGznstwj`,followers:79402,following:428,location:"Seattle, WA",website:"http://allenai.org",imageUrl:"https://pbs.twimg.com/profile_images/1819065604370051072/UrIOp6zI_400x400.png"},{id:"artificialanlys",name:"Artificial Analysis",group:"founder",role:"",handle:"ArtificialAnlys",associated:"",verified:"blue",joinedDate:"Jan 2024",bioTags:[],bio:"Independent analysis of AI models and hosting providers - choose the best model and API provider for your use-case",followers:78049,following:610,location:"San Francisco",website:"http://artificialanalysis.ai/",imageUrl:"https://pbs.twimg.com/profile_images/1810946341511766016/3mg9KIaQ_400x400.jpg"},{id:"ai_for_success",name:"AshutoshShrivastava",group:"founder",role:"",handle:"ai_for_success",associated:"",verified:"blue",joinedDate:"Jan 2023",bioTags:[],bio:"Post about latest AI news, tools, tutorials and memes.",followers:77335,following:2478,location:"sponsorships  or check my ",website:"https://ashutoshai.com",imageUrl:"https://pbs.twimg.com/profile_images/1687401026805256192/uQ1o2wVQ_400x400.jpg"},{id:"nvidianetworkng",name:"NVIDIA Networking",group:"company",role:"NVIDIA Networking",handle:"NVIDIANetworkng",associated:"",verified:"blue",joinedDate:"Jul 2009",bioTags:[],bio:"Accelerated software-defined networking, storage, security, and management services that are turning the data center into one compute unit.",followers:76651,following:404,location:"Santa Clara, CA",website:"http://nvidia.com/networking",imageUrl:"https://pbs.twimg.com/profile_images/1861614423355596800/JFhz0pnX_400x400.jpg"},{id:"amermathsoc",name:"American Mathematical Society",group:"company",role:"Mathematics Society",handle:"amermathsoc",associated:"",verified:"blue",joinedDate:"May 2010",bioTags:["Research"],bio:"The American Mathematical Society is dedicated to advancing research and connecting the diverse global mathematical community.",followers:75482,following:646,location:"Providence, Rhode Island USA",website:"http://www.ams.org",imageUrl:"https://pbs.twimg.com/profile_images/951154358561001472/1jhyD_bK_400x400.jpg"},{id:"srush_nlp",name:"Sasha Rush",group:"researcher",role:"Professor at Cornell",handle:"srush_nlp",associated:"",verified:"blue",joinedDate:"Dec 2015",bioTags:["Research"],bio:`Researcher at Cursor
https://t.co/cZl0wTfqGz`,followers:75445,following:517,location:"New York, NY",website:"http://rush-nlp.com",imageUrl:"https://pbs.twimg.com/profile_images/1702727441972686848/k52u1cyt_400x400.jpg"},{id:"csprofkgd",name:"Kosta Derpanis (sabbatical in Munich)",group:"researcher",role:"CTO",handle:"CSProfKGD",associated:"",verified:"blue",joinedDate:"Aug 2015",bioTags:[],bio:"#CS Assoc Prof @YorkUniversity, #ComputerVision Scientist Samsung, @VectorInst Affiliate, TPAMI AE, @ELLISforEurope Member #CVPR2026 #ECCV2026 Publicity Chair",followers:74781,following:199,location:"Toronto, Ontario",website:"https://csprofkgd.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1862500837617987584/doETrQCu_400x400.jpg"},{id:"lorwen108",name:"Lorwen C Nagle, PhD",group:"founder",role:"Harvard",handle:"LORWEN108",associated:"",verified:"blue",joinedDate:"Mar 2015",bioTags:[],bio:"Harvard-trained psychologist. Ph.D. @UTAustin. Mental health is wealth. My threads help you build financial success, become fearless, and destroy anxiety.",followers:72883,following:143,location:"Book a free discovery call:",website:"https://calendly.com/lorwen_consulting/enlightenment-session",imageUrl:"https://pbs.twimg.com/profile_images/1836391113034264576/ZrJJ4YuQ_400x400.jpg"},{id:"johnschulman2",name:"John Schulman",group:"researcher",role:"Co-founder at OpenAI",handle:"johnschulman2",associated:"",verified:"blue",joinedDate:"May 2021",bioTags:["Alignment"],bio:"Recently started @thinkymachines. Interested in reinforcement learning, alignment, birds, jazz music",followers:72576,following:1597,location:"",website:"http://joschu.net",imageUrl:"https://pbs.twimg.com/profile_images/1389000537195040770/DzWPljT-_400x400.jpg"},{id:"sethharpesq",name:"Seth Harp",group:"founder",role:"",handle:"sethharpesq",associated:"",joinedDate:"Sep 2020",bioTags:[],bio:"Author of the critically acclaimed NYT Best Seller, THE FORT BRAGG CARTEL, from @VikingBooks, soon to be a TV show from @HBO",followers:72392,following:1032,location:"Austin, TX",website:"https://www.penguinrandomhouse.com/books/730414/the-fort-bragg-cartel-by-seth-harp/",imageUrl:"https://pbs.twimg.com/profile_images/1939855636746862592/URZOKIug_400x400.jpg"},{id:"rihardjarc",name:"Rihard Jarc",group:"media",role:"CTO",handle:"RihardJarc",associated:"",verified:"blue",joinedDate:"Jan 2016",bioTags:["Research"],bio:"UncoverAlpha Tech Research newsletter, and Consulting (AI, cloud, semiconductors, platforms). DMs open. Tweets are only opinions.",followers:72302,following:2785,location:"",website:"https://www.uncoveralpha.com/",imageUrl:"https://pbs.twimg.com/profile_images/1251462631363403776/r4lpY-WV_400x400.jpg"},{id:"ai__pub",name:"AI Pub",group:"company",role:"AI News & Research",handle:"ai__pub",associated:"",verified:"blue",joinedDate:"Jul 2022",bioTags:["Research"],bio:"AI papers and AI research explained, for technical people. Get hired by the best AI companies: https://t.co/MySVjUGOQ3",followers:71715,following:340,location:"San Francisco, CA",website:"https://airtable.com/shr0Jv3aGS0PFjywx",imageUrl:"https://pbs.twimg.com/profile_images/1557876322940006405/TUavbIZj_400x400.jpg"},{id:"amandaaskell",name:"Amanda Askell",group:"researcher",role:"Researcher at Anthropic",handle:"AmandaAskell",associated:"",verified:"blue",joinedDate:"Jul 2016",bioTags:[],bio:`Philosopher & ethicist trying to make AI be good @AnthropicAI.
Personal account. All opinions come from my training data.`,followers:69652,following:658,location:"San Francisco, CA",website:"http://askell.io",imageUrl:"https://pbs.twimg.com/profile_images/1808357270516125696/-s0TTWR8_400x400.jpg"},{id:"tobyphln",name:"Toby Pohlen",group:"founder",role:"Founding member @xAI",handle:"TobyPhln",associated:"",verified:"blue",joinedDate:"Dec 2012",bioTags:[],bio:"Founding member @xAI. Previously @GoogleDeepMind. @RWTH alumnus.",followers:69364,following:589,location:"London, UK",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1848762733732253696/S1aucmiu_400x400.jpg"},{id:"sebastienbubeck",name:"Sebastien Bubeck",group:"researcher",role:"Research at Microsoft",handle:"SebastienBubeck",associated:"",verified:"blue",joinedDate:"Jan 2012",bioTags:[],bio:"I work on AI at OpenAI. Former VP AI and Distinguished Scientist at Microsoft.",followers:69318,following:1444,location:"Seattle, WA",website:"http://sbubeck.com",imageUrl:"https://pbs.twimg.com/profile_images/1709609135321583616/6bXuF85D_400x400.jpg"},{id:"julien_c",name:"Julien Chaumond",group:"founder",role:"Co-founder at Hugging Face",handle:"julien_c",associated:"",verified:"blue",joinedDate:"Sep 2008",bioTags:["Founder"],bio:"Co-founder and CTO at @huggingface . ML/AI for everyone, building products to propel communities fwd. @Stanford + @Polytechnique",followers:68444,following:1186,location:"Paris / New York",website:"https://huggingface.co",imageUrl:"https://pbs.twimg.com/profile_images/1108502565925326850/zPsBf2BI_400x400.png"},{id:"nvidiashield",name:"NVIDIA SHIELD",group:"company",role:"NVIDIA SHIELD",handle:"NVIDIASHIELD",associated:"",joinedDate:"Jul 2014",bioTags:[],bio:"One box to rule them all. #NVIDIASHIELD is a streaming beast with gaming, smart home, 4K HDR and Google Assistant capabilities.",followers:66805,following:378,location:"California, USA",website:"http://shield.nvidia.com",imageUrl:"https://pbs.twimg.com/profile_images/1658528389370908672/hA4E5Mt0_400x400.png"},{id:"sirbayes",name:"Kevin Patrick Murphy",group:"researcher",role:"Professor at UBC",handle:"sirbayes",associated:"",verified:"blue",joinedDate:"Oct 2016",bioTags:["Research"],bio:"Research Scientist at Google DeepMind. Interested in Bayesian Machine Learning.",followers:66408,following:628,location:"",website:"https://www.cs.ubc.ca/~murphyk/",imageUrl:"https://pbs.twimg.com/profile_images/1346948649603846145/eFBHivR2_400x400.jpg"},{id:"miles_brundage",name:"Miles Brundage",group:"researcher",role:"CTO & Researcher",handle:"Miles_Brundage",associated:"",verified:"blue",joinedDate:"Feb 2013",bioTags:["Research"],bio:"AI policy researcher, @lfschiavo wife guy, fan of cute animals and sci-fi, executive director of AVERI (https://t.co/qq9xcmKikU), Substacker, views my own",followers:66066,following:12728,location:"San Francisco, CA",website:"http://www.milesbrundage.com",imageUrl:"https://pbs.twimg.com/profile_images/2010851888007450624/XWRO7CIH_400x400.jpg"},{id:"sedielem",name:"Sander Dieleman",group:"researcher",role:"Research Scientist at Google",handle:"sedielem",associated:"",verified:"blue",joinedDate:"Dec 2014",bioTags:["Deep Learning","Research"],bio:"Research Scientist at Google DeepMind (WaveNet, Imagen, Veo). I tweet about deep learning (research + software), music, generative models (personal account).",followers:65858,following:1905,location:"London, England",website:"https://sander.ai",imageUrl:"https://pbs.twimg.com/profile_images/539842407081066497/6JaLwehz_400x400.png"},{id:"deliprao",name:"Delip Rao e/",group:"founder",role:"Busy inventing the shipwreck",handle:"deliprao",associated:"",verified:"blue",joinedDate:"Oct 2008",bioTags:["NLP"],bio:"Busy inventing the shipwreck. @Penn. Past: @johnshopkins, @UCSC, @Amazon, @Twitter ||Art: #NLProc, Vision, Speech, #DeepLearning || Life: , improv, running ",followers:65177,following:5207,location:"NYC, SF ",website:"https://deliprao.com",imageUrl:"https://pbs.twimg.com/profile_images/1521801057965264896/bo8B1BjJ_400x400.jpg"},{id:"zacharylipton",name:"Zachary Lipton",group:"researcher",role:"Professor at CMU",handle:"zacharylipton",associated:"",verified:"blue",joinedDate:"Jan 2009",bioTags:["Founder","Professor"],bio:"Cofounder & CTO: @AbridgeHQ, Professor: CMU/@acmi_lab, Creator: @d2l_ai & https://t.co/QQt98VNLUp, Relapsing ",followers:64855,following:1953,location:"San Francisco, CA",website:"http://www.acmilab.org",imageUrl:"https://pbs.twimg.com/profile_images/1915691012338704385/dVKMXThO_400x400.jpg"},{id:"nvidiastudio",name:"NVIDIA Studio",group:"company",role:"NVIDIA Studio",handle:"NVIDIAStudio",associated:"",verified:"blue",joinedDate:"Dec 2018",bioTags:[],bio:" Fast-track your creativity. Do more, wait less with #NVIDIAStudio RTX systems and GPUs. | Get inspired with #StudioShare.",followers:64001,following:136,location:"Imagination",website:"https://linktr.ee/nvidiacreators",imageUrl:"https://pbs.twimg.com/profile_images/1579974405928517632/I7jWn8UO_400x400.png"},{id:"__tinygrad__",name:"the tiny corp",group:"company",role:"ML Framework",handle:"__tinygrad__",associated:"",verified:"blue",joinedDate:"Jun 2023",bioTags:[],bio:`We make tinygrad; sell tinybox for the GPU middle class.
Our mission is to commoditize the petaflop.`,followers:63505,following:161,location:"Hong Kong",website:"https://tinygrad.org",imageUrl:"https://pbs.twimg.com/profile_images/1772444459625766913/1meZwC16_400x400.jpg"},{id:"roydanroy",name:"Dan Roy",group:"researcher",role:"CTO & Professor at Google",handle:"roydanroy",associated:"",verified:"blue",joinedDate:"Jun 2009",bioTags:["Research","Professor"],bio:"@Google DeepMind. On leave, Canada CIFAR AI Chair and Former Research Director, @VectorInst. Professor, @UofT (Statistics/CS). Views are my own.",followers:62235,following:1861,location:"London",website:"http://danroy.org/",imageUrl:"https://pbs.twimg.com/profile_images/647245794249015296/575wCuTG_400x400.jpg"},{id:"osanseviero",name:"Omar Sanseviero",group:"founder",role:"huggingface",handle:"osanseviero",associated:"",verified:"blue",joinedDate:"Oct 2010",bioTags:[],bio:`Developer Experience Lead at @GoogleDeepMind

Building Gemini API, Gemma, AI Studio and more AI products. My views

ex-Chief Llama Officer @huggingface `,followers:61620,following:2731,location:"Zurich",website:"https://osanseviero.github.io/hackerllama/",imageUrl:"https://pbs.twimg.com/profile_images/1676696716693700608/t4kv-MrC_400x400.jpg"},{id:"thegautamkamath",name:"Gautam Kamath",group:"researcher",role:"Professor at Waterloo",handle:"thegautamkamath",associated:"",joinedDate:"Dec 2009",bioTags:[],bio:"Assistant Prof of CS @UWaterloo, Faculty @VectorInst, Canada @CIFAR_News AI Chair. Joining @NYU_Courant Fall 2026. Co-EiC @TmlrOrg. I lead @TheSalonML.",followers:61042,following:598,location:"Waterloo, Ontario",website:"http://www.gautamkamath.com",imageUrl:"https://pbs.twimg.com/profile_images/1702778756195053568/G7kQIlvx_400x400.jpg"},{id:"mathemagic1an",name:"Jay Hack",group:"founder",role:"Founder at stanford",handle:"mathemagic1an",associated:"",verified:"blue",joinedDate:"May 2013",bioTags:["Founder"],bio:"Head of AI @clickup. Tweets about AI, computing, dev tools and knowledge work. Previously founder @codegen / ML + data @palantir / @stanford. Not a pseudonym.",followers:60473,following:3329,location:"San Francisco",website:"http://jay.ai",imageUrl:"https://pbs.twimg.com/profile_images/1607042017095258114/sSUQlvdW_400x400.jpg"},{id:"tdietterich",name:"Thomas G. Dietterich",group:"researcher",role:"Professor Emeritus at Oregon State",handle:"tdietterich",associated:"",joinedDate:"Aug 2012",bioTags:["Professor"],bio:"Distinguished Professor (Emeritus), Oregon State Univ.; Former President, Assoc. for the Adv. of Artificial Intelligence; Robust AI & Comput. Sustainability",followers:59657,following:642,location:"Corvallis, OR",website:"http://web.engr.oregonstate.edu/~tgd/",imageUrl:"https://pbs.twimg.com/profile_images/704767204437336065/wAAXEdOd_400x400.jpg"},{id:"nvidiageforcetr",name:"NVIDIA GeForce TR",group:"company",role:"NVIDIA Turkey",handle:"nvidiageforcetr",associated:"",verified:"blue",joinedDate:"Sep 2017",bioTags:[],bio:"GeForce RTX 50 Serisi ekran kartlar ve dizst bilgisayarlar, NVIDIA Blackwell ve yapay zeka gcyle karnzda!",followers:58151,following:72,location:"",website:"https://www.nvidia.com/",imageUrl:"https://pbs.twimg.com/profile_images/1970147131496296448/1wf-vpWJ_400x400.jpg"},{id:"nvidiagamedev",name:"NVIDIAGameDev",group:"company",role:"NVIDIA Game Development",handle:"NVIDIAGameDev",associated:"",verified:"blue",joinedDate:"Jan 2009",bioTags:[],bio:"NVIDIA-related news and announcements of interest to game developers",followers:56616,following:522,location:"Santa Clara, CA",website:"https://developer.nvidia.com/industries/game-development",imageUrl:"https://pbs.twimg.com/profile_images/1869154628782436352/yCRNLjNQ_400x400.jpg"},{id:"sarahookr",name:"Sara Hooker",group:"researcher",role:"Research Lead at Cohere",handle:"sarahookr",associated:"",verified:"blue",joinedDate:"May 2016",bioTags:[],bio:"Building intelligence that evolves @adaptionlabs. Built @Cohere_Labs, @GoogleBrain, @GoogleDeepmind. ML Efficiency, Multimodal\\lingual.",followers:56192,following:10018,location:"San Francisco",website:"https://www.sarahooker.me/",imageUrl:"https://pbs.twimg.com/profile_images/1403376500192071683/zvr_Hkox_400x400.jpg"},{id:"mmbronstein",name:"Michael Bronstein",group:"researcher",role:"Professor at Oxford",handle:"mmbronstein",associated:"",joinedDate:"Aug 2009",bioTags:["Professor"],bio:"#DeepMind Professor of #AI @UniofOxford / Director #AITHYRA / Chief Scientist @vant_ai / https://t.co/kZpGpDzYeV (opinions are mine) ",followers:55624,following:7119,location:"",website:"https://www.cs.ox.ac.uk/people/michael.bronstein/",imageUrl:"https://pbs.twimg.com/profile_images/2009293684295258114/oQPVNwpc_400x400.jpg"},{id:"littmath",name:"Daniel Litt",group:"researcher",role:"Professor at Toronto",handle:"littmath",associated:"",verified:"blue",joinedDate:"Aug 2010",bioTags:["Professor"],bio:'Assistant professor (of mathematics) at the University of Toronto. "Tireless math ronin." Algebraic geometry, number theory, etc. He/him.',followers:54753,following:893,location:"Toronto, Ontario",website:"http://www.daniellitt.com",imageUrl:"https://pbs.twimg.com/profile_images/1588888923081687045/KGL3lgvC_400x400.jpg"},{id:"nvidiahpcdev",name:"NVIDIA HPC Developer",group:"company",role:"NVIDIA HPC",handle:"NVIDIAHPCDev",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:[],bio:"See the latest HPC developer news and resources from @NVIDIA. Be sure to check out our NVIDIA Technical Blog for more.",followers:54158,following:687,location:"Santa Clara, CA",website:"https://developer.nvidia.com/blog",imageUrl:"https://pbs.twimg.com/profile_images/1836133737169653760/V1Lj4vN5_400x400.jpg"},{id:"theworldlabs",name:"World Labs",group:"company",role:"AI Research Lab",handle:"theworldlabs",associated:"",verified:"blue",joinedDate:"Dec 2023",bioTags:[],bio:"World Labs is a spatial intelligence company, building frontier models that can perceive, generate, and interact with the 3D world.",followers:54125,following:45,location:"San Francisco, CA",website:"http://worldlabs.ai",imageUrl:"https://pbs.twimg.com/profile_images/1834548472592089088/LYRGq_Kn_400x400.jpg"},{id:"nvidiadc",name:"NVIDIA Data Center",group:"company",role:"NVIDIA Data Center",handle:"NVIDIADC",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:[],bio:"AI factories for the era of AI reasoning.",followers:53705,following:1664,location:"Santa Clara, CA",website:"https://www.nvidia.com/en-us/data-center/",imageUrl:"https://pbs.twimg.com/profile_images/1859346502243713026/NzLZW_Ag_400x400.jpg"},{id:"sleepinyourhat",name:"Sam Bowman",group:"researcher",role:"Professor at NYU",handle:"sleepinyourhat",associated:"",joinedDate:"Jul 2011",bioTags:["LLMs","Alignment"],bio:"AI alignment + LLMs at Anthropic. On leave from NYU. Views not employers'. No relation to @s8mb. I think you should join @givingwhatwecan.",followers:53601,following:3247,location:"San Francisco",website:"https://sleepinyourhat.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1915807599867662336/rHHhdB___400x400.jpg"},{id:"fofrai",name:"fofr",group:"founder",role:"Google",handle:"fofrAI",associated:"",verified:"blue",joinedDate:"Jul 2022",bioTags:[],bio:"Experimenting with AI at Google DeepMind",followers:53534,following:1466,location:"",website:"http://fofr.ai",imageUrl:"https://pbs.twimg.com/profile_images/1732174612178350080/X1uR3MvQ_400x400.jpg"},{id:"merettm",name:"Jakub Pachocki",group:"founder",role:"Chief Scientist at OpenAI",handle:"merettm",associated:"",verified:"blue",joinedDate:"Aug 2018",bioTags:[],bio:"OpenAI",followers:52030,following:20,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1032407242727809025/AJpM67Ve_400x400.jpg"},{id:"dpkingma",name:"Durk Kingma",group:"researcher",role:"Research Scientist at Google",handle:"dpkingma",associated:"",joinedDate:"Mar 2009",bioTags:[],bio:"@AnthropicAI. Prev. @Google Brain/DeepMind, founding team @OpenAI. Computer scientist; inventor of the VAE, Adam optimizer, and other methods. ML PhD.",followers:51723,following:408,location:"",website:"https://dpkingma.com",imageUrl:"https://pbs.twimg.com/profile_images/1866077672687702016/4CvbDNcn_400x400.jpg"},{id:"shengjia_zhao",name:"Shengjia Zhao",group:"researcher",role:"Meta",handle:"shengjia_zhao",associated:"",verified:"blue",joinedDate:"Oct 2016",bioTags:[],bio:"Chief Scientist @ Meta MSL. Formerly MTS @ OpenAI, PhD @ Stanford. I train models. All opinions my own.",followers:51349,following:230,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/871905725500477440/IAaj_fa7_400x400.jpg"},{id:"melmitchell1",name:"Melanie Mitchell",group:"researcher",role:"Professor at Santa Fe Institute",handle:"MelMitchell1",associated:"",joinedDate:"Sep 2011",bioTags:["Professor"],bio:"Professor, Santa Fe Institute.  Mostly posting  on https://t.co/4NpA2IL5Va (at-melaniemitchell). More thoughts at https://t.co/nC43NHRozX.",followers:49653,following:671,location:"Santa Fe, NM",website:"http://melaniemitchell.me",imageUrl:"https://pbs.twimg.com/profile_images/1417524012104785928/HENn1FzD_400x400.jpg"},{id:"savvyrl",name:"Rosanne Liu",group:"founder",role:"Google",handle:"savvyRL",associated:"",joinedDate:"Mar 2013",bioTags:["Deep Learning","Research"],bio:"Mom. Cofounded & running @ml_collective. Host of Deep Learning Classics & Trends. Research at Google DeepMind. DEI/DIA Chair of ICLR & NeurIPS.",followers:49438,following:1031,location:"San Francisco, CA",website:"https://rosanneliu.com/",imageUrl:"https://pbs.twimg.com/profile_images/1661771743785263104/ePmGOL1w_400x400.jpg"},{id:"nvidianewsroom",name:"NVIDIA Newsroom",group:"company",role:"NVIDIA News",handle:"nvidianewsroom",associated:"",verified:"blue",joinedDate:"Mar 2025",bioTags:[],bio:"The official newsroom for NVIDIA. Innovation delivered daily.",followers:49127,following:36,location:"",website:"https://nvidianews.nvidia.com/",imageUrl:"https://pbs.twimg.com/profile_images/1897079284390617092/6gB0nESi_400x400.jpg"},{id:"joshwoodward",name:"Josh Woodward",group:"company",role:"Google",handle:"joshwoodward",associated:"",verified:"blue",joinedDate:"Oct 2010",bioTags:[],bio:"VP, @Google @GoogleLabs @GeminiApp @GoogleAIStudio",followers:48861,following:764,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1994910063794806784/CJr-dzpj_400x400.jpg"},{id:"nvidiaanz",name:"NVIDIA ANZ",group:"company",role:"NVIDIA Australia & NZ",handle:"NvidiaANZ",associated:"",verified:"blue",joinedDate:"Sep 2015",bioTags:[],bio:"Introducing GeForce RTX 50 Series graphics cards &  laptops, powered by NVIDIA Blackwell and AI.",followers:48628,following:706,location:"Australia and New Zealand",website:"https://www.nvidia.com/en-au/geforce/",imageUrl:"https://pbs.twimg.com/profile_images/1980092889175666688/gqzmLp-R_400x400.jpg"},{id:"shaneguml",name:"Shane Gu",group:"founder",role:"OpenAI",handle:"shaneguML",associated:"",verified:"blue",joinedDate:"Jun 2016",bioTags:["GPT"],bio:"Gemini Thinking, Senior Staff AE @GoogleDeepMind. -born . ex: Gemini 1.5-3, GPT-4 @OpenAI (JP: @shanegJP). Personal opinions.",followers:47682,following:2197,location:"Mountain View, CA",website:"https://scholar.google.com/citations?user=B8wslVsAAAAJ",imageUrl:"https://pbs.twimg.com/profile_images/1860165285627518976/3TI_C6pk_400x400.jpg"},{id:"yuhu_ai_",name:"Yuhuai (Tony) Wu",group:"founder",role:"Co-founder",handle:"Yuhu_ai_",associated:"",joinedDate:"Jul 2017",bioTags:["Transformers","Founder"],bio:"Co-Founder @xAI. Grok Reasoning, STaR, Minerva, AlphaGeometry, Autoformalization, AlphaStar, Memorizing transformer.",followers:45774,following:460,location:"Stanford",website:"https://yuhuaiwu.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1281320278363119617/d9Ngg05T_400x400.jpg"},{id:"jonathanross321",name:"Jonathan Ross",group:"founder",role:"Founder at Nvidia",handle:"JonathanRoss321",associated:"",verified:"blue",joinedDate:"Nov 2021",bioTags:["Founder"],bio:`Double the World's AI Compute
Chief Software Architect @ Nvidia, Founder of Groq, Creator of the LPU & Google's TPU`,followers:45607,following:219,location:"",website:"https://www.nvidia.com",imageUrl:"https://pbs.twimg.com/profile_images/1827406129066078208/gFpaaXaq_400x400.jpg"},{id:"chhillee",name:"Horace He",group:"founder",role:"",handle:"cHHillee",associated:"",verified:"blue",joinedDate:"Feb 2010",bioTags:[],bio:'@thinkymachines Formerly @PyTorch "My learning style is Horace twitter threads" - @typedfemale',followers:45329,following:555,location:"chhillee",website:"https://www.thonking.ai/p/strangely-matrix-multiplications",imageUrl:"https://pbs.twimg.com/profile_images/1747412378751574016/0es3s5Fz_400x400.jpg"},{id:"egrefen",name:"Edward Grefenstette",group:"researcher",role:"CTO & Professor",handle:"egrefen",associated:"",joinedDate:"Apr 2007",bioTags:["Research","Professor"],bio:"FR/US/GB AI/ML Person, Director of Research at @GoogleDeepMind, Honorary Professor at @UCL_DARK, @ELLISforEurope Fellow. All posts are personal.",followers:44586,following:894,location:"London, United Kingdom",website:"http://www.egrefen.com",imageUrl:"https://pbs.twimg.com/profile_images/1701720890138882048/8_FxlWxz_400x400.jpg"},{id:"mattniessner",name:"Matthias Niessner",group:"researcher",role:"Co-founder & Professor",handle:"MattNiessner",associated:"",verified:"blue",joinedDate:"Mar 2015",bioTags:["Founder","Professor"],bio:`Professor for Visual Computing & Artificial Intelligence @TU_Muenchen
Co-Founder @synthesiaIO
Co-Founder @SpAItial_AI`,followers:44231,following:283,location:"Munich, Bavaria",website:"https://niessnerlab.org/publications.html",imageUrl:"https://pbs.twimg.com/profile_images/746260005918146560/ghNddE9L_400x400.jpg"},{id:"hendrycks",name:"Dan Hendrycks",group:"researcher",role:"CTO",handle:"hendrycks",associated:"",verified:"blue",joinedDate:"Aug 2009",bioTags:["AI Safety"],bio:` Center for AI Safety Director
 xAI and Scale AI advisor
 GELU/MMLU/MATH/HLE
 PhD in AI
 Analyzing AI models, companies, policies, and geopolitics`,followers:44145,following:111,location:"San Francisco",website:"https://newsletter.safe.ai",imageUrl:"https://pbs.twimg.com/profile_images/1884117842699902978/EklOGf5d_400x400.jpg"},{id:"peterberezinbca",name:"Peter Berezin",group:"founder",role:"CTO",handle:"PeterBerezinBCA",associated:"",verified:"blue",joinedDate:"Mar 2017",bioTags:["Research"],bio:"Chief Global Strategist and Director of Research @bcaresearch Formerly with Goldman Sachs & IMF",followers:43706,following:661,location:"Hilbert space",website:"http://www.bcaresearch.com",imageUrl:"https://pbs.twimg.com/profile_images/1635243673548906496/8lhtDS1B_400x400.jpg"},{id:"zai_org",name:"Z.ai",group:"company",role:"AI Company",handle:"Zai_org",associated:"",joinedDate:"Nov 2023",bioTags:["AGI"],bio:`The AI Lab behind GLM models, dedicated to inspiring the development of AGI to benefit humanity.

https://t.co/x14hb3jO7O`,followers:43687,following:225,location:"user_feedback@z.ai",website:"http://z.ai",imageUrl:"https://pbs.twimg.com/profile_images/1970775077181411328/W8XKaUIh_400x400.jpg"},{id:"getjonwithit",name:"Jonathan Gorard",group:"founder",role:"Princeton",handle:"getjonwithit",associated:"",joinedDate:"Nov 2012",bioTags:[],bio:`Applied mathematician, computational physicist @Princeton
Previously @Cambridge_Uni
Making the universe computable.`,followers:43651,following:18,location:"Princeton, NJ",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1330192676222865414/mhhuGgKB_400x400.jpg"},{id:"nvidiajapan",name:"NVIDIA Japan",group:"company",role:"NVIDIA Japan",handle:"NVIDIAJapan",associated:"",verified:"blue",joinedDate:"Oct 2010",bioTags:[],bio:"  ",followers:43620,following:230,location:"",website:"http://www.nvidia.co.jp/",imageUrl:"https://pbs.twimg.com/profile_images/1862300595220078592/hGVao7Zs_400x400.jpg"},{id:"chrszegedy",name:"Christian Szegedy",group:"researcher",role:"Research Scientist",handle:"ChrSzegedy",associated:"",verified:"blue",joinedDate:"Jun 2015",bioTags:["Research"],bio:"#deeplearning, #ai research scientist. Opinions are mine.",followers:43235,following:2842,location:"Sunnyvale, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1728625627207725056/auh7rYVv_400x400.jpg"},{id:"billpeeb",name:"Bill Peebles",group:"researcher",role:"Research Scientist at OpenAI",handle:"billpeeb",associated:"",verified:"blue",joinedDate:"Jul 2012",bioTags:[],bio:"head of sora @openai ",followers:43035,following:306,location:"",website:"https://wpeebles.com",imageUrl:"https://pbs.twimg.com/profile_images/1973120495043354625/sTrUPHov_400x400.jpg"},{id:"jeffteper",name:"Jeff Teper",group:"company",role:"Microsoft",handle:"jeffteper",associated:"",verified:"blue",joinedDate:"May 2009",bioTags:[],bio:"President - Microsoft 365 Collab Apps & Platforms - Teams, SharePoint, AI    best community in tech",followers:43019,following:935,location:"Redmond, WA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1253063329091694592/pSS0UgpK_400x400.jpg"},{id:"petarv_93",name:"Petar Velikovi",group:"researcher",role:"Staff Research Scientist at Google DeepMind",handle:"PetarV_93",associated:"",verified:"blue",joinedDate:"Jan 2013",bioTags:["Research"],bio:"Senior Staff Research Scientist @GoogleDeepMind | Affiliated Lecturer @Cambridge_Uni | Assoc @clarehall_cam | GDL Scholar @ELLISforEurope. Monoids. ",followers:42999,following:555,location:"London ",website:"https://petar-v.com",imageUrl:"https://pbs.twimg.com/profile_images/1991824836180500481/uDwvd0lk_400x400.jpg"},{id:"black_in_ai",name:"Black in AI",group:"company",role:"AI Community Organization",handle:"black_in_ai",associated:"",joinedDate:"Nov 2017",bioTags:[],bio:"Black in AI empowers a global community of AI professionals of African descent to be full partners in shaping our technological and economic future.",followers:42747,following:313,location:"",website:"http://www.blackinai.org",imageUrl:"https://pbs.twimg.com/profile_images/1841203973161619462/pJjiPD8f_400x400.png"},{id:"npew",name:"Peter Welinder",group:"founder",role:"VP at OpenAI",handle:"npew",associated:"",verified:"blue",joinedDate:"Apr 2010",bioTags:[],bio:"VP and GM @OpenAI",followers:42340,following:924,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1527047003984629761/6ZfqcDtO_400x400.jpg"},{id:"unslothai",name:"Unsloth AI",group:"company",role:"LLM Fine-tuning Tools",handle:"UnslothAI",associated:"",verified:"blue",joinedDate:"Nov 2023",bioTags:[],bio:"Making open-source AI accessible!  https://t.co/2kXqhhvdCD",followers:42291,following:448,location:"San Francisco, CA",website:"http://unsloth.ai",imageUrl:"https://pbs.twimg.com/profile_images/1790653115441782784/VXHiO8LM_400x400.jpg"},{id:"askokara",name:"Okara",group:"founder",role:"private ai chat with open source models",handle:"askOkara",associated:"",verified:"blue",joinedDate:"Dec 2021",bioTags:["Open Source"],bio:"private ai chat with open source models",followers:42147,following:690,location:"web",website:"https://okara.ai/",imageUrl:"https://pbs.twimg.com/profile_images/2006964709212434438/9CNd6lAH_400x400.jpg"},{id:"gneubig",name:"Graham Neubig",group:"researcher",role:"Professor at CMU",handle:"gneubig",associated:"",verified:"blue",joinedDate:"Sep 2010",bioTags:["Founder","Professor"],bio:`Associate professor @LTIatCMU.
Co-founder/chief scientist @OpenHandsDev.
I mostly work on modeling language.`,followers:42016,following:749,location:"Pittsburgh, PA",website:"http://www.phontron.com",imageUrl:"https://pbs.twimg.com/profile_images/1115600347/drawing-me_400x400.png"},{id:"suchenzang",name:"Susan Zhang",group:"company",role:"Google",handle:"suchenzang",associated:"",verified:"blue",joinedDate:"Apr 2014",bioTags:[],bio:"@ Google Deepmind. Past: @MetaAI, @OpenAI, @unitygames, @losalamosnatlab, @Princeton etc. Always hungry for intelligence.",followers:41198,following:766,location:"",website:"https://suchenzang.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1965607429271683074/D9Yvuz-O_400x400.jpg"},{id:"_mohansolo",name:"Varun Mohan",group:"founder",role:"building @antigravity @GoogleDeepMind",handle:"_mohansolo",associated:"",verified:"blue",joinedDate:"Jan 2019",bioTags:[],bio:"building @antigravity @GoogleDeepMind",followers:40788,following:231,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1658293192549339138/V0Y7u33__400x400.jpg"},{id:"khoomeik",name:"Rohan Pandey",group:"company",role:"OpenAI",handle:"khoomeik",associated:"",joinedDate:"Feb 2020",bioTags:["Research"],bio:"descending cross-entropy to ascend entropy @PeriodicLabs || prev research @OpenAI @CarnegieMellon '23",followers:40575,following:2611,location:"San Francisco, CA",website:"https://rpandey.tech",imageUrl:"https://pbs.twimg.com/profile_images/1970553499902681088/He-CtSGQ_400x400.jpg"},{id:"tydsh",name:"Yuandong Tian",group:"researcher",role:"Co-founder & CTO at Meta",handle:"tydsh",associated:"",verified:"blue",joinedDate:"Dec 2009",bioTags:["LLMs","Robotics","Startup","Founder"],bio:"co-founder of Stealth Startup. ex-Meta FAIR Director. ex-Google. Reasoning, Optimization and Understanding LLM. Novelist in spare time. PhD in @CMU_Robotics.",followers:40526,following:918,location:"California, USA",website:"http://yuandong-tian.com",imageUrl:"https://pbs.twimg.com/profile_images/1382126627883077632/qFn6cjhc_400x400.jpg"},{id:"tlogg",name:"Dario TLO Wnsch",group:"founder",role:"Co-founder at deepmind",handle:"TLOgg",associated:"",joinedDate:"Feb 2011",bioTags:["Founder"],bio:"Co-founder & General Manager of Competitive Operations @shopifyrebels @shopify @teamliquid StarCraft 2 alumni @deepmind AlphaStar contributor ",followers:39528,following:1241,location:"Alpha Quadrant",website:"http://TLO.gg",imageUrl:"https://pbs.twimg.com/profile_images/1537979589649002497/9qXQYDqe_400x400.jpg"},{id:"alexgraveley",name:"Alex Graveley",group:"founder",role:"CEO",handle:"alexgraveley",associated:"",verified:"blue",joinedDate:"Jul 2022",bioTags:[],bio:"Co-creator GitHub Copilot, Dropbox Paper. 2x CEO. Working on @Perplexity_ai & @Comet. Survivor ",followers:38154,following:1557,location:"US",website:"https://alexgraveley.com",imageUrl:"https://pbs.twimg.com/profile_images/1669608410776764416/kVuKoJmS_400x400.jpg"},{id:"sundeep",name:"sunny madra",group:"company",role:"Nvidia",handle:"sundeep",associated:"",verified:"blue",joinedDate:"Oct 2009",bioTags:[],bio:"VP @Nvidia, prev (COO/President@GroqInc) prev (co-f@definitiveio acq. by groq, co-f@autonomic acq. by @ford, and co-f@xtreme labs acq. by pivotal/@vmware)",followers:37748,following:5320,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/2005896047193907200/rkyjKTpD_400x400.jpg"},{id:"nvidiaworkstatn",name:"NVIDIA Workstation",group:"company",role:"NVIDIA Workstation",handle:"NVIDIAworkstatn",associated:"",verified:"blue",joinedDate:"Nov 2009",bioTags:[],bio:"The #NVIDIARTXPRO platform for professional visualization drives the innovation of graphics and #AI, from the desktop to the data center to the cloud.",followers:36588,following:1146,location:"Santa Clara, CA",website:"https://www.nvidia.com/en-us/design-visualization/",imageUrl:"https://pbs.twimg.com/profile_images/1866913814031241217/YJSZ1KXi_400x400.jpg"},{id:"stuartjritchie",name:"Stuart Ritchie",group:"founder",role:"Research Comms @AnthropicAI",handle:"StuartJRitchie",associated:"",verified:"blue",joinedDate:"Aug 2010",bioTags:["Research"],bio:"Research Comms @AnthropicAI",followers:36492,following:1186,location:"London",website:"https://www.sciencefictions.org",imageUrl:"https://pbs.twimg.com/profile_images/1288882190634364937/YhDe6kz0_400x400.jpg"},{id:"timzaman",name:"Tim Zaman",group:"founder",role:"OpenAI",handle:"timzaman",associated:"",verified:"blue",joinedDate:"Jun 2010",bioTags:[],bio:"Frontier Clusters at OpenAI. Formerly DeepMind, Tesla AI (head of AI Infra), X/Twitter, NVIDIA.",followers:35891,following:227,location:"San Francisco, CA",website:"http://www.timzaman.com",imageUrl:"https://pbs.twimg.com/profile_images/1388188008793337861/HgLX98oe_400x400.jpg"},{id:"yoshua_bengio",name:"Yoshua Bengio",group:"researcher",role:"Deep Learning Pioneer",handle:"Yoshua_Bengio",associated:"",verified:"blue",joinedDate:"Sep 2024",bioTags:["Research"],bio:`Working towards the safe development of AI for the benefit of all @UMontreal, @LawZero_ & @Mila_Quebec
A.M. Turing Award Recipient and most-cited AI researcher.`,followers:34775,following:232,location:"Montral, Qubec, Canada",website:"https://yoshuabengio.org/",imageUrl:"https://pbs.twimg.com/profile_images/1831403866228670464/ervekqfd_400x400.jpg"},{id:"mattt",name:"Mattt",group:"company",role:"huggingface",handle:"mattt",associated:"",verified:"blue",joinedDate:"Dec 2006",bioTags:[],bio:"Collaborating w/@huggingface and writing on @nshipster. Prev: @replicate, @github, @apple, BA @CarnegieMellon",followers:33870,following:65,location:"Portland, OR",website:"https://github.com/mattt",imageUrl:"https://pbs.twimg.com/profile_images/969321564050112513/fbdJZmEh_400x400.jpg"},{id:"chatgpt21",name:"Chris",group:"founder",role:"Agi 2029 - Applied in RL, CL, and generalization",handle:"chatgpt21",associated:"",verified:"blue",joinedDate:"Jan 2023",bioTags:["AGI","Startup"],bio:"Agi 2029 - Applied in RL, CL, and generalization | Program Manager | Investing in early startups  E/CC ",followers:33496,following:1072,location:"",website:"https://www.asciibench.com/",imageUrl:"https://pbs.twimg.com/profile_images/2001137569275256832/bO_iEVnF_400x400.jpg"},{id:"zoubinghahrama1",name:"Zoubin Ghahramani",group:"researcher",role:"VP Research at Google",handle:"ZoubinGhahrama1",associated:"",verified:"blue",joinedDate:"Aug 2020",bioTags:["Research","Professor"],bio:"VP Research, Google DeepMind, ex-head of Google Brain. Professor at University of Cambridge. Machine Learning Researcher. ex-Chief Scientist & VP of AI, Uber.",followers:33260,following:693,location:"Cambridge, UK",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1294283059747893248/9K2p5oV__400x400.jpg"},{id:"liamfedus",name:"William Fedus",group:"company",role:"Co-founder at OpenAI",handle:"LiamFedus",associated:"",verified:"blue",joinedDate:"Oct 2012",bioTags:["Founder"],bio:`Co-Founder of @periodiclabs

Past: VP of Post-Training @OpenAI; Google Brain`,followers:32714,following:1156,location:"San Francisco, CA",website:"http://acsweb.ucsd.edu/~wfedus/",imageUrl:"https://pbs.twimg.com/profile_images/946842870916448256/X0_3p45X_400x400.jpg"},{id:"askalphaxiv",name:"alphaXiv",group:"company",role:"AI Research Platform",handle:"askalphaxiv",associated:"",verified:"blue",joinedDate:"Nov 2023",bioTags:["Research"],bio:"High fidelity research",followers:32646,following:44,location:"",website:"http://alphaxiv.org",imageUrl:"https://pbs.twimg.com/profile_images/1866663567417806848/-Vj32Dq-_400x400.jpg"},{id:"cixliv",name:"CIX ",group:"founder",role:"Founder & CEO",handle:"cixliv",associated:"",verified:"blue",joinedDate:"Jan 2013",bioTags:["Startup","Founder"],bio:"Building Real Steel - CEO / Chief Robot Fighter @REK - Decade of startups in AR/VR - Founder @LIV + more - Post about VR and Humanoid Robots",followers:32283,following:8335,location:"California",website:"http://rek.com",imageUrl:"https://pbs.twimg.com/profile_images/2001533291527380992/T0_Tcexs_400x400.jpg"},{id:"natashajaques",name:"Natasha Jaques",group:"company",role:"Professor & Research Scientist",handle:"natashajaques",associated:"",verified:"blue",joinedDate:"Jun 2009",bioTags:["Research","Professor"],bio:"Assistant Professor leading the Social RL Lab https://t.co/ykwfJG84Bj @uwcse and Staff Research Scientist at @GoogleAI.",followers:32216,following:1117,location:"Seattle, WA",website:"http://natashajaques.ai",imageUrl:"https://pbs.twimg.com/profile_images/1702377276376227840/kG1riV9J_400x400.jpg"},{id:"jaykreps",name:"Jay Kreps",group:"founder",role:"CEO at anthropic",handle:"jaykreps",associated:"",verified:"blue",joinedDate:"Mar 2010",bioTags:[],bio:"CEO of @confluentinc (https://t.co/fKQHUemwWR). One of the original creators of @apachekafka. Board member at @anthropic. S se puede.",followers:31535,following:915,location:"Palo Alto, California",website:"http://www.confluent.io/blog",imageUrl:"https://pbs.twimg.com/profile_images/1123808410510737408/NCWzmizz_400x400.png"},{id:"lateinteraction",name:"Omar Khattab",group:"researcher",role:"Professor at MIT",handle:"lateinteraction",associated:"",verified:"blue",joinedDate:"Dec 2022",bioTags:["NLP","Research","Professor"],bio:`Asst professor @MIT CSAIL @nlp_mit.

Research includes https://t.co/VgyLxl0oa1, https://t.co/ZZaSzaRaZ7 (@DSPyOSS), RLMs, and GEPA.

Prev: CS PhD @StanfordNLP. Research @Databricks.`,followers:30119,following:3254,location:"Cambridge, MA",website:"https://omarkhattab.com/",imageUrl:"https://pbs.twimg.com/profile_images/1613558765764374528/aZQB6U4b_400x400.jpg"},{id:"chris_j_paxton",name:"Chris Paxton",group:"founder",role:"Mostly posting about robots",handle:"chris_j_paxton",associated:"",verified:"blue",joinedDate:"Dec 2013",bioTags:["AGI","Robotics"],bio:`Mostly posting about robots.

currently AI @agilityrobotics

prev embodied AI @AIatMeta, @NVIDIAAI. All views my own.`,followers:29706,following:3209,location:"Pittsburgh, PA",website:"https://itcanthink.substack.com/",imageUrl:"https://pbs.twimg.com/profile_images/1330994153518411777/2LfHg9GF_400x400.jpg"},{id:"gordic_aleksa",name:"Aleksa Gordi ()",group:"founder",role:"Microsoft",handle:"gordic_aleksa",associated:"",verified:"blue",joinedDate:"Sep 2017",bioTags:["LLMs"],bio:`pretraining LLMs

getting us to singularity with friends

computers can be understood: https://t.co/doHE1Qv2Sj

x @GoogleDeepMind @Microsoft`,followers:29073,following:230,location:"San Francisco, CA",website:"https://www.aleksagordic.com/",imageUrl:"https://pbs.twimg.com/profile_images/1961835942957985792/JsXmqrBl_400x400.jpg"},{id:"jamesmontemagno",name:"James Montemagno",group:"founder",role:"Microsoft",handle:"JamesMontemagno",associated:"",verified:"blue",joinedDate:"Jan 2009",bioTags:[],bio:"Developer Community Lead @Microsoft focusing on @code, @githubcopilot, @dotnet, @visualstudio, and more! Creator of https://t.co/QFtWdDJvaw",followers:28914,following:35,location:"",website:"https://www.youtube.com/jamesmontemagno",imageUrl:"https://pbs.twimg.com/profile_images/1790636025167130624/dnJ8ZfKe_400x400.jpg"},{id:"tkipf",name:"Thomas Kipf",group:"researcher",role:"Research Scientist at Google DeepMind",handle:"tkipf",associated:"",verified:"blue",joinedDate:"Jun 2009",bioTags:["Robotics","Neural Networks"],bio:"Sr. Staff RS at @GoogleDeepMind. Veo Team. Priors: GNNs, Structured World Models, Neural Assets, Veo Ingredients Co-Lead, Veo Robotics",followers:28851,following:1387,location:"San Francisco, CA",website:"https://scholar.google.com/citations?user=83HL5FwAAAAJ",imageUrl:"https://pbs.twimg.com/profile_images/1925727886264184832/DPIJ1grK_400x400.jpg"},{id:"boazbaraktcs",name:"Boaz Barak",group:"researcher",role:"Professor at Harvard",handle:"boazbaraktcs",associated:"",verified:"blue",joinedDate:"Jan 2020",bioTags:[],bio:`Computer Scientist. See also https://t.co/EXWR5k634w .
@harvard @openai opinions my own.`,followers:28717,following:702,location:"Cambridge, MA",website:"https://www.boazbarak.org/",imageUrl:"https://pbs.twimg.com/profile_images/1252262363132280834/ytIN-vzv_400x400.jpg"},{id:"thsottiaux",name:"Tibo",group:"founder",role:"OpenAI",handle:"thsottiaux",associated:"",verified:"blue",joinedDate:"Aug 2025",bioTags:[],bio:"Codex @OpenAI",followers:28496,following:52,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1953339828738899968/WWQlU2RT_400x400.jpg"},{id:"nickaturley",name:"Nick Turley",group:"founder",role:"vp & head of @chatgptapp",handle:"nickaturley",associated:"",verified:"blue",joinedDate:"Mar 2013",bioTags:["GPT"],bio:"vp & head of @chatgptapp",followers:27562,following:898,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1956499252764672000/HFL-mLAj_400x400.jpg"},{id:"jsuarez",name:"Joseph Suarez ",group:"researcher",role:"Founder at MIT",handle:"jsuarez",associated:"",verified:"blue",joinedDate:"Mar 2019",bioTags:["LLMs","Neural Networks","Founder"],bio:"I build sane open-source RL tools. MIT PhD, creator of Neural MMO and founder of PufferAI. DM for business: non-LLM sim engineering, RL R&D, infra & support.",followers:27294,following:115,location:"",website:"https://puffer.ai",imageUrl:"https://pbs.twimg.com/profile_images/1513561864524939267/X2E-h1d4_400x400.jpg"},{id:"zicokolter",name:"Zico Kolter",group:"researcher",role:"Professor at CMU",handle:"zicokolter",associated:"",verified:"blue",joinedDate:"Mar 2017",bioTags:["Professor"],bio:"Professor and Head of Machine Learning Department at @CarnegieMellon. Board member @OpenAI and @Qualcomm. Chief Scientist @GraySwanAI.",followers:27272,following:721,location:"Pittsburgh, PA",website:"http://zicokolter.com",imageUrl:"https://pbs.twimg.com/profile_images/1821507829406007297/IIrL9ky5_400x400.jpg"},{id:"rao2z",name:"Subbarao Kambhampati ( )",group:"researcher",role:"Professor at ASU",handle:"rao2z",associated:"",verified:"blue",joinedDate:"Oct 2014",bioTags:["Research"],bio:"AI researcher & teacher @SCAI_ASU.  Former President of @RealAAAI; Chair of @AAAS Sec T. Here to tweach #AI. YouTube Ch: https://t.co/4beUPOmf6y Bsky: rao2z",followers:26892,following:57,location:"Tempe, AZ",website:"http://rakaposhi.eas.asu.edu",imageUrl:"https://pbs.twimg.com/profile_images/1240088892751007745/zFdWaIFe_400x400.jpg"},{id:"zeyuanallenzhu",name:"Zeyuan Allen-Zhu, Sc.D.",group:"founder",role:"Meta",handle:"ZeyuanAllenZhu",associated:"",verified:"blue",joinedDate:"Apr 2010",bioTags:[],bio:`physics of language models @ Meta (FAIR at MSL, not GenAI or TBD)
Tsinghua Physics  MIT CSAIL  Princeton/IAS
IOI x 2  ICPC  USACO  Codejam  math MCM`,followers:25291,following:531,location:"",website:"http://zeyuan.allen-zhu.com",imageUrl:"https://pbs.twimg.com/profile_images/1777537825493426176/OYHinr5A_400x400.jpg"},{id:"nvidia_ai_pc",name:"NVIDIA AI PC",group:"company",role:"NVIDIA AI PC",handle:"NVIDIA_AI_PC",associated:"",verified:"blue",joinedDate:"Nov 2024",bioTags:[],bio:"NVIDIA Powers the World's AI. And Yours with RTX AI PCs.  #AIonRTX",followers:24577,following:22,location:"",website:"https://www.nvidia.com/en-us/ai-on-rtx/",imageUrl:"https://pbs.twimg.com/profile_images/1856713042689482752/yF_VW5Zc_400x400.jpg"},{id:"jm_alexia",name:"Alexia Jolicoeur-Martineau",group:"researcher",role:"Research Scientist",handle:"jm_alexia",associated:"",joinedDate:"Mar 2017",bioTags:["Research"],bio:`AI Researcher  
2025 ARC Prize Winner

I build generative AI for images, videos, text, tabular data, weights, molecules, and video games.`,followers:24423,following:2086,location:"Montral, Qubec",website:"http://ajolicoeur.wordpress.com",imageUrl:"https://pbs.twimg.com/profile_images/1480318038427803651/i_-ZNnjh_400x400.jpg"},{id:"alexwei_",name:"Alexander Wei",group:"researcher",role:"OpenAI",handle:"alexwei_",associated:"",verified:"blue",joinedDate:"Mar 2022",bioTags:[],bio:`Reasoning @OpenAI.

Co-built CICERO @MetaAI | @Berkeley_AI PhD '23 | @Harvard '20`,followers:24410,following:203,location:"San Francisco, CA",website:"https://www.alexwei.org",imageUrl:"https://pbs.twimg.com/profile_images/1695738958041493504/OkFyoThU_400x400.jpg"},{id:"nvidiaomniverse",name:"NVIDIA Omniverse",group:"company",role:"NVIDIA Omniverse Platform",handle:"nvidiaomniverse",associated:"",verified:"blue",joinedDate:"Oct 2020",bioTags:[],bio:"The official handle for #NVIDIAOmniverse. The platform for developing #OpenUSD applications for industrial digitalization and generative physical #AI.",followers:24121,following:318,location:"",website:"https://www.nvidia.com/omniverse",imageUrl:"https://pbs.twimg.com/profile_images/1864432630059683841/FbTveajA_400x400.jpg"},{id:"ctnzr",name:"Bryan Catanzaro",group:"founder",role:"VP at NVIDIA",handle:"ctnzr",associated:"",verified:"blue",joinedDate:"Feb 2011",bioTags:["Deep Learning","Research"],bio:"VP, Applied Deep Learning Research @ NVIDIA",followers:23958,following:473,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1699513548647596032/QZ3dWSYh_400x400.jpg"},{id:"embirico",name:"Alexander Embiricos",group:"founder",role:"OpenAI",handle:"embirico",associated:"",verified:"blue",joinedDate:"Nov 2011",bioTags:[],bio:"Codex @OpenAI",followers:23943,following:1025,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1649509163712561153/mTxQ1REO_400x400.jpg"},{id:"ericzelikman",name:"Eric Zelikman",group:"researcher",role:"Co-founder & CEO at stanford",handle:"ericzelikman",associated:"",verified:"blue",joinedDate:"Apr 2010",bioTags:["Founder"],bio:"cofounder & ceo @humansand - building ai for humans // was lgtm-ing @xAI, phd-ing @stanford",followers:23532,following:1988,location:"",website:"http://humansand.ai",imageUrl:"https://pbs.twimg.com/profile_images/2012725421796626432/TNRRFUS5_400x400.jpg"},{id:"wightmanr",name:"Ross Wightman",group:"founder",role:"Computer Vision @ ",handle:"wightmanr",associated:"",verified:"blue",joinedDate:"Apr 2012",bioTags:["Vision","Startup"],bio:"Computer Vision @ . Ex head of Software, Firmware Engineering at a Canadian . Currently building ML, AI systems or investing in startups that do it better.",followers:23400,following:1339,location:"Vancouver, BC",website:"http://rwightman.com/",imageUrl:"https://pbs.twimg.com/profile_images/769304549135880192/gUzKgYuk_400x400.jpg"},{id:"sashamtl",name:"Sasha Luccioni, PhD ",group:"founder",role:"HuggingFace",handle:"SashaMTL",associated:"",joinedDate:"Jan 2015",bioTags:[],bio:"Climate & AI Lead of @HuggingFace | Member of ClimateChangeAI | @TEDTalks speaker . (She/her/Dr/)",followers:22589,following:3642,location:"Tiohti:ke Montral",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1704612826797498368/OSpePMlj_400x400.jpg"},{id:"alexgdimakis",name:"Alex Dimakis",group:"researcher",role:"Professor at UT Austin",handle:"AlexGDimakis",associated:"",verified:"blue",joinedDate:"Apr 2009",bioTags:["Founder","Professor"],bio:"Professor, UC berkeley | Founder @bespokelabsai |",followers:22487,following:2467,location:"Berkeley, CA",website:"https://people.eecs.berkeley.edu/~alexdimakis/",imageUrl:"https://pbs.twimg.com/profile_images/542926798338543617/KwlwoJRr_400x400.jpeg"},{id:"simpsoka",name:"Kath Korevec",group:"company",role:"CTO at Google",handle:"simpsoka",associated:"",verified:"blue",joinedDate:"Jun 2007",bioTags:[],bio:"Director of Product at Google Labs. Code AI. Dive in  @googlelabs, @stitchbygoogle, and @julesagent Previously @vercel, @github and @heroku",followers:22088,following:569,location:"",website:"https://kathy.pm/",imageUrl:"https://pbs.twimg.com/profile_images/1994103983762493443/DQL9pgB7_400x400.jpg"},{id:"kalomaze",name:"kalomaze",group:"researcher",role:"Researcher",handle:"kalomaze",associated:"",verified:"blue",joinedDate:"Oct 2020",bioTags:["Research"],bio:"ML researcher (@primeintellect), speculator  extremely silly jester",followers:22031,following:2490,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1998312107968995328/mVy3lsqU_400x400.jpg"},{id:"nvidiagtc",name:"NVIDIA GTC",group:"company",role:"NVIDIA GTC Conference",handle:"NVIDIAGTC",associated:"",verified:"blue",joinedDate:"Sep 2020",bioTags:[],bio:`Register for the premier global AI conference. 

Join us March 16-19 in San Jose, CA.`,followers:21962,following:204,location:"",website:"https://www.nvidia.com/gtc/",imageUrl:"https://pbs.twimg.com/profile_images/1861543899925565440/DGTkc_RB_400x400.jpg"},{id:"risingsayak",name:"Sayak Paul",group:"founder",role:"ML at Hugging Face ",handle:"RisingSayak",associated:"",verified:"blue",joinedDate:"May 2012",bioTags:[],bio:"ML at Hugging Face ",followers:21768,following:125,location:"Earth",website:"https://sayak.dev/",imageUrl:"https://pbs.twimg.com/profile_images/1485518937404350464/DYrpvgPr_400x400.jpg"},{id:"brentm_spacex",name:"Brent Mayo",group:"founder",role:"SpaceX",handle:"BrentM_SpaceX",associated:"",verified:"blue",joinedDate:"Mar 2022",bioTags:[],bio:"xAI Engineer/SpaceX Engineer",followers:21706,following:198,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1886989226807353344/1bbJImwi_400x400.jpg"},{id:"adocomplete",name:"Ado",group:"founder",role:"Community, Claude, Code at @AnthropicAI",handle:"adocomplete",associated:"",verified:"blue",joinedDate:"Dec 2011",bioTags:[],bio:"Community, Claude, Code at @AnthropicAI",followers:21614,following:1433,location:"Colorado",website:"https://adocomplete.com",imageUrl:"https://pbs.twimg.com/profile_images/2006485392326004737/EMUfrfo8_400x400.jpg"},{id:"geoffreylitt",name:"Geoffrey Litt",group:"founder",role:"",handle:"geoffreylitt",associated:"",verified:"blue",joinedDate:"Nov 2010",bioTags:[],bio:"malleable software @NotionHQ / prev @inkandswitch, @MIT_CSAIL / ",followers:21588,following:1768,location:"Washington, DC",website:"https://www.geoffreylitt.com",imageUrl:"https://pbs.twimg.com/profile_images/722626068293763072/4erM-SPN_400x400.jpg"},{id:"koraykv",name:"koray kavukcuoglu",group:"researcher",role:"VP Research at Google DeepMind",handle:"koraykv",associated:"",verified:"blue",joinedDate:"Oct 2012",bioTags:[],bio:`Chief AI Architect, Google.
CTO, Google DeepMind`,followers:21543,following:102,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1952910128388423681/lMRfGHmB_400x400.jpg"},{id:"nvidiacc",name:"NVIDIA Customer Care",group:"company",role:"NVIDIA Customer Care",handle:"nvidiacc",associated:"",verified:"blue",joinedDate:"Oct 2009",bioTags:[],bio:"Official Twitter account for NVIDIA Customer Care.  We are here to help answer your technical questions and provide troubleshooting assistance.",followers:20937,following:92,location:"Santa Clara, California",website:"http://www.nvidia.com/nvcc",imageUrl:"https://pbs.twimg.com/profile_images/1580315776291987457/k_wGXsXP_400x400.jpg"},{id:"hannawallach",name:"Hanna Wallach (@hannawallach.bsky.social)",group:"researcher",role:"Senior Principal Researcher at Microsoft",handle:"hannawallach",associated:"",joinedDate:"Sep 2012",bioTags:["Research","Founder"],bio:"Microsoft Research NYC. Fairness, accountability & transparency in AI/ML. NeurIPS & ICML board member, WiML co-founder, sloth enthusiast. She/her.",followers:20795,following:906,location:"Brooklyn, NY",website:"http://dirichlet.net/",imageUrl:"https://pbs.twimg.com/profile_images/2623320981/kinlr53ma1flkp9jerk4_400x400.jpeg"},{id:"remicadene",name:"Remi Cadene",group:"founder",role:"Co-founder & CEO",handle:"RemiCadene",associated:"",verified:"blue",joinedDate:"Feb 2014",bioTags:["Founder"],bio:`Co-Founder and CEO at @UMA_Robots 

Building on top of @LeRobotHF`,followers:20680,following:1027,location:"Paris",website:"http://remicadene.com",imageUrl:"https://pbs.twimg.com/profile_images/1673900473190088704/ZKYHtzBs_400x400.jpg"},{id:"maithra_raghu",name:"Maithra Raghu",group:"researcher",role:"Research Scientist at Google",handle:"maithra_raghu",associated:"",verified:"blue",joinedDate:"Jul 2017",bioTags:["Research","Founder"],bio:"Cofounder and CEO @Samaya_AI. Formerly Research Scientist Google Brain (@GoogleAI), PhD in ML @Cornell.",followers:20365,following:525,location:"",website:"http://maithraraghu.com",imageUrl:"https://pbs.twimg.com/profile_images/1705088879618121728/Q4HZKfqt_400x400.jpg"},{id:"agarwl_",name:"Rishabh Agarwal",group:"company",role:"Meta",handle:"agarwl_",associated:"",verified:"blue",joinedDate:"May 2016",bioTags:[],bio:"Reinforcement Learner @periodiclabs, Adjunct Prof at McGill. Ex Meta, DeepMind, Brain, @iitbombay. NeurIPS Best Paper, On-Policy Distillation",followers:20273,following:828,location:"Montral, Canada",website:"https://agarwl.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1347289900916346886/khqL_K4W_400x400.jpg"},{id:"xwang_lk",name:"Xin Eric Wang",group:"researcher",role:"CTO & Professor",handle:"xwang_lk",associated:"",verified:"blue",joinedDate:"Feb 2012",bioTags:["NLP","Research","Professor"],bio:"Professor @ucsantabarbara. Head of Research @SimularAI. Director @ucsbcrml. Co-Director @ucsbNLP. #Multimodal #AgenticAI. AI for Humanity.",followers:19843,following:1340,location:"Santa Barbara, CA",website:"https://eric-xw.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1998441772343828480/2TR-PwPq_400x400.jpg"},{id:"heinrichkuttler",name:"heiner",group:"researcher",role:"DeepMind",handle:"HeinrichKuttler",associated:"",verified:"blue",joinedDate:"May 2020",bioTags:[],bio:"Supercomputing lead @xAI. Previously: @InflectionAI, @AIatMeta, @DeepMind, @Google, @LMU_Muenchen, PhD math-ph. Opinions my own. (Can be yours for a small fee.)",followers:19775,following:1174,location:"Palo Alto, CA",website:"https://heiner.ai",imageUrl:"https://pbs.twimg.com/profile_images/1455656517433233418/CcpIm10n_400x400.jpg"},{id:"sammcallister",name:"sam mcallister",group:"founder",role:"some people call me smca",handle:"sammcallister",associated:"",verified:"blue",joinedDate:"Sep 2009",bioTags:[],bio:"some people call me smca. technical non technical member of staff at @anthropicai. prev at stripe. ",followers:19295,following:995,location:"london",website:"https://smca.io",imageUrl:"https://pbs.twimg.com/profile_images/1989346628981886976/7W-5noSE_400x400.jpg"},{id:"jfpuget",name:"JFPuget ",group:"researcher",role:"Nvidia",handle:"JFPuget",associated:"",verified:"blue",joinedDate:"Mar 2012",bioTags:[],bio:"Machine Learning at @Nvidia, 6x Kaggle Grandmaster CPMP. Arc Prize winner.  ML PhD. Ex ENS Ulm, ILOG CPLEX, IBM. Views are my own.",followers:19138,following:1473,location:"France ",website:"https://www.kaggle.com/cpmpml",imageUrl:"https://pbs.twimg.com/profile_images/2065763037/JFP2_400x400.jpg"},{id:"catherineols",name:"Catherine Olsson",group:"researcher",role:"Safety Team at Anthropic",handle:"catherineols",associated:"",verified:"blue",joinedDate:"May 2010",bioTags:[],bio:`Hanging out with Claude, improving its behavior, and building tools to support that @AnthropicAI 

prev: @open_phil @googlebrain @openai (@microcovid)`,followers:18988,following:1442,location:"San Francisco",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1557826463281295360/7NIHBVko_400x400.jpg"},{id:"aprilwright",name:"April C Wright",group:"founder",role:"The Infosec Diplomat, Absurdist Polymath",handle:"aprilwright",associated:"",verified:"blue",joinedDate:"Jul 2008",bioTags:[],bio:"The Infosec Diplomat, Absurdist Polymath. AI philosopher. Reality-Auditor. Hacker, Author @oreilly. Privacy, ethics, chaotic good",followers:18467,following:4685,location:"@aprilwright@infosec.exchange",website:"http://architectsecurity.org",imageUrl:"https://pbs.twimg.com/profile_images/1145376020582846464/SMe_UIaH_400x400.jpg"},{id:"nielsrogge",name:"Niels Rogge",group:"founder",role:"huggingface",handle:"NielsRogge",associated:"",joinedDate:"Apr 2010",bioTags:["Deep Learning"],bio:"ML Engineer @ML6team @huggingface. @KU_Leuven grad. General interest in machine learning, deep learning. Making AI more accessible for everyone!",followers:18424,following:721,location:"Belgium",website:"http://nielsrogge.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1828883496066060288/n0OUAXhz_400x400.jpg"},{id:"nvidiadrive",name:"NVIDIA DRIVE",group:"company",role:"NVIDIA Autonomous Vehicles",handle:"NVIDIADRIVE",associated:"",verified:"blue",joinedDate:"Aug 2016",bioTags:[],bio:"Transforming transportation with #AI. Follow us for the latest in #autonomousvehicle development and news from our ecosystem.",followers:18358,following:199,location:"Santa Clara, CA",website:"https://nvda.ws/4nTbgMH",imageUrl:"https://pbs.twimg.com/profile_images/1869449601054642176/bkq2Xk6f_400x400.jpg"},{id:"_lewtun",name:"Lewis Tunstall",group:"founder",role:"huggingface",handle:"_lewtun",associated:"",verified:"blue",joinedDate:"Aug 2018",bioTags:[],bio:" post-training @huggingface",followers:18008,following:559,location:"Berne, Switzerland",website:"https://transformersbook.com/",imageUrl:"https://pbs.twimg.com/profile_images/1097405296543236096/gS2C7RIq_400x400.jpg"},{id:"nvidiakorea",name:"NVIDIA Korea",group:"company",role:"NVIDIA Korea",handle:"NVIDIAKorea",associated:"",verified:"blue",joinedDate:"Mar 2011",bioTags:[],bio:"(AI)  , NVIDIA   .   ,   ,         .",followers:17890,following:19221,location:"Seoul",website:"http://www.nvidia.co.kr",imageUrl:"https://pbs.twimg.com/profile_images/1859409007964049408/YDtyXcL4_400x400.jpg"},{id:"azaliamirh",name:"Azalia Mirhoseini",group:"researcher",role:"Research Scientist at Google",handle:"Azaliamirh",associated:"",verified:"blue",joinedDate:"May 2013",bioTags:["Founder"],bio:"Founder @RicursiveAI, Asst. Prof. of CS at Stanford. Prev: DeepMind, Anthropic, Brain. Co-Creator of MoEs, AlphaChip, Test Time Scaling Laws.",followers:17797,following:590,location:"Stanford, CA",website:"https://scalingintelligence.stanford.edu/",imageUrl:"https://pbs.twimg.com/profile_images/1143526877425889281/LlHltTnh_400x400.png"},{id:"wimlworkshop",name:"WiML",group:"company",role:"Women in ML Workshop",handle:"WiMLworkshop",associated:"",joinedDate:"Nov 2014",bioTags:["Research"],bio:"Women in Machine Learning organization. Maintains a list of women in ML. Profiles the research of women in ML. Annual workshop and other events.",followers:17628,following:1146,location:"",website:"http://wimlworkshop.org",imageUrl:"https://pbs.twimg.com/profile_images/676406388994809857/Eqh4OcKw_400x400.png"},{id:"nvidiageforcepl",name:"NVIDIA GeForce PL",group:"company",role:"NVIDIA Poland",handle:"NVIDIAGeForcePL",associated:"",verified:"blue",joinedDate:"Dec 2009",bioTags:[],bio:"Przedstawiamy karty graficzne i laptopy z serii GeForce RTX 50, oparte na architekturze NVIDIA Blackwell i sztucznej inteligencji.",followers:17393,following:225,location:"Polska",website:"http://www.nvidia.pl",imageUrl:"https://pbs.twimg.com/profile_images/2011091998577471488/Axqnq1IV_400x400.jpg"},{id:"shamkakade6",name:"Sham Kakade",group:"researcher",role:"Professor at Harvard",handle:"ShamKakade6",associated:"",verified:"blue",joinedDate:"Dec 2018",bioTags:["Professor"],bio:`Harvard Professor. 
Full stack ML and AI. 
Co-director of  the Kempner Institute for the Study of Artificial and Natural Intelligence.`,followers:17260,following:546,location:"",website:"https://shamulent.github.io",imageUrl:"https://pbs.twimg.com/profile_images/1069108450716762112/8x6xXf4a_400x400.jpg"},{id:"majmudaradam",name:"adammaj",group:"founder",role:"openai",handle:"MajmudarAdam",associated:"",verified:"blue",joinedDate:"Oct 2019",bioTags:["Research"],bio:"research @openai // on leave @penn",followers:17243,following:272,location:"SF",website:"http://adammaj.com",imageUrl:"https://pbs.twimg.com/profile_images/1794879458375352320/CE7oX1gI_400x400.jpg"},{id:"realmadhuguru",name:"Madhu Guru",group:"founder",role:"Google",handle:"realmadhuguru",associated:"",verified:"blue",joinedDate:"Nov 2021",bioTags:[],bio:"Product Leader at Google - Gemini, Veo, Nano Banana. All opinions mine.",followers:15876,following:205,location:"Silicon Valley",website:"http://madhuguru.substack.com",imageUrl:"https://pbs.twimg.com/profile_images/1487465096242737157/AL-7r3o0_400x400.jpg"},{id:"lm_zheng",name:"Lianmin Zheng",group:"founder",role:"Co-founder",handle:"lm_zheng",associated:"",verified:"blue",joinedDate:"Jan 2018",bioTags:["Founder"],bio:"Member of technical staff @xAI | Prev: Ph.D. @UCBerkeley, Co-founder @lmsysorg",followers:15563,following:646,location:"Bay Area, California",website:"http://lmzheng.net/",imageUrl:"https://pbs.twimg.com/profile_images/1107058309994024960/kUJgsrqM_400x400.jpg"},{id:"douwekiela",name:"Douwe Kiela",group:"researcher",role:"Professor at Cambridge",handle:"douwekiela",associated:"",verified:"blue",joinedDate:"Jul 2013",bioTags:[],bio:"@ContextualAI CEO, @Stanford Adjunct Prof.",followers:14921,following:447,location:"Bay Area",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1674853389702922240/RLHeLihs_400x400.jpg"},{id:"jerrod_lew",name:"Jerrod Lew",group:"media",role:"Artist, creator and educator",handle:"jerrod_lew",associated:"",verified:"blue",joinedDate:"May 2023",bioTags:[],bio:`Artist, creator and educator.
Teaching you to tell stories without limits. 
Consider subscribing to my newsletter: https://t.co/cZx6ICaXDN`,followers:14872,following:2764,location:"Australia",website:"https://jerrodlew.com/",imageUrl:"https://pbs.twimg.com/profile_images/1992346776167157760/muDTFMjy_400x400.jpg"},{id:"zjasper",name:"Jasper",group:"company",role:"Co-founder & CEO",handle:"zjasper",associated:"",verified:"blue",joinedDate:"Nov 2018",bioTags:["Founder"],bio:"Co-founder and CEO @Hyperbolic_Labs. ex-@avax & ex-@citsecurities. Finished Math PhD in 2yrs @UCBerkeley. Math Olympiad Gold Medalist. Highest honor @PKU1898",followers:14866,following:1727,location:"California, USA",website:"http://hyperbolic.ai",imageUrl:"https://pbs.twimg.com/profile_images/1929721010049503232/dCqfpEMX_400x400.jpg"},{id:"dileeplearning",name:"Dileep George",group:"researcher",role:"AI Researcher",handle:"dileeplearning",associated:"",verified:"blue",joinedDate:"Jun 2017",bioTags:["AGI","Research","Founder"],bio:"AGI research @DeepMind. Ex cofounder & CTO @vicariousai (acqd by Alphabet) and @Numenta. Triply EE (BTech IIT-Mumbai, MS&PhD Stanford). #AGIComics",followers:14834,following:1409,location:"San Francisco, CA",website:"http://dileeplearning.com",imageUrl:"https://pbs.twimg.com/profile_images/1039010552704450561/eq2xZkut_400x400.jpg"},{id:"nils_reimers",name:"Nils Reimers",group:"founder",role:"Cohere",handle:"Nils_Reimers",associated:"",verified:"blue",joinedDate:"Aug 2016",bioTags:[],bio:"VP AI Search @Cohere | ex-huggingface | Creator of SBERT (https://t.co/MKKOMfuQ4C)",followers:14747,following:519,location:"",website:"https://www.nils-reimers.de",imageUrl:"https://pbs.twimg.com/profile_images/1338879379552743424/WxlU4lqL_400x400.jpg"},{id:"avdnoord",name:"Aron van den Oord",group:"researcher",role:"Research Scientist at Google DeepMind",handle:"avdnoord",associated:"",verified:"blue",joinedDate:"Jan 2013",bioTags:["Research"],bio:`Lead of the GenMedia team working on Veo, Imagen, Genie, Nano Banana, ... 

Research Scientist @ DeepMind`,followers:14528,following:264,location:"London, England",website:"https://avdnoord.github.io/homepage",imageUrl:"https://pbs.twimg.com/profile_images/774282812576894976/IZUQ0T4s_400x400.jpg"},{id:"pashmerepat",name:"pash",group:"founder",role:"openai",handle:"pashmerepat",associated:"",verified:"blue",joinedDate:"Oct 2015",bioTags:[],bio:"codex @openai | prev head of ai @cline | @meta knowledge graph | creator of vault // @usc alum",followers:14407,following:597,location:"sf",website:"",imageUrl:"https://pbs.twimg.com/profile_images/2013776094382694400/nNX1AW2l_400x400.jpg"},{id:"hochreitersepp",name:"Sepp Hochreiter",group:"researcher",role:"LSTM Co-inventor",handle:"HochreiterSepp",associated:"",joinedDate:"Nov 2021",bioTags:["Deep Learning"],bio:"Pioneer of Deep Learning and known for vanishing gradient and the LSTM.",followers:14347,following:375,location:"",website:"https://www.nx-ai.com/",imageUrl:"https://pbs.twimg.com/profile_images/1463121437196267522/lT6EWJED_400x400.jpg"},{id:"rayhotate",name:"Ray Hotate ",group:"researcher",role:"Stanford",handle:"rayhotate",associated:"",verified:"blue",joinedDate:"Oct 2017",bioTags:["Research"],bio:"Member of Technical Staff @xAI / CS(AI)+Math @Stanford @StanfordAILab / prev PE @GoldmanSachs, Quant Research @ Cubist(Point72) / ,  '22 ",followers:14075,following:2095,location:"Stanford, California, USA",website:"https://soundcloud.com/user-211285881",imageUrl:"https://pbs.twimg.com/profile_images/1945740914414018561/7gxkDios_400x400.jpg"},{id:"lerobothf",name:"LeRobot",group:"company",role:"Robotics Platform",handle:"LeRobotHF",associated:"",verified:"blue",joinedDate:"Jul 2024",bioTags:["Robotics"],bio:`~ Lowering the barrier to entry for robotics ~
Crafted with care by @HuggingFace 
Join our discord: https://t.co/Sx2jdT0jeF`,followers:13975,following:19,location:"Worldwide",website:"http://github.com/huggingface/lerobot",imageUrl:"https://pbs.twimg.com/profile_images/1811131318534918144/Dk2D_okm_400x400.jpg"},{id:"andy_l_jones",name:"andy jones",group:"founder",role:"anthropic",handle:"andy_l_jones",associated:"",verified:"blue",joinedDate:"Oct 2012",bioTags:["Research"],bio:`engineering & research at anthropic.

i don't check twitter DMs. email me!`,followers:13857,following:350,location:"SF",website:"http://www.andyljones.com",imageUrl:"https://pbs.twimg.com/profile_images/1443344982346063872/shqMpAL-_400x400.jpg"},{id:"qhwang3",name:"Qian Huang",group:"researcher",role:"",handle:"qhwang3",associated:"",verified:"blue",joinedDate:"Mar 2017",bioTags:[],bio:"prev @xai | CS PhD student @StanfordAILab (on leave)",followers:13818,following:331,location:"Palo Alto, CA",website:"https://q-hwang.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1337167619816710149/Ydk4Ti_M_400x400.jpg"},{id:"koylanai",name:"Muratcan Koylan",group:"founder",role:"Context Engineer, Research Team @ https://t",handle:"koylanai",associated:"",verified:"blue",joinedDate:"Dec 2022",bioTags:["Research"],bio:`Context Engineer, Research Team @ https://t.co/ytKLwdts2F 

- ex AI Agent Systems Manager 99Ravens
- HCI & Marketing background
- Designing agent personas, autonomous workers`,followers:13778,following:3853,location:"Toronto, Canada ",website:"https://muratcankoylan.com/",imageUrl:"https://pbs.twimg.com/profile_images/2017468785473548288/43nF1d1X_400x400.jpg"},{id:"josh_tobin_",name:"Josh Tobin",group:"founder",role:"openai",handle:"josh_tobin_",associated:"",verified:"blue",joinedDate:"Jul 2011",bioTags:[],bio:"agents @openai",followers:13750,following:1200,location:"San Francisco, CA",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1413047908853714945/JcIRsBfy_400x400.jpg"},{id:"nvidiahealth",name:"NVIDIA Healthcare",group:"company",role:"NVIDIA Healthcare",handle:"NVIDIAHealth",associated:"",verified:"blue",joinedDate:"Oct 2020",bioTags:["Research"],bio:"The official handle for #NVIDIAHealthcare. Helping the scientific and developer community advance research, diagnostics, and patient care with #AI.",followers:13622,following:147,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1864479660530438144/NJZZqouX_400x400.jpg"},{id:"anshitasaini_",name:"Anshita Saini",group:"founder",role:"openai",handle:"anshitasaini_",associated:"",verified:"blue",joinedDate:"Feb 2023",bioTags:["GPT"],bio:"chatgpt growth eng @openai",followers:13559,following:422,location:"san francisco",website:"https://www.linkedin.com/in/anshita-saini/",imageUrl:"https://pbs.twimg.com/profile_images/1876046732972425216/74rHzKjF_400x400.jpg"},{id:"pirroh",name:"Michele Catasta",group:"founder",role:"President & Head of AI @Replit",handle:"pirroh",associated:"",verified:"blue",joinedDate:"Feb 2009",bioTags:[],bio:"President & Head of AI @Replit |  @",followers:13286,following:246,location:"SF Bay Area, CA",website:"https://pirroh.fyi",imageUrl:"https://pbs.twimg.com/profile_images/1921747874922045440/wAkYCjVY_400x400.jpg"},{id:"ancadianadragan",name:"Anca Dragan",group:"researcher",role:"Professor at UC Berkeley",handle:"ancadianadragan",associated:"",verified:"blue",joinedDate:"Mar 2018",bioTags:["AI Safety","Alignment","Professor"],bio:"post training co-lead at Google DeepMind, focusing on safety, alignment, post training capabilities  associate professor at UC Berkeley EECS",followers:13227,following:184,location:"San Francisco, CA",website:"http://www.ancadragan.com",imageUrl:"https://pbs.twimg.com/profile_images/1026125638149664769/mKpHuJIA_400x400.jpg"},{id:"kalinowski007",name:"Caitlin Kalinowski",group:"founder",role:"OpenAI",handle:"kalinowski007",associated:"",verified:"blue",joinedDate:"Aug 2012",bioTags:["Robotics"],bio:"Robotics @ OpenAI. Axon Board. Classical liberal: rule of law, pro-innovation. ",followers:13114,following:1399,location:"",website:"https://openai.com/careers/",imageUrl:"https://pbs.twimg.com/profile_images/1938988827353255936/tVnKoAVN_400x400.jpg"},{id:"skildai",name:"Skild AI",group:"company",role:"Robotics AI",handle:"SkildAI",associated:"",verified:"blue",joinedDate:"Jun 2023",bioTags:[],bio:`Any robot. Any task. One brain.

Help build general-purpose robotic intelligence at https://t.co/UKh2kQYSqt`,followers:13022,following:0,location:"USA",website:"https://www.skild.ai/",imageUrl:"https://pbs.twimg.com/profile_images/1810545385183526912/YWRcgcha_400x400.jpg"},{id:"adinayakup",name:"Adina Yakup",group:"founder",role:"huggingface",handle:"AdinaYakup",associated:"",verified:"blue",joinedDate:"Apr 2023",bioTags:[],bio:`@huggingface  |  opinions are my own
  Chinese ML community`,followers:12685,following:876,location:"",website:"http://huggingface.co/AdinaY",imageUrl:"https://pbs.twimg.com/profile_images/1974110789146718209/j2fGFMxT_400x400.jpg"},{id:"dspyoss",name:"DSPy",group:"company",role:"LLM Programming Framework",handle:"DSPyOSS",associated:"",verified:"blue",joinedDate:"Apr 2025",bioTags:["LLMs"],bio:"An open-source declarative framework for building modular AI software. Programmingnot promptingLLMs via higher-level abstractions & optimizers.",followers:12679,following:58,location:"",website:"https://dspy.ai",imageUrl:"https://pbs.twimg.com/profile_images/1915049493319553024/2sK1w7YZ_400x400.jpg"},{id:"tulseedoshi",name:"Tulsee Doshi",group:"founder",role:"CTO at Stanford",handle:"tulseedoshi",associated:"",verified:"blue",joinedDate:"Jun 2012",bioTags:[],bio:"Sr. Director & Product Lead, Gemini Models @GoogleDeepmind. @Stanford CS. Opinions my own.",followers:12493,following:492,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1234374883284377600/MN4p28RV_400x400.jpg"},{id:"felixhill84",name:"Felix Hill",group:"researcher",role:"Research Scientist at Google DeepMind",handle:"FelixHill84",associated:"",joinedDate:"Jul 2010",bioTags:["Research"],bio:`Research Scientist, Deepmind

I try to think hard about everything I tweet, esp on 90s football and 80s music

None of my opinions are really someone else's`,followers:12389,following:740,location:"London, England",website:"https://fh295.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1847905415264194561/l5r92XJk_400x400.jpg"},{id:"guohao_li",name:"Guohao Li ",group:"founder",role:"Oxford",handle:"guohao_li",associated:"",verified:"blue",joinedDate:"Aug 2018",bioTags:[],bio:"@Eigent_AI / @CamelAIOrg. Finding the Scaling Laws of Agents. Prev Oxford, KAUST, ETHz, Intel, Kumo.",followers:12084,following:2222,location:"",website:"https://www.eigent.ai/",imageUrl:"https://pbs.twimg.com/profile_images/1237407213502816256/P2FgBNP1_400x400.jpg"},{id:"yanndubs",name:"Yann Dubois",group:"company",role:"OpenAI",handle:"yanndubs",associated:"",verified:"blue",joinedDate:"Aug 2017",bioTags:[],bio:"Posttraining @OpenAI |  PhD @StanfordAILab",followers:11968,following:1295,location:"San Francisco",website:"https://yanndubs.github.io/",imageUrl:"https://pbs.twimg.com/profile_images/1953964095897817088/OcK0_8hf_400x400.jpg"},{id:"imhaotian",name:"Haotian Liu",group:"founder",role:"building intelligence @xAI",handle:"imhaotian",associated:"",verified:"blue",joinedDate:"Dec 2013",bioTags:["AGI","Research"],bio:"building intelligence @xAI. @grok omni/imagine/vision. creator of #LLaVA, prev. @MSFTResearch @UWMadison",followers:11852,following:523,location:"Cupertino, CA",website:"https://hliu.cc/",imageUrl:"https://pbs.twimg.com/profile_images/1553103157328318464/yMl-EUCs_400x400.jpg"},{id:"nvidiaaijp",name:"NVIDIA AI Japan",group:"company",role:"NVIDIA AI Japan",handle:"NVIDIAAIJP",associated:"",verified:"blue",joinedDate:"Nov 2016",bioTags:[],bio:`  AI () 


GPU `,followers:11812,following:166,location:"",website:"http://www.nvidia.co.jp/object/deep-learning-jp.html",imageUrl:"https://pbs.twimg.com/profile_images/1862300808299040768/CRGUYXSf_400x400.jpg"},{id:"itstkai",name:"Tristan",group:"researcher",role:"Researcher at OpenAI",handle:"ItsTKai",associated:"",joinedDate:"Apr 2025",bioTags:["Research"],bio:"Researcher @OpenAI - Opinions are my own.",followers:11769,following:1508,location:"",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1911405669472743424/ixRAFv3N_400x400.jpg"},{id:"_nateraw",name:"Nate Raw",group:"founder",role:"huggingface",handle:"_nateraw",associated:"",verified:"blue",joinedDate:"Jan 2017",bioTags:[],bio:"machine learning hacker @splice. previously @huggingface @lightningai",followers:9526,following:1603,location:"Austin, TX",website:"https://github.com/nateraw",imageUrl:"https://pbs.twimg.com/profile_images/1850951688040976384/7jhlOVvq_400x400.jpg"},{id:"khipu_ai",name:"khipu.ai",group:"company",role:"Latin American AI Community",handle:"Khipu_AI",associated:"",verified:"blue",joinedDate:"Dec 2018",bioTags:[],bio:"Strengthening the artificial intelligence and machine learning communities in Latin America.",followers:6599,following:86,location:"Latin America",website:"http://khipu.ai",imageUrl:"https://pbs.twimg.com/profile_images/1551644240236761097/aWTNjGYU_400x400.jpg"},{id:"anujsaharan_",name:"Anuj Saharan",group:"founder",role:"openai",handle:"anujsaharan_",associated:"",verified:"blue",joinedDate:"Mar 2010",bioTags:[],bio:"orange vanilla coke enthusiast; superduperintelligence infra @openai",followers:3442,following:281,location:"seattle",website:"",imageUrl:"https://pbs.twimg.com/profile_images/1886036352564879360/6ACJNkIC_400x400.jpg"}],links:[{source:"openai",target:"openainewsroom"},{source:"openai",target:"openaidevs"},{source:"openai",target:"chatgptapp"},{source:"lexfridman",target:"karpathy"},{source:"lexfridman",target:"ylecun"},{source:"lexfridman",target:"thsottiaux"},{source:"lexfridman",target:"moltbook"},{source:"lexfridman",target:"bcherny"},{source:"lexfridman",target:"openclaw"},{source:"lexfridman",target:"steipete"},{source:"lexfridman",target:"chrmanning"},{source:"lexfridman",target:"lateinteraction"},{source:"lexfridman",target:"askalphaxiv"},{source:"lexfridman",target:"mmbronstein"},{source:"lexfridman",target:"svlevine"},{source:"lexfridman",target:"neuripsconf"},{source:"sama",target:"karpathy"},{source:"sama",target:"gdb"},{source:"sama",target:"austen"},{source:"sama",target:"levie"},{source:"sama",target:"alexandr_wang"},{source:"sama",target:"emostaque"},{source:"sama",target:"esyudkowsky"},{source:"sama",target:"palmerluckey"},{source:"sama",target:"pashmerepat"},{source:"sama",target:"boazbaraktcs"},{source:"sama",target:"merettm"},{source:"sama",target:"thsottiaux"},{source:"sama",target:"embirico"},{source:"sama",target:"yanndubs"},{source:"sama",target:"anshitasaini_"},{source:"sama",target:"yacinemtb"},{source:"sama",target:"itstkai"},{source:"sama",target:"chatgpt21"},{source:"sama",target:"_mohansolo"},{source:"sama",target:"majmudaradam"},{source:"sama",target:"anujsaharan_"},{source:"sama",target:"timzaman"},{source:"sama",target:"deryatr_"},{source:"sama",target:"khoomeik"},{source:"satyanadella",target:"bradsmi"},{source:"satyanadella",target:"surface"},{source:"satyanadella",target:"jeffteper"},{source:"satyanadella",target:"azure"},{source:"satyanadella",target:"jamesmontemagno"},{source:"satyanadella",target:"gdb"},{source:"satyanadella",target:"code"},{source:"satyanadella",target:"clementdelangue"},{source:"satyanadella",target:"matthewberman"},{source:"satyanadella",target:"mustafasuleyman"},{source:"satyanadella",target:"sebastienbubeck"},{source:"satyanadella",target:"mspartner"},{source:"nvidiageforce",target:"nvidianewsroom"},{source:"nvidiageforce",target:"nvidia_ai_pc"},{source:"nvidiageforce",target:"nvidiaomniverse"},{source:"nvidiageforce",target:"nvidiageforcejp"},{source:"levie",target:"alexandr_wang"},{source:"levie",target:"darioamodei"},{source:"levie",target:"suchenzang"},{source:"levie",target:"claudeai"},{source:"levie",target:"bcherny"},{source:"levie",target:"thsottiaux"},{source:"levie",target:"realmadhuguru"},{source:"nvidia",target:"nvidiageforce"},{source:"nvidia",target:"nvidiagfn"},{source:"nvidia",target:"nvidiageforceuk"},{source:"nvidia",target:"nvidiastudio"},{source:"nvidia",target:"nvidiageforcede"},{source:"nvidia",target:"nvidiaanz"},{source:"nvidia",target:"nvidiageforcetr"},{source:"nvidia",target:"nvidianewsroom"},{source:"nvidia",target:"nvidia_ai_pc"},{source:"nvidia",target:"nvidiashield"},{source:"nvidia",target:"nvidiageforcejp"},{source:"nvidia",target:"nvidiaaijp"},{source:"nvidia",target:"nvidiaomniverse"},{source:"nvidia",target:"nvidiahealth"},{source:"nvidia",target:"nvidiagtc"},{source:"nvidia",target:"nvidianetworkng"},{source:"nvidia",target:"nvidiaaidev"},{source:"nvidia",target:"nvidiadrive"},{source:"nvidia",target:"nvidiaai"},{source:"nvidia",target:"nvidiageforceme"},{source:"nvidia",target:"nvidiageforcefr"},{source:"nvidia",target:"nvidiageforcela"},{source:"nvidia",target:"nvidiakorea"},{source:"nvidia",target:"nvidiageforcees"},{source:"nvidia",target:"nvidiageforcepl"},{source:"nvidia",target:"nvidiajapan"},{source:"nvidia",target:"nvidiacc"},{source:"nvidia",target:"nvidiaworkstatn"},{source:"nvidia",target:"nvidiahpcdev"},{source:"nvidia",target:"nvidiadc"},{source:"nvidia",target:"nvidiarobotics"},{source:"nvidia",target:"nvidiageforcebr"},{source:"nvidia",target:"nvidiagamedev"},{source:"googleai",target:"googledeepmind"},{source:"googleai",target:"tensorflow"},{source:"googleai",target:"jeffdean"},{source:"googleai",target:"oriolvinyalsml"},{source:"googleai",target:"demishassabis"},{source:"googleai",target:"googleaistudio"},{source:"googleai",target:"officiallogank"},{source:"googleai",target:"tulseedoshi"},{source:"googleai",target:"joshwoodward"},{source:"googleai",target:"googlelabs"},{source:"googleai",target:"googleaidevs"},{source:"googleai",target:"geminiapp"},{source:"xai",target:"rayhotate"},{source:"xai",target:"brentm_spacex"},{source:"xai",target:"heinrichkuttler"},{source:"xai",target:"lm_zheng"},{source:"xai",target:"qhwang3"},{source:"xai",target:"imhaotian"},{source:"xai",target:"ericzelikman"},{source:"xai",target:"hendrycks"},{source:"xai",target:"tobyphln"},{source:"xai",target:"chrszegedy"},{source:"xai",target:"yuhu_ai_"},{source:"xai",target:"ibab"},{source:"karpathy",target:"ylecun"},{source:"karpathy",target:"fchollet"},{source:"karpathy",target:"hardmaru"},{source:"karpathy",target:"_akhaliq"},{source:"karpathy",target:"rasbt"},{source:"karpathy",target:"soumithchintala"},{source:"karpathy",target:"pytorch"},{source:"karpathy",target:"jeremyphoward"},{source:"karpathy",target:"ilyasut"},{source:"karpathy",target:"arankomatsuzaki"},{source:"karpathy",target:"giffmana"},{source:"karpathy",target:"woj_zaremba"},{source:"karpathy",target:"huggingface"},{source:"karpathy",target:"iamtrask"},{source:"karpathy",target:"jeffdean"},{source:"karpathy",target:"sirbayes"},{source:"karpathy",target:"moltbook"},{source:"karpathy",target:"kalomaze"},{source:"karpathy",target:"mitchellh"},{source:"karpathy",target:"steipete"},{source:"karpathy",target:"adocomplete"},{source:"karpathy",target:"bcherny"},{source:"karpathy",target:"nanobanana"},{source:"karpathy",target:"shamkakade6"},{source:"karpathy",target:"billpeeb"},{source:"karpathy",target:"alexgdimakis"},{source:"karpathy",target:"nickcammarata"},{source:"karpathy",target:"agarwl_"},{source:"karpathy",target:"askalphaxiv"},{source:"andrewyng",target:"ylecun"},{source:"andrewyng",target:"fchollet"},{source:"andrewyng",target:"hardmaru"},{source:"andrewyng",target:"rasbt"},{source:"andrewyng",target:"_akhaliq"},{source:"andrewyng",target:"omarsar0"},{source:"andrewyng",target:"pytorch"},{source:"andrewyng",target:"soumithchintala"},{source:"andrewyng",target:"jeremyphoward"},{source:"andrewyng",target:"arankomatsuzaki"},{source:"andrewyng",target:"richardsocher"},{source:"andrewyng",target:"iamtrask"},{source:"andrewyng",target:"huggingface"},{source:"andrewyng",target:"tensorflow"},{source:"andrewyng",target:"jeffdean"},{source:"andrewyng",target:"neuripsconf"},{source:"andrewyng",target:"moltbook"},{source:"andrewyng",target:"thsottiaux"},{source:"andrewyng",target:"claudeai"},{source:"andrewyng",target:"yuhu_ai_"},{source:"andrewyng",target:"bcherny"},{source:"googledeepmind",target:"ylecun"},{source:"googledeepmind",target:"andrewyng"},{source:"googledeepmind",target:"googleai"},{source:"googledeepmind",target:"demishassabis"},{source:"googledeepmind",target:"neuripsconf"},{source:"googledeepmind",target:"tensorflow"},{source:"googledeepmind",target:"oriolvinyalsml"},{source:"googledeepmind",target:"petarv_93"},{source:"googledeepmind",target:"sedielem"},{source:"googledeepmind",target:"gordic_aleksa"},{source:"googledeepmind",target:"felixhill84"},{source:"googledeepmind",target:"egrefen"},{source:"googledeepmind",target:"nandodf"},{source:"googledeepmind",target:"mustafasuleyman"},{source:"googledeepmind",target:"tulseedoshi"},{source:"googledeepmind",target:"officiallogank"},{source:"googledeepmind",target:"joshwoodward"},{source:"googledeepmind",target:"miles_brundage"},{source:"googledeepmind",target:"googleaidevs"},{source:"googledeepmind",target:"geminiapp"},{source:"googledeepmind",target:"googleuk"},{source:"googledeepmind",target:"googlelabs"},{source:"googledeepmind",target:"zoubinghahrama1"},{source:"googledeepmind",target:"mcgillu"},{source:"googledeepmind",target:"khipu_ai"},{source:"azure",target:"satyanadella"},{source:"stevenbjohnson",target:"amandaaskell"},{source:"stevenbjohnson",target:"karpathy"},{source:"stevenbjohnson",target:"joshwoodward"},{source:"stevenbjohnson",target:"officiallogank"},{source:"stevenbjohnson",target:"emollick"},{source:"stevenbjohnson",target:"jeffdean"},{source:"ylecun",target:"_akhaliq"},{source:"ylecun",target:"rasbt"},{source:"ylecun",target:"pytorch"},{source:"ylecun",target:"soumithchintala"},{source:"ylecun",target:"jeremyphoward"},{source:"ylecun",target:"csprofkgd"},{source:"ylecun",target:"giffmana"},{source:"ylecun",target:"huggingface"},{source:"ylecun",target:"neuripsconf"},{source:"ylecun",target:"sirbayes"},{source:"ylecun",target:"mmbronstein"},{source:"ylecun",target:"oriolvinyalsml"},{source:"ylecun",target:"chris_j_paxton"},{source:"ylecun",target:"remicadene"},{source:"ylecun",target:"zeyuanallenzhu"},{source:"ylecun",target:"shengjia_zhao"},{source:"ylecun",target:"everlyn_ai"},{source:"ylecun",target:"alexandr_wang"},{source:"ylecun",target:"amermathsoc"},{source:"ylecun",target:"artificialanlys"},{source:"gdb",target:"merettm"},{source:"gdb",target:"openai"},{source:"gdb",target:"sama"},{source:"anthropicai",target:"jackclarksf"},{source:"anthropicai",target:"amandaaskell"},{source:"anthropicai",target:"janleike"},{source:"anthropicai",target:"ch402"},{source:"anthropicai",target:"catherineols"},{source:"anthropicai",target:"claudeai"},{source:"anthropicai",target:"darioamodei"},{source:"anthropicai",target:"dpkingma"},{source:"anthropicai",target:"jaykreps"},{source:"anthropicai",target:"mikeyk"},{source:"anthropicai",target:"sammcallister"},{source:"anthropicai",target:"alexalbert__"},{source:"anthropicai",target:"stuartjritchie"},{source:"anthropicai",target:"andy_l_jones"},{source:"code",target:"officiallogank"},{source:"demishassabis",target:"ylecun"},{source:"demishassabis",target:"googledeepmind"},{source:"demishassabis",target:"ilyasut"},{source:"demishassabis",target:"oriolvinyalsml"},{source:"demishassabis",target:"jeffdean"},{source:"demishassabis",target:"dileeplearning"},{source:"demishassabis",target:"mustafasuleyman"},{source:"demishassabis",target:"moltbook"},{source:"demishassabis",target:"antigravity"},{source:"demishassabis",target:"fofrai"},{source:"demishassabis",target:"goodside"},{source:"demishassabis",target:"nanobanana"},{source:"demishassabis",target:"googleaistudio"},{source:"demishassabis",target:"_mohansolo"},{source:"demishassabis",target:"karpathy"},{source:"demishassabis",target:"ai_for_success"},{source:"demishassabis",target:"yoshua_bengio"},{source:"demishassabis",target:"hendrycks"},{source:"demishassabis",target:"jerrod_lew"},{source:"demishassabis",target:"sriramk"},{source:"demishassabis",target:"emollick"},{source:"demishassabis",target:"stevenbjohnson"},{source:"demishassabis",target:"joshwoodward"},{source:"demishassabis",target:"geminiapp"},{source:"demishassabis",target:"googlelabs"},{source:"demishassabis",target:"alexandr_wang"},{source:"demishassabis",target:"garymarcus"},{source:"demishassabis",target:"officiallogank"},{source:"demishassabis",target:"ancadianadragan"},{source:"demishassabis",target:"geoffreyhinton"},{source:"demishassabis",target:"clementdelangue"},{source:"demishassabis",target:"arena"},{source:"palmerluckey",target:"alexandr_wang"},{source:"palmerluckey",target:"yacinemtb"},{source:"palmerluckey",target:"goodside"},{source:"huggingface",target:"abhi1thakur"},{source:"huggingface",target:"mervenoyann"},{source:"huggingface",target:"clementdelangue"},{source:"huggingface",target:"giffmana"},{source:"huggingface",target:"richardsocher"},{source:"huggingface",target:"julien_c"},{source:"huggingface",target:"osanseviero"},{source:"huggingface",target:"srush_nlp"},{source:"huggingface",target:"thom_wolf"},{source:"huggingface",target:"risingsayak"},{source:"huggingface",target:"wightmanr"},{source:"huggingface",target:"sashamtl"},{source:"huggingface",target:"douwekiela"},{source:"huggingface",target:"_nateraw"},{source:"huggingface",target:"nielsrogge"},{source:"huggingface",target:"_lewtun"},{source:"huggingface",target:"nils_reimers"},{source:"huggingface",target:"lerobothf"},{source:"huggingface",target:"adinayakup"},{source:"huggingface",target:"unslothai"},{source:"huggingface",target:"allen_ai"},{source:"huggingface",target:"drfeifei"},{source:"huggingface",target:"nvidiaaidev"},{source:"huggingface",target:"remicadene"},{source:"fchollet",target:"ylecun"},{source:"fchollet",target:"tunguz"},{source:"fchollet",target:"hardmaru"},{source:"fchollet",target:"rasbt"},{source:"fchollet",target:"andrewyng"},{source:"fchollet",target:"googledeepmind"},{source:"fchollet",target:"garymarcus"},{source:"fchollet",target:"docmilanfar"},{source:"fchollet",target:"jeremyphoward"},{source:"fchollet",target:"schmidhuberai"},{source:"fchollet",target:"deliprao"},{source:"fchollet",target:"richardsocher"},{source:"fchollet",target:"tensorflow"},{source:"fchollet",target:"sirbayes"},{source:"fchollet",target:"jeffdean"},{source:"fchollet",target:"woj_zaremba"},{source:"fchollet",target:"darioamodei"},{source:"fchollet",target:"aelluswamy"},{source:"fchollet",target:"jfpuget"},{source:"fchollet",target:"jm_alexia"},{source:"fchollet",target:"sarahookr"},{source:"fchollet",target:"zjasper"},{source:"fchollet",target:"koraykv"},{source:"fchollet",target:"fidjissimo"},{source:"fchollet",target:"npew"},{source:"fchollet",target:"zicokolter"},{source:"fchollet",target:"yoshua_bengio"},{source:"fchollet",target:"officiallogank"},{source:"ilyasut",target:"openai"},{source:"drfeifei",target:"ylecun"},{source:"drfeifei",target:"soumithchintala"},{source:"drfeifei",target:"pytorch"},{source:"drfeifei",target:"schmidhuberai"},{source:"drfeifei",target:"neuripsconf"},{source:"drfeifei",target:"svlevine"},{source:"drfeifei",target:"oriolvinyalsml"},{source:"drfeifei",target:"tdietterich"},{source:"drfeifei",target:"zacharylipton"},{source:"drfeifei",target:"chrmanning"},{source:"drfeifei",target:"steipete"},{source:"drfeifei",target:"rohanpaul_ai"},{source:"drfeifei",target:"emollick"},{source:"drfeifei",target:"bradsmi"},{source:"geoffreyhinton",target:"ylecun"},{source:"geoffreyhinton",target:"jeffdean"},{source:"geoffreyhinton",target:"roydanroy"},{source:"geoffreyhinton",target:"chrszegedy"},{source:"geoffreyhinton",target:"dpkingma"},{source:"geoffreyhinton",target:"zoubinghahrama1"},{source:"geoffreyhinton",target:"ilyasut"},{source:"geoffreyhinton",target:"goodfellow_ian"},{source:"nvidiageforcefr",target:"nvidianewsroom"},{source:"nvidiageforcefr",target:"nvidiacc"},{source:"paraga",target:"satyanadella"},{source:"paraga",target:"perplexity_ai"},{source:"chatgptapp",target:"kalinowski007"},{source:"chatgptapp",target:"thsottiaux"},{source:"chatgptapp",target:"claudeai"},{source:"chatgptapp",target:"ch402"},{source:"chatgptapp",target:"amandaaskell"},{source:"chatgptapp",target:"boazbaraktcs"},{source:"chatgptapp",target:"anshitasaini_"},{source:"chatgptapp",target:"sriramk"},{source:"pytorch",target:"ylecun"},{source:"pytorch",target:"rasbt"},{source:"pytorch",target:"soumithchintala"},{source:"pytorch",target:"huggingface"},{source:"pytorch",target:"iamtrask"},{source:"pytorch",target:"chhillee"},{source:"pytorch",target:"julien_c"},{source:"pytorch",target:"srush_nlp"},{source:"pytorch",target:"thom_wolf"},{source:"pytorch",target:"math_rachel"},{source:"mikeyk",target:"alexalbert__"},{source:"mikeyk",target:"sammcallister"},{source:"mikeyk",target:"anthropicai"},{source:"mikeyk",target:"emollick"},{source:"mikeyk",target:"gdb"},{source:"_akhaliq",target:"hardmaru"},{source:"_akhaliq",target:"arankomatsuzaki"},{source:"_akhaliq",target:"pytorch"},{source:"_akhaliq",target:"csprofkgd"},{source:"_akhaliq",target:"soumithchintala"},{source:"_akhaliq",target:"giffmana"},{source:"_akhaliq",target:"jeremyphoward"},{source:"_akhaliq",target:"schmidhuberai"},{source:"_akhaliq",target:"huggingface"},{source:"_akhaliq",target:"abhi1thakur"},{source:"_akhaliq",target:"mattniessner"},{source:"_akhaliq",target:"svlevine"},{source:"_akhaliq",target:"nvidiarobotics"},{source:"_akhaliq",target:"antigravity"},{source:"_akhaliq",target:"nanobanana"},{source:"_akhaliq",target:"geminiapp"},{source:"_akhaliq",target:"tdietterich"},{source:"austen",target:"sriramk"},{source:"austen",target:"alexandr_wang"},{source:"austen",target:"palmerluckey"},{source:"austen",target:"moltbook"},{source:"austen",target:"steipete"},{source:"austen",target:"pashmerepat"},{source:"claudeai",target:"anthropicai"},{source:"miramurati",target:"gdb"},{source:"miramurati",target:"goodside"},{source:"miramurati",target:"alexandr_wang"},{source:"miramurati",target:"woj_zaremba"},{source:"miramurati",target:"ai__pub"},{source:"miramurati",target:"ilyasut"},{source:"miramurati",target:"mathemagic1an"},{source:"miramurati",target:"soumithchintala"},{source:"miramurati",target:"miles_brundage"},{source:"miramurati",target:"npew"},{source:"miramurati",target:"jackclarksf"},{source:"miramurati",target:"jeffdean"},{source:"miramurati",target:"janleike"},{source:"miramurati",target:"chhillee"},{source:"jeffdean",target:"soumithchintala"},{source:"jeffdean",target:"schmidhuberai"},{source:"jeffdean",target:"arankomatsuzaki"},{source:"jeffdean",target:"giffmana"},{source:"jeffdean",target:"csprofkgd"},{source:"jeffdean",target:"sirbayes"},{source:"jeffdean",target:"neuripsconf"},{source:"jeffdean",target:"thegautamkamath"},{source:"jeffdean",target:"savvyrl"},{source:"jeffdean",target:"svlevine"},{source:"jeffdean",target:"chhillee"},{source:"jeffdean",target:"oriolvinyalsml"},{source:"jeffdean",target:"roydanroy"},{source:"jeffdean",target:"mattniessner"},{source:"jeffdean",target:"srush_nlp"},{source:"jeffdean",target:"lateinteraction"},{source:"jeffdean",target:"kalinowski007"},{source:"jeffdean",target:"simpsoka"},{source:"jeffdean",target:"rihardjarc"},{source:"jeffdean",target:"bcherny"},{source:"jeffdean",target:"anujsaharan_"},{source:"jeffdean",target:"littmath"},{source:"geminiapp",target:"tulseedoshi"},{source:"geminiapp",target:"koraykv"},{source:"geminiapp",target:"antigravity"},{source:"geminiapp",target:"officiallogank"},{source:"geminiapp",target:"googleuk"},{source:"geminiapp",target:"nanobanana"},{source:"geminiapp",target:"googleaistudio"},{source:"geminiapp",target:"joshwoodward"},{source:"geminiapp",target:"demishassabis"},{source:"geminiapp",target:"googleaidevs"},{source:"geminiapp",target:"googlelabs"},{source:"geminiapp",target:"tensorflow"},{source:"geminiapp",target:"googledeepmind"},{source:"geminiapp",target:"googleai"},{source:"rasbt",target:"tunguz"},{source:"rasbt",target:"fchollet"},{source:"rasbt",target:"ylecun"},{source:"rasbt",target:"hardmaru"},{source:"rasbt",target:"andrewyng"},{source:"rasbt",target:"omarsar0"},{source:"rasbt",target:"_akhaliq"},{source:"rasbt",target:"drjimfan"},{source:"rasbt",target:"jeremyphoward"},{source:"rasbt",target:"abhi1thakur"},{source:"rasbt",target:"steipete"},{source:"rasbt",target:"alexalbert__"},{source:"rasbt",target:"nvidiaaidev"},{source:"rasbt",target:"julien_c"},{source:"rasbt",target:"ilyasut"},{source:"rasbt",target:"oriolvinyalsml"},{source:"rasbt",target:"goodfellow_ian"},{source:"rasbt",target:"tydsh"},{source:"hardmaru",target:"_akhaliq"},{source:"hardmaru",target:"rasbt"},{source:"hardmaru",target:"omarsar0"},{source:"hardmaru",target:"soumithchintala"},{source:"hardmaru",target:"arankomatsuzaki"},{source:"hardmaru",target:"schmidhuberai"},{source:"hardmaru",target:"jeremyphoward"},{source:"hardmaru",target:"abhi1thakur"},{source:"hardmaru",target:"giffmana"},{source:"hardmaru",target:"csprofkgd"},{source:"hardmaru",target:"woj_zaremba"},{source:"hardmaru",target:"savvyrl"},{source:"hardmaru",target:"sirbayes"},{source:"hardmaru",target:"nickaturley"},{source:"hardmaru",target:"geoffreylitt"},{source:"hardmaru",target:"moltbook"},{source:"hardmaru",target:"openclaw"},{source:"hardmaru",target:"kazu_fujisawa"},{source:"hardmaru",target:"tom_doerr"},{source:"hardmaru",target:"minchoi"},{source:"perplexity_ai",target:"alexgraveley"},{source:"perplexity_ai",target:"gizakdag"},{source:"perplexity_ai",target:"ciguleva"},{source:"tensorflow",target:"fchollet"},{source:"tensorflow",target:"ylecun"},{source:"tensorflow",target:"andrewyng"},{source:"tensorflow",target:"hardmaru"},{source:"tensorflow",target:"googledeepmind"},{source:"tensorflow",target:"googleai"},{source:"tensorflow",target:"mervenoyann"},{source:"tensorflow",target:"jeffdean"},{source:"tensorflow",target:"oriolvinyalsml"},{source:"tensorflow",target:"googleaidevs"},{source:"tensorflow",target:"geminiapp"},{source:"alexandr_wang",target:"gdb"},{source:"alexandr_wang",target:"goodside"},{source:"alexandr_wang",target:"emostaque"},{source:"alexandr_wang",target:"drjimfan"},{source:"alexandr_wang",target:"woj_zaremba"},{source:"alexandr_wang",target:"ilyasut"},{source:"alexandr_wang",target:"soumithchintala"},{source:"alexandr_wang",target:"saranormous"},{source:"alexandr_wang",target:"jsuarez"},{source:"alexandr_wang",target:"zeyuanallenzhu"},{source:"alexandr_wang",target:"giffmana"},{source:"alexandr_wang",target:"shengjia_zhao"},{source:"nvidiageforcees",target:"nvidianewsroom"},{source:"nvidiageforcees",target:"nvidiageforcefr"},{source:"addyosmani",target:"darioamodei"},{source:"addyosmani",target:"fidjissimo"},{source:"addyosmani",target:"thsottiaux"},{source:"addyosmani",target:"ibab"},{source:"addyosmani",target:"koylanai"},{source:"goodfellow_ian",target:"ylecun"},{source:"goodfellow_ian",target:"soumithchintala"},{source:"goodfellow_ian",target:"jeremyphoward"},{source:"goodfellow_ian",target:"sirbayes"},{source:"goodfellow_ian",target:"neuripsconf"},{source:"goodfellow_ian",target:"savvyrl"},{source:"goodfellow_ian",target:"svlevine"},{source:"goodfellow_ian",target:"oriolvinyalsml"},{source:"goodfellow_ian",target:"roydanroy"},{source:"goodfellow_ian",target:"tdietterich"},{source:"goodfellow_ian",target:"zacharylipton"},{source:"goodfellow_ian",target:"sedielem"},{source:"goodfellow_ian",target:"chrmanning"},{source:"goodfellow_ian",target:"sashamtl"},{source:"goodfellow_ian",target:"yoshua_bengio"},{source:"drjimfan",target:"_akhaliq"},{source:"drjimfan",target:"ai__pub"},{source:"drjimfan",target:"arankomatsuzaki"},{source:"drjimfan",target:"lioronai"},{source:"drjimfan",target:"mathemagic1an"},{source:"drjimfan",target:"woj_zaremba"},{source:"drjimfan",target:"schmidhuberai"},{source:"drjimfan",target:"giffmana"},{source:"drjimfan",target:"anthropicai"},{source:"drjimfan",target:"ilyasut"},{source:"drjimfan",target:"_jasonwei"},{source:"drjimfan",target:"svlevine"},{source:"drjimfan",target:"shaneguml"},{source:"drjimfan",target:"addyosmani"},{source:"drjimfan",target:"brian_armstrong"},{source:"drjimfan",target:"zeyuanallenzhu"},{source:"drjimfan",target:"bcherny"},{source:"drjimfan",target:"sundeep"},{source:"drjimfan",target:"jonathanross321"},{source:"drjimfan",target:"palmerluckey"},{source:"drjimfan",target:"skildai"},{source:"drjimfan",target:"paraga"},{source:"drjimfan",target:"claudeai"},{source:"minchoi",target:"openclaw"},{source:"minchoi",target:"steipete"},{source:"minchoi",target:"darioamodei"},{source:"minchoi",target:"aelluswamy"},{source:"minchoi",target:"yuhu_ai_"},{source:"minchoi",target:"bcherny"},{source:"minchoi",target:"rohanpaul_ai"},{source:"minchoi",target:"osanseviero"},{source:"minchoi",target:"clementdelangue"},{source:"nvidiageforcejp",target:"nvidianewsroom"},{source:"nvidiageforcejp",target:"nvidiaomniverse"},{source:"emollick",target:"mmitchell_ai"},{source:"emollick",target:"nanobanana"},{source:"emollick",target:"levie"},{source:"emollick",target:"ibab"},{source:"emollick",target:"nickaturley"},{source:"emollick",target:"littmath"},{source:"emollick",target:"miramurati"},{source:"emollick",target:"googledeepmind"},{source:"emollick",target:"drjimfan"},{source:"emollick",target:"gdb"},{source:"emollick",target:"jeffdean"},{source:"emollick",target:"tom_doerr"},{source:"emollick",target:"sriramk"},{source:"emollick",target:"demishassabis"},{source:"emollick",target:"rohanpaul_ai"},{source:"emollick",target:"anthropicai"},{source:"emostaque",target:"emollick"},{source:"emostaque",target:"ylecun"},{source:"sriramk",target:"ancadianadragan"},{source:"sriramk",target:"openclaw"},{source:"omarsar0",target:"tunguz"},{source:"omarsar0",target:"ylecun"},{source:"omarsar0",target:"rasbt"},{source:"omarsar0",target:"andrewyng"},{source:"omarsar0",target:"hardmaru"},{source:"omarsar0",target:"_akhaliq"},{source:"omarsar0",target:"drjimfan"},{source:"omarsar0",target:"abhi1thakur"},{source:"omarsar0",target:"jeremyphoward"},{source:"omarsar0",target:"ai__pub"},{source:"omarsar0",target:"lioronai"},{source:"omarsar0",target:"mervenoyann"},{source:"omarsar0",target:"soumithchintala"},{source:"omarsar0",target:"geoffreylitt"},{source:"omarsar0",target:"bcherny"},{source:"omarsar0",target:"steipete"},{source:"omarsar0",target:"sundeep"},{source:"omarsar0",target:"addyosmani"},{source:"omarsar0",target:"nils_reimers"},{source:"omarsar0",target:"adocomplete"},{source:"soumithchintala",target:"ylecun"},{source:"soumithchintala",target:"hardmaru"},{source:"soumithchintala",target:"rasbt"},{source:"soumithchintala",target:"pytorch"},{source:"soumithchintala",target:"jeremyphoward"},{source:"soumithchintala",target:"giffmana"},{source:"soumithchintala",target:"chhillee"},{source:"soumithchintala",target:"sirbayes"},{source:"soumithchintala",target:"woj_zaremba"},{source:"soumithchintala",target:"iamtrask"},{source:"soumithchintala",target:"clementdelangue"},{source:"soumithchintala",target:"oriolvinyalsml"},{source:"soumithchintala",target:"jeffdean"},{source:"soumithchintala",target:"srush_nlp"},{source:"soumithchintala",target:"julien_c"},{source:"soumithchintala",target:"steipete"},{source:"soumithchintala",target:"jm_alexia"},{source:"soumithchintala",target:"zai_org"},{source:"soumithchintala",target:"ericzelikman"},{source:"openclaw",target:"steipete"},{source:"officiallogank",target:"lioronai"},{source:"officiallogank",target:"jeremyphoward"},{source:"officiallogank",target:"woj_zaremba"},{source:"officiallogank",target:"huggingface"},{source:"officiallogank",target:"clementdelangue"},{source:"officiallogank",target:"osanseviero"},{source:"officiallogank",target:"julien_c"},{source:"jeremyphoward",target:"fchollet"},{source:"jeremyphoward",target:"ylecun"},{source:"jeremyphoward",target:"rasbt"},{source:"jeremyphoward",target:"hardmaru"},{source:"jeremyphoward",target:"_akhaliq"},{source:"jeremyphoward",target:"omarsar0"},{source:"jeremyphoward",target:"soumithchintala"},{source:"jeremyphoward",target:"pytorch"},{source:"jeremyphoward",target:"abhi1thakur"},{source:"jeremyphoward",target:"schmidhuberai"},{source:"jeremyphoward",target:"mervenoyann"},{source:"jeremyphoward",target:"arankomatsuzaki"},{source:"openaidevs",target:"openai"},{source:"steipete",target:"moltbook"},{source:"steipete",target:"matthewberman"},{source:"tunguz",target:"fchollet"},{source:"tunguz",target:"rasbt"},{source:"tunguz",target:"andrewyng"},{source:"tunguz",target:"hardmaru"},{source:"tunguz",target:"omarsar0"},{source:"tunguz",target:"_akhaliq"},{source:"tunguz",target:"abhi1thakur"},{source:"tunguz",target:"drjimfan"},{source:"tunguz",target:"docmilanfar"},{source:"tunguz",target:"mervenoyann"},{source:"tunguz",target:"lioronai"},{source:"tunguz",target:"thsottiaux"},{source:"tunguz",target:"addyosmani"},{source:"tunguz",target:"darioamodei"},{source:"nvidiaai",target:"ylecun"},{source:"nvidiaai",target:"hardmaru"},{source:"nvidiaai",target:"rasbt"},{source:"nvidiaai",target:"googledeepmind"},{source:"nvidiaai",target:"soumithchintala"},{source:"nvidiaai",target:"jeremyphoward"},{source:"nvidiaai",target:"abhi1thakur"},{source:"nvidiaai",target:"tensorflow"},{source:"nvidiaai",target:"nvidiaaidev"},{source:"nvidiaai",target:"neuripsconf"},{source:"nvidiaai",target:"nvidia"},{source:"nvidiaai",target:"oriolvinyalsml"},{source:"nvidiaai",target:"sedielem"},{source:"nvidiaai",target:"nvidiarobotics"},{source:"nvidiaai",target:"nvidiaomniverse"},{source:"nvidiaai",target:"nvidianewsroom"},{source:"nvidiaai",target:"nvidiashield"},{source:"nvidiaai",target:"nvidiahealth"},{source:"nvidiaai",target:"nvidiagtc"},{source:"bcherny",target:"addyosmani"},{source:"bcherny",target:"darioamodei"},{source:"bcherny",target:"gdb"},{source:"bcherny",target:"adocomplete"},{source:"bcherny",target:"jeffdean"},{source:"bcherny",target:"alexandr_wang"},{source:"bcherny",target:"karpathy"},{source:"bcherny",target:"johnschulman2"},{source:"bcherny",target:"miramurati"},{source:"bcherny",target:"janleike"},{source:"bcherny",target:"amandaaskell"},{source:"bcherny",target:"mikeyk"},{source:"bcherny",target:"anthropicai"},{source:"bcherny",target:"alexalbert__"},{source:"bcherny",target:"ylecun"},{source:"nvidiageforceuk",target:"nvidiaanz"},{source:"nvidiageforceuk",target:"nvidiastudio"},{source:"nvidiageforceuk",target:"nvidiageforcees"},{source:"moltbook",target:"steipete"},{source:"moltbook",target:"openclaw"},{source:"mustafasuleyman",target:"ylecun"},{source:"mustafasuleyman",target:"ilyasut"},{source:"mustafasuleyman",target:"miles_brundage"},{source:"mustafasuleyman",target:"woj_zaremba"},{source:"mustafasuleyman",target:"jeffdean"},{source:"mustafasuleyman",target:"oriolvinyalsml"},{source:"mustafasuleyman",target:"jackclarksf"},{source:"mustafasuleyman",target:"sedielem"},{source:"mustafasuleyman",target:"iamtrask"},{source:"mustafasuleyman",target:"demishassabis"},{source:"mustafasuleyman",target:"nandodf"},{source:"mustafasuleyman",target:"zacharylipton"},{source:"mustafasuleyman",target:"chrmanning"},{source:"mustafasuleyman",target:"shaneguml"},{source:"mustafasuleyman",target:"janleike"},{source:"mustafasuleyman",target:"darioamodei"},{source:"gavinsbaker",target:"lateinteraction"},{source:"esyudkowsky",target:"miles_brundage"},{source:"esyudkowsky",target:"ilyasut"},{source:"esyudkowsky",target:"geoffreyhinton"},{source:"esyudkowsky",target:"goodside"},{source:"yacinemtb",target:"nickcammarata"},{source:"garymarcus",target:"schmidhuberai"},{source:"garymarcus",target:"soumithchintala"},{source:"garymarcus",target:"melmitchell1"},{source:"garymarcus",target:"arankomatsuzaki"},{source:"garymarcus",target:"tdietterich"},{source:"garymarcus",target:"savvyrl"},{source:"garymarcus",target:"sirbayes"},{source:"garymarcus",target:"miles_brundage"},{source:"garymarcus",target:"anthropicai"},{source:"garymarcus",target:"mmbronstein"},{source:"garymarcus",target:"svlevine"},{source:"garymarcus",target:"srush_nlp"},{source:"garymarcus",target:"chrmanning"},{source:"garymarcus",target:"aprilwright"},{source:"garymarcus",target:"theworldlabs"},{source:"garymarcus",target:"nickaturley"},{source:"garymarcus",target:"profstevekeen"},{source:"garymarcus",target:"rohanpaul_ai"},{source:"garymarcus",target:"peterberezinbca"},{source:"garymarcus",target:"sethharpesq"},{source:"garymarcus",target:"fidjissimo"},{source:"mspartner",target:"jeffteper"},{source:"mspartner",target:"azure"},{source:"mspartner",target:"mustafasuleyman"},{source:"mspartner",target:"sama"},{source:"mspartner",target:"mistralai"},{source:"nvidiagfn",target:"nvidiageforce"},{source:"nvidiagfn",target:"nvidiageforceuk"},{source:"nvidiagfn",target:"nvidia"},{source:"nvidiagfn",target:"nvidianewsroom"},{source:"oriolvinyalsml",target:"soumithchintala"},{source:"oriolvinyalsml",target:"ilyasut"},{source:"oriolvinyalsml",target:"svlevine"},{source:"oriolvinyalsml",target:"sedielem"},{source:"oriolvinyalsml",target:"tdietterich"},{source:"oriolvinyalsml",target:"demishassabis"},{source:"oriolvinyalsml",target:"chrmanning"},{source:"oriolvinyalsml",target:"nandodf"},{source:"oriolvinyalsml",target:"egrefen"},{source:"oriolvinyalsml",target:"natashajaques"},{source:"oriolvinyalsml",target:"hochreitersepp"},{source:"oriolvinyalsml",target:"antigravity"},{source:"oriolvinyalsml",target:"satyanadella"},{source:"oriolvinyalsml",target:"johnschulman2"},{source:"oriolvinyalsml",target:"lexfridman"},{source:"oriolvinyalsml",target:"ancadianadragan"},{source:"oriolvinyalsml",target:"miramurati"},{source:"oriolvinyalsml",target:"emostaque"},{source:"oriolvinyalsml",target:"math_rachel"},{source:"oriolvinyalsml",target:"avdnoord"},{source:"oriolvinyalsml",target:"azaliamirh"},{source:"oriolvinyalsml",target:"black_in_ai"},{source:"oriolvinyalsml",target:"mmitchell_ai"},{source:"oriolvinyalsml",target:"koraykv"},{source:"oriolvinyalsml",target:"ctnzr"},{source:"oriolvinyalsml",target:"maithra_raghu"},{source:"oriolvinyalsml",target:"hannawallach"},{source:"oriolvinyalsml",target:"tlogg"},{source:"oriolvinyalsml",target:"wimlworkshop"},{source:"oriolvinyalsml",target:"khipu_ai"},{source:"oriolvinyalsml",target:"chelseabfinn"},{source:"oriolvinyalsml",target:"goodfellow_ian"},{source:"oriolvinyalsml",target:"jeffdean"},{source:"clementdelangue",target:"_akhaliq"},{source:"clementdelangue",target:"rasbt"},{source:"clementdelangue",target:"omarsar0"},{source:"clementdelangue",target:"julien_c"},{source:"clementdelangue",target:"huggingface"},{source:"clementdelangue",target:"mervenoyann"},{source:"clementdelangue",target:"soumithchintala"},{source:"clementdelangue",target:"jeremyphoward"},{source:"clementdelangue",target:"pytorch"},{source:"clementdelangue",target:"abhi1thakur"},{source:"clementdelangue",target:"deliprao"},{source:"clementdelangue",target:"osanseviero"},{source:"clementdelangue",target:"richardsocher"},{source:"clementdelangue",target:"woj_zaremba"},{source:"clementdelangue",target:"thom_wolf"},{source:"clementdelangue",target:"sashamtl"},{source:"clementdelangue",target:"_nateraw"},{source:"clementdelangue",target:"guohao_li"},{source:"clementdelangue",target:"mattt"},{source:"clementdelangue",target:"gavinsbaker"},{source:"clementdelangue",target:"jsuarez"},{source:"clementdelangue",target:"askokara"},{source:"clementdelangue",target:"__tinygrad__"},{source:"clementdelangue",target:"cixliv"},{source:"clementdelangue",target:"aelluswamy"},{source:"aelluswamy",target:"arena"},{source:"aelluswamy",target:"palmerluckey"},{source:"aelluswamy",target:"srush_nlp"},{source:"aelluswamy",target:"esyudkowsky"},{source:"aelluswamy",target:"gdb"},{source:"googleuk",target:"joshwoodward"},{source:"nvidiageforcede",target:"nvidianewsroom"},{source:"goodside",target:"gdb"},{source:"goodside",target:"emostaque"},{source:"goodside",target:"alexandr_wang"},{source:"goodside",target:"drjimfan"},{source:"goodside",target:"esyudkowsky"},{source:"goodside",target:"mathemagic1an"},{source:"goodside",target:"yacinemtb"},{source:"goodside",target:"arankomatsuzaki"},{source:"goodside",target:"woj_zaremba"},{source:"goodside",target:"nickcammarata"},{source:"goodside",target:"anthropicai"},{source:"goodside",target:"zoubinghahrama1"},{source:"goodside",target:"steipete"},{source:"goodside",target:"googlelabs"},{source:"goodside",target:"bcherny"},{source:"goodside",target:"mitchellh"},{source:"tom_doerr",target:"embirico"},{source:"tom_doerr",target:"steipete"},{source:"tom_doerr",target:"gizakdag"},{source:"tom_doerr",target:"ciguleva"},{source:"arankomatsuzaki",target:"_akhaliq"},{source:"arankomatsuzaki",target:"drjimfan"},{source:"arankomatsuzaki",target:"giffmana"},{source:"arankomatsuzaki",target:"soumithchintala"},{source:"arankomatsuzaki",target:"deliprao"},{source:"arankomatsuzaki",target:"anthropicai"},{source:"arankomatsuzaki",target:"_jasonwei"},{source:"arankomatsuzaki",target:"chhillee"},{source:"arankomatsuzaki",target:"huggingface"},{source:"arankomatsuzaki",target:"woj_zaremba"},{source:"arankomatsuzaki",target:"savvyrl"},{source:"arankomatsuzaki",target:"clementdelangue"},{source:"arankomatsuzaki",target:"srush_nlp"},{source:"arankomatsuzaki",target:"wightmanr"},{source:"arankomatsuzaki",target:"bcherny"},{source:"arankomatsuzaki",target:"askalphaxiv"},{source:"arankomatsuzaki",target:"xwang_lk"},{source:"arankomatsuzaki",target:"sedielem"},{source:"arankomatsuzaki",target:"omarsar0"},{source:"arankomatsuzaki",target:"rohanpaul_ai"},{source:"arankomatsuzaki",target:"kalomaze"},{source:"arankomatsuzaki",target:"rasbt"},{source:"chrmanning",target:"soumithchintala"},{source:"chrmanning",target:"srush_nlp"},{source:"chrmanning",target:"sleepinyourhat"},{source:"chrmanning",target:"gneubig"},{source:"chrmanning",target:"_jasonwei"},{source:"chrmanning",target:"thom_wolf"},{source:"chrmanning",target:"tdietterich"},{source:"chrmanning",target:"douwekiela"},{source:"chrmanning",target:"huggingface"},{source:"chrmanning",target:"ctnzr"},{source:"chrmanning",target:"goodfellow_ian"},{source:"chrmanning",target:"adinayakup"},{source:"chrmanning",target:"artificialanlys"},{source:"chrmanning",target:"zai_org"},{source:"chrmanning",target:"suchenzang"},{source:"chrmanning",target:"miles_brundage"},{source:"chrmanning",target:"ylecun"},{source:"neuripsconf",target:"googledeepmind"},{source:"neuripsconf",target:"andrewyng"},{source:"neuripsconf",target:"ylecun"},{source:"neuripsconf",target:"hannawallach"},{source:"neuripsconf",target:"karpathy"},{source:"neuripsconf",target:"nandodf"},{source:"nanobanana",target:"googledeepmind"},{source:"nanobanana",target:"googleaistudio"},{source:"nanobanana",target:"geminiapp"},{source:"everlyn_ai",target:"ylecun"},{source:"ch402",target:"anthropicai"},{source:"ch402",target:"jackclarksf"},{source:"ch402",target:"oriolvinyalsml"},{source:"ch402",target:"zacharylipton"},{source:"ch402",target:"janleike"},{source:"ch402",target:"nandodf"},{source:"ch402",target:"catherineols"},{source:"ch402",target:"claudeai"},{source:"ch402",target:"andy_l_jones"},{source:"ch402",target:"darioamodei"},{source:"rohanpaul_ai",target:"tunguz"},{source:"rohanpaul_ai",target:"ylecun"},{source:"rohanpaul_ai",target:"rasbt"},{source:"rohanpaul_ai",target:"_akhaliq"},{source:"rohanpaul_ai",target:"omarsar0"},{source:"rohanpaul_ai",target:"karpathy"},{source:"rohanpaul_ai",target:"fchollet"},{source:"rohanpaul_ai",target:"bcherny"},{source:"woj_zaremba",target:"gdb"},{source:"woj_zaremba",target:"hardmaru"},{source:"woj_zaremba",target:"googledeepmind"},{source:"woj_zaremba",target:"ilyasut"},{source:"woj_zaremba",target:"soumithchintala"},{source:"woj_zaremba",target:"jeremyphoward"},{source:"woj_zaremba",target:"anthropicai"},{source:"woj_zaremba",target:"richardsocher"},{source:"woj_zaremba",target:"oriolvinyalsml"},{source:"woj_zaremba",target:"miles_brundage"},{source:"woj_zaremba",target:"jackclarksf"},{source:"woj_zaremba",target:"jeffdean"},{source:"woj_zaremba",target:"svlevine"},{source:"woj_zaremba",target:"npew"},{source:"woj_zaremba",target:"majmudaradam"},{source:"woj_zaremba",target:"billpeeb"},{source:"woj_zaremba",target:"ibab"},{source:"woj_zaremba",target:"esyudkowsky"},{source:"woj_zaremba",target:"amandaaskell"},{source:"woj_zaremba",target:"nickcammarata"},{source:"woj_zaremba",target:"johnschulman2"},{source:"woj_zaremba",target:"janleike"},{source:"arena",target:"nanobanana"},{source:"arena",target:"perplexity_ai"},{source:"arena",target:"liamfedus"},{source:"arena",target:"miramurati"},{source:"arena",target:"chatgptapp"},{source:"arena",target:"geminiapp"},{source:"arena",target:"demishassabis"},{source:"arena",target:"jeffdean"},{source:"saranormous",target:"steipete"},{source:"saranormous",target:"bcherny"},{source:"saranormous",target:"nickaturley"},{source:"openainewsroom",target:"openaidevs"},{source:"openainewsroom",target:"chatgptapp"},{source:"openainewsroom",target:"openai"},{source:"googlelabs",target:"googleai"},{source:"googlelabs",target:"googleaidevs"},{source:"googlelabs",target:"openainewsroom"},{source:"googlelabs",target:"geminiapp"},{source:"nvidiarobotics",target:"nvidia"},{source:"nvidiarobotics",target:"nvidiastudio"},{source:"nvidiarobotics",target:"nvidiaaidev"},{source:"nvidiarobotics",target:"pytorch"},{source:"nvidiarobotics",target:"tensorflow"},{source:"nvidiarobotics",target:"nvidiaai"},{source:"nvidiarobotics",target:"nvidiaomniverse"},{source:"nvidiarobotics",target:"nvidiadc"},{source:"nvidiarobotics",target:"nvidianewsroom"},{source:"nvidiarobotics",target:"nvidiajapan"},{source:"nvidiarobotics",target:"drjimfan"},{source:"nvidiarobotics",target:"nvidiacc"},{source:"giffmana",target:"arankomatsuzaki"},{source:"giffmana",target:"soumithchintala"},{source:"giffmana",target:"jeremyphoward"},{source:"giffmana",target:"schmidhuberai"},{source:"giffmana",target:"chhillee"},{source:"giffmana",target:"deliprao"},{source:"giffmana",target:"wightmanr"},{source:"giffmana",target:"sirbayes"},{source:"giffmana",target:"srush_nlp"},{source:"giffmana",target:"anthropicai"},{source:"giffmana",target:"sedielem"},{source:"giffmana",target:"svlevine"},{source:"giffmana",target:"jfpuget"},{source:"giffmana",target:"jm_alexia"},{source:"giffmana",target:"thsottiaux"},{source:"janleike",target:"woj_zaremba"},{source:"janleike",target:"anthropicai"},{source:"janleike",target:"miles_brundage"},{source:"janleike",target:"jackclarksf"},{source:"janleike",target:"amandaaskell"},{source:"janleike",target:"ilyasut"},{source:"janleike",target:"sleepinyourhat"},{source:"janleike",target:"zicokolter"},{source:"janleike",target:"fidjissimo"},{source:"alexalbert__",target:"hendrycks"},{source:"svlevine",target:"soumithchintala"},{source:"svlevine",target:"giffmana"},{source:"svlevine",target:"oriolvinyalsml"},{source:"svlevine",target:"natashajaques"},{source:"svlevine",target:"tdietterich"},{source:"svlevine",target:"sedielem"},{source:"svlevine",target:"dpkingma"},{source:"svlevine",target:"zoubinghahrama1"},{source:"svlevine",target:"remicadene"},{source:"richardsocher",target:"soumithchintala"},{source:"richardsocher",target:"deliprao"},{source:"richardsocher",target:"srush_nlp"},{source:"richardsocher",target:"chrmanning"},{source:"richardsocher",target:"julien_c"},{source:"richardsocher",target:"oriolvinyalsml"},{source:"richardsocher",target:"clementdelangue"},{source:"richardsocher",target:"anthropicai"},{source:"richardsocher",target:"roydanroy"},{source:"richardsocher",target:"neuripsconf"},{source:"richardsocher",target:"sleepinyourhat"},{source:"richardsocher",target:"sedielem"},{source:"richardsocher",target:"zacharylipton"},{source:"richardsocher",target:"tdietterich"},{source:"richardsocher",target:"_jasonwei"},{source:"richardsocher",target:"gneubig"},{source:"richardsocher",target:"thom_wolf"},{source:"richardsocher",target:"sarahookr"},{source:"richardsocher",target:"yuhu_ai_"},{source:"richardsocher",target:"xwang_lk"},{source:"richardsocher",target:"koylanai"},{source:"richardsocher",target:"josh_tobin_"},{source:"richardsocher",target:"saranormous"},{source:"richardsocher",target:"suchenzang"},{source:"richardsocher",target:"tydsh"},{source:"richardsocher",target:"hendrycks"},{source:"richardsocher",target:"tkipf"},{source:"richardsocher",target:"itstkai"},{source:"richardsocher",target:"pirroh"},{source:"richardsocher",target:"ericzelikman"},{source:"richardsocher",target:"liamfedus"},{source:"richardsocher",target:"dspyoss"},{source:"richardsocher",target:"getjonwithit"},{source:"richardsocher",target:"lorwen108"},{source:"richardsocher",target:"shengjia_zhao"},{source:"richardsocher",target:"rao2z"},{source:"antigravity",target:"googleaidevs"},{source:"antigravity",target:"geminiapp"},{source:"antigravity",target:"nanobanana"},{source:"antigravity",target:"koraykv"},{source:"antigravity",target:"googledeepmind"},{source:"antigravity",target:"demishassabis"},{source:"antigravity",target:"_mohansolo"},{source:"googleaistudio",target:"googledeepmind"},{source:"googleaistudio",target:"googleai"},{source:"lioronai",target:"karpathy"},{source:"lioronai",target:"ylecun"},{source:"lioronai",target:"tunguz"},{source:"lioronai",target:"_akhaliq"},{source:"lioronai",target:"fchollet"},{source:"lioronai",target:"rasbt"},{source:"lioronai",target:"hardmaru"},{source:"lioronai",target:"omarsar0"},{source:"lioronai",target:"andrewyng"},{source:"lioronai",target:"drjimfan"},{source:"lioronai",target:"gdb"},{source:"lioronai",target:"googledeepmind"},{source:"lioronai",target:"goodside"},{source:"lioronai",target:"emostaque"},{source:"lioronai",target:"ai__pub"},{source:"lioronai",target:"moltbook"},{source:"profstevekeen",target:"garymarcus"},{source:"jackclarksf",target:"miles_brundage"},{source:"jackclarksf",target:"soumithchintala"},{source:"jackclarksf",target:"arankomatsuzaki"},{source:"jackclarksf",target:"anthropicai"},{source:"jackclarksf",target:"deliprao"},{source:"jackclarksf",target:"jeremyphoward"},{source:"jackclarksf",target:"giffmana"},{source:"jackclarksf",target:"woj_zaremba"},{source:"jackclarksf",target:"richardsocher"},{source:"jackclarksf",target:"amandaaskell"},{source:"jackclarksf",target:"oriolvinyalsml"},{source:"jackclarksf",target:"clementdelangue"},{source:"jackclarksf",target:"chhillee"},{source:"nandodf",target:"soumithchintala"},{source:"nandodf",target:"arankomatsuzaki"},{source:"nandodf",target:"giffmana"},{source:"nandodf",target:"deliprao"},{source:"nandodf",target:"richardsocher"},{source:"nandodf",target:"sirbayes"},{source:"nandodf",target:"oriolvinyalsml"},{source:"nandodf",target:"neuripsconf"},{source:"nandodf",target:"roydanroy"},{source:"nandodf",target:"miles_brundage"},{source:"nandodf",target:"sedielem"},{source:"nandodf",target:"tdietterich"},{source:"nandodf",target:"srush_nlp"},{source:"nandodf",target:"anthropicai"},{source:"nandodf",target:"sarahookr"},{source:"nandodf",target:"code"},{source:"nandodf",target:"bcherny"},{source:"nandodf",target:"theworldlabs"},{source:"nandodf",target:"shengjia_zhao"},{source:"nandodf",target:"zai_org"},{source:"ibab",target:"googledeepmind"},{source:"ibab",target:"hardmaru"},{source:"ibab",target:"_akhaliq"},{source:"ibab",target:"sedielem"},{source:"ibab",target:"emostaque"},{source:"ibab",target:"drjimfan"},{source:"ibab",target:"miles_brundage"},{source:"ibab",target:"arankomatsuzaki"},{source:"ibab",target:"soumithchintala"},{source:"ibab",target:"jackclarksf"},{source:"ibab",target:"ilyasut"},{source:"ibab",target:"anthropicai"},{source:"ibab",target:"janleike"},{source:"ibab",target:"chhillee"},{source:"ibab",target:"jeffdean"},{source:"ibab",target:"steipete"},{source:"docmilanfar",target:"csprofkgd"},{source:"docmilanfar",target:"thegautamkamath"},{source:"docmilanfar",target:"mmbronstein"},{source:"docmilanfar",target:"sirbayes"},{source:"docmilanfar",target:"tdietterich"},{source:"docmilanfar",target:"sarahookr"},{source:"docmilanfar",target:"chris_j_paxton"},{source:"_jasonwei",target:"arankomatsuzaki"},{source:"_jasonwei",target:"deliprao"},{source:"_jasonwei",target:"giffmana"},{source:"_jasonwei",target:"savvyrl"},{source:"_jasonwei",target:"anthropicai"},{source:"_jasonwei",target:"srush_nlp"},{source:"_jasonwei",target:"sleepinyourhat"},{source:"_jasonwei",target:"shaneguml"},{source:"_jasonwei",target:"chrmanning"},{source:"_jasonwei",target:"gneubig"},{source:"_jasonwei",target:"felixhill84"},{source:"_jasonwei",target:"nickaturley"},{source:"_jasonwei",target:"bcherny"},{source:"bradsmi",target:"karpathy"},{source:"bradsmi",target:"sriramk"},{source:"bradsmi",target:"mustafasuleyman"},{source:"bradsmi",target:"drfeifei"},{source:"bradsmi",target:"gdb"},{source:"bradsmi",target:"openai"},{source:"thom_wolf",target:"soumithchintala"},{source:"thom_wolf",target:"arankomatsuzaki"},{source:"thom_wolf",target:"jeremyphoward"},{source:"thom_wolf",target:"abhi1thakur"},{source:"thom_wolf",target:"deliprao"},{source:"thom_wolf",target:"mervenoyann"},{source:"thom_wolf",target:"julien_c"},{source:"thom_wolf",target:"clementdelangue"},{source:"thom_wolf",target:"giffmana"},{source:"thom_wolf",target:"huggingface"},{source:"thom_wolf",target:"richardsocher"},{source:"thom_wolf",target:"srush_nlp"},{source:"thom_wolf",target:"osanseviero"},{source:"thom_wolf",target:"chhillee"},{source:"thom_wolf",target:"savvyrl"},{source:"thom_wolf",target:"pashmerepat"},{source:"thom_wolf",target:"claudeai"},{source:"thom_wolf",target:"thsottiaux"},{source:"nvidiageforcebr",target:"nvidiaaidev"},{source:"nvidiageforcebr",target:"nvidianewsroom"},{source:"nvidiageforcebr",target:"nvidiagamedev"},{source:"googleaidevs",target:"googleai"},{source:"googleaidevs",target:"antigravity"},{source:"googleaidevs",target:"googlelabs"},{source:"googleaidevs",target:"nanobanana"},{source:"googleaidevs",target:"googleaistudio"},{source:"googleaidevs",target:"tulseedoshi"},{source:"googleaidevs",target:"ai_for_success"},{source:"googleaidevs",target:"mathemagic1an"},{source:"googleaidevs",target:"oriolvinyalsml"},{source:"googleaidevs",target:"emollick"},{source:"googleaidevs",target:"demishassabis"},{source:"googleaidevs",target:"joshwoodward"},{source:"googleaidevs",target:"jeffdean"},{source:"googleaidevs",target:"osanseviero"},{source:"googleaidevs",target:"officiallogank"},{source:"googleaidevs",target:"googledeepmind"},{source:"abhi1thakur",target:"tunguz"},{source:"abhi1thakur",target:"fchollet"},{source:"abhi1thakur",target:"ylecun"},{source:"abhi1thakur",target:"rasbt"},{source:"abhi1thakur",target:"omarsar0"},{source:"abhi1thakur",target:"hardmaru"},{source:"abhi1thakur",target:"andrewyng"},{source:"abhi1thakur",target:"_akhaliq"},{source:"abhi1thakur",target:"jeremyphoward"},{source:"abhi1thakur",target:"pytorch"},{source:"abhi1thakur",target:"soumithchintala"},{source:"abhi1thakur",target:"huggingface"},{source:"abhi1thakur",target:"roydanroy"},{source:"math_rachel",target:"jeremyphoward"},{source:"math_rachel",target:"soumithchintala"},{source:"math_rachel",target:"mmitchell_ai"},{source:"math_rachel",target:"sashamtl"},{source:"math_rachel",target:"sedielem"},{source:"math_rachel",target:"natashajaques"},{source:"math_rachel",target:"geoffreylitt"},{source:"math_rachel",target:"steipete"},{source:"math_rachel",target:"suchenzang"},{source:"math_rachel",target:"rohanpaul_ai"},{source:"nvidiageforcela",target:"nvidiageforcees"},{source:"nvidiageforcela",target:"nvidiageforcede"},{source:"nvidiageforcela",target:"nvidiaomniverse"},{source:"nvidiageforcela",target:"nvidiacc"},{source:"nvidiageforcela",target:"nvidiagfn"},{source:"nvidiageforcela",target:"nvidiastudio"},{source:"fidjissimo",target:"levie"},{source:"fidjissimo",target:"sriramk"},{source:"fidjissimo",target:"steipete"},{source:"fidjissimo",target:"billpeeb"},{source:"nvidiaaidev",target:"ylecun"},{source:"nvidiaaidev",target:"_akhaliq"},{source:"nvidiaaidev",target:"hardmaru"},{source:"nvidiaaidev",target:"rasbt"},{source:"nvidiaaidev",target:"googledeepmind"},{source:"nvidiaaidev",target:"pytorch"},{source:"nvidiaaidev",target:"drjimfan"},{source:"nvidiaaidev",target:"soumithchintala"},{source:"nvidiaaidev",target:"csprofkgd"},{source:"nvidiaaidev",target:"jeremyphoward"},{source:"nvidiaaidev",target:"huggingface"},{source:"nvidiaaidev",target:"nvidiaai"},{source:"nvidiaaidev",target:"tensorflow"},{source:"nvidiaaidev",target:"nvidia"},{source:"nvidiaaidev",target:"julien_c"},{source:"nvidiaaidev",target:"neuripsconf"},{source:"nvidiaaidev",target:"anthropicai"},{source:"nvidiaaidev",target:"mistralai"},{source:"nvidiaaidev",target:"unslothai"},{source:"nvidiaaidev",target:"openaidevs"},{source:"nvidiaaidev",target:"xai"},{source:"nvidiaaidev",target:"artificialanlys"},{source:"nvidiageforceme",target:"nvidianewsroom"},{source:"nvidiageforceme",target:"nvidiaomniverse"},{source:"nvidiageforceme",target:"nvidiaworkstatn"},{source:"nvidiageforceme",target:"nvidiacc"},{source:"nvidiageforceme",target:"nvidiageforceuk"},{source:"nvidiageforceme",target:"nvidia"},{source:"nvidiageforceme",target:"nvidiageforce"},{source:"nickcammarata",target:"amandaaskell"},{source:"nickcammarata",target:"bcherny"},{source:"chelseabfinn",target:"soumithchintala"},{source:"chelseabfinn",target:"svlevine"},{source:"chelseabfinn",target:"neuripsconf"},{source:"chelseabfinn",target:"sirbayes"},{source:"chelseabfinn",target:"mattniessner"},{source:"chelseabfinn",target:"srush_nlp"},{source:"chelseabfinn",target:"oriolvinyalsml"},{source:"chelseabfinn",target:"tdietterich"},{source:"chelseabfinn",target:"zacharylipton"},{source:"chelseabfinn",target:"shaneguml"},{source:"chelseabfinn",target:"chrmanning"},{source:"chelseabfinn",target:"liamfedus"},{source:"chelseabfinn",target:"drjimfan"},{source:"chelseabfinn",target:"melmitchell1"},{source:"matthewberman",target:"sama"},{source:"matthewberman",target:"austen"},{source:"matthewberman",target:"levie"},{source:"matthewberman",target:"alexandr_wang"},{source:"matthewberman",target:"moltbook"},{source:"matthewberman",target:"steipete"},{source:"matthewberman",target:"openclaw"},{source:"matthewberman",target:"ericzelikman"},{source:"ciguleva",target:"yuhu_ai_"},{source:"mervenoyann",target:"huggingface"},{source:"mervenoyann",target:"julien_c"},{source:"mervenoyann",target:"osanseviero"},{source:"mervenoyann",target:"openclaw"},{source:"mervenoyann",target:"matthewberman"},{source:"mervenoyann",target:"bcherny"},{source:"gizakdag",target:"moltbook"},{source:"gizakdag",target:"steipete"},{source:"gizakdag",target:"openclaw"},{source:"gizakdag",target:"joshwoodward"},{source:"mmitchell_ai",target:"sashamtl"},{source:"mmitchell_ai",target:"savvyrl"},{source:"mmitchell_ai",target:"miles_brundage"},{source:"mmitchell_ai",target:"clementdelangue"},{source:"mmitchell_ai",target:"sarahookr"},{source:"mmitchell_ai",target:"srush_nlp"},{source:"mmitchell_ai",target:"julien_c"},{source:"mmitchell_ai",target:"osanseviero"},{source:"mmitchell_ai",target:"zacharylipton"},{source:"mmitchell_ai",target:"jm_alexia"},{source:"mmitchell_ai",target:"ctnzr"},{source:"mmitchell_ai",target:"sebastienbubeck"},{source:"iamtrask",target:"fchollet"},{source:"iamtrask",target:"ylecun"},{source:"iamtrask",target:"hardmaru"},{source:"iamtrask",target:"rasbt"},{source:"iamtrask",target:"jeremyphoward"},{source:"iamtrask",target:"soumithchintala"},{source:"iamtrask",target:"abhi1thakur"},{source:"iamtrask",target:"arankomatsuzaki"},{source:"iamtrask",target:"mervenoyann"},{source:"iamtrask",target:"giffmana"},{source:"iamtrask",target:"huggingface"},{source:"iamtrask",target:"srush_nlp"},{source:"iamtrask",target:"sirbayes"},{source:"iamtrask",target:"julien_c"},{source:"iamtrask",target:"oriolvinyalsml"},{source:"iamtrask",target:"woj_zaremba"},{source:"iamtrask",target:"tydsh"},{source:"iamtrask",target:"darioamodei"},{source:"iamtrask",target:"deryatr_"},{source:"allen_ai",target:"deliprao"},{source:"allen_ai",target:"chrmanning"},{source:"allen_ai",target:"thom_wolf"},{source:"allen_ai",target:"egrefen"},{source:"allen_ai",target:"perplexity_ai"},{source:"allen_ai",target:"karpathy"},{source:"allen_ai",target:"sarahookr"},{source:"allen_ai",target:"richardsocher"},{source:"allen_ai",target:"nandodf"},{source:"allen_ai",target:"drjimfan"},{source:"allen_ai",target:"jeremyphoward"},{source:"artificialanlys",target:"yuhu_ai_"},{source:"artificialanlys",target:"suchenzang"},{source:"artificialanlys",target:"srush_nlp"},{source:"artificialanlys",target:"tydsh"},{source:"ai_for_success",target:"steipete"},{source:"ai_for_success",target:"bcherny"},{source:"ai_for_success",target:"koraykv"},{source:"ai_for_success",target:"goodfellow_ian"},{source:"ai_for_success",target:"antigravity"},{source:"ai_for_success",target:"goodside"},{source:"nvidianetworkng",target:"nvidia"},{source:"nvidianetworkng",target:"nvidiastudio"},{source:"nvidianetworkng",target:"nvidiaai"},{source:"nvidianetworkng",target:"nvidiadc"},{source:"nvidianetworkng",target:"nvidiahpcdev"},{source:"nvidianetworkng",target:"nvidiagtc"},{source:"nvidianetworkng",target:"nvidianewsroom"},{source:"nvidianetworkng",target:"nvidiaomniverse"},{source:"nvidianetworkng",target:"nvidiaworkstatn"},{source:"srush_nlp",target:"soumithchintala"},{source:"srush_nlp",target:"clementdelangue"},{source:"srush_nlp",target:"savvyrl"},{source:"srush_nlp",target:"sleepinyourhat"},{source:"srush_nlp",target:"chrmanning"},{source:"srush_nlp",target:"chhillee"},{source:"srush_nlp",target:"gneubig"},{source:"srush_nlp",target:"julien_c"},{source:"srush_nlp",target:"sarahookr"},{source:"srush_nlp",target:"thom_wolf"},{source:"srush_nlp",target:"douwekiela"},{source:"srush_nlp",target:"zicokolter"},{source:"srush_nlp",target:"andy_l_jones"},{source:"srush_nlp",target:"shamkakade6"},{source:"srush_nlp",target:"khoomeik"},{source:"srush_nlp",target:"miramurati"},{source:"csprofkgd",target:"_akhaliq"},{source:"csprofkgd",target:"docmilanfar"},{source:"csprofkgd",target:"mattniessner"},{source:"csprofkgd",target:"giffmana"},{source:"csprofkgd",target:"schmidhuberai"},{source:"csprofkgd",target:"soumithchintala"},{source:"csprofkgd",target:"arankomatsuzaki"},{source:"csprofkgd",target:"mmbronstein"},{source:"csprofkgd",target:"neuripsconf"},{source:"csprofkgd",target:"yoshua_bengio"},{source:"csprofkgd",target:"sedielem"},{source:"csprofkgd",target:"rasbt"},{source:"johnschulman2",target:"gdb"},{source:"johnschulman2",target:"goodside"},{source:"johnschulman2",target:"googledeepmind"},{source:"johnschulman2",target:"emostaque"},{source:"johnschulman2",target:"drjimfan"},{source:"johnschulman2",target:"woj_zaremba"},{source:"johnschulman2",target:"soumithchintala"},{source:"johnschulman2",target:"ilyasut"},{source:"johnschulman2",target:"arankomatsuzaki"},{source:"johnschulman2",target:"jeremyphoward"},{source:"johnschulman2",target:"giffmana"},{source:"johnschulman2",target:"anthropicai"},{source:"johnschulman2",target:"svlevine"},{source:"johnschulman2",target:"richardsocher"},{source:"johnschulman2",target:"mathemagic1an"},{source:"johnschulman2",target:"miles_brundage"},{source:"johnschulman2",target:"sammcallister"},{source:"johnschulman2",target:"moltbook"},{source:"johnschulman2",target:"claudeai"},{source:"rihardjarc",target:"claudeai"},{source:"rihardjarc",target:"darioamodei"},{source:"rihardjarc",target:"steipete"},{source:"rihardjarc",target:"openclaw"},{source:"rihardjarc",target:"nvidianewsroom"},{source:"ai__pub",target:"karpathy"},{source:"ai__pub",target:"ylecun"},{source:"ai__pub",target:"_akhaliq"},{source:"ai__pub",target:"fchollet"},{source:"ai__pub",target:"hardmaru"},{source:"ai__pub",target:"gdb"},{source:"ai__pub",target:"emostaque"},{source:"ai__pub",target:"rasbt"},{source:"ai__pub",target:"googledeepmind"},{source:"ai__pub",target:"drjimfan"},{source:"ai__pub",target:"omarsar0"},{source:"ai__pub",target:"lioronai"},{source:"ai__pub",target:"arankomatsuzaki"},{source:"ai__pub",target:"pytorch"},{source:"ai__pub",target:"jeremyphoward"},{source:"ai__pub",target:"soumithchintala"},{source:"ai__pub",target:"jeffdean"},{source:"ai__pub",target:"chhillee"},{source:"ai__pub",target:"suchenzang"},{source:"ai__pub",target:"pirroh"},{source:"ai__pub",target:"perplexity_ai"},{source:"amandaaskell",target:"esyudkowsky"},{source:"amandaaskell",target:"nickcammarata"},{source:"amandaaskell",target:"miles_brundage"},{source:"amandaaskell",target:"anthropicai"},{source:"amandaaskell",target:"claudeai"},{source:"amandaaskell",target:"ancadianadragan"},{source:"amandaaskell",target:"lexfridman"},{source:"amandaaskell",target:"darioamodei"},{source:"amandaaskell",target:"yoshua_bengio"},{source:"amandaaskell",target:"alexalbert__"},{source:"amandaaskell",target:"stuartjritchie"},{source:"tobyphln",target:"imhaotian"},{source:"tobyphln",target:"aelluswamy"},{source:"tobyphln",target:"lm_zheng"},{source:"tobyphln",target:"thsottiaux"},{source:"sebastienbubeck",target:"thegautamkamath"},{source:"sebastienbubeck",target:"docmilanfar"},{source:"sebastienbubeck",target:"roydanroy"},{source:"sebastienbubeck",target:"sirbayes"},{source:"sebastienbubeck",target:"boazbaraktcs"},{source:"sebastienbubeck",target:"mmbronstein"},{source:"sebastienbubeck",target:"neuripsconf"},{source:"sebastienbubeck",target:"tdietterich"},{source:"sebastienbubeck",target:"zacharylipton"},{source:"sebastienbubeck",target:"moltbook"},{source:"sebastienbubeck",target:"thsottiaux"},{source:"sebastienbubeck",target:"chatgpt21"},{source:"sebastienbubeck",target:"chhillee"},{source:"sebastienbubeck",target:"ericzelikman"},{source:"julien_c",target:"omarsar0"},{source:"julien_c",target:"clementdelangue"},{source:"julien_c",target:"mervenoyann"},{source:"julien_c",target:"huggingface"},{source:"julien_c",target:"abhi1thakur"},{source:"julien_c",target:"soumithchintala"},{source:"julien_c",target:"pytorch"},{source:"julien_c",target:"jeremyphoward"},{source:"julien_c",target:"osanseviero"},{source:"julien_c",target:"deliprao"},{source:"julien_c",target:"thom_wolf"},{source:"julien_c",target:"richardsocher"},{source:"julien_c",target:"srush_nlp"},{source:"julien_c",target:"_nateraw"},{source:"julien_c",target:"darioamodei"},{source:"julien_c",target:"bcherny"},{source:"nvidiashield",target:"nvidiageforce"},{source:"nvidiashield",target:"nvidiagfn"},{source:"nvidiashield",target:"nvidiastudio"},{source:"nvidiashield",target:"nvidiageforceuk"},{source:"nvidiashield",target:"nvidiaanz"},{source:"nvidiashield",target:"nvidia"},{source:"sirbayes",target:"docmilanfar"},{source:"sirbayes",target:"schmidhuberai"},{source:"sirbayes",target:"giffmana"},{source:"sirbayes",target:"soumithchintala"},{source:"sirbayes",target:"roydanroy"},{source:"sirbayes",target:"neuripsconf"},{source:"sirbayes",target:"mmbronstein"},{source:"sirbayes",target:"svlevine"},{source:"sirbayes",target:"tdietterich"},{source:"sirbayes",target:"claudeai"},{source:"sirbayes",target:"palmerluckey"},{source:"sirbayes",target:"rasbt"},{source:"miles_brundage",target:"deliprao"},{source:"miles_brundage",target:"arankomatsuzaki"},{source:"miles_brundage",target:"soumithchintala"},{source:"miles_brundage",target:"jackclarksf"},{source:"miles_brundage",target:"anthropicai"},{source:"miles_brundage",target:"richardsocher"},{source:"miles_brundage",target:"woj_zaremba"},{source:"miles_brundage",target:"giffmana"},{source:"miles_brundage",target:"savvyrl"},{source:"miles_brundage",target:"sleepinyourhat"},{source:"miles_brundage",target:"amandaaskell"},{source:"miles_brundage",target:"srush_nlp"},{source:"miles_brundage",target:"openaidevs"},{source:"sedielem",target:"soumithchintala"},{source:"sedielem",target:"giffmana"},{source:"sedielem",target:"arankomatsuzaki"},{source:"sedielem",target:"pytorch"},{source:"sedielem",target:"schmidhuberai"},{source:"sedielem",target:"jeremyphoward"},{source:"sedielem",target:"richardsocher"},{source:"sedielem",target:"sirbayes"},{source:"sedielem",target:"csprofkgd"},{source:"sedielem",target:"chhillee"},{source:"sedielem",target:"woj_zaremba"},{source:"sedielem",target:"oriolvinyalsml"},{source:"sedielem",target:"iamtrask"},{source:"sedielem",target:"srush_nlp"},{source:"sedielem",target:"neuripsconf"},{source:"sedielem",target:"savvyrl"},{source:"sedielem",target:"moltbook"},{source:"sedielem",target:"goodside"},{source:"deliprao",target:"arankomatsuzaki"},{source:"deliprao",target:"srush_nlp"},{source:"deliprao",target:"giffmana"},{source:"deliprao",target:"csprofkgd"},{source:"deliprao",target:"thegautamkamath"},{source:"deliprao",target:"clementdelangue"},{source:"deliprao",target:"savvyrl"},{source:"deliprao",target:"sirbayes"},{source:"deliprao",target:"_jasonwei"},{source:"deliprao",target:"chhillee"},{source:"deliprao",target:"miles_brundage"},{source:"deliprao",target:"sarahookr"},{source:"deliprao",target:"chrmanning"},{source:"deliprao",target:"roydanroy"},{source:"deliprao",target:"adocomplete"},{source:"deliprao",target:"bcherny"},{source:"deliprao",target:"aelluswamy"},{source:"zacharylipton",target:"thegautamkamath"},{source:"zacharylipton",target:"roydanroy"},{source:"zacharylipton",target:"giffmana"},{source:"zacharylipton",target:"savvyrl"},{source:"zacharylipton",target:"srush_nlp"},{source:"zacharylipton",target:"neuripsconf"},{source:"zacharylipton",target:"tdietterich"},{source:"zacharylipton",target:"sarahookr"},{source:"zacharylipton",target:"chrmanning"},{source:"zacharylipton",target:"sleepinyourhat"},{source:"zacharylipton",target:"natashajaques"},{source:"zacharylipton",target:"karpathy"},{source:"zacharylipton",target:"emollick"},{source:"zacharylipton",target:"suchenzang"},{source:"zacharylipton",target:"alexandr_wang"},{source:"zacharylipton",target:"_jasonwei"},{source:"zacharylipton",target:"yuhu_ai_"},{source:"nvidiastudio",target:"nvidiagfn"},{source:"nvidiastudio",target:"nvidiaanz"},{source:"nvidiastudio",target:"nvidia"},{source:"nvidiastudio",target:"nvidiaomniverse"},{source:"nvidiastudio",target:"nvidiagamedev"},{source:"nvidiastudio",target:"nvidianewsroom"},{source:"nvidiastudio",target:"nvidia_ai_pc"},{source:"__tinygrad__",target:"openclaw"},{source:"__tinygrad__",target:"zai_org"},{source:"__tinygrad__",target:"allen_ai"},{source:"__tinygrad__",target:"openai"},{source:"roydanroy",target:"thegautamkamath"},{source:"roydanroy",target:"csprofkgd"},{source:"roydanroy",target:"sirbayes"},{source:"roydanroy",target:"savvyrl"},{source:"roydanroy",target:"mmbronstein"},{source:"roydanroy",target:"zacharylipton"},{source:"roydanroy",target:"tdietterich"},{source:"roydanroy",target:"srush_nlp"},{source:"roydanroy",target:"petarv_93"},{source:"roydanroy",target:"sarahookr"},{source:"roydanroy",target:"suchenzang"},{source:"roydanroy",target:"jsuarez"},{source:"osanseviero",target:"_akhaliq"},{source:"osanseviero",target:"rasbt"},{source:"osanseviero",target:"omarsar0"},{source:"osanseviero",target:"mervenoyann"},{source:"osanseviero",target:"drjimfan"},{source:"osanseviero",target:"huggingface"},{source:"osanseviero",target:"abhi1thakur"},{source:"osanseviero",target:"clementdelangue"},{source:"osanseviero",target:"julien_c"},{source:"osanseviero",target:"jeremyphoward"},{source:"osanseviero",target:"pytorch"},{source:"osanseviero",target:"soumithchintala"},{source:"osanseviero",target:"arankomatsuzaki"},{source:"osanseviero",target:"lioronai"},{source:"osanseviero",target:"giffmana"},{source:"osanseviero",target:"jonathanross321"},{source:"thegautamkamath",target:"docmilanfar"},{source:"thegautamkamath",target:"roydanroy"},{source:"thegautamkamath",target:"savvyrl"},{source:"thegautamkamath",target:"neuripsconf"},{source:"thegautamkamath",target:"mmbronstein"},{source:"thegautamkamath",target:"boazbaraktcs"},{source:"thegautamkamath",target:"sebastienbubeck"},{source:"thegautamkamath",target:"zacharylipton"},{source:"thegautamkamath",target:"sarahookr"},{source:"thegautamkamath",target:"littmath"},{source:"mathemagic1an",target:"goodside"},{source:"mathemagic1an",target:"gdb"},{source:"mathemagic1an",target:"_akhaliq"},{source:"mathemagic1an",target:"drjimfan"},{source:"mathemagic1an",target:"emostaque"},{source:"mathemagic1an",target:"alexandr_wang"},{source:"mathemagic1an",target:"ai__pub"},{source:"mathemagic1an",target:"lioronai"},{source:"mathemagic1an",target:"arankomatsuzaki"},{source:"mathemagic1an",target:"alexgraveley"},{source:"mathemagic1an",target:"steipete"},{source:"mathemagic1an",target:"addyosmani"},{source:"mathemagic1an",target:"thsottiaux"},{source:"tdietterich",target:"soumithchintala"},{source:"tdietterich",target:"deliprao"},{source:"tdietterich",target:"giffmana"},{source:"tdietterich",target:"roydanroy"},{source:"tdietterich",target:"thegautamkamath"},{source:"tdietterich",target:"sirbayes"},{source:"tdietterich",target:"savvyrl"},{source:"tdietterich",target:"neuripsconf"},{source:"tdietterich",target:"zacharylipton"},{source:"tdietterich",target:"svlevine"},{source:"tdietterich",target:"srush_nlp"},{source:"tdietterich",target:"sarahookr"},{source:"tdietterich",target:"geoffreylitt"},{source:"tdietterich",target:"ilyasut"},{source:"tdietterich",target:"omarsar0"},{source:"tdietterich",target:"docmilanfar"},{source:"nvidiageforcetr",target:"nvidiagfn"},{source:"nvidiagamedev",target:"nvidiastudio"},{source:"nvidiagamedev",target:"nvidia"},{source:"nvidiagamedev",target:"nvidiaaidev"},{source:"nvidiagamedev",target:"nvidiaomniverse"},{source:"nvidiagamedev",target:"nvidiaai"},{source:"nvidiagamedev",target:"nvidiarobotics"},{source:"nvidiagamedev",target:"nvidianewsroom"},{source:"nvidiagamedev",target:"nvidia_ai_pc"},{source:"nvidiagamedev",target:"nvidiagtc"},{source:"nvidiagamedev",target:"nvidiageforcede"},{source:"nvidiagamedev",target:"nvidiageforcefr"},{source:"nvidiagamedev",target:"nvidiageforcepl"},{source:"nvidiagamedev",target:"nvidiaanz"},{source:"nvidiagamedev",target:"nvidiageforcela"},{source:"sarahookr",target:"deliprao"},{source:"sarahookr",target:"savvyrl"},{source:"sarahookr",target:"arankomatsuzaki"},{source:"sarahookr",target:"giffmana"},{source:"sarahookr",target:"thegautamkamath"},{source:"sarahookr",target:"roydanroy"},{source:"sarahookr",target:"srush_nlp"},{source:"sarahookr",target:"neuripsconf"},{source:"sarahookr",target:"zacharylipton"},{source:"sarahookr",target:"sashamtl"},{source:"sarahookr",target:"chhillee"},{source:"sarahookr",target:"egrefen"},{source:"sarahookr",target:"_jasonwei"},{source:"mmbronstein",target:"docmilanfar"},{source:"mmbronstein",target:"csprofkgd"},{source:"mmbronstein",target:"petarv_93"},{source:"mmbronstein",target:"giffmana"},{source:"mmbronstein",target:"mattniessner"},{source:"mmbronstein",target:"sirbayes"},{source:"mmbronstein",target:"neuripsconf"},{source:"mmbronstein",target:"thegautamkamath"},{source:"mmbronstein",target:"savvyrl"},{source:"mmbronstein",target:"roydanroy"},{source:"mmbronstein",target:"deryatr_"},{source:"mmbronstein",target:"tom_doerr"},{source:"littmath",target:"thegautamkamath"},{source:"littmath",target:"jeffdean"},{source:"littmath",target:"demishassabis"},{source:"littmath",target:"alexwei_"},{source:"nvidiahpcdev",target:"nvidia"},{source:"nvidiahpcdev",target:"nvidiaaidev"},{source:"nvidiahpcdev",target:"soumithchintala"},{source:"nvidiahpcdev",target:"nvidiaai"},{source:"nvidiahpcdev",target:"nvidiarobotics"},{source:"nvidiahpcdev",target:"nvidiadc"},{source:"nvidiahpcdev",target:"nvidiaomniverse"},{source:"nvidiahpcdev",target:"sedielem"},{source:"nvidiahpcdev",target:"nvidiagamedev"},{source:"nvidiahpcdev",target:"nvidiahealth"},{source:"nvidiahpcdev",target:"nvidiagtc"},{source:"nvidiahpcdev",target:"goodfellow_ian"},{source:"nvidiahpcdev",target:"tensorflow"},{source:"theworldlabs",target:"karpathy"},{source:"theworldlabs",target:"geoffreyhinton"},{source:"theworldlabs",target:"jeffdean"},{source:"theworldlabs",target:"drfeifei"},{source:"nvidiadc",target:"nvidia"},{source:"nvidiadc",target:"nvidiaai"},{source:"nvidiadc",target:"nvidiastudio"},{source:"nvidiadc",target:"nvidiaaidev"},{source:"nvidiadc",target:"nvidiarobotics"},{source:"nvidiadc",target:"nvidiaomniverse"},{source:"nvidiadc",target:"nvidiahpcdev"},{source:"nvidiadc",target:"nvidiakorea"},{source:"nvidiadc",target:"nvidianewsroom"},{source:"nvidiadc",target:"nvidia_ai_pc"},{source:"nvidiadc",target:"nvidiaaijp"},{source:"nvidiadc",target:"nvidiagtc"},{source:"nvidiadc",target:"nvidiahealth"},{source:"nvidiadc",target:"goodfellow_ian"},{source:"nvidiadc",target:"ctnzr"},{source:"sleepinyourhat",target:"arankomatsuzaki"},{source:"sleepinyourhat",target:"srush_nlp"},{source:"sleepinyourhat",target:"chrmanning"},{source:"sleepinyourhat",target:"anthropicai"},{source:"sleepinyourhat",target:"miles_brundage"},{source:"sleepinyourhat",target:"_jasonwei"},{source:"sleepinyourhat",target:"gneubig"},{source:"sleepinyourhat",target:"savvyrl"},{source:"sleepinyourhat",target:"felixhill84"},{source:"sleepinyourhat",target:"sarahookr"},{source:"sleepinyourhat",target:"zacharylipton"},{source:"fofrai",target:"hardmaru"},{source:"fofrai",target:"_akhaliq"},{source:"fofrai",target:"openclaw"},{source:"fofrai",target:"moltbook"},{source:"fofrai",target:"steipete"},{source:"fofrai",target:"simpsoka"},{source:"fofrai",target:"esyudkowsky"},{source:"merettm",target:"sama"},{source:"merettm",target:"gdb"},{source:"merettm",target:"openai"},{source:"merettm",target:"sebastienbubeck"},{source:"dpkingma",target:"arankomatsuzaki"},{source:"dpkingma",target:"giffmana"},{source:"dpkingma",target:"sirbayes"},{source:"dpkingma",target:"sedielem"},{source:"dpkingma",target:"svlevine"},{source:"dpkingma",target:"tdietterich"},{source:"dpkingma",target:"oriolvinyalsml"},{source:"dpkingma",target:"_jasonwei"},{source:"dpkingma",target:"shaneguml"},{source:"dpkingma",target:"zoubinghahrama1"},{source:"dpkingma",target:"hochreitersepp"},{source:"shengjia_zhao",target:"karpathy"},{source:"shengjia_zhao",target:"drjimfan"},{source:"shengjia_zhao",target:"googledeepmind"},{source:"shengjia_zhao",target:"sama"},{source:"shengjia_zhao",target:"gdb"},{source:"shengjia_zhao",target:"fchollet"},{source:"shengjia_zhao",target:"richardsocher"},{source:"shengjia_zhao",target:"svlevine"},{source:"shengjia_zhao",target:"woj_zaremba"},{source:"shengjia_zhao",target:"zoubinghahrama1"},{source:"shengjia_zhao",target:"dpkingma"},{source:"shengjia_zhao",target:"jeffdean"},{source:"shengjia_zhao",target:"_jasonwei"},{source:"shengjia_zhao",target:"alexandr_wang"},{source:"shengjia_zhao",target:"satyanadella"},{source:"melmitchell1",target:"garymarcus"},{source:"melmitchell1",target:"schmidhuberai"},{source:"melmitchell1",target:"mmitchell_ai"},{source:"melmitchell1",target:"tdietterich"},{source:"melmitchell1",target:"roydanroy"},{source:"melmitchell1",target:"miles_brundage"},{source:"melmitchell1",target:"felixhill84"},{source:"melmitchell1",target:"anthropicai"},{source:"melmitchell1",target:"yoshua_bengio"},{source:"melmitchell1",target:"amandaaskell"},{source:"melmitchell1",target:"zicokolter"},{source:"savvyrl",target:"arankomatsuzaki"},{source:"savvyrl",target:"giffmana"},{source:"savvyrl",target:"deliprao"},{source:"savvyrl",target:"soumithchintala"},{source:"savvyrl",target:"csprofkgd"},{source:"savvyrl",target:"thegautamkamath"},{source:"savvyrl",target:"sarahookr"},{source:"savvyrl",target:"neuripsconf"},{source:"savvyrl",target:"_jasonwei"},{source:"savvyrl",target:"chhillee"},{source:"savvyrl",target:"anthropicai"},{source:"savvyrl",target:"srush_nlp"},{source:"savvyrl",target:"roydanroy"},{source:"savvyrl",target:"palmerluckey"},{source:"savvyrl",target:"egrefen"},{source:"savvyrl",target:"nanobanana"},{source:"savvyrl",target:"darioamodei"},{source:"nvidianewsroom",target:"nvidiageforceme"},{source:"nvidianewsroom",target:"nvidiageforcejp"},{source:"nvidianewsroom",target:"nvidiageforcebr"},{source:"nvidianewsroom",target:"nvidiageforcepl"},{source:"nvidianewsroom",target:"nvidiageforcees"},{source:"nvidianewsroom",target:"nvidiakorea"},{source:"nvidianewsroom",target:"nvidiajapan"},{source:"nvidianewsroom",target:"nvidiaaijp"},{source:"nvidianewsroom",target:"nvidiaanz"},{source:"nvidianewsroom",target:"nvidia_ai_pc"},{source:"nvidianewsroom",target:"nvidiaomniverse"},{source:"nvidianewsroom",target:"nvidiahealth"},{source:"nvidianewsroom",target:"nvidiagtc"},{source:"nvidianewsroom",target:"nvidiastudio"},{source:"nvidianewsroom",target:"nvidiagfn"},{source:"nvidianewsroom",target:"nvidiaaidev"},{source:"nvidianewsroom",target:"nvidiadrive"},{source:"nvidianewsroom",target:"nvidiaai"},{source:"nvidianewsroom",target:"nvidiageforcefr"},{source:"nvidianewsroom",target:"nvidiageforcede"},{source:"nvidianewsroom",target:"nvidiadc"},{source:"nvidianewsroom",target:"nvidiarobotics"},{source:"nvidianewsroom",target:"nvidiaworkstatn"},{source:"nvidianewsroom",target:"nvidiahpcdev"},{source:"nvidianewsroom",target:"nvidiageforceuk"},{source:"nvidianewsroom",target:"nvidiageforce"},{source:"nvidianewsroom",target:"nvidiacc"},{source:"nvidianewsroom",target:"nvidianetworkng"},{source:"nvidianewsroom",target:"nvidiagamedev"},{source:"nvidianewsroom",target:"nvidia"},{source:"joshwoodward",target:"steipete"},{source:"joshwoodward",target:"osanseviero"},{source:"joshwoodward",target:"_mohansolo"},{source:"joshwoodward",target:"nanobanana"},{source:"nvidiaanz",target:"nvidiageforceuk"},{source:"nvidiaanz",target:"nvidiastudio"},{source:"shaneguml",target:"drjimfan"},{source:"shaneguml",target:"arankomatsuzaki"},{source:"shaneguml",target:"soumithchintala"},{source:"shaneguml",target:"svlevine"},{source:"shaneguml",target:"giffmana"},{source:"shaneguml",target:"savvyrl"},{source:"shaneguml",target:"csprofkgd"},{source:"shaneguml",target:"woj_zaremba"},{source:"shaneguml",target:"_jasonwei"},{source:"shaneguml",target:"sirbayes"},{source:"shaneguml",target:"natashajaques"},{source:"shaneguml",target:"jm_alexia"},{source:"shaneguml",target:"openclaw"},{source:"shaneguml",target:"steipete"},{source:"shaneguml",target:"moltbook"},{source:"yuhu_ai_",target:"drjimfan"},{source:"yuhu_ai_",target:"arankomatsuzaki"},{source:"yuhu_ai_",target:"_jasonwei"},{source:"yuhu_ai_",target:"soumithchintala"},{source:"yuhu_ai_",target:"woj_zaremba"},{source:"yuhu_ai_",target:"shaneguml"},{source:"yuhu_ai_",target:"schmidhuberai"},{source:"yuhu_ai_",target:"chhillee"},{source:"yuhu_ai_",target:"srush_nlp"},{source:"yuhu_ai_",target:"svlevine"},{source:"yuhu_ai_",target:"jeffdean"},{source:"yuhu_ai_",target:"miles_brundage"},{source:"yuhu_ai_",target:"gavinsbaker"},{source:"yuhu_ai_",target:"yoshua_bengio"},{source:"jonathanross321",target:"levie"},{source:"jonathanross321",target:"nvidia"},{source:"jonathanross321",target:"ch402"},{source:"jonathanross321",target:"_akhaliq"},{source:"jonathanross321",target:"thom_wolf"},{source:"jonathanross321",target:"kalomaze"},{source:"jonathanross321",target:"sarahookr"},{source:"chhillee",target:"drjimfan"},{source:"chhillee",target:"soumithchintala"},{source:"chhillee",target:"pytorch"},{source:"chhillee",target:"arankomatsuzaki"},{source:"chhillee",target:"giffmana"},{source:"chhillee",target:"jeremyphoward"},{source:"chhillee",target:"srush_nlp"},{source:"chhillee",target:"wightmanr"},{source:"chhillee",target:"schmidhuberai"},{source:"chhillee",target:"anthropicai"},{source:"chhillee",target:"savvyrl"},{source:"chhillee",target:"_jasonwei"},{source:"chhillee",target:"heinrichkuttler"},{source:"egrefen",target:"soumithchintala"},{source:"egrefen",target:"roydanroy"},{source:"egrefen",target:"srush_nlp"},{source:"egrefen",target:"savvyrl"},{source:"egrefen",target:"sirbayes"},{source:"egrefen",target:"neuripsconf"},{source:"egrefen",target:"felixhill84"},{source:"egrefen",target:"sarahookr"},{source:"egrefen",target:"svlevine"},{source:"egrefen",target:"sedielem"},{source:"egrefen",target:"oriolvinyalsml"},{source:"egrefen",target:"chhillee"},{source:"egrefen",target:"zacharylipton"},{source:"egrefen",target:"chrmanning"},{source:"egrefen",target:"littmath"},{source:"egrefen",target:"julien_c"},{source:"egrefen",target:"clementdelangue"},{source:"egrefen",target:"ericzelikman"},{source:"egrefen",target:"liamfedus"},{source:"egrefen",target:"ctnzr"},{source:"mattniessner",target:"_akhaliq"},{source:"mattniessner",target:"csprofkgd"},{source:"mattniessner",target:"mmbronstein"},{source:"hendrycks",target:"woj_zaremba"},{source:"hendrycks",target:"_jasonwei"},{source:"hendrycks",target:"janleike"},{source:"hendrycks",target:"catherineols"},{source:"hendrycks",target:"tdietterich"},{source:"hendrycks",target:"demishassabis"},{source:"hendrycks",target:"garymarcus"},{source:"hendrycks",target:"esyudkowsky"},{source:"hendrycks",target:"yoshua_bengio"},{source:"hendrycks",target:"openainewsroom"},{source:"hendrycks",target:"goodfellow_ian"},{source:"peterberezinbca",target:"moltbook"},{source:"zai_org",target:"moltbook"},{source:"zai_org",target:"minchoi"},{source:"zai_org",target:"guohao_li"},{source:"zai_org",target:"demishassabis"},{source:"zai_org",target:"deryatr_"},{source:"zai_org",target:"satyanadella"},{source:"nvidiajapan",target:"nvidiageforcejp"},{source:"nvidiajapan",target:"nvidianewsroom"},{source:"nvidiajapan",target:"nvidiagtc"},{source:"nvidiajapan",target:"nvidiaomniverse"},{source:"chrszegedy",target:"docmilanfar"},{source:"chrszegedy",target:"giffmana"},{source:"chrszegedy",target:"soumithchintala"},{source:"chrszegedy",target:"arankomatsuzaki"},{source:"chrszegedy",target:"schmidhuberai"},{source:"chrszegedy",target:"csprofkgd"},{source:"chrszegedy",target:"deliprao"},{source:"chrszegedy",target:"woj_zaremba"},{source:"chrszegedy",target:"savvyrl"},{source:"chrszegedy",target:"thegautamkamath"},{source:"chrszegedy",target:"sirbayes"},{source:"chrszegedy",target:"chhillee"},{source:"chrszegedy",target:"deryatr_"},{source:"chrszegedy",target:"imhaotian"},{source:"billpeeb",target:"_akhaliq"},{source:"billpeeb",target:"karpathy"},{source:"billpeeb",target:"hardmaru"},{source:"billpeeb",target:"drjimfan"},{source:"billpeeb",target:"sama"},{source:"billpeeb",target:"arankomatsuzaki"},{source:"billpeeb",target:"soumithchintala"},{source:"billpeeb",target:"gdb"},{source:"billpeeb",target:"andrewyng"},{source:"billpeeb",target:"savvyrl"},{source:"billpeeb",target:"pytorch"},{source:"billpeeb",target:"woj_zaremba"},{source:"billpeeb",target:"oriolvinyalsml"},{source:"billpeeb",target:"yuhu_ai_"},{source:"billpeeb",target:"fidjissimo"},{source:"jeffteper",target:"steipete"},{source:"jeffteper",target:"ilyasut"},{source:"jeffteper",target:"geoffreyhinton"},{source:"jeffteper",target:"demishassabis"},{source:"jeffteper",target:"ylecun"},{source:"jeffteper",target:"mustafasuleyman"},{source:"jeffteper",target:"openai"},{source:"jeffteper",target:"karpathy"},{source:"jeffteper",target:"gdb"},{source:"jeffteper",target:"sebastienbubeck"},{source:"jeffteper",target:"palmerluckey"},{source:"petarv_93",target:"mmbronstein"},{source:"petarv_93",target:"schmidhuberai"},{source:"petarv_93",target:"soumithchintala"},{source:"petarv_93",target:"neuripsconf"},{source:"petarv_93",target:"chhillee"},{source:"petarv_93",target:"gordic_aleksa"},{source:"petarv_93",target:"srush_nlp"},{source:"petarv_93",target:"oriolvinyalsml"},{source:"petarv_93",target:"sarahookr"},{source:"petarv_93",target:"googleaistudio"},{source:"petarv_93",target:"suchenzang"},{source:"petarv_93",target:"shaneguml"},{source:"petarv_93",target:"googlelabs"},{source:"petarv_93",target:"officiallogank"},{source:"petarv_93",target:"darioamodei"},{source:"petarv_93",target:"yoshua_bengio"},{source:"black_in_ai",target:"mmitchell_ai"},{source:"black_in_ai",target:"sarahookr"},{source:"black_in_ai",target:"neuripsconf"},{source:"black_in_ai",target:"zacharylipton"},{source:"black_in_ai",target:"wimlworkshop"},{source:"black_in_ai",target:"chelseabfinn"},{source:"black_in_ai",target:"googleai"},{source:"npew",target:"gdb"},{source:"npew",target:"goodside"},{source:"npew",target:"hardmaru"},{source:"npew",target:"emostaque"},{source:"npew",target:"drjimfan"},{source:"npew",target:"alexandr_wang"},{source:"npew",target:"woj_zaremba"},{source:"npew",target:"arankomatsuzaki"},{source:"npew",target:"miramurati"},{source:"npew",target:"ai__pub"},{source:"npew",target:"ilyasut"},{source:"npew",target:"anthropicai"},{source:"npew",target:"soumithchintala"},{source:"npew",target:"miles_brundage"},{source:"npew",target:"moltbook"},{source:"npew",target:"embirico"},{source:"npew",target:"fidjissimo"},{source:"npew",target:"khoomeik"},{source:"unslothai",target:"nvidia_ai_pc"},{source:"unslothai",target:"matthewberman"},{source:"unslothai",target:"lioronai"},{source:"gneubig",target:"srush_nlp"},{source:"gneubig",target:"chrmanning"},{source:"gneubig",target:"_jasonwei"},{source:"gneubig",target:"zacharylipton"},{source:"gneubig",target:"douwekiela"},{source:"gneubig",target:"thom_wolf"},{source:"gneubig",target:"thsottiaux"},{source:"gneubig",target:"ilyasut"},{source:"gneubig",target:"askalphaxiv"},{source:"gneubig",target:"omarsar0"},{source:"gneubig",target:"_lewtun"},{source:"suchenzang",target:"drjimfan"},{source:"suchenzang",target:"soumithchintala"},{source:"suchenzang",target:"chhillee"},{source:"suchenzang",target:"deliprao"},{source:"suchenzang",target:"_jasonwei"},{source:"suchenzang",target:"savvyrl"},{source:"suchenzang",target:"giffmana"},{source:"suchenzang",target:"miles_brundage"},{source:"suchenzang",target:"yacinemtb"},{source:"suchenzang",target:"jackclarksf"},{source:"suchenzang",target:"artificialanlys"},{source:"suchenzang",target:"littmath"},{source:"suchenzang",target:"jm_alexia"},{source:"suchenzang",target:"alexgdimakis"},{source:"_mohansolo",target:"palmerluckey"},{source:"_mohansolo",target:"oriolvinyalsml"},{source:"_mohansolo",target:"shaneguml"},{source:"_mohansolo",target:"joshwoodward"},{source:"_mohansolo",target:"koraykv"},{source:"_mohansolo",target:"antigravity"},{source:"_mohansolo",target:"demishassabis"},{source:"_mohansolo",target:"jeffdean"},{source:"_mohansolo",target:"yacinemtb"},{source:"_mohansolo",target:"embirico"},{source:"_mohansolo",target:"lexfridman"},{source:"_mohansolo",target:"fidjissimo"},{source:"_mohansolo",target:"sriramk"},{source:"khoomeik",target:"sama"},{source:"khoomeik",target:"fchollet"},{source:"khoomeik",target:"tunguz"},{source:"khoomeik",target:"deliprao"},{source:"khoomeik",target:"chrmanning"},{source:"khoomeik",target:"drjimfan"},{source:"khoomeik",target:"goodside"},{source:"khoomeik",target:"_akhaliq"},{source:"khoomeik",target:"ylecun"},{source:"khoomeik",target:"karpathy"},{source:"khoomeik",target:"hardmaru"},{source:"khoomeik",target:"jackclarksf"},{source:"khoomeik",target:"_jasonwei"},{source:"khoomeik",target:"moltbook"},{source:"khoomeik",target:"jm_alexia"},{source:"khoomeik",target:"andy_l_jones"},{source:"tydsh",target:"soumithchintala"},{source:"tydsh",target:"svlevine"},{source:"tydsh",target:"neuripsconf"},{source:"tydsh",target:"_jasonwei"},{source:"tydsh",target:"shaneguml"},{source:"tydsh",target:"savvyrl"},{source:"tydsh",target:"chhillee"},{source:"tydsh",target:"oriolvinyalsml"},{source:"tydsh",target:"antigravity"},{source:"tydsh",target:"ericzelikman"},{source:"tydsh",target:"jm_alexia"},{source:"tydsh",target:"rohanpaul_ai"},{source:"alexgraveley",target:"goodside"},{source:"alexgraveley",target:"alexandr_wang"},{source:"alexgraveley",target:"drjimfan"},{source:"alexgraveley",target:"mathemagic1an"},{source:"alexgraveley",target:"yacinemtb"},{source:"alexgraveley",target:"woj_zaremba"},{source:"alexgraveley",target:"arankomatsuzaki"},{source:"alexgraveley",target:"ilyasut"},{source:"alexgraveley",target:"steipete"},{source:"alexgraveley",target:"svlevine"},{source:"alexgraveley",target:"timzaman"},{source:"sundeep",target:"levie"},{source:"sundeep",target:"sriramk"},{source:"sundeep",target:"chatgpt21"},{source:"sundeep",target:"steipete"},{source:"sundeep",target:"openaidevs"},{source:"sundeep",target:"nvidiaomniverse"},{source:"sundeep",target:"azaliamirh"},{source:"nvidiaworkstatn",target:"nvidiastudio"},{source:"nvidiaworkstatn",target:"nvidia"},{source:"nvidiaworkstatn",target:"nvidiaomniverse"},{source:"nvidiaworkstatn",target:"nvidiadc"},{source:"nvidiaworkstatn",target:"nvidiageforceuk"},{source:"nvidiaworkstatn",target:"nvidiaaidev"},{source:"nvidiaworkstatn",target:"nvidiaai"},{source:"nvidiaworkstatn",target:"nvidiarobotics"},{source:"nvidiaworkstatn",target:"nvidiahpcdev"},{source:"nvidiaworkstatn",target:"nvidianewsroom"},{source:"nvidiaworkstatn",target:"nvidianetworkng"},{source:"nvidiaworkstatn",target:"nvidiahealth"},{source:"nvidiaworkstatn",target:"nvidiagtc"},{source:"stuartjritchie",target:"catherineols"},{source:"stuartjritchie",target:"claudeai"},{source:"timzaman",target:"aelluswamy"},{source:"timzaman",target:"johnschulman2"},{source:"timzaman",target:"saranormous"},{source:"timzaman",target:"thsottiaux"},{source:"timzaman",target:"levie"},{source:"timzaman",target:"npew"},{source:"timzaman",target:"fidjissimo"},{source:"timzaman",target:"sriramk"},{source:"timzaman",target:"itstkai"},{source:"yoshua_bengio",target:"hendrycks"},{source:"yoshua_bengio",target:"openai"},{source:"yoshua_bengio",target:"miles_brundage"},{source:"mattt",target:"steipete"},{source:"chatgpt21",target:"sundeep"},{source:"chatgpt21",target:"openclaw"},{source:"zoubinghahrama1",target:"sirbayes"},{source:"zoubinghahrama1",target:"roydanroy"},{source:"zoubinghahrama1",target:"neuripsconf"},{source:"zoubinghahrama1",target:"giffmana"},{source:"zoubinghahrama1",target:"mmbronstein"},{source:"zoubinghahrama1",target:"savvyrl"},{source:"zoubinghahrama1",target:"svlevine"},{source:"zoubinghahrama1",target:"petarv_93"},{source:"zoubinghahrama1",target:"srush_nlp"},{source:"zoubinghahrama1",target:"tdietterich"},{source:"zoubinghahrama1",target:"sedielem"},{source:"zoubinghahrama1",target:"zacharylipton"},{source:"zoubinghahrama1",target:"sarahookr"},{source:"zoubinghahrama1",target:"_jasonwei"},{source:"zoubinghahrama1",target:"_mohansolo"},{source:"zoubinghahrama1",target:"fofrai"},{source:"zoubinghahrama1",target:"tulseedoshi"},{source:"zoubinghahrama1",target:"chris_j_paxton"},{source:"zoubinghahrama1",target:"drjimfan"},{source:"zoubinghahrama1",target:"nanobanana"},{source:"zoubinghahrama1",target:"suchenzang"},{source:"liamfedus",target:"drjimfan"},{source:"liamfedus",target:"arankomatsuzaki"},{source:"liamfedus",target:"giffmana"},{source:"liamfedus",target:"deliprao"},{source:"liamfedus",target:"soumithchintala"},{source:"liamfedus",target:"woj_zaremba"},{source:"liamfedus",target:"savvyrl"},{source:"liamfedus",target:"_jasonwei"},{source:"liamfedus",target:"chhillee"},{source:"liamfedus",target:"anthropicai"},{source:"liamfedus",target:"miles_brundage"},{source:"liamfedus",target:"srush_nlp"},{source:"liamfedus",target:"yuhu_ai_"},{source:"liamfedus",target:"bcherny"},{source:"liamfedus",target:"tydsh"},{source:"liamfedus",target:"billpeeb"},{source:"askalphaxiv",target:"sarahookr"},{source:"askalphaxiv",target:"allen_ai"},{source:"askalphaxiv",target:"ylecun"},{source:"askalphaxiv",target:"lateinteraction"},{source:"askalphaxiv",target:"karpathy"},{source:"cixliv",target:"openclaw"},{source:"cixliv",target:"moltbook"},{source:"cixliv",target:"jm_alexia"},{source:"natashajaques",target:"soumithchintala"},{source:"natashajaques",target:"savvyrl"},{source:"natashajaques",target:"svlevine"},{source:"natashajaques",target:"csprofkgd"},{source:"natashajaques",target:"thegautamkamath"},{source:"natashajaques",target:"neuripsconf"},{source:"natashajaques",target:"sarahookr"},{source:"natashajaques",target:"roydanroy"},{source:"natashajaques",target:"shaneguml"},{source:"natashajaques",target:"drjimfan"},{source:"natashajaques",target:"sama"},{source:"natashajaques",target:"melmitchell1"},{source:"natashajaques",target:"agarwl_"},{source:"jaykreps",target:"claudeai"},{source:"jaykreps",target:"egrefen"},{source:"jaykreps",target:"_mohansolo"},{source:"jaykreps",target:"bcherny"},{source:"jaykreps",target:"embirico"},{source:"jaykreps",target:"koraykv"},{source:"lateinteraction",target:"goodside"},{source:"lateinteraction",target:"ylecun"},{source:"lateinteraction",target:"sama"},{source:"lateinteraction",target:"karpathy"},{source:"lateinteraction",target:"arankomatsuzaki"},{source:"lateinteraction",target:"nils_reimers"},{source:"lateinteraction",target:"fchollet"},{source:"lateinteraction",target:"sleepinyourhat"},{source:"lateinteraction",target:"emostaque"},{source:"lateinteraction",target:"deliprao"},{source:"lateinteraction",target:"_jasonwei"},{source:"lateinteraction",target:"natashajaques"},{source:"chris_j_paxton",target:"ylecun"},{source:"chris_j_paxton",target:"_akhaliq"},{source:"chris_j_paxton",target:"drjimfan"},{source:"chris_j_paxton",target:"hardmaru"},{source:"chris_j_paxton",target:"googledeepmind"},{source:"chris_j_paxton",target:"svlevine"},{source:"chris_j_paxton",target:"soumithchintala"},{source:"chris_j_paxton",target:"docmilanfar"},{source:"chris_j_paxton",target:"arankomatsuzaki"},{source:"chris_j_paxton",target:"omarsar0"},{source:"gordic_aleksa",target:"hardmaru"},{source:"gordic_aleksa",target:"omarsar0"},{source:"gordic_aleksa",target:"googledeepmind"},{source:"gordic_aleksa",target:"pytorch"},{source:"gordic_aleksa",target:"soumithchintala"},{source:"gordic_aleksa",target:"petarv_93"},{source:"gordic_aleksa",target:"jeremyphoward"},{source:"gordic_aleksa",target:"giffmana"},{source:"gordic_aleksa",target:"arankomatsuzaki"},{source:"gordic_aleksa",target:"schmidhuberai"},{source:"gordic_aleksa",target:"mmbronstein"},{source:"gordic_aleksa",target:"huggingface"},{source:"gordic_aleksa",target:"chhillee"},{source:"gordic_aleksa",target:"woj_zaremba"},{source:"gordic_aleksa",target:"ilyasut"},{source:"gordic_aleksa",target:"wightmanr"},{source:"gordic_aleksa",target:"sarahookr"},{source:"gordic_aleksa",target:"miramurati"},{source:"gordic_aleksa",target:"saranormous"},{source:"gordic_aleksa",target:"sriramk"},{source:"gordic_aleksa",target:"shaneguml"},{source:"gordic_aleksa",target:"srush_nlp"},{source:"gordic_aleksa",target:"tobyphln"},{source:"gordic_aleksa",target:"jonathanross321"},{source:"jamesmontemagno",target:"satyanadella"},{source:"tkipf",target:"petarv_93"},{source:"tkipf",target:"mmbronstein"},{source:"tkipf",target:"csprofkgd"},{source:"tkipf",target:"sirbayes"},{source:"tkipf",target:"mattniessner"},{source:"tkipf",target:"neuripsconf"},{source:"tkipf",target:"savvyrl"},{source:"tkipf",target:"chhillee"},{source:"tkipf",target:"srush_nlp"},{source:"tkipf",target:"svlevine"},{source:"tkipf",target:"roydanroy"},{source:"tkipf",target:"sedielem"},{source:"tkipf",target:"ericzelikman"},{source:"tkipf",target:"antigravity"},{source:"tkipf",target:"nanobanana"},{source:"tkipf",target:"googleaistudio"},{source:"boazbaraktcs",target:"thegautamkamath"},{source:"boazbaraktcs",target:"roydanroy"},{source:"boazbaraktcs",target:"sebastienbubeck"},{source:"boazbaraktcs",target:"savvyrl"},{source:"boazbaraktcs",target:"srush_nlp"},{source:"boazbaraktcs",target:"zacharylipton"},{source:"boazbaraktcs",target:"tdietterich"},{source:"boazbaraktcs",target:"lateinteraction"},{source:"boazbaraktcs",target:"moltbook"},{source:"boazbaraktcs",target:"kalinowski007"},{source:"boazbaraktcs",target:"bcherny"},{source:"thsottiaux",target:"addyosmani"},{source:"thsottiaux",target:"miramurati"},{source:"thsottiaux",target:"steipete"},{source:"thsottiaux",target:"giffmana"},{source:"thsottiaux",target:"timzaman"},{source:"thsottiaux",target:"janleike"},{source:"thsottiaux",target:"gdb"},{source:"thsottiaux",target:"ilyasut"},{source:"thsottiaux",target:"woj_zaremba"},{source:"thsottiaux",target:"nickaturley"},{source:"nickaturley",target:"karpathy"},{source:"nickaturley",target:"gdb"},{source:"nickaturley",target:"goodside"},{source:"nickaturley",target:"ylecun"},{source:"nickaturley",target:"alexandr_wang"},{source:"nickaturley",target:"hardmaru"},{source:"nickaturley",target:"drjimfan"},{source:"nickaturley",target:"emostaque"},{source:"nickaturley",target:"miramurati"},{source:"nickaturley",target:"googledeepmind"},{source:"nickaturley",target:"woj_zaremba"},{source:"nickaturley",target:"esyudkowsky"},{source:"nickaturley",target:"openclaw"},{source:"zicokolter",target:"thegautamkamath"},{source:"zicokolter",target:"roydanroy"},{source:"zicokolter",target:"sirbayes"},{source:"zicokolter",target:"tdietterich"},{source:"zicokolter",target:"svlevine"},{source:"zicokolter",target:"zacharylipton"},{source:"zicokolter",target:"sebastienbubeck"},{source:"zicokolter",target:"natashajaques"},{source:"zicokolter",target:"steipete"},{source:"zicokolter",target:"demishassabis"},{source:"zicokolter",target:"tydsh"},{source:"zicokolter",target:"thsottiaux"},{source:"zicokolter",target:"yanndubs"},{source:"zicokolter",target:"saranormous"},{source:"rao2z",target:"tdietterich"},{source:"rao2z",target:"roydanroy"},{source:"rao2z",target:"melmitchell1"},{source:"rao2z",target:"srush_nlp"},{source:"rao2z",target:"chrmanning"},{source:"rao2z",target:"alexgdimakis"},{source:"rao2z",target:"lateinteraction"},{source:"rao2z",target:"fchollet"},{source:"rao2z",target:"dileeplearning"},{source:"rao2z",target:"karpathy"},{source:"rao2z",target:"andrewyng"},{source:"rao2z",target:"geoffreyhinton"},{source:"rao2z",target:"googledeepmind"},{source:"zeyuanallenzhu",target:"thegautamkamath"},{source:"zeyuanallenzhu",target:"sebastienbubeck"},{source:"zeyuanallenzhu",target:"roydanroy"},{source:"zeyuanallenzhu",target:"boazbaraktcs"},{source:"zeyuanallenzhu",target:"tydsh"},{source:"zeyuanallenzhu",target:"alexgdimakis"},{source:"zeyuanallenzhu",target:"sirbayes"},{source:"zeyuanallenzhu",target:"nandodf"},{source:"zeyuanallenzhu",target:"miramurati"},{source:"zeyuanallenzhu",target:"drjimfan"},{source:"zeyuanallenzhu",target:"demishassabis"},{source:"zeyuanallenzhu",target:"soumithchintala"},{source:"nvidia_ai_pc",target:"unslothai"},{source:"nvidia_ai_pc",target:"matthewberman"},{source:"nvidia_ai_pc",target:"nvidiagamedev"},{source:"nvidia_ai_pc",target:"nvidianewsroom"},{source:"nvidia_ai_pc",target:"nvidiaaidev"},{source:"nvidia_ai_pc",target:"nvidiastudio"},{source:"nvidia_ai_pc",target:"nvidiaai"},{source:"nvidia_ai_pc",target:"nvidiageforce"},{source:"nvidia_ai_pc",target:"nvidia"},{source:"jm_alexia",target:"_akhaliq"},{source:"jm_alexia",target:"docmilanfar"},{source:"jm_alexia",target:"arankomatsuzaki"},{source:"jm_alexia",target:"soumithchintala"},{source:"jm_alexia",target:"giffmana"},{source:"jm_alexia",target:"deliprao"},{source:"jm_alexia",target:"csprofkgd"},{source:"jm_alexia",target:"sirbayes"},{source:"jm_alexia",target:"savvyrl"},{source:"jm_alexia",target:"chhillee"},{source:"jm_alexia",target:"sedielem"},{source:"jm_alexia",target:"schmidhuberai"},{source:"jm_alexia",target:"thegautamkamath"},{source:"jm_alexia",target:"rihardjarc"},{source:"jm_alexia",target:"chrszegedy"},{source:"alexwei_",target:"yanndubs"},{source:"alexwei_",target:"merettm"},{source:"alexwei_",target:"sleepinyourhat"},{source:"alexwei_",target:"sama"},{source:"alexwei_",target:"sebastienbubeck"},{source:"alexwei_",target:"chatgptapp"},{source:"nvidiaomniverse",target:"nvidiastudio"},{source:"nvidiaomniverse",target:"nvidia"},{source:"nvidiaomniverse",target:"nvidiaai"},{source:"nvidiaomniverse",target:"nvidiaaidev"},{source:"nvidiaomniverse",target:"nvidiaworkstatn"},{source:"nvidiaomniverse",target:"nvidiadc"},{source:"nvidiaomniverse",target:"nvidiarobotics"},{source:"nvidiaomniverse",target:"nvidiadrive"},{source:"nvidiaomniverse",target:"ctnzr"},{source:"nvidiaomniverse",target:"nvidianewsroom"},{source:"nvidiaomniverse",target:"huggingface"},{source:"nvidiaomniverse",target:"azure"},{source:"nvidiaomniverse",target:"openai"},{source:"ctnzr",target:"hardmaru"},{source:"ctnzr",target:"soumithchintala"},{source:"ctnzr",target:"schmidhuberai"},{source:"ctnzr",target:"jeremyphoward"},{source:"ctnzr",target:"richardsocher"},{source:"ctnzr",target:"iamtrask"},{source:"ctnzr",target:"jeffdean"},{source:"ctnzr",target:"woj_zaremba"},{source:"ctnzr",target:"svlevine"},{source:"ctnzr",target:"sedielem"},{source:"ctnzr",target:"clementdelangue"},{source:"ctnzr",target:"oriolvinyalsml"},{source:"ctnzr",target:"dpkingma"},{source:"ctnzr",target:"miramurati"},{source:"embirico",target:"sama"},{source:"embirico",target:"levie"},{source:"embirico",target:"emollick"},{source:"embirico",target:"thsottiaux"},{source:"embirico",target:"zicokolter"},{source:"ericzelikman",target:"drjimfan"},{source:"ericzelikman",target:"karpathy"},{source:"ericzelikman",target:"_akhaliq"},{source:"ericzelikman",target:"goodside"},{source:"ericzelikman",target:"tunguz"},{source:"ericzelikman",target:"rasbt"},{source:"ericzelikman",target:"_jasonwei"},{source:"ericzelikman",target:"chhillee"},{source:"ericzelikman",target:"yuhu_ai_"},{source:"ericzelikman",target:"chrmanning"},{source:"ericzelikman",target:"mathemagic1an"},{source:"ericzelikman",target:"garymarcus"},{source:"ericzelikman",target:"shaneguml"},{source:"ericzelikman",target:"sleepinyourhat"},{source:"ericzelikman",target:"mmbronstein"},{source:"ericzelikman",target:"minchoi"},{source:"wightmanr",target:"_akhaliq"},{source:"wightmanr",target:"rasbt"},{source:"wightmanr",target:"omarsar0"},{source:"wightmanr",target:"giffmana"},{source:"wightmanr",target:"pytorch"},{source:"wightmanr",target:"soumithchintala"},{source:"wightmanr",target:"jeremyphoward"},{source:"wightmanr",target:"arankomatsuzaki"},{source:"wightmanr",target:"abhi1thakur"},{source:"wightmanr",target:"mervenoyann"},{source:"wightmanr",target:"huggingface"},{source:"wightmanr",target:"chhillee"},{source:"wightmanr",target:"julien_c"},{source:"wightmanr",target:"clementdelangue"},{source:"wightmanr",target:"steipete"},{source:"wightmanr",target:"openclaw"},{source:"wightmanr",target:"getjonwithit"},{source:"sashamtl",target:"mmitchell_ai"},{source:"sashamtl",target:"mervenoyann"},{source:"sashamtl",target:"clementdelangue"},{source:"sashamtl",target:"huggingface"},{source:"sashamtl",target:"osanseviero"},{source:"sashamtl",target:"julien_c"},{source:"sashamtl",target:"deliprao"},{source:"sashamtl",target:"savvyrl"},{source:"sashamtl",target:"sarahookr"},{source:"sashamtl",target:"abhi1thakur"},{source:"sashamtl",target:"giffmana"},{source:"sashamtl",target:"thom_wolf"},{source:"sashamtl",target:"_nateraw"},{source:"sashamtl",target:"srush_nlp"},{source:"alexgdimakis",target:"docmilanfar"},{source:"alexgdimakis",target:"thegautamkamath"},{source:"alexgdimakis",target:"roydanroy"},{source:"alexgdimakis",target:"csprofkgd"},{source:"alexgdimakis",target:"savvyrl"},{source:"alexgdimakis",target:"zacharylipton"},{source:"alexgdimakis",target:"sirbayes"},{source:"alexgdimakis",target:"sebastienbubeck"},{source:"alexgdimakis",target:"mmbronstein"},{source:"alexgdimakis",target:"thsottiaux"},{source:"alexgdimakis",target:"fidjissimo"},{source:"simpsoka",target:"koraykv"},{source:"simpsoka",target:"tulseedoshi"},{source:"simpsoka",target:"_mohansolo"},{source:"kalomaze",target:"claudeai"},{source:"nvidiagtc",target:"nvidiageforce"},{source:"nvidiagtc",target:"ylecun"},{source:"nvidiagtc",target:"nvidia"},{source:"nvidiagtc",target:"nvidiastudio"},{source:"nvidiagtc",target:"andrewyng"},{source:"nvidiagtc",target:"tunguz"},{source:"nvidiagtc",target:"nvidiaomniverse"},{source:"nvidiagtc",target:"googledeepmind"},{source:"nvidiagtc",target:"nvidiaaidev"},{source:"nvidiagtc",target:"drjimfan"},{source:"nvidiagtc",target:"nvidiaai"},{source:"nvidiagtc",target:"pytorch"},{source:"nvidiagtc",target:"nvidiarobotics"},{source:"nvidiagtc",target:"nvidiadc"},{source:"nvidiagtc",target:"nvidiaworkstatn"},{source:"nvidiagtc",target:"nvidiahpcdev"},{source:"nvidiagtc",target:"nvidiadrive"},{source:"nvidiagtc",target:"nvidianewsroom"},{source:"risingsayak",target:"rasbt"},{source:"risingsayak",target:"abhi1thakur"},{source:"risingsayak",target:"jeremyphoward"},{source:"risingsayak",target:"pytorch"},{source:"risingsayak",target:"huggingface"},{source:"risingsayak",target:"giffmana"},{source:"risingsayak",target:"soumithchintala"},{source:"risingsayak",target:"tensorflow"},{source:"risingsayak",target:"iamtrask"},{source:"risingsayak",target:"srush_nlp"},{source:"risingsayak",target:"thom_wolf"},{source:"risingsayak",target:"sarahookr"},{source:"risingsayak",target:"oriolvinyalsml"},{source:"risingsayak",target:"svlevine"},{source:"risingsayak",target:"josh_tobin_"},{source:"risingsayak",target:"satyanadella"},{source:"risingsayak",target:"ilyasut"},{source:"risingsayak",target:"geoffreyhinton"},{source:"risingsayak",target:"nvidiaai"},{source:"brentm_spacex",target:"rayhotate"},{source:"brentm_spacex",target:"heinrichkuttler"},{source:"brentm_spacex",target:"hendrycks"},{source:"brentm_spacex",target:"yuhu_ai_"},{source:"adocomplete",target:"geoffreylitt"},{source:"adocomplete",target:"bcherny"},{source:"adocomplete",target:"_mohansolo"},{source:"adocomplete",target:"antigravity"},{source:"adocomplete",target:"clementdelangue"},{source:"adocomplete",target:"goodside"},{source:"adocomplete",target:"osanseviero"},{source:"geoffreylitt",target:"bcherny"},{source:"geoffreylitt",target:"embirico"},{source:"koraykv",target:"ylecun"},{source:"koraykv",target:"googledeepmind"},{source:"koraykv",target:"soumithchintala"},{source:"koraykv",target:"oriolvinyalsml"},{source:"koraykv",target:"sedielem"},{source:"koraykv",target:"egrefen"},{source:"koraykv",target:"anthropicai"},{source:"koraykv",target:"demishassabis"},{source:"koraykv",target:"ilyasut"},{source:"koraykv",target:"jeffdean"},{source:"koraykv",target:"nandodf"},{source:"koraykv",target:"natashajaques"},{source:"koraykv",target:"chrmanning"},{source:"koraykv",target:"mustafasuleyman"},{source:"koraykv",target:"dileeplearning"},{source:"koraykv",target:"antigravity"},{source:"koraykv",target:"_mohansolo"},{source:"koraykv",target:"fchollet"},{source:"koraykv",target:"emollick"},{source:"koraykv",target:"officiallogank"},{source:"koraykv",target:"arena"},{source:"koraykv",target:"goodfellow_ian"},{source:"nvidiacc",target:"nvidiageforce"},{source:"nvidiacc",target:"nvidiagfn"},{source:"nvidiacc",target:"nvidiageforceuk"},{source:"nvidiacc",target:"nvidia"},{source:"nvidiacc",target:"nvidiarobotics"},{source:"nvidiacc",target:"nvidiaai"},{source:"nvidiacc",target:"nvidiaaidev"},{source:"nvidiacc",target:"nvidiaworkstatn"},{source:"nvidiacc",target:"nvidiaomniverse"},{source:"nvidiacc",target:"nvidiadc"},{source:"nvidiacc",target:"nvidiagtc"},{source:"nvidiacc",target:"nvidiashield"},{source:"hannawallach",target:"mmitchell_ai"},{source:"hannawallach",target:"roydanroy"},{source:"hannawallach",target:"neuripsconf"},{source:"hannawallach",target:"zacharylipton"},{source:"hannawallach",target:"srush_nlp"},{source:"hannawallach",target:"sarahookr"},{source:"hannawallach",target:"chrmanning"},{source:"hannawallach",target:"sleepinyourhat"},{source:"hannawallach",target:"tdietterich"},{source:"hannawallach",target:"sashamtl"},{source:"hannawallach",target:"melmitchell1"},{source:"hannawallach",target:"sirbayes"},{source:"remicadene",target:"karpathy"},{source:"remicadene",target:"_akhaliq"},{source:"remicadene",target:"ylecun"},{source:"remicadene",target:"hardmaru"},{source:"remicadene",target:"googledeepmind"},{source:"remicadene",target:"timzaman"},{source:"remicadene",target:"gdb"},{source:"remicadene",target:"fchollet"},{source:"remicadene",target:"bcherny"},{source:"maithra_raghu",target:"soumithchintala"},{source:"maithra_raghu",target:"savvyrl"},{source:"maithra_raghu",target:"giffmana"},{source:"maithra_raghu",target:"deliprao"},{source:"maithra_raghu",target:"srush_nlp"},{source:"maithra_raghu",target:"sarahookr"},{source:"maithra_raghu",target:"zacharylipton"},{source:"maithra_raghu",target:"neuripsconf"},{source:"maithra_raghu",target:"natashajaques"},{source:"maithra_raghu",target:"svlevine"},{source:"maithra_raghu",target:"sedielem"},{source:"maithra_raghu",target:"fidjissimo"},{source:"maithra_raghu",target:"levie"},{source:"maithra_raghu",target:"askalphaxiv"},{source:"maithra_raghu",target:"satyanadella"},{source:"maithra_raghu",target:"nandodf"},{source:"maithra_raghu",target:"sriramk"},{source:"maithra_raghu",target:"fchollet"},{source:"agarwl_",target:"svlevine"},{source:"agarwl_",target:"savvyrl"},{source:"agarwl_",target:"docmilanfar"},{source:"agarwl_",target:"shaneguml"},{source:"agarwl_",target:"soumithchintala"},{source:"agarwl_",target:"sirbayes"},{source:"agarwl_",target:"natashajaques"},{source:"agarwl_",target:"neuripsconf"},{source:"agarwl_",target:"arankomatsuzaki"},{source:"agarwl_",target:"giffmana"},{source:"agarwl_",target:"sarahookr"},{source:"agarwl_",target:"roydanroy"},{source:"agarwl_",target:"unslothai"},{source:"agarwl_",target:"bcherny"},{source:"agarwl_",target:"shamkakade6"},{source:"xwang_lk",target:"arankomatsuzaki"},{source:"xwang_lk",target:"csprofkgd"},{source:"xwang_lk",target:"srush_nlp"},{source:"xwang_lk",target:"gneubig"},{source:"xwang_lk",target:"thegautamkamath"},{source:"xwang_lk",target:"sleepinyourhat"},{source:"xwang_lk",target:"tydsh"},{source:"xwang_lk",target:"steipete"},{source:"xwang_lk",target:"andy_l_jones"},{source:"xwang_lk",target:"askalphaxiv"},{source:"xwang_lk",target:"jm_alexia"},{source:"xwang_lk",target:"yoshua_bengio"},{source:"heinrichkuttler",target:"ylecun"},{source:"heinrichkuttler",target:"karpathy"},{source:"heinrichkuttler",target:"hardmaru"},{source:"heinrichkuttler",target:"googledeepmind"},{source:"heinrichkuttler",target:"_akhaliq"},{source:"heinrichkuttler",target:"fchollet"},{source:"heinrichkuttler",target:"egrefen"},{source:"heinrichkuttler",target:"soumithchintala"},{source:"heinrichkuttler",target:"drjimfan"},{source:"heinrichkuttler",target:"giffmana"},{source:"heinrichkuttler",target:"gdb"},{source:"heinrichkuttler",target:"felixhill84"},{source:"heinrichkuttler",target:"arankomatsuzaki"},{source:"heinrichkuttler",target:"andrewyng"},{source:"heinrichkuttler",target:"tunguz"},{source:"heinrichkuttler",target:"steipete"},{source:"heinrichkuttler",target:"chatgpt21"},{source:"sammcallister",target:"johnschulman2"},{source:"sammcallister",target:"demishassabis"},{source:"jfpuget",target:"ylecun"},{source:"jfpuget",target:"omarsar0"},{source:"jfpuget",target:"mervenoyann"},{source:"jfpuget",target:"pytorch"},{source:"jfpuget",target:"soumithchintala"},{source:"jfpuget",target:"giffmana"},{source:"jfpuget",target:"arankomatsuzaki"},{source:"jfpuget",target:"huggingface"},{source:"jfpuget",target:"julien_c"},{source:"jfpuget",target:"schmidhuberai"},{source:"jfpuget",target:"wightmanr"},{source:"jfpuget",target:"sarahookr"},{source:"jfpuget",target:"bcherny"},{source:"jfpuget",target:"askalphaxiv"},{source:"catherineols",target:"miles_brundage"},{source:"catherineols",target:"jackclarksf"},{source:"catherineols",target:"anthropicai"},{source:"catherineols",target:"amandaaskell"},{source:"catherineols",target:"woj_zaremba"},{source:"catherineols",target:"savvyrl"},{source:"catherineols",target:"sleepinyourhat"},{source:"catherineols",target:"roydanroy"},{source:"catherineols",target:"sarahookr"},{source:"catherineols",target:"sriramk"},{source:"catherineols",target:"claudeai"},{source:"catherineols",target:"stuartjritchie"},{source:"catherineols",target:"johnschulman2"},{source:"aprilwright",target:"ylecun"},{source:"aprilwright",target:"soumithchintala"},{source:"aprilwright",target:"tdietterich"},{source:"aprilwright",target:"garymarcus"},{source:"nielsrogge",target:"_akhaliq"},{source:"nielsrogge",target:"hardmaru"},{source:"nielsrogge",target:"huggingface"},{source:"nielsrogge",target:"osanseviero"},{source:"nielsrogge",target:"julien_c"},{source:"nielsrogge",target:"clementdelangue"},{source:"nielsrogge",target:"giffmana"},{source:"nielsrogge",target:"soumithchintala"},{source:"nielsrogge",target:"arankomatsuzaki"},{source:"nielsrogge",target:"_nateraw"},{source:"nielsrogge",target:"_lewtun"},{source:"nielsrogge",target:"ai__pub"},{source:"nielsrogge",target:"thom_wolf"},{source:"nielsrogge",target:"wightmanr"},{source:"nielsrogge",target:"deliprao"},{source:"nielsrogge",target:"googleai"},{source:"nielsrogge",target:"openclaw"},{source:"nielsrogge",target:"xai"},{source:"nielsrogge",target:"aelluswamy"},{source:"nielsrogge",target:"askalphaxiv"},{source:"nielsrogge",target:"adinayakup"},{source:"nielsrogge",target:"rao2z"},{source:"nielsrogge",target:"fofrai"},{source:"nvidiadrive",target:"nvidia"},{source:"nvidiadrive",target:"nvidiaaidev"},{source:"nvidiadrive",target:"nvidiarobotics"},{source:"nvidiadrive",target:"nvidiaomniverse"},{source:"nvidiadrive",target:"nvidiadc"},{source:"nvidiadrive",target:"nvidianewsroom"},{source:"nvidiadrive",target:"nvidiahpcdev"},{source:"nvidiadrive",target:"nvidiaworkstatn"},{source:"nvidiadrive",target:"nvidiagtc"},{source:"_lewtun",target:"rasbt"},{source:"_lewtun",target:"tunguz"},{source:"_lewtun",target:"_akhaliq"},{source:"_lewtun",target:"mervenoyann"},{source:"_lewtun",target:"osanseviero"},{source:"_lewtun",target:"huggingface"},{source:"_lewtun",target:"julien_c"},{source:"_lewtun",target:"jeremyphoward"},{source:"_lewtun",target:"abhi1thakur"},{source:"_lewtun",target:"clementdelangue"},{source:"_lewtun",target:"drjimfan"},{source:"_lewtun",target:"pytorch"},{source:"_lewtun",target:"_nateraw"},{source:"_lewtun",target:"soumithchintala"},{source:"_lewtun",target:"arankomatsuzaki"},{source:"_lewtun",target:"littmath"},{source:"_lewtun",target:"getjonwithit"},{source:"_lewtun",target:"ericzelikman"},{source:"_lewtun",target:"jm_alexia"},{source:"_lewtun",target:"khoomeik"},{source:"nvidiakorea",target:"nvidia"},{source:"nvidiakorea",target:"nvidiadc"},{source:"nvidiakorea",target:"nvidiarobotics"},{source:"nvidiakorea",target:"nvidiadrive"},{source:"nvidiakorea",target:"nvidiaai"},{source:"azaliamirh",target:"soumithchintala"},{source:"azaliamirh",target:"giffmana"},{source:"azaliamirh",target:"arankomatsuzaki"},{source:"azaliamirh",target:"savvyrl"},{source:"azaliamirh",target:"svlevine"},{source:"azaliamirh",target:"jeffdean"},{source:"azaliamirh",target:"deliprao"},{source:"azaliamirh",target:"sarahookr"},{source:"azaliamirh",target:"oriolvinyalsml"},{source:"azaliamirh",target:"woj_zaremba"},{source:"azaliamirh",target:"tdietterich"},{source:"azaliamirh",target:"sedielem"},{source:"azaliamirh",target:"anthropicai"},{source:"azaliamirh",target:"sundeep"},{source:"azaliamirh",target:"saranormous"},{source:"nvidiageforcepl",target:"nvidiagfn"},{source:"shamkakade6",target:"sebastienbubeck"},{source:"shamkakade6",target:"boazbaraktcs"},{source:"shamkakade6",target:"svlevine"},{source:"shamkakade6",target:"tdietterich"},{source:"shamkakade6",target:"natashajaques"},{source:"shamkakade6",target:"srush_nlp"},{source:"shamkakade6",target:"alexgdimakis"},{source:"shamkakade6",target:"sleepinyourhat"},{source:"shamkakade6",target:"giffmana"},{source:"shamkakade6",target:"thom_wolf"},{source:"majmudaradam",target:"sama"},{source:"majmudaradam",target:"woj_zaremba"},{source:"majmudaradam",target:"ilyasut"},{source:"majmudaradam",target:"gavinsbaker"},{source:"majmudaradam",target:"anshitasaini_"},{source:"realmadhuguru",target:"sama"},{source:"realmadhuguru",target:"karpathy"},{source:"realmadhuguru",target:"emollick"},{source:"realmadhuguru",target:"bcherny"},{source:"realmadhuguru",target:"jeffdean"},{source:"realmadhuguru",target:"deryatr_"},{source:"realmadhuguru",target:"fidjissimo"},{source:"realmadhuguru",target:"emostaque"},{source:"lm_zheng",target:"karpathy"},{source:"lm_zheng",target:"ylecun"},{source:"lm_zheng",target:"_akhaliq"},{source:"lm_zheng",target:"drjimfan"},{source:"lm_zheng",target:"pytorch"},{source:"lm_zheng",target:"chhillee"},{source:"lm_zheng",target:"hardmaru"},{source:"lm_zheng",target:"tydsh"},{source:"lm_zheng",target:"bcherny"},{source:"lm_zheng",target:"woj_zaremba"},{source:"lm_zheng",target:"zai_org"},{source:"douwekiela",target:"arankomatsuzaki"},{source:"douwekiela",target:"soumithchintala"},{source:"douwekiela",target:"clementdelangue"},{source:"douwekiela",target:"deliprao"},{source:"douwekiela",target:"giffmana"},{source:"douwekiela",target:"richardsocher"},{source:"douwekiela",target:"huggingface"},{source:"douwekiela",target:"_jasonwei"},{source:"douwekiela",target:"srush_nlp"},{source:"douwekiela",target:"chrmanning"},{source:"douwekiela",target:"sleepinyourhat"},{source:"douwekiela",target:"savvyrl"},{source:"douwekiela",target:"gneubig"},{source:"douwekiela",target:"anthropicai"},{source:"douwekiela",target:"chhillee"},{source:"douwekiela",target:"levie"},{source:"douwekiela",target:"austen"},{source:"douwekiela",target:"woj_zaremba"},{source:"douwekiela",target:"miles_brundage"},{source:"douwekiela",target:"svlevine"},{source:"douwekiela",target:"shaneguml"},{source:"douwekiela",target:"johnschulman2"},{source:"douwekiela",target:"timzaman"},{source:"douwekiela",target:"jackclarksf"},{source:"douwekiela",target:"sedielem"},{source:"jerrod_lew",target:"openclaw"},{source:"zjasper",target:"steipete"},{source:"zjasper",target:"bcherny"},{source:"zjasper",target:"jm_alexia"},{source:"zjasper",target:"askalphaxiv"},{source:"zjasper",target:"jonathanross321"},{source:"dileeplearning",target:"garymarcus"},{source:"dileeplearning",target:"soumithchintala"},{source:"dileeplearning",target:"melmitchell1"},{source:"dileeplearning",target:"deliprao"},{source:"dileeplearning",target:"woj_zaremba"},{source:"dileeplearning",target:"giffmana"},{source:"dileeplearning",target:"felixhill84"},{source:"dileeplearning",target:"savvyrl"},{source:"dileeplearning",target:"roydanroy"},{source:"dileeplearning",target:"sirbayes"},{source:"dileeplearning",target:"miles_brundage"},{source:"dileeplearning",target:"openclaw"},{source:"dileeplearning",target:"officiallogank"},{source:"dileeplearning",target:"lateinteraction"},{source:"nils_reimers",target:"arankomatsuzaki"},{source:"nils_reimers",target:"mervenoyann"},{source:"nils_reimers",target:"julien_c"},{source:"nils_reimers",target:"clementdelangue"},{source:"nils_reimers",target:"huggingface"},{source:"nils_reimers",target:"giffmana"},{source:"nils_reimers",target:"deliprao"},{source:"nils_reimers",target:"richardsocher"},{source:"nils_reimers",target:"osanseviero"},{source:"nils_reimers",target:"thom_wolf"},{source:"nils_reimers",target:"srush_nlp"},{source:"nils_reimers",target:"_lewtun"},{source:"nils_reimers",target:"_jasonwei"},{source:"nils_reimers",target:"steipete"},{source:"nils_reimers",target:"googleaistudio"},{source:"nils_reimers",target:"zai_org"},{source:"nils_reimers",target:"rohanpaul_ai"},{source:"nils_reimers",target:"sebastienbubeck"},{source:"nils_reimers",target:"zjasper"},{source:"avdnoord",target:"soumithchintala"},{source:"avdnoord",target:"sedielem"},{source:"avdnoord",target:"giffmana"},{source:"avdnoord",target:"oriolvinyalsml"},{source:"avdnoord",target:"neuripsconf"},{source:"avdnoord",target:"svlevine"},{source:"avdnoord",target:"mattniessner"},{source:"avdnoord",target:"_jasonwei"},{source:"avdnoord",target:"dpkingma"},{source:"avdnoord",target:"nandodf"},{source:"avdnoord",target:"chatgpt21"},{source:"avdnoord",target:"_mohansolo"},{source:"avdnoord",target:"alexandr_wang"},{source:"avdnoord",target:"shengjia_zhao"},{source:"avdnoord",target:"fofrai"},{source:"pashmerepat",target:"embirico"},{source:"pashmerepat",target:"thsottiaux"},{source:"pashmerepat",target:"gdb"},{source:"pashmerepat",target:"goodside"},{source:"pashmerepat",target:"kalinowski007"},{source:"pashmerepat",target:"chatgpt21"},{source:"hochreitersepp",target:"schmidhuberai"},{source:"hochreitersepp",target:"giffmana"},{source:"hochreitersepp",target:"soumithchintala"},{source:"hochreitersepp",target:"csprofkgd"},{source:"hochreitersepp",target:"sirbayes"},{source:"hochreitersepp",target:"petarv_93"},{source:"hochreitersepp",target:"mmbronstein"},{source:"hochreitersepp",target:"roydanroy"},{source:"hochreitersepp",target:"sedielem"},{source:"hochreitersepp",target:"savvyrl"},{source:"hochreitersepp",target:"neuripsconf"},{source:"hochreitersepp",target:"oriolvinyalsml"},{source:"hochreitersepp",target:"tdietterich"},{source:"hochreitersepp",target:"sama"},{source:"hochreitersepp",target:"emostaque"},{source:"hochreitersepp",target:"thom_wolf"},{source:"hochreitersepp",target:"pytorch"},{source:"hochreitersepp",target:"openai"},{source:"rayhotate",target:"bcherny"},{source:"lerobothf",target:"nvidiarobotics"},{source:"lerobothf",target:"julien_c"},{source:"lerobothf",target:"huggingface"},{source:"lerobothf",target:"thom_wolf"},{source:"lerobothf",target:"clementdelangue"},{source:"lerobothf",target:"remicadene"},{source:"andy_l_jones",target:"anthropicai"},{source:"andy_l_jones",target:"amandaaskell"},{source:"andy_l_jones",target:"jackclarksf"},{source:"andy_l_jones",target:"arankomatsuzaki"},{source:"andy_l_jones",target:"janleike"},{source:"andy_l_jones",target:"catherineols"},{source:"andy_l_jones",target:"sleepinyourhat"},{source:"andy_l_jones",target:"ch402"},{source:"andy_l_jones",target:"chhillee"},{source:"andy_l_jones",target:"darioamodei"},{source:"andy_l_jones",target:"zeyuanallenzhu"},{source:"andy_l_jones",target:"alexalbert__"},{source:"qhwang3",target:"_akhaliq"},{source:"qhwang3",target:"ylecun"},{source:"qhwang3",target:"karpathy"},{source:"qhwang3",target:"drjimfan"},{source:"qhwang3",target:"petarv_93"},{source:"qhwang3",target:"hardmaru"},{source:"qhwang3",target:"arankomatsuzaki"},{source:"qhwang3",target:"googledeepmind"},{source:"qhwang3",target:"fchollet"},{source:"qhwang3",target:"chhillee"},{source:"qhwang3",target:"anthropicai"},{source:"qhwang3",target:"andrewyng"},{source:"qhwang3",target:"_jasonwei"},{source:"qhwang3",target:"mmbronstein"},{source:"qhwang3",target:"srush_nlp"},{source:"qhwang3",target:"johnschulman2"},{source:"qhwang3",target:"shengjia_zhao"},{source:"qhwang3",target:"heinrichkuttler"},{source:"qhwang3",target:"imhaotian"},{source:"qhwang3",target:"perplexity_ai"},{source:"qhwang3",target:"officiallogank"},{source:"qhwang3",target:"ibab"},{source:"qhwang3",target:"tobyphln"},{source:"qhwang3",target:"lm_zheng"},{source:"koylanai",target:"arena"},{source:"koylanai",target:"moltbook"},{source:"koylanai",target:"openclaw"},{source:"josh_tobin_",target:"omarsar0"},{source:"josh_tobin_",target:"soumithchintala"},{source:"josh_tobin_",target:"jeremyphoward"},{source:"josh_tobin_",target:"richardsocher"},{source:"josh_tobin_",target:"woj_zaremba"},{source:"josh_tobin_",target:"iamtrask"},{source:"josh_tobin_",target:"savvyrl"},{source:"josh_tobin_",target:"svlevine"},{source:"josh_tobin_",target:"risingsayak"},{source:"josh_tobin_",target:"shaneguml"},{source:"josh_tobin_",target:"jsuarez"},{source:"josh_tobin_",target:"ericzelikman"},{source:"josh_tobin_",target:"embirico"},{source:"nvidiahealth",target:"googledeepmind"},{source:"nvidiahealth",target:"nvidiaai"},{source:"nvidiahealth",target:"nvidia"},{source:"nvidiahealth",target:"nvidiaaidev"},{source:"nvidiahealth",target:"nvidiarobotics"},{source:"nvidiahealth",target:"nvidiadc"},{source:"nvidiahealth",target:"tensorflow"},{source:"nvidiahealth",target:"nvidiahpcdev"},{source:"nvidiahealth",target:"neuripsconf"},{source:"nvidiahealth",target:"ctnzr"},{source:"nvidiahealth",target:"nvidianewsroom"},{source:"anshitasaini_",target:"thsottiaux"},{source:"anshitasaini_",target:"amandaaskell"},{source:"anshitasaini_",target:"soumithchintala"},{source:"anshitasaini_",target:"yanndubs"},{source:"anshitasaini_",target:"johnschulman2"},{source:"anshitasaini_",target:"addyosmani"},{source:"pirroh",target:"sama"},{source:"pirroh",target:"karpathy"},{source:"pirroh",target:"ylecun"},{source:"pirroh",target:"fchollet"},{source:"pirroh",target:"hardmaru"},{source:"pirroh",target:"gdb"},{source:"pirroh",target:"rasbt"},{source:"pirroh",target:"goodside"},{source:"pirroh",target:"googledeepmind"},{source:"pirroh",target:"_akhaliq"},{source:"pirroh",target:"drjimfan"},{source:"pirroh",target:"mmbronstein"},{source:"pirroh",target:"bcherny"},{source:"pirroh",target:"richardsocher"},{source:"pirroh",target:"emollick"},{source:"pirroh",target:"pashmerepat"},{source:"ancadianadragan",target:"svlevine"},{source:"ancadianadragan",target:"anthropicai"},{source:"ancadianadragan",target:"tdietterich"},{source:"ancadianadragan",target:"chrmanning"},{source:"ancadianadragan",target:"sleepinyourhat"},{source:"ancadianadragan",target:"amandaaskell"},{source:"ancadianadragan",target:"yoshua_bengio"},{source:"ancadianadragan",target:"alexandr_wang"},{source:"ancadianadragan",target:"sama"},{source:"ancadianadragan",target:"googledeepmind"},{source:"ancadianadragan",target:"johnschulman2"},{source:"ancadianadragan",target:"oriolvinyalsml"},{source:"ancadianadragan",target:"ch402"},{source:"ancadianadragan",target:"esyudkowsky"},{source:"ancadianadragan",target:"zoubinghahrama1"},{source:"ancadianadragan",target:"zicokolter"},{source:"ancadianadragan",target:"koraykv"},{source:"ancadianadragan",target:"satyanadella"},{source:"ancadianadragan",target:"openai"},{source:"ancadianadragan",target:"hendrycks"},{source:"ancadianadragan",target:"geoffreyhinton"},{source:"ancadianadragan",target:"mmitchell_ai"},{source:"kalinowski007",target:"sama"},{source:"kalinowski007",target:"palmerluckey"},{source:"kalinowski007",target:"cixliv"},{source:"kalinowski007",target:"levie"},{source:"kalinowski007",target:"amandaaskell"},{source:"kalinowski007",target:"moltbook"},{source:"kalinowski007",target:"pashmerepat"},{source:"kalinowski007",target:"tunguz"},{source:"adinayakup",target:"gavinsbaker"},{source:"adinayakup",target:"mistralai"},{source:"dspyoss",target:"tom_doerr"},{source:"tulseedoshi",target:"sama"},{source:"tulseedoshi",target:"mmitchell_ai"},{source:"tulseedoshi",target:"karpathy"},{source:"tulseedoshi",target:"sarahookr"},{source:"tulseedoshi",target:"andrewyng"},{source:"tulseedoshi",target:"googleai"},{source:"tulseedoshi",target:"jeffdean"},{source:"tulseedoshi",target:"jackclarksf"},{source:"tulseedoshi",target:"antigravity"},{source:"tulseedoshi",target:"emostaque"},{source:"tulseedoshi",target:"emollick"},{source:"tulseedoshi",target:"fidjissimo"},{source:"tulseedoshi",target:"ancadianadragan"},{source:"tulseedoshi",target:"googledeepmind"},{source:"tulseedoshi",target:"_mohansolo"},{source:"felixhill84",target:"deliprao"},{source:"felixhill84",target:"chrmanning"},{source:"felixhill84",target:"savvyrl"},{source:"felixhill84",target:"srush_nlp"},{source:"felixhill84",target:"egrefen"},{source:"felixhill84",target:"_jasonwei"},{source:"felixhill84",target:"sleepinyourhat"},{source:"felixhill84",target:"shaneguml"},{source:"felixhill84",target:"tdietterich"},{source:"felixhill84",target:"oriolvinyalsml"},{source:"felixhill84",target:"sedielem"},{source:"felixhill84",target:"yoshua_bengio"},{source:"felixhill84",target:"_akhaliq"},{source:"felixhill84",target:"clementdelangue"},{source:"felixhill84",target:"mervenoyann"},{source:"felixhill84",target:"thom_wolf"},{source:"felixhill84",target:"sashamtl"},{source:"felixhill84",target:"boazbaraktcs"},{source:"felixhill84",target:"khoomeik"},{source:"guohao_li",target:"_akhaliq"},{source:"guohao_li",target:"petarv_93"},{source:"guohao_li",target:"karpathy"},{source:"guohao_li",target:"mmbronstein"},{source:"guohao_li",target:"giffmana"},{source:"guohao_li",target:"roydanroy"},{source:"guohao_li",target:"darioamodei"},{source:"yanndubs",target:"ylecun"},{source:"yanndubs",target:"_akhaliq"},{source:"yanndubs",target:"drjimfan"},{source:"yanndubs",target:"giffmana"},{source:"yanndubs",target:"thegautamkamath"},{source:"yanndubs",target:"soumithchintala"},{source:"yanndubs",target:"roydanroy"},{source:"yanndubs",target:"pytorch"},{source:"yanndubs",target:"neuripsconf"},{source:"yanndubs",target:"sarahookr"},{source:"yanndubs",target:"csprofkgd"},{source:"yanndubs",target:"thsottiaux"},{source:"yanndubs",target:"fidjissimo"},{source:"imhaotian",target:"billpeeb"},{source:"nvidiaaijp",target:"nvidiajapan"},{source:"nvidiaaijp",target:"nvidianewsroom"},{source:"nvidiaaijp",target:"nvidiaomniverse"},{source:"nvidiaaijp",target:"nvidiahealth"},{source:"itstkai",target:"pashmerepat"},{source:"itstkai",target:"stevenbjohnson"},{source:"_nateraw",target:"_akhaliq"},{source:"_nateraw",target:"rasbt"},{source:"_nateraw",target:"hardmaru"},{source:"_nateraw",target:"tunguz"},{source:"_nateraw",target:"emostaque"},{source:"_nateraw",target:"mervenoyann"},{source:"_nateraw",target:"osanseviero"},{source:"_nateraw",target:"omarsar0"},{source:"_nateraw",target:"julien_c"},{source:"_nateraw",target:"goodside"},{source:"_nateraw",target:"huggingface"},{source:"_nateraw",target:"drjimfan"},{source:"_nateraw",target:"clementdelangue"},{source:"_nateraw",target:"googledeepmind"},{source:"_nateraw",target:"jeremyphoward"},{source:"_nateraw",target:"abhi1thakur"},{source:"_nateraw",target:"_lewtun"},{source:"_nateraw",target:"zai_org"},{source:"_nateraw",target:"darioamodei"},{source:"_nateraw",target:"neuripsconf"},{source:"_nateraw",target:"jsuarez"},{source:"khipu_ai",target:"neuripsconf"},{source:"khipu_ai",target:"oriolvinyalsml"},{source:"khipu_ai",target:"nandodf"},{source:"khipu_ai",target:"soumithchintala"},{source:"khipu_ai",target:"sarahookr"},{source:"khipu_ai",target:"wimlworkshop"},{source:"khipu_ai",target:"ch402"},{source:"anujsaharan_",target:"sama"},{source:"anujsaharan_",target:"karpathy"},{source:"anujsaharan_",target:"gdb"},{source:"anujsaharan_",target:"thsottiaux"},{source:"anujsaharan_",target:"realmadhuguru"},{source:"anujsaharan_",target:"kalomaze"},{source:"anujsaharan_",target:"agarwl_"}]};var uee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const cee=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hee=(i,e)=>{const t=mt.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:a,children:o,...l},c)=>mt.createElement("svg",{ref:c,...uee,width:r,height:r,stroke:n,strokeWidth:a?Number(s)*24/Number(r):s,className:`lucide lucide-${cee(i)}`,...l},[...e.map(([d,f])=>mt.createElement(d,f)),...(Array.isArray(o)?o:[o])||[]]));return t.displayName=`${i}`,t};var Zs=hee;const Sb=Zs("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),dee=Zs("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),gR=Zs("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),fee=Zs("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),pee=Zs("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),gee=Zs("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),mee=Zs("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),_ee=Zs("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),yee=Zs("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),vee=Zs("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),m0=Zs("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),nl={name:"Jenny",handle:"Jenny_the_Bunny",bio:"Building cool things with AI. Creator of this AI influencer page. Let's be friends on X!",joinedDate:"Mar 2015 but never used until Feb 2026"};function xee(){var z,B;const[i]=mt.useState(lee),[e,t]=mt.useState(window.innerWidth<768),[n,r]=mt.useState(window.innerWidth>=768),[s,a]=mt.useState(!0),[o,l]=mt.useState(!1),[c,d]=mt.useState(null),[f,p]=mt.useState(!1),[m,_]=mt.useState(""),[b,v]=mt.useState(null);mt.useRef(null);const y=mt.useRef(new Map);mt.useEffect(()=>{const O=()=>{const V=window.innerWidth<768;t(V),V&&n&&window.innerWidth<768&&r(!1)};return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]);const S=mt.useMemo(()=>{const O=new Map;return i.links.forEach(V=>{const Y=typeof V.source=="object"?V.source.id:V.source,G=typeof V.target=="object"?V.target.id:V.target;O.set(Y,(O.get(Y)||0)+1),O.set(G,(O.get(G)||0)+1)}),[...i.nodes].map(V=>({...V,val:O.get(V.id)||0})).sort((V,Y)=>(Y.followers||Y.val||0)-(V.followers||V.val||0))},[i]),T=mt.useMemo(()=>{const O=new Map;return S.forEach((V,Y)=>{O.set(V.id,Y+1)}),O},[S]),E=mt.useMemo(()=>{let O=S;if(b&&(O=O.filter(V=>V.group===b)),m.trim()){const V=m.toLowerCase().trim();O=O.filter(Y=>{const G=(Y.name||"").toLowerCase(),W=(Y.handle||"").toLowerCase(),te=(Y.role||"").toLowerCase(),U=(Y.associated||"").toLowerCase(),H=(Y.bio||"").toLowerCase(),le=(Y.bioTags||[]).join(" ").toLowerCase();return G.includes(V)||W.includes(V)||te.includes(V)||U.includes(V)||H.includes(V)||le.includes(V)})}return O},[S,m,b]),N=mt.useMemo(()=>{if(!b)return i;const O=new Set(i.nodes.filter(V=>V.group===b).map(V=>V.id));return{nodes:i.nodes.filter(V=>O.has(V.id)),links:i.links.filter(V=>{const Y=typeof V.source=="object"?V.source.id:V.source,G=typeof V.target=="object"?V.target.id:V.target;return O.has(Y)&&O.has(G)})}},[i,b]);mt.useEffect(()=>{if(c&&y.current.has(c.id)){const O=y.current.get(c.id);O==null||O.scrollIntoView({behavior:"smooth",block:"nearest"})}},[c]),(z=i==null?void 0:i.nodes)!=null&&z.length,(B=i==null?void 0:i.links)!=null&&B.length;const M=O=>{if(p(!1),(c==null?void 0:c.id)===O.id){d(null);return}d(O),e&&r(!1)},C=()=>{d(null),p(!1)},D=O=>{v(V=>V===O?null:O),d(null),p(!1)},R=O=>O.imageUrl?O.imageUrl:O.handle?`https://unavatar.io/twitter/${O.handle}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(O.name)}&background=random&color=fff&size=128`,P=O=>{O.currentTarget.onerror=null,c&&(O.currentTarget.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(c.name)}&background=1e293b&color=cbd5e1&size=128`)},L=O=>O?O>=1e6?`${(O/1e6).toFixed(1)}M`:O>=1e3?`${(O/1e3).toFixed(1)}K`:O.toString():"0";return me.jsxs("div",{className:"w-full h-screen relative overflow-hidden bg-[#0B0C15] text-white font-sans",children:[me.jsx(aee,{data:N,onNodeClick:M,onClearSelection:C,selectedNode:c,keepOrphans:!!b}),me.jsxs("div",{className:`absolute top-0 left-0 h-full bg-[#05060A]/80 backdrop-blur-xl border-r border-white/10 z-30 transition-all duration-300 ease-in-out flex flex-col ${e?n?"w-72 translate-x-0":"w-72 -translate-x-72":n?"w-80 translate-x-0":"w-80 -translate-x-80"}`,children:[me.jsxs("div",{className:"px-4 py-3 border-b border-white/10 bg-[#05060A]/50",children:[me.jsx("h1",{className:"text-xl font-display font-bold text-white tracking-tight",children:"Top AI Influencers on X"}),me.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:["Data last updated: ",oee]})]}),me.jsx("div",{className:"p-3 border-b border-white/10",children:me.jsxs("div",{className:"relative",children:[me.jsx(vee,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),me.jsx("input",{type:"text",placeholder:"Search by name, handle, or role...",value:m,onChange:O=>_(O.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-800/50 border border-white/10 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50"}),m&&me.jsx("button",{onClick:()=>_(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white",children:me.jsx(m0,{className:"w-4 h-4"})})]})}),me.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-2 custom-scrollbar",children:E.map((O,V)=>{const Y=(c==null?void 0:c.id)===O.id;return me.jsxs("button",{ref:G=>{G?y.current.set(O.id,G):y.current.delete(O.id)},onClick:()=>M(O),className:`w-full text-left p-3 rounded-xl mb-1 flex items-center gap-3 transition-all duration-200 border ${Y?"bg-indigo-600/20 border-indigo-500/50 shadow-lg shadow-indigo-900/20":"hover:bg-white/5 border-transparent"}`,children:[me.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${Y?"bg-indigo-500 text-white":"bg-slate-800 text-slate-400"}`,children:T.get(O.id)}),me.jsxs("div",{className:"min-w-0 flex-1",children:[me.jsxs("div",{className:"flex items-baseline gap-1.5 truncate",children:[me.jsx("span",{className:`text-sm font-semibold ${Y?"text-white":"text-slate-200"}`,children:O.name}),O.handle&&me.jsxs("span",{className:"text-xs text-slate-500 font-mono truncate",children:["@",O.handle]})]}),me.jsxs("div",{className:"flex items-center justify-between gap-2 mt-0.5",children:[me.jsx("span",{className:"text-xs text-slate-500 truncate flex-1",children:O.role?`${O.role}${O.associated&&O.associated!==O.name?` @ ${O.associated}`:""}`:""}),me.jsx("span",{className:"text-[10px] text-slate-600 whitespace-nowrap shrink-0",children:O.followers?O.followers>=1e6?`${(O.followers/1e6).toFixed(1)}M`:`${Math.round(O.followers/1e3)}K`:`${O.val} conn.`})]})]})]},O.id)})}),me.jsx("div",{className:"border-t border-white/10 bg-[#05060A]/50 p-2",children:me.jsxs("button",{onClick:()=>{d(null),p(!0)},className:`w-full text-left p-3 rounded-xl flex items-center gap-3 transition-all duration-200 border ${f?"bg-indigo-600/20 border-indigo-500/50":"hover:bg-white/5 border-transparent"}`,children:[me.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${f?"bg-indigo-500 text-white":"bg-slate-800 text-slate-400"}`,children:"x"}),me.jsxs("div",{className:"min-w-0 flex-1",children:[me.jsxs("div",{className:"flex items-baseline gap-1.5 truncate",children:[me.jsx("span",{className:`text-sm font-semibold ${f?"text-white":"text-slate-200"}`,children:"Jenny"}),me.jsx("span",{className:"text-xs text-slate-500 font-mono truncate",children:"@Jenny_the_Bunny"})]}),me.jsx("div",{className:"flex items-center gap-2 mt-0.5",children:me.jsx("span",{className:"text-xs text-slate-500 truncate",children:"Creator of this page"})})]})]})})]}),me.jsx("button",{onClick:()=>r(!n),className:`absolute top-6 z-40 p-2 bg-slate-800/80 text-white border border-white/10 rounded-r-lg hover:bg-slate-700 transition-all duration-300 ${e?n?"left-72":"left-0":n?"left-80":"left-0"}`,children:n?me.jsx(fee,{className:"w-4 h-4"}):me.jsx(yee,{className:"w-4 h-4"})}),(c||f)&&me.jsxs("div",{className:`fixed z-50 animate-in fade-in duration-300 pointer-events-none flex flex-col gap-4 ${e?"bottom-20 left-4 right-4 w-auto":"top-6 right-6 w-[400px] max-w-[calc(100vw-48px)] slide-in-from-right-10"}`,children:[f&&me.jsxs("div",{className:"bg-[#090A10]/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl pointer-events-auto relative overflow-hidden group",children:[me.jsx("div",{className:"h-24 bg-gradient-to-br from-pink-900/50 via-slate-800/50 to-indigo-900/30 relative",children:me.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#090A10]/80 to-transparent"})}),me.jsx("button",{onClick:C,className:"absolute top-3 right-3 p-1.5 bg-black/40 hover:bg-black/60 rounded-full text-white/80 hover:text-white transition-colors z-20 backdrop-blur-sm",children:me.jsx(m0,{className:"w-4 h-4"})}),me.jsxs("div",{className:"px-4 pb-4 relative",children:[me.jsxs("div",{className:"flex justify-between items-start",children:[me.jsx("div",{className:"relative -mt-12 mb-3",children:me.jsx("img",{src:R(nl),alt:nl.name,onError:O=>{O.currentTarget.onerror=null,O.currentTarget.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(nl.name)}&background=1e293b&color=cbd5e1&size=128`},className:"w-20 h-20 rounded-full border-4 border-[#090A10] object-cover bg-slate-800 shadow-lg"})}),me.jsx("a",{href:`https://x.com/${nl.handle}`,target:"_blank",rel:"noopener noreferrer",className:"mt-3 px-5 py-2 bg-white hover:bg-white/90 text-black font-bold text-sm rounded-full transition-all",children:"Follow"})]}),me.jsxs("div",{className:"mb-3",children:[me.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-1.5",children:[nl.name,me.jsx(Sb,{className:"w-5 h-5 text-blue-400 fill-blue-400/20"})]}),me.jsxs("div",{className:"text-slate-500 text-sm",children:["@",nl.handle]})]}),me.jsx("p",{className:"text-sm text-slate-200 leading-relaxed mb-3",children:nl.bio}),me.jsx("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-slate-500 mb-4",children:me.jsxs("div",{className:"flex items-center gap-1",children:[me.jsx(gR,{className:"w-4 h-4"}),me.jsxs("span",{children:["Joined ",nl.joinedDate]})]})})]})]}),c&&me.jsx(me.Fragment,{children:me.jsxs("div",{className:"bg-[#090A10]/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl pointer-events-auto relative overflow-hidden group",children:[me.jsx("div",{className:"h-24 bg-gradient-to-br from-indigo-900/50 via-slate-800/50 to-purple-900/30 relative",children:me.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#090A10]/80 to-transparent"})}),me.jsx("button",{onClick:C,className:"absolute top-3 right-3 p-1.5 bg-black/40 hover:bg-black/60 rounded-full text-white/80 hover:text-white transition-colors z-20 backdrop-blur-sm",children:me.jsx(m0,{className:"w-4 h-4"})}),me.jsxs("div",{className:"px-4 pb-4 relative",children:[me.jsxs("div",{className:"flex justify-between items-start",children:[me.jsxs("div",{className:"relative -mt-12 mb-3",children:[me.jsx("img",{src:R(c),alt:c.name,onError:P,className:"w-20 h-20 rounded-full border-4 border-[#090A10] object-cover bg-slate-800 shadow-lg"}),c.group==="company"&&me.jsx("div",{className:"absolute -bottom-1 -right-1 bg-[#090A10] rounded-full p-1",children:me.jsx(dee,{className:"w-4 h-4 text-amber-400"})})]}),c.handle&&me.jsx("a",{href:`https://x.com/${c.handle}`,target:"_blank",rel:"noopener noreferrer",className:"mt-3 px-5 py-2 bg-white hover:bg-white/90 text-black font-bold text-sm rounded-full transition-all",children:"Follow"})]}),me.jsxs("div",{className:"mb-3",children:[me.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-1.5",children:[c.name,c.verified==="gold"&&me.jsx(Sb,{className:"w-5 h-5 text-amber-400 fill-amber-400/20"}),c.verified==="blue"&&me.jsx(Sb,{className:"w-5 h-5 text-blue-400 fill-blue-400/20"})]}),me.jsxs("div",{className:"text-slate-500 text-sm",children:["@",c.handle]})]}),(c.bio||c.role)&&me.jsx("p",{className:"text-sm text-slate-200 leading-relaxed mb-3",children:c.bio||`${c.role}${c.associated?` @ ${c.associated}`:""}`}),me.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-slate-500 mb-4",children:[c.location&&me.jsxs("div",{className:"flex items-center gap-1",children:[me.jsx(_ee,{className:"w-4 h-4"}),me.jsx("span",{children:c.location})]}),c.website&&me.jsxs("a",{href:`https://${c.website}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-indigo-400 hover:underline",children:[me.jsx(mee,{className:"w-4 h-4"}),me.jsx("span",{children:c.website})]}),c.joinedDate&&me.jsxs("div",{className:"flex items-center gap-1",children:[me.jsx(gR,{className:"w-4 h-4"}),me.jsxs("span",{children:["Joined ",c.joinedDate]})]})]}),(c.followers||c.following)&&me.jsxs("div",{className:"flex gap-4 text-sm",children:[c.following!==void 0&&me.jsxs("div",{children:[me.jsx("span",{className:"font-bold text-white",children:L(c.following)}),me.jsx("span",{className:"text-slate-500 ml-1",children:"Following"})]}),c.followers!==void 0&&me.jsxs("div",{children:[me.jsx("span",{className:"font-bold text-white",children:L(c.followers)}),me.jsx("span",{className:"text-slate-500 ml-1",children:"Followers"})]})]})]})]})})]}),me.jsxs("div",{className:`absolute z-20 bg-[#0B0C15]/80 backdrop-blur-md border border-white/10 rounded-xl transition-all duration-300 ease-in-out ${e?"top-4 right-4":"bottom-6 right-6"} ${s?"p-4":"p-2"}`,children:[me.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-2 w-full text-left",children:[me.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider font-medium",children:"Legend"}),me.jsx(pee,{className:`w-3 h-3 text-slate-400 transition-transform duration-300 ${s?"rotate-90":""}`})]}),me.jsxs("div",{className:`flex flex-col gap-1 overflow-hidden transition-all duration-300 ease-in-out ${s?"mt-3 max-h-60 opacity-100":"max-h-0 opacity-0"}`,children:[[{key:"company",color:"#FFD4A3",label:"Company / Organization"},{key:"founder",color:"#A3D4FF",label:"Founder / Builder"},{key:"researcher",color:"#E0B3FF",label:"Researcher / Academia"},{key:"investor",color:"#B3FFB3",label:"Investor"},{key:"media",color:"#FFB3D9",label:"Media"}].map(O=>me.jsxs("button",{onClick:()=>D(O.key),className:`flex items-center gap-2 px-2 py-1 rounded-md transition-all duration-200 text-left ${b===O.key?"bg-white/10 ring-1 ring-white/20":"hover:bg-white/5"} ${b&&b!==O.key?"opacity-40":"opacity-100"}`,children:[me.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:O.color,boxShadow:`0 0 8px ${O.color}`}}),me.jsx("span",{className:"text-xs text-slate-300",children:O.label})]},O.key)),b&&me.jsx("button",{onClick:()=>{v(null),d(null)},className:"text-[10px] text-indigo-400 hover:text-indigo-300 transition-colors mt-1 px-2",children:"Clear filter"}),me.jsx("div",{className:"border-t border-white/10 my-2"}),me.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-1.5 text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:[me.jsx(gee,{className:"w-3.5 h-3.5"}),me.jsx("span",{children:"Methodology"})]})]})]}),o&&me.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[me.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>l(!1)}),me.jsxs("div",{className:"relative bg-[#0B0C15] border border-white/10 rounded-2xl shadow-2xl max-w-lg w-full max-h-[80vh] overflow-y-auto custom-scrollbar",children:[me.jsxs("div",{className:"sticky top-0 bg-[#0B0C15] border-b border-white/10 px-6 py-4 flex items-center justify-between",children:[me.jsx("h2",{className:"text-lg font-bold text-white",children:"Methodology"}),me.jsx("button",{onClick:()=>l(!1),className:"p-1.5 hover:bg-white/10 rounded-full text-slate-400 hover:text-white transition-colors",children:me.jsx(m0,{className:"w-5 h-5"})})]}),me.jsxs("div",{className:"px-5 py-3 space-y-2.5",children:[me.jsxs("div",{children:[me.jsx("h3",{className:"text-xs font-semibold text-indigo-400 uppercase tracking-wider mb-1",children:"Discovery & Selection"}),me.jsxs("p",{className:"text-xs text-slate-300 leading-relaxed",children:["Starting from ",me.jsx("span",{className:"text-white font-medium",children:"seed accounts"})," (OpenAI, Anthropic, DeepMind, top researchers), we crawl who they follow to find AI voices. If multiple trusted sources follow someone, they matter. The top 300 are selected using:"]}),me.jsxs("div",{className:"bg-slate-800/50 border border-white/10 rounded-md px-2.5 py-1.5 font-mono text-xs text-white mt-1.5 mb-1",children:["Score = log",me.jsx("sub",{children:"10"}),"(followers) x seed_connections"]}),me.jsx("p",{className:"text-xs text-slate-400",children:"Log scale prevents mega-accounts from dominating. Minimum 1K followers, AI keywords in bio, blocklist for general media."})]}),me.jsxs("div",{children:[me.jsx("h3",{className:"text-xs font-semibold text-indigo-400 uppercase tracking-wider mb-1",children:"Graph & Connections"}),me.jsxs("p",{className:"text-xs text-slate-300 leading-relaxed",children:["The default view shows all connections. ",me.jsx("span",{className:"text-white font-medium",children:"Click a node"})," to see who they follow. Node sizes reflect followers. Filter by category using the legend."]})]}),me.jsx("div",{className:"pt-2 border-t border-white/10",children:me.jsxs("p",{className:"text-xs text-slate-400",children:["This methodology may not be perfect. Have ideas?"," ",me.jsx("a",{href:"https://x.com/Jenny_the_Bunny",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:text-indigo-300",children:"Hit me up on X"})]})})]})]})]}),me.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: rgba(255, 255, 255, 0.02);
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.1);
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.2);
        }
        @keyframes moveRight {
          0% { left: -6px; }
          100% { left: calc(100% + 6px); }
        }
      `})]})}const OD=document.getElementById("root");if(!OD)throw new Error("Could not find root element to mount to");const bee=AI.createRoot(OD);bee.render(me.jsxs(mR.StrictMode,{children:[me.jsx(xee,{}),me.jsx(FI,{})]}));
